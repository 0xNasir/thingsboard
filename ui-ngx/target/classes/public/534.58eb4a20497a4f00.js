"use strict";(self.webpackChunkthingsboard=self.webpackChunkthingsboard||[]).push([[534],{40534:(B_,So,c)=>{c.r(So),c.d(So,{HomePagesModule:()=>di});var e=c(98678),p=c(35103),b=c(67522),se=c(77767),r=c(5476),Pe=c(75883),Fa=c(97493),V=c(57395),T=c(9351),be=c(716),xe=c(90654),Y=c(35879),$=c(15068),to=c(59771),pi=c(4752),Fn=c(22378),x=c(83976),g=c(96342),De=c(99952),S=c(76070),mi=c(52018),fe=c(3759),F=c(12165),A=c(18730),z=c(15277),O=c(91137),_=c(70976),ye=c(10622),X=c(76439),Ce=c(33122),U=c(75705),ve=c(23968),h=c(89097),G=c(80095),Io=c(68971),no=c(43603);function Sr(i,n){1&i&&e.\u0275\u0275element(0,"mat-progress-bar",29)}function Ir(i,n){1&i&&e.\u0275\u0275element(0,"div",30)}function wr(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.mail-from-required")," "))}function Er(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-option",31),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){const t=n.$implicit,a=e.\u0275\u0275nextContext();let o;e.\u0275\u0275property("value",t),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",(null==(o=a.templates.get(t))?null:o.name)||"Custom"," ")}}function Mr(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-option",31),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){const t=n.$implicit;e.\u0275\u0275property("value",t),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",t.toUpperCase()," ")}}function Dr(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.smtp-host-required")," "))}function Ar(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.smtp-port-required")," "))}function Nr(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.smtp-port-invalid")," "))}function Fr(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.timeout-required")," "))}function Lr(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.timeout-invalid")," "))}function Pr(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-option",31),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){const t=n.$implicit;e.\u0275\u0275property("value",t),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",t," ")}}function kr(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-form-field",45)(1,"mat-label",10),e.\u0275\u0275text(2,"admin.tls-version"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"mat-select",46),e.\u0275\u0275template(4,Pr,2,2,"mat-option",14),e.\u0275\u0275elementEnd()()),2&i){const t=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(4),e.\u0275\u0275property("ngForOf",t.tlsVersions)}}function Rr(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.proxy-host-required")," "))}function Or(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.proxy-port-required")," "))}function Br(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.proxy-port-range")," "))}function Vr(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div")(1,"div",47)(2,"mat-form-field",34)(3,"mat-label",10),e.\u0275\u0275text(4,"admin.proxy-host"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(5,"input",48),e.\u0275\u0275template(6,Rr,3,3,"mat-error",12),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(7,"mat-form-field",36)(8,"mat-label",10),e.\u0275\u0275text(9,"admin.proxy-port"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(10,"input",49),e.\u0275\u0275template(11,Or,3,3,"mat-error",12),e.\u0275\u0275template(12,Br,3,3,"mat-error",12),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(13,"div",50)(14,"mat-form-field",45)(15,"mat-label",10),e.\u0275\u0275text(16,"admin.proxy-user"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(17,"input",51),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(18,"mat-form-field",45)(19,"mat-label",10),e.\u0275\u0275text(20,"admin.proxy-password"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(21,"input",52)(22,"tb-toggle-password",53),e.\u0275\u0275elementEnd()()()),2&i){const t=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(6),e.\u0275\u0275property("ngIf",t.mailSettings.get("proxyHost").hasError("required")),e.\u0275\u0275advance(5),e.\u0275\u0275property("ngIf",t.mailSettings.get("proxyPort").hasError("required")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.mailSettings.get("proxyPort").hasError("pattern")||t.mailSettings.get("proxyPort").hasError("min")||t.mailSettings.get("proxyPort").hasError("max"))}}function Ur(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-form-field",9)(1,"mat-label",10),e.\u0275\u0275text(2,"admin.smtp-protocol"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"mat-select",32),e.\u0275\u0275template(4,Mr,2,2,"mat-option",14),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(5,"div",33)(6,"mat-form-field",34)(7,"mat-label",10),e.\u0275\u0275text(8,"admin.smtp-host"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(9,"input",35),e.\u0275\u0275template(10,Dr,3,3,"mat-error",12),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(11,"mat-form-field",36)(12,"mat-label",10),e.\u0275\u0275text(13,"admin.smtp-port"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(14,"input",37,38),e.\u0275\u0275elementStart(16,"mat-hint",39),e.\u0275\u0275text(17),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(18,Ar,3,3,"mat-error",12),e.\u0275\u0275template(19,Nr,3,3,"mat-error",12),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(20,"mat-form-field",9)(21,"mat-label",10),e.\u0275\u0275text(22,"admin.timeout-msec"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(23,"input",40,41),e.\u0275\u0275elementStart(25,"mat-hint",39),e.\u0275\u0275text(26),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(27,Fr,3,3,"mat-error",12),e.\u0275\u0275template(28,Lr,3,3,"mat-error",12),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(29,"mat-slide-toggle",42),e.\u0275\u0275text(30),e.\u0275\u0275pipe(31,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(32,kr,5,1,"mat-form-field",43),e.\u0275\u0275elementStart(33,"mat-slide-toggle",44),e.\u0275\u0275text(34),e.\u0275\u0275pipe(35,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(36,Vr,23,3,"div",12)),2&i){const t=e.\u0275\u0275reference(15),a=e.\u0275\u0275reference(24),o=e.\u0275\u0275nextContext();e.\u0275\u0275advance(4),e.\u0275\u0275property("ngForOf",o.smtpProtocols),e.\u0275\u0275advance(6),e.\u0275\u0275property("ngIf",o.mailSettings.get("smtpHost").hasError("required")),e.\u0275\u0275advance(7),e.\u0275\u0275textInterpolate1("",(null==t.value?null:t.value.length)||0,"/5"),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",o.mailSettings.get("smtpPort").hasError("required")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",o.mailSettings.get("smtpPort").hasError("pattern")||o.mailSettings.get("smtpPort").hasError("maxlength")),e.\u0275\u0275advance(7),e.\u0275\u0275textInterpolate1("",(null==a.value?null:a.value.length)||0,"/6"),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",o.mailSettings.get("timeout").hasError("required")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",o.mailSettings.get("timeout").hasError("pattern")||o.mailSettings.get("timeout").hasError("maxlength")),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(31,12,"admin.enable-tls")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",o.mailSettings.get("enableTls").value),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(35,14,"admin.enable-proxy")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",o.mailSettings.get("enableProxy").value)}}function Gr(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",54),e.\u0275\u0275element(1,"div",55),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("tb-help",t.helpLink)}}function jr(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-checkbox",58),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.change-password")," "))}function Wr(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-form-field",9)(1,"mat-label",10),e.\u0275\u0275text(2,"common.password"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(3,"input",59),e.\u0275\u0275pipe(4,"translate"),e.\u0275\u0275element(5,"tb-toggle-password",53),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(3),e.\u0275\u0275propertyInterpolate("placeholder",e.\u0275\u0275pipeBind1(4,1,"common.enter-password")))}function qr(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"section"),e.\u0275\u0275template(1,jr,3,3,"mat-checkbox",56),e.\u0275\u0275template(2,Wr,6,3,"mat-form-field",57),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.showChangePassword),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.mailSettings.get("changePassword").value||!t.showChangePassword)}}function $r(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.oauth2.client-id-required")," "))}function Hr(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.oauth2.client-id-max-length")," "))}function zr(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.oauth2.client-secret-required")," "))}function Kr(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.oauth2.client-secret-max-length")," "))}function Yr(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.oauth2.microsoft-tenant-id-required")," "))}function Jr(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-form-field",45)(1,"mat-label",10),e.\u0275\u0275text(2,"admin.oauth2.microsoft-tenant-id"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(3,"input",73),e.\u0275\u0275template(4,Yr,3,3,"mat-error",12),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(4),e.\u0275\u0275property("ngIf",t.mailSettings.get("providerTenantId").hasError("required"))}}function Qr(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.oauth2.access-token-uri-required")," "))}function Xr(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.oauth2.uri-pattern-error")," "))}function Zr(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.oauth2.access-token-uri-required")," "))}function es(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.oauth2.uri-pattern-error")," "))}function ts(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"mat-chip-row",81),e.\u0275\u0275listener("removed",function(){const s=e.\u0275\u0275restoreView(t).index,l=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(l.removeScope(s))}),e.\u0275\u0275text(1),e.\u0275\u0275elementStart(2,"mat-icon",82),e.\u0275\u0275text(3,"cancel"),e.\u0275\u0275elementEnd()()}if(2&i){const t=n.$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",t," ")}}function ns(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.oauth2.scope-required")," "))}function is(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",50)(1,"mat-form-field",45)(2,"mat-label",10),e.\u0275\u0275text(3,"admin.oauth2.authorization-uri"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(4,"input",74),e.\u0275\u0275elementStart(5,"button",75),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(o.toggleEditMode("authUri"))}),e.\u0275\u0275elementStart(6,"mat-icon",76),e.\u0275\u0275text(7,"create"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(8,Qr,3,3,"mat-error",12),e.\u0275\u0275template(9,Xr,3,3,"mat-error",12),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(10,"mat-form-field",45)(11,"mat-label",10),e.\u0275\u0275text(12,"admin.oauth2.token-uri"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(13,"input",77),e.\u0275\u0275elementStart(14,"button",75),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(o.toggleEditMode("tokenUri"))}),e.\u0275\u0275elementStart(15,"mat-icon",76),e.\u0275\u0275text(16,"create"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(17,Zr,3,3,"mat-error",12),e.\u0275\u0275template(18,es,3,3,"mat-error",12),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(19,"mat-form-field",45)(20,"mat-label",10),e.\u0275\u0275text(21,"admin.oauth2.scope"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(22,"mat-chip-grid",null,78),e.\u0275\u0275template(24,ts,4,1,"mat-chip-row",79),e.\u0275\u0275elementStart(25,"input",80),e.\u0275\u0275listener("matChipInputTokenEnd",function(o){e.\u0275\u0275restoreView(t);const s=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(s.addScope(o))}),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(26,ns,3,3,"mat-error",12),e.\u0275\u0275elementEnd()}if(2&i){const t=e.\u0275\u0275reference(23),a=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(8),e.\u0275\u0275property("ngIf",a.mailSettings.get("authUri").hasError("required")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",a.mailSettings.get("authUri").hasError("pattern")),e.\u0275\u0275advance(8),e.\u0275\u0275property("ngIf",a.mailSettings.get("tokenUri").hasError("required")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",a.mailSettings.get("tokenUri").hasError("pattern")),e.\u0275\u0275advance(6),e.\u0275\u0275property("ngForOf",a.mailSettings.get("scope").value)("ngForTrackBy",a.trackByParams),e.\u0275\u0275advance(1),e.\u0275\u0275property("matChipInputFor",t)("matChipInputSeparatorKeyCodes",a.separatorKeysCodes),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",a.mailSettings.get("scope").hasError("required"))}}function as(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-option",31),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"uppercase"),e.\u0275\u0275pipe(3,"translate"),e.\u0275\u0275elementEnd()),2&i){const t=n.$implicit,a=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("value",t),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,2,e.\u0275\u0275pipeBind1(3,4,a.domainSchemaTranslations.get(t)))," ")}}function os(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.error-verification-url")," "))}function rs(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.domain-name-max-length")," "))}function ss(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.domain-name-unique")," "))}function ls(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"section")(1,"div",50)(2,"mat-form-field",45)(3,"mat-label",10),e.\u0275\u0275text(4,"admin.oauth2.client-id"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(5,"input",60),e.\u0275\u0275template(6,$r,3,3,"mat-error",12),e.\u0275\u0275template(7,Hr,3,3,"mat-error",12),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(8,"mat-form-field",45)(9,"mat-label",10),e.\u0275\u0275text(10,"admin.oauth2.client-secret"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(11,"input",61),e.\u0275\u0275template(12,zr,3,3,"mat-error",12),e.\u0275\u0275template(13,Kr,3,3,"mat-error",12),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(14,Jr,5,1,"mat-form-field",43),e.\u0275\u0275elementStart(15,"mat-expansion-panel",62)(16,"mat-expansion-panel-header")(17,"mat-panel-description",63),e.\u0275\u0275text(18," tenant-profile.advanced-settings "),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(19,is,27,9,"ng-template",17),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(20,"fieldset",18)(21,"legend",19),e.\u0275\u0275text(22,"admin.oauth2.redirect-uri"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(23,"div",64)(24,"div",65)(25,"div",66)(26,"mat-form-field",67)(27,"mat-label",10),e.\u0275\u0275text(28,"admin.oauth2.protocol"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(29,"mat-select",68),e.\u0275\u0275template(30,as,4,6,"mat-option",14),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(31,"mat-form-field",45)(32,"mat-label",10),e.\u0275\u0275text(33,"admin.domain-name"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(34,"input",69),e.\u0275\u0275template(35,os,3,3,"mat-error",12),e.\u0275\u0275template(36,rs,3,3,"mat-error",12),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(37,ss,3,3,"mat-error",12),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(38,"div",70)(39,"mat-form-field",45)(40,"mat-label",10),e.\u0275\u0275text(41,"admin.oauth2.redirect-uri-template"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(42,"input",71)(43,"tb-copy-button",72),e.\u0275\u0275pipe(44,"translate"),e.\u0275\u0275elementEnd()()()()()),2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(6),e.\u0275\u0275property("ngIf",t.mailSettings.get("clientId").hasError("required")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.mailSettings.get("clientId").hasError("maxlen gth")),e.\u0275\u0275advance(5),e.\u0275\u0275property("ngIf",t.mailSettings.get("clientSecret").hasError("required")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.mailSettings.get("clientSecret").hasError("maxlength")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.mailSettings.get("providerId").value===t.mailServerOauth2Provider.OFFICE_365),e.\u0275\u0275advance(1),e.\u0275\u0275property("expanded",t.mailSettings.get("providerId").value===t.mailServerOauth2Provider.CUSTOM),e.\u0275\u0275advance(9),e.\u0275\u0275property("formGroup",t.domainForm),e.\u0275\u0275advance(6),e.\u0275\u0275property("ngForOf",t.protocols),e.\u0275\u0275advance(5),e.\u0275\u0275property("ngIf",t.domainForm.get("name").hasError("pattern")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.domainForm.get("name").hasError("maxlength")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.domainForm.hasError("unique")),e.\u0275\u0275advance(6),e.\u0275\u0275propertyInterpolate("tooltipText",e.\u0275\u0275pipeBind1(44,13,"admin.oauth2.copy-redirect-uri")),e.\u0275\u0275property("copyText",t.mailSettings.get("redirectUri").value)}}function ds(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"section",83)(1,"div")(2,"span",84),e.\u0275\u0275text(3,"admin.oauth2.access-token-status"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"span"),e.\u0275\u0275text(5),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(6,"button",85),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.generateAccessToken())}),e.\u0275\u0275pipe(7,"async"),e.\u0275\u0275text(8),e.\u0275\u0275elementEnd()()}if(2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate1(" ",t.accessTokenStatus," "),e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(7,3,t.isLoading$)||t.mailSettings.invalid||t.domainForm.invalid||t.mailSettings.dirty||t.domainForm.dirty),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",t.accessTokenButtonName," ")}}class ui extends se.I{constructor(n,t,a,o,s,l,d,m){super(n),this.store=n,this.router=t,this.route=a,this.adminService=o,this.authService=s,this.translate=l,this.fb=d,this.window=m,this.smtpProtocols=Object.values(Pe.PO),this.showChangePassword=!1,this.protocols=Object.values($.t$).filter(y=>y!==$.t$.MIXED),this.domainSchemaTranslations=$.$Z,this.mailServerOauth2Provider=Pe.r6,this.tlsVersions=["TLSv1","TLSv1.1","TLSv1.2","TLSv1.3"],this.templates=new Map,this.templateProvider=["CUSTOM"],this.separatorKeysCodes=[Fn.ENTER,Fn.COMMA],this.destroy$=new be.x,this.DOMAIN_AND_PORT_REGEXP=/^(?:\w+(?::\w+)?@)?[^\s/]+(?::\d+)?$/,this.URL_REGEXP=/^[A-Za-z][A-Za-z\d.+-]*:\/*(?:\w+(?::\w+)?@)?[^\s/]+(?::\d+)?(?:\/[\w#!:.,?+=&%@\-/]*)?$/,this.mailSettings=this.fb.group({mailFrom:["",[r.Validators.required]],smtpProtocol:[Pe.PO.SMTP],smtpHost:["localhost",[r.Validators.required]],smtpPort:[25,[r.Validators.required,r.Validators.pattern(Pe.A8),r.Validators.maxLength(5)]],timeout:[1e4,[r.Validators.required,r.Validators.pattern(/^[0-9]{1,6}$/),r.Validators.maxLength(6)]],enableTls:[!1],tlsVersion:[{value:null,disabled:!0}],enableProxy:[!1],proxyHost:[{value:"",disabled:!0},[r.Validators.required]],proxyPort:[{value:null,disabled:!0},[r.Validators.required,r.Validators.min(1),r.Validators.max(65535)]],proxyUser:[{value:"",disabled:!0}],proxyPassword:[{value:"",disabled:!0}],username:[""],changePassword:[!1],password:[""],enableOauth2:[!1],providerId:["CUSTOM",[r.Validators.required]],clientId:[{value:"",disabled:!0},[r.Validators.required,r.Validators.maxLength(255)]],clientSecret:[{value:"",disabled:!0},[r.Validators.required,r.Validators.maxLength(2048)]],providerTenantId:[{value:"",disabled:!0},[r.Validators.required]],authUri:[{value:"",disabled:!0},[r.Validators.required,r.Validators.pattern(this.URL_REGEXP)]],tokenUri:[{value:"",disabled:!0},[r.Validators.required,r.Validators.pattern(this.URL_REGEXP)]],scope:[],redirectUri:[{value:"",disabled:!0}]}),this.defaultConfiguration={providerId:"CUSTOM",smtpProtocol:Pe.PO.SMTP,smtpHost:"",smtpPort:null,timeout:null,enableTls:!1,tlsVersion:null,enableProxy:!1,proxyHost:"",proxyPort:null,proxyUser:"",proxyPassword:"",enableOauth2:!1,clientId:"",clientSecret:"",providerTenantId:"",authUri:"",tokenUri:"",scope:[],redirectUri:""},this.domainForm=this.fb.group({name:[this.window.location.hostname,[r.Validators.required,r.Validators.maxLength(255),r.Validators.pattern(this.DOMAIN_AND_PORT_REGEXP)]],scheme:[$.t$.HTTPS,r.Validators.required]})}ngOnInit(){this.mailServerSettingsForm(),this.domainFormConfiguration(),(0,xe.D)([this.adminService.getLoginProcessingUrl(),this.adminService.getMailConfigTemplate(),this.adminService.getAdminSettings("mail")]).subscribe(([n,t,a])=>{this.loginProcessingUrl=n,this.initTemplates(t),this.adminSettings=a,this.adminSettings.jsonValue&&(0,T.HD)(this.adminSettings.jsonValue.enableTls)&&(this.adminSettings.jsonValue.enableTls="true"===this.adminSettings.jsonValue.enableTls),this.showChangePassword=!(0,T.nu)(this.adminSettings.jsonValue.showChangePassword)||this.adminSettings.jsonValue.showChangePassword,delete this.adminSettings.jsonValue.showChangePassword,this.adminSettings.jsonValue.providerId||(this.adminSettings.jsonValue.providerId="CUSTOM"),this.mailSettings.reset(this.adminSettings.jsonValue,{emitEvent:!1}),this.enableMailPassword(!this.showChangePassword),this.enableProxyChanged(),this.enableTls(this.adminSettings.jsonValue.enableTls),this.helpLink=this.templates.get(this.adminSettings.jsonValue.providerId)?.helpLink||null,this.adminSettings.jsonValue.enableOauth2?(this.enableOauth2(!!this.adminSettings.jsonValue.enableOauth2),this.enableProviderTenantIdChanged(this.adminSettings.jsonValue.providerId),this.parseUrl(this.adminSettings.jsonValue.redirectUri),this.mailSettings.get("redirectUri").patchValue(this.adminSettings.jsonValue.redirectUri,{emitEvent:!1})):this.mailSettings.get("enableOauth2").patchValue(!1,{emitEvent:!1})})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),super.ngOnDestroy()}initTemplates(n){n.map(t=>{delete t.additionalInfo,this.templates.set(t.providerId,t)}),this.templateProvider.push(...Array.from(this.templates.keys())),this.templateProvider.sort()}mailServerSettingsForm(){this.registerDisableOnLoadFormControl(this.mailSettings.get("smtpProtocol")),this.registerDisableOnLoadFormControl(this.mailSettings.get("enableTls")),this.registerDisableOnLoadFormControl(this.mailSettings.get("enableProxy")),this.registerDisableOnLoadFormControl(this.mailSettings.get("changePassword")),this.mailSettings.get("enableTls").valueChanges.pipe((0,Y.R)(this.destroy$)).subscribe(n=>this.enableTls(n)),this.mailSettings.get("enableProxy").valueChanges.pipe((0,Y.R)(this.destroy$)).subscribe(()=>{this.enableProxyChanged()}),this.mailSettings.get("changePassword").valueChanges.pipe((0,Y.R)(this.destroy$)).subscribe(n=>{this.enableMailPassword(n)}),this.mailSettings.get("enableOauth2").valueChanges.pipe((0,Y.R)(this.destroy$)).subscribe(n=>{this.enableOauth2(n),this.enableProviderTenantIdChanged(this.mailSettings.get("providerId").value),n&&!this.mailSettings.get("redirectUri").value&&this.mailSettings.get("redirectUri").patchValue(this.redirectURI(),{emitEvent:!1})}),this.mailSettings.get("providerTenantId").valueChanges.pipe((0,Y.R)(this.destroy$)).subscribe(n=>{const t=this.templates.get(this.mailServerOauth2Provider.OFFICE_365).authorizationUri.replace("%s",`${n}`),a=this.templates.get(this.mailServerOauth2Provider.OFFICE_365).accessTokenUri.replace("%s",`${n}`);this.mailSettings.get("authUri").patchValue(t,{emitEvent:!1}),this.mailSettings.get("tokenUri").patchValue(a,{emitEvent:!1})}),this.mailSettings.get("providerId").valueChanges.pipe((0,Y.R)(this.destroy$)).subscribe(n=>{if(n!==this.mailServerOauth2Provider.CUSTOM&&n){const t=this.templates.get(n);this.helpLink=t.helpLink,this.mailSettings.patchValue({smtpProtocol:Pe.PO[t.smtpProtocol],smtpHost:t.smtpHost,smtpPort:t.smtpPort,timeout:t.timeout,enableTls:t.enableTls,tlsVersion:t.tlsVersion,authUri:t.authorizationUri,tokenUri:t.accessTokenUri,scope:t.scope,enableOauth2:!1,enableProxy:!1,proxyHost:"",proxyPort:null,proxyUser:"",proxyPassword:"",clientId:"",clientSecret:"",providerTenantId:"",redirectUri:""},{emitEvent:!1})}else this.mailSettings.reset({...this.adminSettings.jsonValue,...this.defaultConfiguration},{emitEvent:!1});this.enableTls(this.mailSettings.get("enableTls").value),this.enableOauth2(this.mailSettings.get("enableOauth2").value),this.enableProviderTenantIdChanged(n)})}domainFormConfiguration(){this.domainForm.get("name").valueChanges.pipe((0,Y.R)(this.destroy$)).subscribe(n=>this.mailSettings.get("redirectUri").patchValue(this.redirectURI(this.domainForm.get("scheme").value,n),{emitEvent:!1})),this.domainForm.get("scheme").valueChanges.pipe((0,Y.R)(this.destroy$)).subscribe(n=>this.mailSettings.get("redirectUri").patchValue(this.redirectURI(n),{emitEvent:!1}))}enableOauth2(n){n?(this.mailSettings.get("clientId").enable({emitEvent:!1}),this.mailSettings.get("clientSecret").enable({emitEvent:!1}),this.mailSettings.get("redirectUri").enable({emitEvent:!1}),this.mailSettings.get("providerId").value===this.mailServerOauth2Provider.CUSTOM?(this.mailSettings.get("authUri").enable({emitEvent:!1}),this.mailSettings.get("tokenUri").enable({emitEvent:!1})):(this.mailSettings.get("authUri").disable({emitEvent:!1}),this.mailSettings.get("tokenUri").disable({emitEvent:!1}))):(this.mailSettings.get("clientId").disable({emitEvent:!1}),this.mailSettings.get("clientSecret").disable({emitEvent:!1}),this.mailSettings.get("redirectUri").disable({emitEvent:!1}),this.mailSettings.get("authUri").disable({emitEvent:!1}),this.mailSettings.get("tokenUri").disable({emitEvent:!1}))}enableProviderTenantIdChanged(n){n===this.mailServerOauth2Provider.OFFICE_365&&this.mailSettings.get("enableOauth2").value?this.mailSettings.get("providerTenantId").enable({emitEvent:!1}):this.mailSettings.get("providerTenantId").disable({emitEvent:!1})}enableProxyChanged(){this.mailSettings.get("enableProxy").value?(this.mailSettings.get("proxyHost").enable({emitEvent:!1}),this.mailSettings.get("proxyPort").enable({emitEvent:!1}),this.mailSettings.get("proxyUser").enable({emitEvent:!1}),this.mailSettings.get("proxyPassword").enable({emitEvent:!1})):(this.mailSettings.get("proxyHost").disable({emitEvent:!1}),this.mailSettings.get("proxyPort").disable({emitEvent:!1}),this.mailSettings.get("proxyUser").disable({emitEvent:!1}),this.mailSettings.get("proxyPassword").disable({emitEvent:!1}))}enableMailPassword(n){n?this.mailSettings.get("password").enable({emitEvent:!1}):this.mailSettings.get("password").disable({emitEvent:!1})}enableTls(n){n?this.mailSettings.get("tlsVersion").enable({emitEvent:!1}):this.mailSettings.get("tlsVersion").disable({emitEvent:!1})}sendTestMail(){this.adminSettings.jsonValue={...this.adminSettings.jsonValue,...this.mailSettingsFormValue},this.adminService.sendTestMail(this.adminSettings).subscribe({next:()=>this.store.dispatch(new V.zi({message:this.translate.instant("admin.test-mail-sent"),type:"success"})),error:n=>this.store.dispatch(new V.zi({message:n.error.message,type:"error"}))})}save(){this.adminSettings.jsonValue={...this.adminSettings.jsonValue,...this.mailSettingsFormValue},this.adminService.saveAdminSettings(this.adminSettings).subscribe(n=>{this.adminSettings=n,this.showChangePassword=!0,this.mailSettings.reset(this.adminSettings.jsonValue,{emitEvent:!1}),this.domainForm.reset(this.domainForm.value),this.parseUrl(this.adminSettings.jsonValue.redirectUri)})}generateAccessToken(){this.adminService.generateAccessToken().subscribe(n=>this.window.location.href=n)}redirectURI(n,t){const a=this.domainForm.value;if(""!==a.name){return`${(0,T.$K)(n)?n.toLowerCase():a.scheme.toLowerCase()}://${(0,T.$K)(t)?t:a.name}${this.loginProcessingUrl}`}return""}parseUrl(n){if(n){const t=new URL(n);this.domainForm.get("scheme").patchValue(t.protocol.startsWith("https")?$.t$.HTTPS:$.t$.HTTP,{emitEvent:!1}),this.domainForm.get("name").patchValue(t.host,{emitEvent:!1})}}get accessTokenButtonName(){return this.translate.instant(this.adminSettings.jsonValue.tokenGenerated?"admin.oauth2.update-access-token":"admin.oauth2.generate-access-token")}get accessTokenStatus(){return this.translate.instant(this.adminSettings.jsonValue.tokenGenerated?"admin.oauth2.token-status-generated":"admin.oauth2.token-status-not-generated")}confirmForm(){return this.mailSettings}get mailSettingsFormValue(){const n=this.mailSettings.getRawValue();return delete n.changePassword,(0,T.nu)(n.password)||delete n.password,n}trackByParams(n){return n}removeScope(n){const t=this.mailSettings.get("scope");t.removeAt(n),t.markAsTouched(),t.markAsDirty()}addScope(n){const t=n.chipInput.inputElement,a=n.value,o=this.mailSettings.get("scope");""!==a.trim()&&(o.push(this.fb.control(a.trim())),o.markAsDirty()),t&&(t.value="")}toggleEditMode(n){this.mailSettings.get(n).disabled?this.mailSettings.get(n).enable():this.mailSettings.get(n).disable()}}ui.\u0275fac=function(n){return new(n||ui)(e.\u0275\u0275directiveInject(x.Store),e.\u0275\u0275directiveInject(b.Router),e.\u0275\u0275directiveInject(b.ActivatedRoute),e.\u0275\u0275directiveInject(Fa.l),e.\u0275\u0275directiveInject(pi.e),e.\u0275\u0275directiveInject(g.TranslateService),e.\u0275\u0275directiveInject(r.FormBuilder),e.\u0275\u0275directiveInject(to.m9))},ui.\u0275cmp=e.\u0275\u0275defineComponent({type:ui,selectors:[["tb-mail-server"]],features:[e.\u0275\u0275InheritDefinitionFeature],decls:60,vars:41,consts:[["appearance","outlined",1,"settings-card"],["translate","",1,"mat-headline-5"],["fxFlex",""],["tb-help","outgoingMailSettings"],["color","warn","mode","indeterminate",4,"ngIf"],["style","height: 4px;",4,"ngIf"],[2,"padding-top","16px"],[3,"formGroup","ngSubmit"],[3,"disabled"],[1,"mat-block"],["translate",""],["matInput","","formControlName","mailFrom","required",""],[4,"ngIf"],["formControlName","providerId"],[3,"value",4,"ngFor","ngForOf"],[1,"configuration-panel","mat-elevation-z0",3,"expanded"],["fxLayoutAlign","start center","translate",""],["matExpansionPanelContent",""],["fxLayout","column",1,"fields-group"],["translate","",1,"group-title"],["matInput","","formControlName","username","autocomplete","new-username",3,"placeholder"],["fxLayoutAlign","space-between center",2,"height","50px","padding-bottom","20px",3,"fxHide"],["formControlName","enableOauth2",1,"tb-notification-unread-toggle-group",2,"width","250px"],["fxFlex","",3,"value"],["class","details-buttons",4,"ngIf"],["fxLayout","row","fxLayout.xs","column","fxLayoutAlign.gt-xs","space-between center","style","padding-bottom: 12px",4,"ngIf"],["fxLayout","row","fxLayoutAlign","end center","fxLayout.xs","column","fxLayoutAlign.xs","end","fxLayoutGap","16px"],["mat-raised-button","","type","button",3,"disabled","click"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],["color","warn","mode","indeterminate"],[2,"height","4px"],[3,"value"],["formControlName","smtpProtocol"],["fxLayout.gt-sm","row","fxLayoutGap.gt-sm","10px"],["fxFlex","100","fxFlex.gt-sm","60",1,"mat-block"],["matInput","","formControlName","smtpHost","placeholder","localhost","required",""],["fxFlex","100","fxFlex.gt-sm","40",1,"mat-block"],["matInput","","formControlName","smtpPort","placeholder","25","maxlength","5","required",""],["smtpPortInput",""],["align","end"],["matInput","","formControlName","timeout","placeholder","10000","maxlength","6","required",""],["timeoutInput",""],["fxFlex","","formControlName","enableTls",2,"display","block","padding-bottom","22px"],["fxFlex","","class","mat-block",4,"ngIf"],["formControlName","enableProxy",2,"display","block","padding-bottom","22px"],["fxFlex","",1,"mat-block"],["formControlName","tlsVersion"],["fxLayout.gt-sm","row","fxLayoutGap.gt-sm","8px"],["matInput","","required","","formControlName","proxyHost"],["matInput","","required","","formControlName","proxyPort","type","number","step","1","min","1","max","65535"],["fxLayout","row","fxLayout.xs","column","fxLayoutGap.gt-xs","8px"],["matInput","","formControlName","proxyUser"],["matInput","","type","password","formControlName","proxyPassword","autocomplete","new-proxy-password"],["matSuffix",""],[1,"details-buttons"],[3,"tb-help"],["formControlName","changePassword","style","padding-bottom: 16px;",4,"ngIf"],["class","mat-block",4,"ngIf"],["formControlName","changePassword",2,"padding-bottom","16px"],["matInput","","formControlName","password","type","password","autocomplete","new-password",3,"placeholder"],["matInput","","formControlName","clientId","required",""],["matInput","","formControlName","clientSecret","required",""],[1,"mat-elevation-z0",3,"expanded"],["fxLayoutAlign","end","translate",""],["fxFlex","","fxLayout","row","fxLayout.xs","column","fxLayoutGap","8px"],["fxLayout","column","fxFlex.sm","60","fxFlex.gt-sm","50",3,"formGroup"],["fxLayout","row","fxLayout.xs","column","fxLayout.md","column","fxLayoutGap","8px","fxLayoutGap.md","0px"],["fxFlex","30","fxFlex.md","","fxFlex.xs","",1,"mat-block"],["formControlName","scheme"],["matInput","","formControlName","name","required",""],["fxFlex","","fxLayout","column"],["matInput","","formControlName","redirectUri","readonly",""],["matSuffix","","color","primary","tooltipPosition","above","icon","mdi:clipboard-arrow-left",3,"copyText","tooltipText"],["matInput","","formControlName","providerTenantId","required",""],["matInput","","formControlName","authUri","required",""],["mat-icon-button","","matSuffix","","type","button",3,"click"],[1,"material-icons"],["matInput","","formControlName","tokenUri","required",""],["scopeList",""],["removable","",3,"removed",4,"ngFor","ngForOf","ngForTrackBy"],["matChipInputAddOnBlur","",3,"matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputTokenEnd"],["removable","",3,"removed"],["matChipRemove",""],["fxLayout","row","fxLayout.xs","column","fxLayoutAlign.gt-xs","space-between center",2,"padding-bottom","12px"],["translate","",1,"token-status"],["mat-raised-button","","type","button","color","primary",3,"disabled","click"]],template:function(n,t){1&n&&(e.\u0275\u0275elementStart(0,"div")(1,"mat-card",0)(2,"mat-card-header")(3,"mat-card-title")(4,"span",1),e.\u0275\u0275text(5,"admin.outgoing-mail-settings"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275element(6,"span",2)(7,"div",3),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(8,Sr,1,0,"mat-progress-bar",4),e.\u0275\u0275pipe(9,"async"),e.\u0275\u0275template(10,Ir,1,0,"div",5),e.\u0275\u0275pipe(11,"async"),e.\u0275\u0275elementStart(12,"mat-card-content",6)(13,"form",7),e.\u0275\u0275listener("ngSubmit",function(){return t.save()}),e.\u0275\u0275elementStart(14,"fieldset",8),e.\u0275\u0275pipe(15,"async"),e.\u0275\u0275elementStart(16,"mat-form-field",9)(17,"mat-label",10),e.\u0275\u0275text(18,"admin.mail-from"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(19,"input",11),e.\u0275\u0275template(20,wr,3,3,"mat-error",12),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(21,"mat-form-field",9)(22,"mat-label",10),e.\u0275\u0275text(23,"admin.oauth2.smtp-provider"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(24,"mat-select",13),e.\u0275\u0275template(25,Er,2,2,"mat-option",14),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(26,"mat-expansion-panel",15)(27,"mat-expansion-panel-header")(28,"mat-panel-title",16),e.\u0275\u0275text(29," admin.connection-settings "),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(30,Ur,37,16,"ng-template",17),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(31,"fieldset",18)(32,"legend",19),e.\u0275\u0275text(33,"admin.oauth2.authentication"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(34,"mat-form-field",9)(35,"mat-label",10),e.\u0275\u0275text(36,"common.username"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(37,"input",20),e.\u0275\u0275pipe(38,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(39,"div",21)(40,"mat-button-toggle-group",22)(41,"mat-button-toggle",23),e.\u0275\u0275text(42),e.\u0275\u0275pipe(43,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(44,"mat-button-toggle",23),e.\u0275\u0275text(45),e.\u0275\u0275pipe(46,"translate"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(47,Gr,2,1,"div",24),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(48,qr,3,2,"section",12),e.\u0275\u0275template(49,ls,45,15,"section",12),e.\u0275\u0275template(50,ds,9,5,"section",25),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(51,"div",26)(52,"button",27),e.\u0275\u0275listener("click",function(){return t.sendTestMail()}),e.\u0275\u0275pipe(53,"async"),e.\u0275\u0275text(54),e.\u0275\u0275pipe(55,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(56,"button",28),e.\u0275\u0275pipe(57,"async"),e.\u0275\u0275text(58),e.\u0275\u0275pipe(59,"translate"),e.\u0275\u0275elementEnd()()()()()()()),2&n&&(e.\u0275\u0275advance(8),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(9,21,t.isLoading$)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!e.\u0275\u0275pipeBind1(11,23,t.isLoading$)),e.\u0275\u0275advance(3),e.\u0275\u0275property("formGroup",t.mailSettings),e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(15,25,t.isLoading$)),e.\u0275\u0275advance(6),e.\u0275\u0275property("ngIf",t.mailSettings.get("mailFrom").hasError("required")),e.\u0275\u0275advance(5),e.\u0275\u0275property("ngForOf",t.templateProvider),e.\u0275\u0275advance(1),e.\u0275\u0275property("expanded",t.mailSettings.get("providerId").value===t.mailServerOauth2Provider.CUSTOM),e.\u0275\u0275advance(11),e.\u0275\u0275propertyInterpolate("placeholder",e.\u0275\u0275pipeBind1(38,27,"common.enter-username")),e.\u0275\u0275advance(2),e.\u0275\u0275property("fxHide","SENDGRID"===t.mailSettings.get("providerId").value),e.\u0275\u0275advance(2),e.\u0275\u0275property("value",!1),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(43,29,"admin.oauth2.basic")),e.\u0275\u0275advance(2),e.\u0275\u0275property("value",!0),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(46,31,"admin.oauth2.oauth2")),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",t.helpLink&&t.mailSettings.get("enableOauth2").value),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!t.mailSettings.get("enableOauth2").value),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.mailSettings.get("enableOauth2").value),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.mailSettings.get("enableOauth2").value),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(53,33,t.isLoading$)||t.mailSettings.get("enableOauth2").value?t.mailSettings.invalid||t.domainForm.invalid||t.mailSettings.dirty||t.domainForm.dirty:t.mailSettings.invalid),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(55,35,"admin.send-test-mail")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(57,37,t.isLoading$)||t.mailSettings.invalid||t.domainForm.invalid||!t.mailSettings.dirty&&!t.domainForm.dirty),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1("",e.\u0275\u0275pipeBind1(59,39,"action.save")," "))},dependencies:[p.NgForOf,p.NgIf,De.HelpComponent,S.MatButton,S.MatIconButton,mi.MatButtonToggleGroup,mi.MatButtonToggle,fe.MatCheckbox,F.MatIcon,A.MatCard,A.MatCardContent,A.MatCardHeader,A.MatCardTitle,z.MatProgressBar,O.MatInput,_.MatFormField,_.MatLabel,_.MatHint,_.MatError,_.MatSuffix,ye.MatSelect,X.MatOption,Ce.MatSlideToggle,U.MatExpansionPanel,U.MatExpansionPanelHeader,U.MatExpansionPanelTitle,U.MatExpansionPanelDescription,U.MatExpansionPanelContent,ve.MatChipGrid,ve.MatChipInput,ve.MatChipRemove,ve.MatChipRow,h.DefaultLayoutDirective,h.DefaultLayoutGapDirective,h.DefaultLayoutAlignDirective,h.DefaultFlexDirective,G.DefaultShowHideDirective,r.\u0275NgNoValidate,r.DefaultValueAccessor,r.NumberValueAccessor,r.NgControlStatus,r.NgControlStatusGroup,r.RequiredValidator,r.MaxLengthValidator,r.MinValidator,r.MaxValidator,r.FormGroupDirective,r.FormControlName,g.TranslateDirective,Io.CopyButtonComponent,no.TogglePasswordComponent,p.AsyncPipe,p.UpperCasePipe,g.TranslatePipe],styles:['@charset "UTF-8";[_nghost-%COMP%]   .fields-group[_ngcontent-%COMP%]{padding:0 8px 8px;margin:10px 0;border:1px groove rgba(0,0,0,.25);border-radius:4px}[_nghost-%COMP%]   .fields-group[_ngcontent-%COMP%]   legend[_ngcontent-%COMP%]{margin-bottom:8px;color:#000000b3;width:-moz-fit-content;width:fit-content}[_nghost-%COMP%]   .token-status[_ngcontent-%COMP%]{font:400 14px/16px Roboto,Helvetica Neue,sans-serif;color:#0009;letter-spacing:.25px;padding:8px 0}[_nghost-%COMP%]     .mat-expansion-panel .mat-expansion-panel-header{height:48px;padding:0 12px}[_nghost-%COMP%]     .mat-expansion-panel .mat-expansion-panel-header.mat-expanded{height:48px}[_nghost-%COMP%]     .mat-expansion-panel .mat-expansion-panel-body{padding:0 12px}[_nghost-%COMP%]     .mat-expansion-panel.configuration-panel{border:1px solid rgba(0,0,0,.2)}[_nghost-%COMP%]     .mat-button-toggle-group.tb-notification-unread-toggle-group.mat-button-toggle-group-appearance-standard{border:none;border-radius:14px}[_nghost-%COMP%]     .mat-button-toggle-group.tb-notification-unread-toggle-group.mat-button-toggle-group-appearance-standard .mat-button-toggle+.mat-button-toggle{border-left:none}[_nghost-%COMP%]     .mat-button-toggle-group.tb-notification-unread-toggle-group .mat-button-toggle{background:rgba(0,0,0,.06);height:28px;align-items:center;display:flex}[_nghost-%COMP%]     .mat-button-toggle-group.tb-notification-unread-toggle-group .mat-button-toggle .mat-button-toggle-ripple{inset:2px;border-radius:12px}[_nghost-%COMP%]     .mat-button-toggle-group.tb-notification-unread-toggle-group .mat-button-toggle-button{color:#959595}[_nghost-%COMP%]     .mat-button-toggle-group.tb-notification-unread-toggle-group .mat-button-toggle-focus-overlay{border-radius:14px;margin:2px}[_nghost-%COMP%]     .mat-button-toggle-group.tb-notification-unread-toggle-group .mat-button-toggle-checked .mat-button-toggle-button{background-color:#424242;color:#fff;border-radius:14px;margin-left:2px;margin-right:2px}[_nghost-%COMP%]     .mat-button-toggle-group.tb-notification-unread-toggle-group .mat-button-toggle-appearance-standard .mat-button-toggle-label-content{line-height:24px;font-size:16px;font-weight:500}[_nghost-%COMP%]     .mat-button-toggle-group.tb-notification-unread-toggle-group .mat-button-toggle-checked.mat-button-toggle-appearance-standard:not(.mat-button-toggle-disabled):hover .mat-button-toggle-focus-overlay{opacity:.01}','@charset "UTF-8";[_nghost-%COMP%]   .mat-mdc-card.settings-card[_ngcontent-%COMP%]{margin:8px}[_nghost-%COMP%]   .mat-mdc-card.settings-card[_ngcontent-%COMP%]   .fields-group[_ngcontent-%COMP%]{padding:0 16px 8px;margin:10px 0;border:1px groove #7c7c7c;border-radius:4px}@media screen and (min-width: 960px) and (max-width: 1279px){[_nghost-%COMP%]   .mat-mdc-card.settings-card[_ngcontent-%COMP%]{width:80%}}@media screen and (min-width: 1280px){[_nghost-%COMP%]   .mat-mdc-card.settings-card[_ngcontent-%COMP%]{width:60%}}']});var N=c(15248),u=c(93828),io=c(43556),cs=c(25696),wo=c(60341);function ps(i,n){1&i&&e.\u0275\u0275element(0,"mat-progress-bar",25)}function ms(i,n){1&i&&e.\u0275\u0275element(0,"div",26)}function us(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.base-url-required")," "))}function gs(i,n){1&i&&e.\u0275\u0275element(0,"mat-progress-bar",25)}function fs(i,n){1&i&&e.\u0275\u0275element(0,"div",26)}function hs(i,n){1&i&&e.\u0275\u0275elementContainer(0)}function bs(i,n){1&i&&e.\u0275\u0275elementContainer(0)}const gi=function(i){return{protocol:i}};function ys(i,n){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,hs,1,0,"ng-container",27),e.\u0275\u0275template(2,bs,1,0,"ng-container",27),e.\u0275\u0275elementContainerEnd()),2&i){const t=e.\u0275\u0275nextContext(),a=e.\u0275\u0275reference(62);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngTemplateOutlet",a)("ngTemplateOutletContext",e.\u0275\u0275pureFunction1(4,gi,t.protocol)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngTemplateOutlet",a)("ngTemplateOutletContext",e.\u0275\u0275pureFunction1(6,gi,t.protocol+"s"))}}function vs(i,n){1&i&&e.\u0275\u0275elementContainer(0)}function _s(i,n){1&i&&e.\u0275\u0275elementContainer(0)}function xs(i,n){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,vs,1,0,"ng-container",27),e.\u0275\u0275template(2,_s,1,0,"ng-container",27),e.\u0275\u0275elementContainerEnd()),2&i){const t=e.\u0275\u0275nextContext(),a=e.\u0275\u0275reference(62);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngTemplateOutlet",a)("ngTemplateOutletContext",e.\u0275\u0275pureFunction1(4,gi,t.protocol)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngTemplateOutlet",a)("ngTemplateOutletContext",e.\u0275\u0275pureFunction1(6,gi,t.protocol+"s"))}}function Cs(i,n){1&i&&e.\u0275\u0275elementContainer(0)}function Ts(i,n){1&i&&e.\u0275\u0275elementContainer(0)}function Ss(i,n){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,Cs,1,0,"ng-container",27),e.\u0275\u0275template(2,Ts,1,0,"ng-container",27),e.\u0275\u0275elementContainerEnd()),2&i){const t=e.\u0275\u0275nextContext(),a=e.\u0275\u0275reference(62);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngTemplateOutlet",a)("ngTemplateOutletContext",e.\u0275\u0275pureFunction1(4,gi,t.protocol)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngTemplateOutlet",a)("ngTemplateOutletContext",e.\u0275\u0275pureFunction1(6,gi,t.protocol+"s"))}}function Is(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.device-connectivity.port-pattern")," "))}function ws(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.device-connectivity.port-range")," "))}function Es(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",28)(1,"mat-slide-toggle",29),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"div",30)(5,"mat-form-field",31)(6,"mat-label",8),e.\u0275\u0275text(7,"admin.device-connectivity.host"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(8,"input",32),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(9,"mat-form-field",31)(10,"mat-label",8),e.\u0275\u0275text(11,"admin.device-connectivity.port"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(12,"input",33),e.\u0275\u0275template(13,Is,3,3,"mat-error",10),e.\u0275\u0275template(14,ws,3,3,"mat-error",10),e.\u0275\u0275elementEnd()()()),2&i){const t=n.protocol,a=e.\u0275\u0275nextContext();e.\u0275\u0275property("formGroupName",t),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(3,4,"admin.device-connectivity."+t)," "),e.\u0275\u0275advance(11),e.\u0275\u0275property("ngIf",a.deviceConnectivitySettingsForm.get(t+".port").hasError("pattern")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",a.deviceConnectivitySettingsForm.get(t+".port").hasError("min")||a.deviceConnectivitySettingsForm.get(t+".port").hasError("max"))}}class fi extends se.I{constructor(n,t,a){super(n),this.store=n,this.adminService=t,this.fb=a,this.protocol="http",this.destroy$=new be.x,this.buildGeneralServerSettingsForm(),this.adminService.getAdminSettings("general").subscribe(o=>this.processGeneralSettings(o)),this.buildDeviceConnectivitySettingsForm(),this.adminService.getAdminSettings("connectivity").subscribe(o=>this.processDeviceConnectivitySettings(o))}ngOnDestroy(){super.ngOnDestroy(),this.destroy$.next(),this.destroy$.complete()}buildGeneralServerSettingsForm(){this.generalSettings=this.fb.group({baseUrl:["",[r.Validators.required]],prohibitDifferentUrl:["",[]]})}buildDeviceConnectivitySettingsForm(){this.deviceConnectivitySettingsForm=this.fb.group({http:this.buildDeviceConnectivityInfoForm(),https:this.buildDeviceConnectivityInfoForm(),mqtt:this.buildDeviceConnectivityInfoForm(),mqtts:this.buildDeviceConnectivityInfoForm(),coap:this.buildDeviceConnectivityInfoForm(),coaps:this.buildDeviceConnectivityInfoForm()})}buildDeviceConnectivityInfoForm(){const n=this.fb.group({enabled:[!1,[]],host:[{value:"",disabled:!0}],port:[{value:null,disabled:!0},[r.Validators.min(1),r.Validators.max(65535),r.Validators.pattern("[0-9]*")]]});return n.get("enabled").valueChanges.pipe((0,Y.R)(this.destroy$)).subscribe(t=>{t?(n.get("host").enable({emitEvent:!1}),n.get("port").enable({emitEvent:!1})):(n.get("host").disable({emitEvent:!1}),n.get("port").disable({emitEvent:!1}))}),n}save(){this.adminSettings.jsonValue={...this.adminSettings.jsonValue,...this.generalSettings.value},this.adminService.saveAdminSettings(this.adminSettings).subscribe(n=>this.processGeneralSettings(n))}saveDeviceConnectivitySettings(){this.deviceConnectivitySettings.jsonValue={...this.deviceConnectivitySettings.jsonValue,...this.deviceConnectivitySettingsForm.getRawValue()},this.adminService.saveAdminSettings(this.deviceConnectivitySettings).subscribe(n=>this.processDeviceConnectivitySettings(n))}discardGeneralSettings(){this.generalSettings.reset(this.adminSettings.jsonValue)}discardDeviceConnectivitySettings(){this.deviceConnectivitySettingsForm.reset(this.deviceConnectivitySettings.jsonValue)}processGeneralSettings(n){this.adminSettings=n,this.generalSettings.reset(this.adminSettings.jsonValue)}processDeviceConnectivitySettings(n){this.deviceConnectivitySettings=n,this.deviceConnectivitySettingsForm.reset(this.deviceConnectivitySettings.jsonValue)}confirmForm(){return this.generalSettings.dirty?this.generalSettings:this.deviceConnectivitySettingsForm}}fi.\u0275fac=function(n){return new(n||fi)(e.\u0275\u0275directiveInject(x.Store),e.\u0275\u0275directiveInject(Fa.l),e.\u0275\u0275directiveInject(r.FormBuilder))},fi.\u0275cmp=e.\u0275\u0275defineComponent({type:fi,selectors:[["tb-general-settings"]],features:[e.\u0275\u0275InheritDefinitionFeature],decls:71,vars:60,consts:[["appearance","outlined",1,"settings-card"],["fxLayout","row"],["translate","",1,"mat-headline-5"],["color","warn","mode","indeterminate",4,"ngIf"],["style","height: 4px;",4,"ngIf"],[1,"tb-form-panel","no-border","no-padding",3,"formGroup","ngSubmit"],[3,"disabled"],[1,"mat-block"],["translate",""],["matInput","","formControlName","baseUrl","required",""],[4,"ngIf"],[1,"tb-form-row",3,"tb-hint-tooltip-icon"],["formControlName","prohibitDifferentUrl",1,"mat-slide","margin"],["fxLayout","row","fxLayoutAlign","end center","fxLayoutGap","8px",1,"layout-wrap"],["mat-button","","color","primary","type","button",3,"disabled","click"],["mat-button","","mat-raised-button","","color","primary","type","submit",3,"disabled"],[1,"tb-form-panel","no-border","no-padding"],[1,"tb-form-panel","no-border","no-padding","toggle-group"],["appearance","fill",3,"ngModel","ngModelChange"],["value","http"],["value","mqtt"],["value","coap"],[1,"tb-form-hint","tb-primary-fill"],["connectivitySettings",""],["mat-raised-button","","color","primary","type","submit",3,"disabled"],["color","warn","mode","indeterminate"],[2,"height","4px"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"tb-form-panel","stroked","no-padding-bottom",3,"formGroupName"],["formControlName","enabled",1,"mat-slide"],[1,"tb-form-row","column-xs","no-border","no-padding","tb-standard-fields"],["fxFlex",""],["matInput","","formControlName","host"],["matInput","","type","number","min","0","max","65535","formControlName","port"]],template:function(n,t){1&n&&(e.\u0275\u0275elementStart(0,"mat-card",0)(1,"mat-card-header")(2,"mat-card-title")(3,"div",1)(4,"span",2),e.\u0275\u0275text(5,"admin.general-settings"),e.\u0275\u0275elementEnd()()()(),e.\u0275\u0275template(6,ps,1,0,"mat-progress-bar",3),e.\u0275\u0275pipe(7,"async"),e.\u0275\u0275template(8,ms,1,0,"div",4),e.\u0275\u0275pipe(9,"async"),e.\u0275\u0275elementStart(10,"mat-card-content")(11,"form",5),e.\u0275\u0275listener("ngSubmit",function(){return t.save()}),e.\u0275\u0275elementStart(12,"fieldset",6),e.\u0275\u0275pipe(13,"async"),e.\u0275\u0275elementStart(14,"mat-form-field",7)(15,"mat-label",8),e.\u0275\u0275text(16,"admin.base-url"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(17,"input",9),e.\u0275\u0275template(18,us,3,3,"mat-error",10),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(19,"div",11),e.\u0275\u0275pipe(20,"translate"),e.\u0275\u0275elementStart(21,"mat-slide-toggle",12),e.\u0275\u0275text(22),e.\u0275\u0275pipe(23,"translate"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(24,"div",13)(25,"button",14),e.\u0275\u0275listener("click",function(){return t.discardGeneralSettings()}),e.\u0275\u0275text(26),e.\u0275\u0275pipe(27,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(28,"button",15),e.\u0275\u0275pipe(29,"async"),e.\u0275\u0275text(30),e.\u0275\u0275pipe(31,"translate"),e.\u0275\u0275elementEnd()()()()(),e.\u0275\u0275elementStart(32,"mat-card",0)(33,"mat-card-header")(34,"mat-card-title")(35,"div",2),e.\u0275\u0275text(36,"admin.device-connectivity.device-connectivity"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275template(37,gs,1,0,"mat-progress-bar",3),e.\u0275\u0275pipe(38,"async"),e.\u0275\u0275template(39,fs,1,0,"div",4),e.\u0275\u0275pipe(40,"async"),e.\u0275\u0275elementStart(41,"mat-card-content")(42,"section",16)(43,"div",17)(44,"tb-toggle-select",18),e.\u0275\u0275listener("ngModelChange",function(o){return t.protocol=o}),e.\u0275\u0275elementStart(45,"tb-toggle-option",19),e.\u0275\u0275text(46),e.\u0275\u0275pipe(47,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(48,"tb-toggle-option",20),e.\u0275\u0275text(49),e.\u0275\u0275pipe(50,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(51,"tb-toggle-option",21),e.\u0275\u0275text(52),e.\u0275\u0275pipe(53,"translate"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(54,"div",22),e.\u0275\u0275text(55),e.\u0275\u0275pipe(56,"translate"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(57,"form",5),e.\u0275\u0275listener("ngSubmit",function(){return t.saveDeviceConnectivitySettings()}),e.\u0275\u0275template(58,ys,3,8,"ng-container",10),e.\u0275\u0275template(59,xs,3,8,"ng-container",10),e.\u0275\u0275template(60,Ss,3,8,"ng-container",10),e.\u0275\u0275template(61,Es,15,6,"ng-template",null,23,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementStart(63,"div",13)(64,"button",14),e.\u0275\u0275listener("click",function(){return t.discardDeviceConnectivitySettings()}),e.\u0275\u0275text(65),e.\u0275\u0275pipe(66,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(67,"button",24),e.\u0275\u0275pipe(68,"async"),e.\u0275\u0275text(69),e.\u0275\u0275pipe(70,"translate"),e.\u0275\u0275elementEnd()()()()()()),2&n&&(e.\u0275\u0275advance(6),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(7,26,t.isLoading$)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!e.\u0275\u0275pipeBind1(9,28,t.isLoading$)),e.\u0275\u0275advance(3),e.\u0275\u0275property("formGroup",t.generalSettings),e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(13,30,t.isLoading$)),e.\u0275\u0275advance(6),e.\u0275\u0275property("ngIf",t.generalSettings.get("baseUrl").hasError("required")),e.\u0275\u0275advance(1),e.\u0275\u0275propertyInterpolate("tb-hint-tooltip-icon",e.\u0275\u0275pipeBind1(20,32,"admin.prohibit-different-url-hint")),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(23,34,"admin.prohibit-different-url")," "),e.\u0275\u0275advance(3),e.\u0275\u0275property("disabled",t.generalSettings.pristine),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1("",e.\u0275\u0275pipeBind1(27,36,"action.undo")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(29,38,t.isLoading$)||t.generalSettings.invalid||!t.generalSettings.dirty),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1("",e.\u0275\u0275pipeBind1(31,40,"action.save")," "),e.\u0275\u0275advance(7),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(38,42,t.isLoading$)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!e.\u0275\u0275pipeBind1(40,44,t.isLoading$)),e.\u0275\u0275advance(5),e.\u0275\u0275property("ngModel",t.protocol),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(47,46,"admin.device-connectivity.http-s")),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(50,48,"admin.device-connectivity.mqtt-s")),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(53,50,"admin.device-connectivity.coap-s")),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(56,52,"admin.device-connectivity.hint")),e.\u0275\u0275advance(2),e.\u0275\u0275property("formGroup",t.deviceConnectivitySettingsForm),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf","http"===t.protocol),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf","mqtt"===t.protocol),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf","coap"===t.protocol),e.\u0275\u0275advance(4),e.\u0275\u0275property("disabled",t.deviceConnectivitySettingsForm.pristine),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1("",e.\u0275\u0275pipeBind1(66,54,"action.undo")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(68,56,t.isLoading$)||t.deviceConnectivitySettingsForm.invalid||!t.deviceConnectivitySettingsForm.dirty),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1("",e.\u0275\u0275pipeBind1(70,58,"action.save")," "))},dependencies:[p.NgIf,p.NgTemplateOutlet,S.MatButton,A.MatCard,A.MatCardContent,A.MatCardHeader,A.MatCardTitle,z.MatProgressBar,O.MatInput,_.MatFormField,_.MatLabel,_.MatError,Ce.MatSlideToggle,h.DefaultLayoutDirective,h.DefaultLayoutGapDirective,h.DefaultLayoutAlignDirective,h.DefaultFlexDirective,r.\u0275NgNoValidate,r.DefaultValueAccessor,r.NumberValueAccessor,r.NgControlStatus,r.NgControlStatusGroup,r.RequiredValidator,r.MinValidator,r.MaxValidator,r.NgModel,r.FormGroupDirective,r.FormControlName,r.FormGroupName,g.TranslateDirective,io.ToggleOption,cs.ToggleSelectComponent,wo.HintTooltipIconComponent,p.AsyncPipe,g.TranslatePipe],styles:['@charset "UTF-8";[_nghost-%COMP%]   .settings-card[_ngcontent-%COMP%]   .toggle-group[_ngcontent-%COMP%]{max-width:670px;width:100%;margin:0 auto}[_nghost-%COMP%]   .settings-card[_ngcontent-%COMP%]   .toggle-group[_ngcontent-%COMP%]   .tb-form-hint[_ngcontent-%COMP%]{text-align:center}@media screen and (max-width: 599px){[_nghost-%COMP%]   .settings-card[_ngcontent-%COMP%]   .tb-form-row[_ngcontent-%COMP%]{gap:0}}','@charset "UTF-8";[_nghost-%COMP%]   .mat-mdc-card.settings-card[_ngcontent-%COMP%]{margin:8px}[_nghost-%COMP%]   .mat-mdc-card.settings-card[_ngcontent-%COMP%]   .fields-group[_ngcontent-%COMP%]{padding:0 16px 8px;margin:10px 0;border:1px groove #7c7c7c;border-radius:4px}@media screen and (min-width: 960px) and (max-width: 1279px){[_nghost-%COMP%]   .mat-mdc-card.settings-card[_ngcontent-%COMP%]{width:80%}}@media screen and (min-width: 1280px){[_nghost-%COMP%]   .mat-mdc-card.settings-card[_ngcontent-%COMP%]{width:60%}}']});var ne=c(69637),Z=c(27303),pe=c(58030),J=c(9237);function Ms(i,n){1&i&&e.\u0275\u0275element(0,"mat-progress-bar",44)}function Ds(i,n){1&i&&e.\u0275\u0275element(0,"div",45)}function As(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.minimum-max-failed-login-attempts-range")," "))}function Ns(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.minimum-password-length-required")," "))}function Fs(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.minimum-password-length-range")," "))}function Ls(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.minimum-password-length-range")," "))}function Ps(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.maximum-password-length-min")," "))}function ks(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.maximum-password-length-less-min")," "))}function Rs(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.minimum-uppercase-letters-range")," "))}function Os(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.minimum-lowercase-letters-range")," "))}function Bs(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.minimum-digits-range")," "))}function Vs(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.minimum-special-characters-range")," "))}function Us(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.password-expiration-period-days-range")," "))}function Gs(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.password-reuse-frequency-days-range")," "))}function js(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.jwt.issuer-name-required")," "))}function Ws(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.jwt.signings-key-required")," "))}function qs(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.jwt.signings-key-base64")," "))}function $s(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.jwt.signings-key-min-length")," "))}function Hs(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.jwt.expiration-time-required")," "))}function zs(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.jwt.expiration-time-pattern")," "))}function Ks(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.jwt.expiration-time-min")," "))}function Ys(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.jwt.refresh-expiration-time-required")," "))}function Js(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.jwt.refresh-expiration-time-pattern")," "))}function Qs(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.jwt.refresh-expiration-time-min")," "))}function Xs(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.jwt.refresh-expiration-time-less-token")," "))}class hi extends se.I{constructor(n,t,a,o,s,l,d){super(n),this.store=n,this.router=t,this.adminService=a,this.authService=o,this.dialogService=s,this.translate=l,this.fb=d,this.buildSecuritySettingsForm(),this.buildJwtSecuritySettingsForm(),this.adminService.getSecuritySettings().subscribe(m=>this.processSecuritySettings(m)),this.adminService.getJwtSettings().subscribe(m=>this.processJwtSettings(m))}buildSecuritySettingsForm(){this.securitySettingsFormGroup=this.fb.group({maxFailedLoginAttempts:[null,[r.Validators.min(0)]],userLockoutNotificationEmail:["",[]],passwordPolicy:this.fb.group({minimumLength:[null,[r.Validators.required,r.Validators.min(6),r.Validators.max(50)]],maximumLength:[null,[r.Validators.min(6),this.maxPasswordValidation()]],minimumUppercaseLetters:[null,r.Validators.min(0)],minimumLowercaseLetters:[null,r.Validators.min(0)],minimumDigits:[null,r.Validators.min(0)],minimumSpecialCharacters:[null,r.Validators.min(0)],passwordExpirationPeriodDays:[null,r.Validators.min(0)],passwordReuseFrequencyDays:[null,r.Validators.min(0)],allowWhitespaces:[!0],forceUserToResetPasswordIfNotValid:[!1]})})}buildJwtSecuritySettingsForm(){this.jwtSecuritySettingsFormGroup=this.fb.group({tokenIssuer:["",r.Validators.required],tokenSigningKey:["",[r.Validators.required,this.base64Format]],tokenExpirationTime:[0,[r.Validators.required,r.Validators.pattern("[0-9]*"),r.Validators.min(60)]],refreshTokenExpTime:[0,[r.Validators.required,r.Validators.pattern("[0-9]*"),r.Validators.min(900)]]},{validators:this.refreshTokenTimeGreatTokenTime.bind(this)}),this.jwtSecuritySettingsFormGroup.get("tokenExpirationTime").valueChanges.subscribe(()=>this.jwtSecuritySettingsFormGroup.get("refreshTokenExpTime").updateValueAndValidity({onlySelf:!0}))}save(){this.securitySettings={...this.securitySettings,...this.securitySettingsFormGroup.value},this.adminService.saveSecuritySettings(this.securitySettings).subscribe(n=>this.processSecuritySettings(n))}saveJwtSettings(){const n=this.jwtSecuritySettingsFormGroup.value;this.confirmChangeJWTSettings().pipe((0,ne.z)(t=>t?this.adminService.saveJwtSettings(n).pipe((0,Z.b)(a=>this.authService.setUserFromJwtToken(a.token,a.refreshToken,!1)),(0,ne.z)(()=>this.adminService.getJwtSettings()),(0,Z.b)(a=>this.processJwtSettings(a))):(0,J.of)(null))).subscribe(()=>{})}maxPasswordValidation(){return n=>{const t=n.value;return t&&t<n.parent.value?.minimumLength?{lessMin:!0}:null}}discardSetting(){this.securitySettingsFormGroup.reset(this.securitySettings)}discardJwtSetting(){this.jwtSecuritySettingsFormGroup.reset(this.jwtSettings)}markAsTouched(){this.jwtSecuritySettingsFormGroup.get("tokenSigningKey").markAsTouched()}confirmChangeJWTSettings(){return this.jwtSecuritySettingsFormGroup.get("tokenIssuer").value!==(this.jwtSettings?.tokenIssuer||"")||this.jwtSecuritySettingsFormGroup.get("tokenSigningKey").value!==(this.jwtSettings?.tokenSigningKey||"")?this.dialogService.confirm(this.translate.instant("admin.jwt.info-header"),`<div style="max-width: 640px">${this.translate.instant("admin.jwt.info-message")}</div>`,this.translate.instant("action.discard-changes"),this.translate.instant("action.confirm")):(0,J.of)(!0)}generateSigningKey(){this.jwtSecuritySettingsFormGroup.get("tokenSigningKey").setValue(btoa((0,T.PX)(64))),this.jwtSecuritySettingsFormGroup.get("tokenSigningKey").pristine&&(this.jwtSecuritySettingsFormGroup.get("tokenSigningKey").markAsDirty(),this.jwtSecuritySettingsFormGroup.get("tokenSigningKey").markAsTouched())}processSecuritySettings(n){this.securitySettings=n,this.securitySettingsFormGroup.reset(this.securitySettings)}processJwtSettings(n){this.jwtSettings=n,this.jwtSecuritySettingsFormGroup.reset(n)}refreshTokenTimeGreatTokenTime(n){if(n){if(n.value.tokenExpirationTime>=n.value.refreshTokenExpTime)return n.get("refreshTokenExpTime").untouched&&n.get("refreshTokenExpTime").markAsTouched(),n.get("refreshTokenExpTime").setErrors({lessToken:!0}),{lessToken:!0}}return null}base64Format(n){if(""===n.value||"thingsboardDefaultSigningKey"===n.value)return null;try{return atob(n.value).length<32?{minLength:!0}:null}catch{return{base64:!0}}}confirmForm(){return this.securitySettingsFormGroup.dirty?this.securitySettingsFormGroup:this.jwtSecuritySettingsFormGroup}}hi.\u0275fac=function(n){return new(n||hi)(e.\u0275\u0275directiveInject(x.Store),e.\u0275\u0275directiveInject(b.Router),e.\u0275\u0275directiveInject(Fa.l),e.\u0275\u0275directiveInject(pi.e),e.\u0275\u0275directiveInject(pe.x),e.\u0275\u0275directiveInject(g.TranslateService),e.\u0275\u0275directiveInject(r.UntypedFormBuilder))},hi.\u0275cmp=e.\u0275\u0275defineComponent({type:hi,selectors:[["tb-security-settings"]],features:[e.\u0275\u0275InheritDefinitionFeature],decls:149,vars:66,consts:[["appearance","outlined",1,"settings-card"],["translate","",1,"mat-headline-5"],["fxFlex",""],["tb-help","securitySettings"],["color","warn","mode","indeterminate",4,"ngIf"],["style","height: 4px;",4,"ngIf"],["autocomplete","off",3,"formGroup","ngSubmit"],[3,"disabled"],[1,"fields-group"],["translate","",1,"group-title"],[1,"mat-block"],["translate",""],["matInput","","type","number","formControlName","maxFailedLoginAttempts","step","1","min","0"],[4,"ngIf"],["matInput","","type","email","formControlName","userLockoutNotificationEmail"],["formGroupName","passwordPolicy"],["fxLayout","row","fxLayout.xs","column","fxLayoutGap.gt-xs","8px"],["fxFlex","",1,"mat-block"],["matInput","","type","number","formControlName","minimumLength","step","1","min","6","max","50","required",""],["fxFlex","","subscriptSizing","dynamic",1,"mat-block"],["matInput","","type","number","formControlName","maximumLength","step","1","min","6"],["matInput","","type","number","formControlName","minimumUppercaseLetters","step","1","min","0"],["matInput","","type","number","formControlName","minimumLowercaseLetters","step","1","min","0"],["matInput","","type","number","formControlName","minimumDigits","step","1","min","0"],["matInput","","type","number","formControlName","minimumSpecialCharacters","step","1","min","0"],["matInput","","type","number","formControlName","passwordExpirationPeriodDays","step","1","min","0"],["matInput","","type","number","formControlName","passwordReuseFrequencyDays","step","1","min","0"],["fxFlex","","formControlName","allowWhitespaces",2,"margin-bottom","16px"],["fxFlex","","formControlName","forceUserToResetPasswordIfNotValid",2,"margin-bottom","16px"],[3,"tb-hint-tooltip-icon"],["fxLayout","row","fxLayoutAlign","end center","fxLayoutGap","8px",1,"layout-wrap",2,"margin-top","16px"],["mat-button","","color","primary","type","button",3,"disabled","click"],["mat-button","","mat-raised-button","","color","primary","type","submit",3,"disabled"],["tb-help","jwtSecuritySettings"],[2,"padding-top","16px"],["fxLayout","column","fxLayoutGap","8px",3,"disabled"],["fxLayout","row","fxLayout.xs","column","fxLayoutGap","8px"],["matInput","","required","","formControlName","tokenIssuer"],["matInput","","required","","formControlName","tokenSigningKey",3,"focus"],["type","button","matSuffix","","mat-button","","color","primary",2,"line-height","32px",3,"click"],["matInput","","type","number","required","","formControlName","tokenExpirationTime","step","1","min","0"],["matInput","","type","number","required","","formControlName","refreshTokenExpTime","step","1","min","0"],["fxLayout","row","fxLayoutAlign","end center","fxLayoutGap","8px",1,"layout-wrap"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],["color","warn","mode","indeterminate"],[2,"height","4px"]],template:function(n,t){1&n&&(e.\u0275\u0275elementStart(0,"mat-card",0)(1,"mat-card-header")(2,"mat-card-title")(3,"span",1),e.\u0275\u0275text(4,"admin.security-settings"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275element(5,"span",2)(6,"div",3),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(7,Ms,1,0,"mat-progress-bar",4),e.\u0275\u0275pipe(8,"async"),e.\u0275\u0275template(9,Ds,1,0,"div",5),e.\u0275\u0275pipe(10,"async"),e.\u0275\u0275elementStart(11,"mat-card-content")(12,"form",6),e.\u0275\u0275listener("ngSubmit",function(){return t.save()}),e.\u0275\u0275elementStart(13,"fieldset",7),e.\u0275\u0275pipe(14,"async"),e.\u0275\u0275elementStart(15,"fieldset",8)(16,"legend",9),e.\u0275\u0275text(17,"admin.general-policy"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(18,"mat-form-field",10)(19,"mat-label",11),e.\u0275\u0275text(20,"admin.max-failed-login-attempts"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(21,"input",12),e.\u0275\u0275template(22,As,3,3,"mat-error",13),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(23,"mat-form-field",10)(24,"mat-label",11),e.\u0275\u0275text(25,"admin.user-lockout-notification-email"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(26,"input",14),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(27,"fieldset",8)(28,"legend",9),e.\u0275\u0275text(29,"admin.password-policy"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(30,"section",15)(31,"div",16)(32,"mat-form-field",17)(33,"mat-label",11),e.\u0275\u0275text(34,"admin.minimum-password-length"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(35,"input",18),e.\u0275\u0275template(36,Ns,3,3,"mat-error",13),e.\u0275\u0275template(37,Fs,3,3,"mat-error",13),e.\u0275\u0275template(38,Ls,3,3,"mat-error",13),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(39,"mat-form-field",19)(40,"mat-label",11),e.\u0275\u0275text(41,"admin.maximum-password-length"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(42,"input",20)(43,"mat-hint"),e.\u0275\u0275template(44,Ps,3,3,"mat-error",13),e.\u0275\u0275template(45,ks,3,3,"mat-error",13),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(46,"div",16)(47,"mat-form-field",17)(48,"mat-label",11),e.\u0275\u0275text(49,"admin.minimum-uppercase-letters"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(50,"input",21),e.\u0275\u0275template(51,Rs,3,3,"mat-error",13),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(52,"mat-form-field",17)(53,"mat-label",11),e.\u0275\u0275text(54,"admin.minimum-lowercase-letters"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(55,"input",22),e.\u0275\u0275template(56,Os,3,3,"mat-error",13),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(57,"div",16)(58,"mat-form-field",17)(59,"mat-label",11),e.\u0275\u0275text(60,"admin.minimum-digits"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(61,"input",23),e.\u0275\u0275template(62,Bs,3,3,"mat-error",13),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(63,"mat-form-field",17)(64,"mat-label",11),e.\u0275\u0275text(65,"admin.minimum-special-characters"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(66,"input",24),e.\u0275\u0275template(67,Vs,3,3,"mat-error",13),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(68,"div",16)(69,"mat-form-field",17)(70,"mat-label",11),e.\u0275\u0275text(71,"admin.password-expiration-period-days"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(72,"input",25),e.\u0275\u0275template(73,Us,3,3,"mat-error",13),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(74,"mat-form-field",17)(75,"mat-label",11),e.\u0275\u0275text(76,"admin.password-reuse-frequency-days"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(77,"input",26),e.\u0275\u0275template(78,Gs,3,3,"mat-error",13),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(79,"div",16)(80,"mat-checkbox",27)(81,"mat-label",11),e.\u0275\u0275text(82,"admin.allow-whitespace"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(83,"mat-checkbox",28)(84,"mat-label",29),e.\u0275\u0275pipe(85,"translate"),e.\u0275\u0275text(86),e.\u0275\u0275pipe(87,"translate"),e.\u0275\u0275elementEnd()()()()(),e.\u0275\u0275elementStart(88,"div",30)(89,"button",31),e.\u0275\u0275listener("click",function(){return t.discardSetting()}),e.\u0275\u0275text(90),e.\u0275\u0275pipe(91,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(92,"button",32),e.\u0275\u0275pipe(93,"async"),e.\u0275\u0275text(94),e.\u0275\u0275pipe(95,"translate"),e.\u0275\u0275elementEnd()()()()()(),e.\u0275\u0275elementStart(96,"mat-card",0)(97,"mat-card-header")(98,"mat-card-title")(99,"span",1),e.\u0275\u0275text(100,"admin.jwt.security-settings"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275element(101,"span",2)(102,"div",33),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(103,"mat-card-content",34)(104,"form",6),e.\u0275\u0275listener("ngSubmit",function(){return t.saveJwtSettings()}),e.\u0275\u0275elementStart(105,"fieldset",35),e.\u0275\u0275pipe(106,"async"),e.\u0275\u0275elementStart(107,"div",36)(108,"mat-form-field",17)(109,"mat-label",11),e.\u0275\u0275text(110,"admin.jwt.issuer-name"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(111,"input",37),e.\u0275\u0275template(112,js,3,3,"mat-error",13),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(113,"mat-form-field",17)(114,"mat-label",11),e.\u0275\u0275text(115,"admin.jwt.signings-key"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(116,"input",38),e.\u0275\u0275listener("focus",function(){return t.markAsTouched()}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(117,"button",39),e.\u0275\u0275listener("click",function(){return t.generateSigningKey()}),e.\u0275\u0275text(118),e.\u0275\u0275pipe(119,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(120,"mat-hint",11),e.\u0275\u0275text(121,"admin.jwt.signings-key-hint"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(122,Ws,3,3,"mat-error",13),e.\u0275\u0275template(123,qs,3,3,"mat-error",13),e.\u0275\u0275template(124,$s,3,3,"mat-error",13),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(125,"div",36)(126,"mat-form-field",17)(127,"mat-label",11),e.\u0275\u0275text(128,"admin.jwt.expiration-time"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(129,"input",40),e.\u0275\u0275template(130,Hs,3,3,"mat-error",13),e.\u0275\u0275template(131,zs,3,3,"mat-error",13),e.\u0275\u0275template(132,Ks,3,3,"mat-error",13),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(133,"mat-form-field",17)(134,"mat-label",11),e.\u0275\u0275text(135,"admin.jwt.refresh-expiration-time"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(136,"input",41),e.\u0275\u0275template(137,Ys,3,3,"mat-error",13),e.\u0275\u0275template(138,Js,3,3,"mat-error",13),e.\u0275\u0275template(139,Qs,3,3,"mat-error",13),e.\u0275\u0275template(140,Xs,3,3,"mat-error",13),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(141,"div",42)(142,"button",31),e.\u0275\u0275listener("click",function(){return t.discardJwtSetting()}),e.\u0275\u0275text(143),e.\u0275\u0275pipe(144,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(145,"button",43),e.\u0275\u0275pipe(146,"async"),e.\u0275\u0275text(147),e.\u0275\u0275pipe(148,"translate"),e.\u0275\u0275elementEnd()()()()()()),2&n&&(e.\u0275\u0275advance(7),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(8,40,t.isLoading$)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!e.\u0275\u0275pipeBind1(10,42,t.isLoading$)),e.\u0275\u0275advance(3),e.\u0275\u0275property("formGroup",t.securitySettingsFormGroup),e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(14,44,t.isLoading$)),e.\u0275\u0275advance(9),e.\u0275\u0275property("ngIf",t.securitySettingsFormGroup.get("maxFailedLoginAttempts").hasError("min")),e.\u0275\u0275advance(14),e.\u0275\u0275property("ngIf",t.securitySettingsFormGroup.get("passwordPolicy.minimumLength").hasError("required")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.securitySettingsFormGroup.get("passwordPolicy.minimumLength").hasError("min")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.securitySettingsFormGroup.get("passwordPolicy.minimumLength").hasError("max")),e.\u0275\u0275advance(6),e.\u0275\u0275property("ngIf",t.securitySettingsFormGroup.get("passwordPolicy.maximumLength").hasError("min")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.securitySettingsFormGroup.get("passwordPolicy.maximumLength").hasError("lessMin")),e.\u0275\u0275advance(6),e.\u0275\u0275property("ngIf",t.securitySettingsFormGroup.get("passwordPolicy.minimumUppercaseLetters").hasError("min")),e.\u0275\u0275advance(5),e.\u0275\u0275property("ngIf",t.securitySettingsFormGroup.get("passwordPolicy.minimumLowercaseLetters").hasError("min")),e.\u0275\u0275advance(6),e.\u0275\u0275property("ngIf",t.securitySettingsFormGroup.get("passwordPolicy.minimumDigits").hasError("min")),e.\u0275\u0275advance(5),e.\u0275\u0275property("ngIf",t.securitySettingsFormGroup.get("passwordPolicy.minimumSpecialCharacters").hasError("min")),e.\u0275\u0275advance(6),e.\u0275\u0275property("ngIf",t.securitySettingsFormGroup.get("passwordPolicy.passwordExpirationPeriodDays").hasError("min")),e.\u0275\u0275advance(5),e.\u0275\u0275property("ngIf",t.securitySettingsFormGroup.get("passwordPolicy.passwordReuseFrequencyDays").hasError("min")),e.\u0275\u0275advance(6),e.\u0275\u0275propertyInterpolate("tb-hint-tooltip-icon",e.\u0275\u0275pipeBind1(85,46,"admin.force-reset-password-if-no-valid-hint")),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(87,48,"admin.force-reset-password-if-no-valid")," "),e.\u0275\u0275advance(3),e.\u0275\u0275property("disabled",t.securitySettingsFormGroup.pristine),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1("",e.\u0275\u0275pipeBind1(91,50,"action.undo")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(93,52,t.isLoading$)||t.securitySettingsFormGroup.invalid||!t.securitySettingsFormGroup.dirty),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1("",e.\u0275\u0275pipeBind1(95,54,"action.save")," "),e.\u0275\u0275advance(10),e.\u0275\u0275property("formGroup",t.jwtSecuritySettingsFormGroup),e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(106,56,t.isLoading$)),e.\u0275\u0275advance(7),e.\u0275\u0275property("ngIf",t.jwtSecuritySettingsFormGroup.get("tokenIssuer").hasError("required")),e.\u0275\u0275advance(6),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(119,58,"admin.jwt.generate-key")," "),e.\u0275\u0275advance(4),e.\u0275\u0275property("ngIf",t.jwtSecuritySettingsFormGroup.get("tokenSigningKey").hasError("required")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.jwtSecuritySettingsFormGroup.get("tokenSigningKey").hasError("base64")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.jwtSecuritySettingsFormGroup.get("tokenSigningKey").hasError("minLength")),e.\u0275\u0275advance(6),e.\u0275\u0275property("ngIf",t.jwtSecuritySettingsFormGroup.get("tokenExpirationTime").hasError("required")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.jwtSecuritySettingsFormGroup.get("tokenExpirationTime").hasError("pattern")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.jwtSecuritySettingsFormGroup.get("tokenExpirationTime").hasError("min")),e.\u0275\u0275advance(5),e.\u0275\u0275property("ngIf",t.jwtSecuritySettingsFormGroup.get("refreshTokenExpTime").hasError("required")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.jwtSecuritySettingsFormGroup.get("refreshTokenExpTime").hasError("pattern")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.jwtSecuritySettingsFormGroup.get("refreshTokenExpTime").hasError("min")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.jwtSecuritySettingsFormGroup.get("refreshTokenExpTime").hasError("lessToken")),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",t.jwtSecuritySettingsFormGroup.pristine),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1("",e.\u0275\u0275pipeBind1(144,60,"action.undo")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(146,62,t.isLoading$)||t.jwtSecuritySettingsFormGroup.invalid||!t.jwtSecuritySettingsFormGroup.dirty),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1("",e.\u0275\u0275pipeBind1(148,64,"action.save")," "))},dependencies:[p.NgIf,De.HelpComponent,S.MatButton,fe.MatCheckbox,A.MatCard,A.MatCardContent,A.MatCardHeader,A.MatCardTitle,z.MatProgressBar,O.MatInput,_.MatFormField,_.MatLabel,_.MatHint,_.MatError,_.MatSuffix,h.DefaultLayoutDirective,h.DefaultLayoutGapDirective,h.DefaultLayoutAlignDirective,h.DefaultFlexDirective,r.\u0275NgNoValidate,r.DefaultValueAccessor,r.NumberValueAccessor,r.NgControlStatus,r.NgControlStatusGroup,r.RequiredValidator,r.MinValidator,r.MaxValidator,r.FormGroupDirective,r.FormControlName,r.FormGroupName,g.TranslateDirective,wo.HintTooltipIconComponent,p.AsyncPipe,g.TranslatePipe],styles:['@charset "UTF-8";[_nghost-%COMP%]   .mat-headline-5[_ngcontent-%COMP%]{margin-bottom:8px}[_nghost-%COMP%]   .mat-mdc-card-title[_ngcontent-%COMP%]{margin:0}[_nghost-%COMP%]   .fields-group[_ngcontent-%COMP%]{padding:8px 16px 0;margin:10px 0;border:1px groove rgba(0,0,0,.25);border-radius:4px}[_nghost-%COMP%]   .fields-group[_ngcontent-%COMP%]   legend[_ngcontent-%COMP%]{color:#000000b3}','@charset "UTF-8";[_nghost-%COMP%]   .mat-mdc-card.settings-card[_ngcontent-%COMP%]{margin:8px}[_nghost-%COMP%]   .mat-mdc-card.settings-card[_ngcontent-%COMP%]   .fields-group[_ngcontent-%COMP%]{padding:0 16px 8px;margin:10px 0;border:1px groove #7c7c7c;border-radius:4px}@media screen and (min-width: 960px) and (max-width: 1279px){[_nghost-%COMP%]   .mat-mdc-card.settings-card[_ngcontent-%COMP%]{width:80%}}@media screen and (min-width: 1280px){[_nghost-%COMP%]   .mat-mdc-card.settings-card[_ngcontent-%COMP%]{width:60%}}']});var ao=c(56601),Zs=c(88062),Ln=c(88462),H=c(31128);function el(i,n){1&i&&e.\u0275\u0275element(0,"mat-progress-bar",14)}function tl(i,n){1&i&&e.\u0275\u0275element(0,"div",15)}function nl(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-option",55),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"uppercase"),e.\u0275\u0275pipe(3,"translate"),e.\u0275\u0275elementEnd()),2&i){const t=n.$implicit,a=e.\u0275\u0275nextContext(5);e.\u0275\u0275property("value",t),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,2,e.\u0275\u0275pipeBind1(3,4,a.domainSchemaTranslations.get(t)))," ")}}function il(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.error-verification-url")," "))}function al(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.domain-name-max-length")," "))}function ol(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.domain-name-unique")," "))}function rl(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-form-field",47),e.\u0275\u0275element(1,"input",50)(2,"tb-copy-button",51),e.\u0275\u0275pipe(3,"translate"),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275nextContext().$implicit,a=e.\u0275\u0275nextContext(4);e.\u0275\u0275advance(1),e.\u0275\u0275property("value",a.redirectURIMixed(t)),e.\u0275\u0275advance(1),e.\u0275\u0275propertyInterpolate("tooltipText",e.\u0275\u0275pipeBind1(3,3,"admin.oauth2.copy-redirect-uri")),e.\u0275\u0275property("copyText",a.redirectURIMixed(t))}}function sl(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"section",38)(1,"div",39)(2,"div",40)(3,"div",41)(4,"div",42)(5,"mat-form-field",43)(6,"mat-label",44),e.\u0275\u0275text(7,"admin.oauth2.protocol"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(8,"mat-select",45),e.\u0275\u0275template(9,nl,4,6,"mat-option",46),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(10,"mat-form-field",47)(11,"mat-label",44),e.\u0275\u0275text(12,"admin.domain-name"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(13,"input",48),e.\u0275\u0275template(14,il,3,3,"mat-error",33),e.\u0275\u0275template(15,al,3,3,"mat-error",33),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(16,ol,3,3,"mat-error",33),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(17,"div",49)(18,"mat-form-field",47)(19,"mat-label",44),e.\u0275\u0275text(20,"admin.oauth2.redirect-uri-template"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(21,"input",50)(22,"tb-copy-button",51),e.\u0275\u0275pipe(23,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(24,rl,4,5,"mat-form-field",52),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(25,"div",53)(26,"button",54),e.\u0275\u0275listener("click",function(o){const l=e.\u0275\u0275restoreView(t).index,d=e.\u0275\u0275nextContext(2).$implicit,m=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(m.removeDomainInfo(o,d,l))}),e.\u0275\u0275pipe(27,"translate"),e.\u0275\u0275elementStart(28,"mat-icon"),e.\u0275\u0275text(29,"close"),e.\u0275\u0275elementEnd()()()()()}if(2&i){const t=n.$implicit,a=n.index,o=e.\u0275\u0275nextContext(2).$implicit,s=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275property("formGroupName",a),e.\u0275\u0275advance(8),e.\u0275\u0275property("ngForOf",s.protocols),e.\u0275\u0275advance(5),e.\u0275\u0275property("ngIf",t.get("name").hasError("pattern")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.get("name").hasError("maxlength")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.hasError("unique")),e.\u0275\u0275advance(5),e.\u0275\u0275property("value",s.redirectURI(t)),e.\u0275\u0275advance(1),e.\u0275\u0275propertyInterpolate("tooltipText",e.\u0275\u0275pipeBind1(23,11,"admin.oauth2.copy-redirect-uri")),e.\u0275\u0275property("copyText",s.redirectURI(t)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf","MIXED"===t.get("scheme").value),e.\u0275\u0275advance(2),e.\u0275\u0275propertyInterpolate("matTooltip",e.\u0275\u0275pipeBind1(27,13,"admin.oauth2.delete-domain")),e.\u0275\u0275property("disabled",s.domainInfos(o).controls.length<2)}}function ll(i,n){1&i&&(e.\u0275\u0275elementStart(0,"div")(1,"span",56),e.\u0275\u0275text(2,"admin.oauth2.no-mobile-apps"),e.\u0275\u0275elementEnd()())}function dl(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.oauth2.mobile-package-unique")," "))}function cl(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.oauth2.invalid-mobile-app-secret")," "))}function pl(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"section",57)(1,"div",39)(2,"div",40)(3,"div",49)(4,"mat-form-field",58)(5,"mat-label",44),e.\u0275\u0275text(6,"admin.oauth2.mobile-package"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(7,"input",59),e.\u0275\u0275pipe(8,"translate"),e.\u0275\u0275elementStart(9,"mat-hint",44),e.\u0275\u0275text(10,"admin.oauth2.mobile-package-hint"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(11,dl,3,3,"mat-error",33),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(12,"div",60)(13,"mat-form-field",47)(14,"mat-label",44),e.\u0275\u0275text(15,"admin.oauth2.mobile-app-secret"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(16,"textarea",61)(17,"tb-copy-button",51),e.\u0275\u0275pipe(18,"translate"),e.\u0275\u0275template(19,cl,3,3,"mat-error",33),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(20,"div",53)(21,"button",62),e.\u0275\u0275listener("click",function(o){const l=e.\u0275\u0275restoreView(t).index,d=e.\u0275\u0275nextContext(2).$implicit,m=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(m.removeMobileInfo(o,d,l))}),e.\u0275\u0275pipe(22,"translate"),e.\u0275\u0275elementStart(23,"mat-icon"),e.\u0275\u0275text(24,"close"),e.\u0275\u0275elementEnd()()()()()}if(2&i){const t=n.$implicit,a=n.index;e.\u0275\u0275advance(1),e.\u0275\u0275property("formGroupName",a),e.\u0275\u0275advance(6),e.\u0275\u0275propertyInterpolate("placeholder",e.\u0275\u0275pipeBind1(8,7,"admin.oauth2.mobile-package-placeholder")),e.\u0275\u0275advance(4),e.\u0275\u0275property("ngIf",t.hasError("unique")),e.\u0275\u0275advance(6),e.\u0275\u0275propertyInterpolate("tooltipText",e.\u0275\u0275pipeBind1(18,9,"admin.oauth2.copy-mobile-app-secret")),e.\u0275\u0275property("copyText",t.get("appSecret").value),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",t.get("appSecret").invalid),e.\u0275\u0275advance(2),e.\u0275\u0275propertyInterpolate("matTooltip",e.\u0275\u0275pipeBind1(22,11,"admin.oauth2.delete-mobile-app"))}}function ml(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-option",55),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){const t=n.$implicit;e.\u0275\u0275property("value",t),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",t," ")}}function ul(i,n){if(1&i&&e.\u0275\u0275element(0,"div",75),2&i){const t=e.\u0275\u0275nextContext(2).$implicit,a=e.\u0275\u0275nextContext(4);e.\u0275\u0275property("tb-help",a.getHelpLink(t))}}function gl(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-option",55),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i){const t=n.$implicit,a=e.\u0275\u0275nextContext(6);e.\u0275\u0275property("value",t),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,2,a.platformTypeTranslations.get(t))," ")}}function fl(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.oauth2.client-id-required")," "))}function hl(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.oauth2.client-id-max-length")," "))}function bl(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.oauth2.client-secret-required")," "))}function yl(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.oauth2.client-secret-max-length")," "))}function vl(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",98),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext(3).$implicit,s=e.\u0275\u0275nextContext(4);return e.\u0275\u0275resetView(s.toggleEditMode(o,"accessTokenUri"))}),e.\u0275\u0275elementStart(1,"mat-icon",99),e.\u0275\u0275text(2,"create"),e.\u0275\u0275elementEnd()()}}function _l(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.oauth2.access-token-uri-required")," "))}function xl(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.oauth2.uri-pattern-error")," "))}function Cl(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",98),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext(3).$implicit,s=e.\u0275\u0275nextContext(4);return e.\u0275\u0275resetView(s.toggleEditMode(o,"authorizationUri"))}),e.\u0275\u0275elementStart(1,"mat-icon",99),e.\u0275\u0275text(2,"create"),e.\u0275\u0275elementEnd()()}}function Tl(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.oauth2.authorization-uri-required")," "))}function Sl(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.oauth2.uri-pattern-error")," "))}function Il(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",100),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext(3).$implicit,s=e.\u0275\u0275nextContext(4);return e.\u0275\u0275resetView(s.toggleEditMode(o,"jwkSetUri"))}),e.\u0275\u0275elementStart(1,"mat-icon",99),e.\u0275\u0275text(2,"create"),e.\u0275\u0275elementEnd()()}}function wl(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.oauth2.uri-pattern-error")," "))}function El(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",98),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext(3).$implicit,s=e.\u0275\u0275nextContext(4);return e.\u0275\u0275resetView(s.toggleEditMode(o,"userInfoUri"))}),e.\u0275\u0275elementStart(1,"mat-icon",99),e.\u0275\u0275text(2,"create"),e.\u0275\u0275elementEnd()()}}function Ml(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.oauth2.uri-pattern-error")," "))}function Dl(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-option",55),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"uppercase"),e.\u0275\u0275elementEnd()),2&i){const t=n.$implicit;e.\u0275\u0275property("value",t),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,2,t)," ")}}function Al(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.oauth2.login-button-label-required")," "))}function Nl(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",65)(1,"mat-form-field",58)(2,"mat-label",44),e.\u0275\u0275text(3,"admin.oauth2.login-button-label"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(4,"input",101),e.\u0275\u0275pipe(5,"translate"),e.\u0275\u0275template(6,Al,3,3,"mat-error",33),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(7,"mat-form-field",47)(8,"mat-label",44),e.\u0275\u0275text(9,"admin.oauth2.login-button-icon"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(10,"input",102),e.\u0275\u0275elementEnd()()),2&i){const t=e.\u0275\u0275nextContext(3).$implicit;e.\u0275\u0275advance(4),e.\u0275\u0275propertyInterpolate("placeholder",e.\u0275\u0275pipeBind1(5,2,"admin.oauth2.login-button-label-placeholder")),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",t.get("loginButtonLabel").hasError("required"))}}function Fl(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"mat-chip-row",103),e.\u0275\u0275listener("removed",function(){const s=e.\u0275\u0275restoreView(t).index,l=e.\u0275\u0275nextContext(3).$implicit,d=e.\u0275\u0275nextContext(4);return e.\u0275\u0275resetView(d.removeScope(s,l))}),e.\u0275\u0275text(1),e.\u0275\u0275elementStart(2,"mat-icon",104),e.\u0275\u0275text(3,"cancel"),e.\u0275\u0275elementEnd()()}if(2&i){const t=n.$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",t," ")}}function Ll(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.oauth2.scope-required")," "))}function Pl(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.oauth2.user-name-attribute-name-required")," "))}function kl(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-option",55),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){const t=n.$implicit;e.\u0275\u0275property("value",t),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",t," ")}}function Rl(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.oauth2.email-attribute-key-required")," "))}function Ol(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.oauth2.email-attribute-key-max-length")," "))}function Bl(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-form-field",115)(1,"mat-label",44),e.\u0275\u0275text(2,"admin.oauth2.email-attribute-key"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(3,"input",116),e.\u0275\u0275template(4,Rl,3,3,"mat-error",33),e.\u0275\u0275template(5,Ol,3,3,"mat-error",33),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275nextContext(4).$implicit;e.\u0275\u0275advance(4),e.\u0275\u0275property("ngIf",t.get("mapperConfig.basic.emailAttributeKey").hasError("required")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.get("mapperConfig.basic.emailAttributeKey").hasError("maxlength"))}}function Vl(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.oauth2.first-name-attribute-key-max-length")," "))}function Ul(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.oauth2.last-name-attribute-key-max-length")," "))}function Gl(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-option",55),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){const t=n.$implicit;e.\u0275\u0275property("value",t),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",t," ")}}function jl(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.oauth2.tenant-name-pattern-required")," "))}function Wl(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.oauth2.tenant-name-pattern-max-length")," "))}function ql(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.oauth2.customer-name-pattern-max-length")," "))}function $l(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.oauth2.default-dashboard-name-max-length")," "))}function Hl(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"section",105),e.\u0275\u0275template(1,Bl,6,2,"mat-form-field",106),e.\u0275\u0275elementStart(2,"div",65)(3,"mat-form-field",47)(4,"mat-label",44),e.\u0275\u0275text(5,"admin.oauth2.first-name-attribute-key"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(6,"input",107),e.\u0275\u0275template(7,Vl,3,3,"mat-error",33),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(8,"mat-form-field",47)(9,"mat-label",44),e.\u0275\u0275text(10,"admin.oauth2.last-name-attribute-key"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(11,"input",108),e.\u0275\u0275template(12,Ul,3,3,"mat-error",33),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(13,"div",65)(14,"mat-form-field",47)(15,"mat-label",44),e.\u0275\u0275text(16,"admin.oauth2.tenant-name-strategy"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(17,"mat-select",109),e.\u0275\u0275template(18,Gl,2,2,"mat-option",46),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(19,"mat-form-field",110)(20,"mat-label",44),e.\u0275\u0275text(21,"admin.oauth2.tenant-name-pattern"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(22,"input",111),e.\u0275\u0275template(23,jl,3,3,"mat-error",33),e.\u0275\u0275template(24,Wl,3,3,"mat-error",33),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(25,"mat-form-field",47)(26,"mat-label",44),e.\u0275\u0275text(27,"admin.oauth2.customer-name-pattern"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(28,"input",112),e.\u0275\u0275template(29,ql,3,3,"mat-error",33),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(30,"div",65)(31,"mat-form-field",47)(32,"mat-label",44),e.\u0275\u0275text(33,"admin.oauth2.default-dashboard-name"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(34,"input",113),e.\u0275\u0275template(35,$l,3,3,"mat-error",33),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(36,"mat-checkbox",114),e.\u0275\u0275text(37),e.\u0275\u0275pipe(38,"translate"),e.\u0275\u0275elementEnd()()()),2&i){const t=e.\u0275\u0275nextContext(3).$implicit,a=e.\u0275\u0275nextContext(4);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.get("mapperConfig.type").value!==a.mapperConfigType.GITHUB),e.\u0275\u0275advance(6),e.\u0275\u0275property("ngIf",t.get("mapperConfig.basic.firstNameAttributeKey").hasError("maxlength")),e.\u0275\u0275advance(5),e.\u0275\u0275property("ngIf",t.get("mapperConfig.basic.lastNameAttributeKey").hasError("maxlength")),e.\u0275\u0275advance(6),e.\u0275\u0275property("ngForOf",a.tenantNameStrategies),e.\u0275\u0275advance(1),e.\u0275\u0275property("fxShow","CUSTOM"===t.get("mapperConfig.basic.tenantNameStrategy").value),e.\u0275\u0275advance(3),e.\u0275\u0275property("required","CUSTOM"===t.get("mapperConfig.basic.tenantNameStrategy").value),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.get("mapperConfig.basic.tenantNamePattern").hasError("required")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.get("mapperConfig.basic.tenantNamePattern").hasError("maxlength")),e.\u0275\u0275advance(5),e.\u0275\u0275property("ngIf",t.get("mapperConfig.basic.customerNamePattern").hasError("maxlength")),e.\u0275\u0275advance(6),e.\u0275\u0275property("ngIf",t.get("mapperConfig.basic.defaultDashboardName").hasError("maxlength")),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(38,11,"admin.oauth2.always-fullscreen")," ")}}function zl(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.oauth2.url-required")," "))}function Kl(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.oauth2.url-pattern")," "))}function Yl(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.oauth2.url-max-length")," "))}function Jl(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.oauth2.username-max-length")," "))}function Ql(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.oauth2.password-max-length")," "))}function Xl(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"section",117)(1,"mat-form-field",115)(2,"mat-label",44),e.\u0275\u0275text(3,"admin.oauth2.url"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(4,"input",118),e.\u0275\u0275template(5,zl,3,3,"mat-error",33),e.\u0275\u0275template(6,Kl,3,3,"mat-error",33),e.\u0275\u0275template(7,Yl,3,3,"mat-error",33),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(8,"div",65)(9,"mat-form-field",47)(10,"mat-label",44),e.\u0275\u0275text(11,"common.username"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(12,"input",119),e.\u0275\u0275template(13,Jl,3,3,"mat-error",33),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(14,"mat-form-field",47)(15,"mat-label",44),e.\u0275\u0275text(16,"common.password"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(17,"input",120)(18,"tb-toggle-password",121),e.\u0275\u0275template(19,Ql,3,3,"mat-error",33),e.\u0275\u0275elementEnd()()()),2&i){const t=e.\u0275\u0275nextContext(3).$implicit;e.\u0275\u0275advance(5),e.\u0275\u0275property("ngIf",t.get("mapperConfig.custom.url").hasError("required")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.get("mapperConfig.custom.url").hasError("pattern")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.get("mapperConfig.custom.url").hasError("maxlength")),e.\u0275\u0275advance(6),e.\u0275\u0275property("ngIf",t.get("mapperConfig.custom.username").hasError("maxlength")),e.\u0275\u0275advance(6),e.\u0275\u0275property("ngIf",t.get("mapperConfig.custom.password").hasError("maxlength"))}}function Zl(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"mat-tab-group",26)(1,"mat-tab",27),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementStart(3,"div",76)(4,"mat-form-field",47)(5,"mat-label",44),e.\u0275\u0275text(6,"admin.oauth2.access-token-uri"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(7,"input",77),e.\u0275\u0275template(8,vl,3,0,"button",78),e.\u0275\u0275template(9,_l,3,3,"mat-error",33),e.\u0275\u0275template(10,xl,3,3,"mat-error",33),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(11,"mat-form-field",47)(12,"mat-label",44),e.\u0275\u0275text(13,"admin.oauth2.authorization-uri"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(14,"input",79),e.\u0275\u0275template(15,Cl,3,0,"button",78),e.\u0275\u0275template(16,Tl,3,3,"mat-error",33),e.\u0275\u0275template(17,Sl,3,3,"mat-error",33),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(18,"div",65)(19,"mat-form-field",47)(20,"mat-label",44),e.\u0275\u0275text(21,"admin.oauth2.jwk-set-uri"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(22,"input",80),e.\u0275\u0275template(23,Il,3,0,"button",81),e.\u0275\u0275template(24,wl,3,3,"mat-error",33),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(25,"mat-form-field",47)(26,"mat-label",44),e.\u0275\u0275text(27,"admin.oauth2.user-info-uri"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(28,"input",82),e.\u0275\u0275template(29,El,3,0,"button",78),e.\u0275\u0275template(30,Ml,3,3,"mat-error",33),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(31,"mat-form-field",47)(32,"mat-label",44),e.\u0275\u0275text(33,"admin.oauth2.client-authentication-method"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(34,"mat-select",83),e.\u0275\u0275template(35,Dl,3,4,"mat-option",46),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(36,Nl,11,4,"div",84),e.\u0275\u0275elementStart(37,"section",85)(38,"div",86)(39,"mat-checkbox",87),e.\u0275\u0275text(40),e.\u0275\u0275pipe(41,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(42,"mat-checkbox",88),e.\u0275\u0275text(43),e.\u0275\u0275pipe(44,"translate"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(45,"mat-form-field",47)(46,"mat-label",44),e.\u0275\u0275text(47,"admin.oauth2.scope"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(48,"mat-chip-grid",null,89),e.\u0275\u0275template(50,Fl,4,1,"mat-chip-row",90),e.\u0275\u0275elementStart(51,"input",91),e.\u0275\u0275listener("matChipInputTokenEnd",function(o){e.\u0275\u0275restoreView(t);const s=e.\u0275\u0275nextContext(2).$implicit,l=e.\u0275\u0275nextContext(4);return e.\u0275\u0275resetView(l.addScope(o,s))}),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(52,Ll,3,3,"mat-error",33),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(53,"tb-error",92),e.\u0275\u0275pipe(54,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(55,"mat-tab",27),e.\u0275\u0275pipe(56,"translate"),e.\u0275\u0275elementStart(57,"mat-form-field",93)(58,"mat-label",44),e.\u0275\u0275text(59,"admin.oauth2.user-name-attribute-name"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(60,"input",94),e.\u0275\u0275template(61,Pl,3,3,"mat-error",33),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(62,"section",85)(63,"mat-form-field",47)(64,"mat-label",44),e.\u0275\u0275text(65,"admin.oauth2.type"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(66,"mat-select",95),e.\u0275\u0275template(67,kl,2,2,"mat-option",46),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(68,Hl,39,13,"section",96),e.\u0275\u0275template(69,Xl,20,5,"section",97),e.\u0275\u0275elementEnd()()()}if(2&i){const t=e.\u0275\u0275reference(49),a=e.\u0275\u0275nextContext(2).$implicit,o=e.\u0275\u0275nextContext(4);e.\u0275\u0275advance(1),e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(2,26,"admin.oauth2.general")),e.\u0275\u0275advance(7),e.\u0275\u0275property("ngIf",!o.isCustomProvider(a)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",a.get("accessTokenUri").hasError("required")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",a.get("accessTokenUri").hasError("pattern")),e.\u0275\u0275advance(5),e.\u0275\u0275property("ngIf",!o.isCustomProvider(a)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",a.get("authorizationUri").hasError("required")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",a.get("authorizationUri").hasError("pattern")),e.\u0275\u0275advance(6),e.\u0275\u0275property("ngIf",!o.isCustomProvider(a)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",a.get("jwkSetUri").hasError("pattern")),e.\u0275\u0275advance(5),e.\u0275\u0275property("ngIf",!o.isCustomProvider(a)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",a.get("userInfoUri").hasError("pattern")),e.\u0275\u0275advance(5),e.\u0275\u0275property("ngForOf",o.clientAuthenticationMethods),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",o.isCustomProvider(a)),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(41,28,"admin.oauth2.allow-user-creation")," "),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(44,30,"admin.oauth2.activate-user")," "),e.\u0275\u0275advance(7),e.\u0275\u0275property("ngForOf",a.get("scope").value)("ngForTrackBy",o.trackByParams),e.\u0275\u0275advance(1),e.\u0275\u0275property("matChipInputFor",t)("matChipInputSeparatorKeyCodes",o.separatorKeysCodes),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",a.get("scope").hasError("required")),e.\u0275\u0275advance(1),e.\u0275\u0275property("error",a.get("scope").hasError("required")?e.\u0275\u0275pipeBind1(54,32,"admin.oauth2.scope-required"):""),e.\u0275\u0275advance(2),e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(56,34,"admin.oauth2.mapper")),e.\u0275\u0275advance(6),e.\u0275\u0275property("ngIf",a.get("userNameAttributeName").hasError("required")),e.\u0275\u0275advance(6),e.\u0275\u0275property("ngForOf",o.mapperConfigTypes),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",a.get("mapperConfig.type").value!==o.mapperConfigType.CUSTOM),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",a.get("mapperConfig.type").value===o.mapperConfigType.CUSTOM)}}function ed(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"section",21)(1,"div",65)(2,"section",66)(3,"mat-form-field",47)(4,"mat-label",44),e.\u0275\u0275text(5,"admin.oauth2.login-provider"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(6,"mat-select",67),e.\u0275\u0275template(7,ml,2,2,"mat-option",46),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(8,ul,1,1,"div",68),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(9,"mat-form-field",69)(10,"mat-label",44),e.\u0275\u0275text(11,"admin.oauth2.allowed-platforms"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(12,"mat-select",70),e.\u0275\u0275pipe(13,"translate"),e.\u0275\u0275template(14,gl,3,4,"mat-option",46),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(15,"div",65)(16,"mat-form-field",47)(17,"mat-label",44),e.\u0275\u0275text(18,"admin.oauth2.client-id"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(19,"input",71),e.\u0275\u0275template(20,fl,3,3,"mat-error",33),e.\u0275\u0275template(21,hl,3,3,"mat-error",33),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(22,"mat-form-field",47)(23,"mat-label",44),e.\u0275\u0275text(24,"admin.oauth2.client-secret"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(25,"input",72),e.\u0275\u0275template(26,bl,3,3,"mat-error",33),e.\u0275\u0275template(27,yl,3,3,"mat-error",33),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(28,"mat-expansion-panel",73)(29,"mat-expansion-panel-header",74)(30,"mat-panel-description",23),e.\u0275\u0275text(31),e.\u0275\u0275pipe(32,"translate"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(33,Zl,70,36,"ng-template",25),e.\u0275\u0275elementEnd()()),2&i){const t=e.\u0275\u0275nextContext(),a=t.index,o=t.$implicit,s=e.\u0275\u0275nextContext(4);e.\u0275\u0275property("formGroupName",a),e.\u0275\u0275advance(7),e.\u0275\u0275property("ngForOf",s.templateProvider),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!s.isCustomProvider(o)),e.\u0275\u0275advance(4),e.\u0275\u0275propertyInterpolate("placeholder",e.\u0275\u0275pipeBind1(13,13,"admin.oauth2.all-platforms")),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",s.platformTypes),e.\u0275\u0275advance(6),e.\u0275\u0275property("ngIf",o.get("clientId").hasError("required")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",o.get("clientId").hasError("maxlength")),e.\u0275\u0275advance(5),e.\u0275\u0275property("ngIf",o.get("clientSecret").hasError("required")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",o.get("clientSecret").hasError("maxlength")),e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",s.isCustomProvider(o))("expanded",s.isCustomProvider(o)),e.\u0275\u0275advance(1),e.\u0275\u0275property("fxHide",s.isCustomProvider(o)),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(32,15,"admin.oauth2.custom-setting")," ")}}function td(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"mat-expansion-panel",63)(1,"mat-expansion-panel-header")(2,"mat-panel-title",22),e.\u0275\u0275text(3),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"mat-panel-description",23)(5,"button",64),e.\u0275\u0275listener("click",function(o){const l=e.\u0275\u0275restoreView(t).index,d=e.\u0275\u0275nextContext(2).$implicit,m=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(m.deleteRegistration(o,d,l))}),e.\u0275\u0275pipe(6,"translate"),e.\u0275\u0275elementStart(7,"mat-icon"),e.\u0275\u0275text(8,"delete"),e.\u0275\u0275elementEnd()()()(),e.\u0275\u0275template(9,ed,34,17,"ng-template",25),e.\u0275\u0275elementEnd()}if(2&i){const t=n.$implicit,a=e.\u0275\u0275nextContext(2).$implicit,o=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" ",o.getProviderName(t)," "),e.\u0275\u0275advance(2),e.\u0275\u0275propertyInterpolate("matTooltip",e.\u0275\u0275pipeBind1(6,3,"admin.oauth2.delete-provider")),e.\u0275\u0275property("disabled",o.clientRegistrations(a).controls.length<2)}}function nd(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"mat-tab-group",26)(1,"mat-tab",27),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementContainerStart(3,28),e.\u0275\u0275element(4,"div",6),e.\u0275\u0275template(5,sl,30,15,"section",29),e.\u0275\u0275elementStart(6,"div",30)(7,"button",31),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext().$implicit,s=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(s.addDomainInfo(o))}),e.\u0275\u0275pipe(8,"async"),e.\u0275\u0275text(9),e.\u0275\u0275pipe(10,"translate"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(11,"mat-tab",27),e.\u0275\u0275pipe(12,"translate"),e.\u0275\u0275elementContainerStart(13,32),e.\u0275\u0275element(14,"div",6),e.\u0275\u0275template(15,ll,3,0,"div",33),e.\u0275\u0275template(16,pl,25,13,"section",34),e.\u0275\u0275elementStart(17,"div",30)(18,"button",31),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext().$implicit,s=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(s.addMobileInfo(o))}),e.\u0275\u0275pipe(19,"async"),e.\u0275\u0275text(20),e.\u0275\u0275pipe(21,"translate"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(22,"div",35),e.\u0275\u0275text(23,"admin.oauth2.providers"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerStart(24,36),e.\u0275\u0275elementStart(25,"div",18),e.\u0275\u0275template(26,td,10,5,"mat-expansion-panel",37),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275elementStart(27,"div",11)(28,"button",31),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext().$implicit,s=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(s.addRegistration(o))}),e.\u0275\u0275pipe(29,"async"),e.\u0275\u0275text(30),e.\u0275\u0275pipe(31,"translate"),e.\u0275\u0275elementEnd()()}if(2&i){const t=e.\u0275\u0275nextContext().$implicit,a=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(2,15,"admin.oauth2.domains")),e.\u0275\u0275advance(4),e.\u0275\u0275property("ngForOf",a.domainInfos(t).controls)("ngForTrackBy",a.trackByItem),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(8,17,a.isLoading$)),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(10,19,"admin.oauth2.add-domain")," "),e.\u0275\u0275advance(2),e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(12,21,"admin.oauth2.mobile-apps")),e.\u0275\u0275advance(4),e.\u0275\u0275property("ngIf",0===a.mobileInfos(t).length),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",a.mobileInfos(t).controls)("ngForTrackBy",a.trackByItem),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(19,23,a.isLoading$)),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(21,25,"admin.oauth2.add-mobile-app")," "),e.\u0275\u0275advance(6),e.\u0275\u0275property("ngForOf",a.clientRegistrations(t).controls)("ngForTrackBy",a.trackByItem),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(29,27,a.isLoading$)),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(31,29,"admin.oauth2.add-provider")," ")}}function id(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"mat-expansion-panel",21)(2,"mat-expansion-panel-header")(3,"mat-panel-title",22),e.\u0275\u0275text(4),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"mat-panel-description",23)(6,"button",24),e.\u0275\u0275listener("click",function(o){const l=e.\u0275\u0275restoreView(t).index,d=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(d.deleteOAuth2ParamsInfo(o,l))}),e.\u0275\u0275pipe(7,"translate"),e.\u0275\u0275elementStart(8,"mat-icon"),e.\u0275\u0275text(9,"delete"),e.\u0275\u0275elementEnd()()()(),e.\u0275\u0275template(10,nd,32,31,"ng-template",25),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()}if(2&i){const t=n.$implicit,a=n.index,o=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275property("formGroupName",a),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" ",o.domainListTittle(t)," "),e.\u0275\u0275advance(2),e.\u0275\u0275propertyInterpolate("matTooltip",e.\u0275\u0275pipeBind1(7,3,"action.delete"))}}function ad(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"section",16),e.\u0275\u0275elementContainerStart(1,17),e.\u0275\u0275elementStart(2,"div",18)(3,"mat-accordion",19),e.\u0275\u0275template(4,id,11,5,"ng-container",20),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(4),e.\u0275\u0275property("ngForOf",t.oauth2ParamsInfos.controls)("ngForTrackBy",t.trackByItem)}}function od(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",122),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.addOAuth2ParamsInfo())}),e.\u0275\u0275pipe(1,"async"),e.\u0275\u0275elementStart(2,"mat-icon"),e.\u0275\u0275text(3,"add"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"span",44),e.\u0275\u0275text(5,"action.add"),e.\u0275\u0275elementEnd()()}if(2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(1,1,t.isLoading$))}}class ot extends se.I{constructor(n,t,a,o,s,l,d){super(n),this.store=n,this.route=t,this.oauth2Service=a,this.fb=o,this.dialogService=s,this.translate=l,this.window=d,this.URL_REGEXP=/^[A-Za-z][A-Za-z\d.+-]*:\/*(?:\w+(?::\w+)?@)?[^\s/]+(?::\d+)?(?:\/[\w#!:.,?+=&%@\-/]*)?$/,this.DOMAIN_AND_PORT_REGEXP=/^(?:\w+(?::\w+)?@)?[^\s/]+(?::\d+)?$/,this.subscriptions=[],this.templates=new Map,this.defaultProvider={additionalInfo:{providerName:"Custom"},clientAuthenticationMethod:$.sq.POST,userNameAttributeName:"email",mapperConfig:{allowUserCreation:!0,activateUser:!1,type:$.P.BASIC,basic:{emailAttributeKey:"email",tenantNameStrategy:$.eK.DOMAIN,alwaysFullScreen:!1}}},this.separatorKeysCodes=[Fn.ENTER,Fn.COMMA],this.clientAuthenticationMethods=Object.keys($.sq),this.mapperConfigType=$.P,this.mapperConfigTypes=Object.keys($.P),this.tenantNameStrategies=Object.keys($.eK),this.protocols=Object.values($.t$),this.domainSchemaTranslations=$.$Z,this.platformTypes=Object.values($.zh),this.platformTypeTranslations=$.X2,this.templateProvider=["Custom"],this.loginProcessingUrl=this.route.snapshot.data.loginProcessingUrl}get oauth2ParamsInfos(){return this.oauth2SettingsForm.get("oauth2ParamsInfos")}static validateScope(n){const t=n.value;return t&&t.length?null:{required:!0}}ngOnInit(){this.buildOAuth2SettingsForm(),(0,xe.D)([this.oauth2Service.getOAuth2Template(),this.oauth2Service.getOAuth2Settings()]).subscribe(([n,t])=>{this.initTemplates(n),this.oauth2Info=t,this.initOAuth2Settings(this.oauth2Info)})}ngOnDestroy(){super.ngOnDestroy(),this.subscriptions.forEach(n=>{n.unsubscribe()})}initTemplates(n){n.map(t=>{delete t.additionalInfo,this.templates.set(t.name,t)}),this.templateProvider.push(...Array.from(this.templates.keys())),this.templateProvider.sort()}formBasicGroup(n){let t;t=n?.tenantNamePattern?n.tenantNamePattern:{value:null,disabled:!0};const a=this.fb.group({emailAttributeKey:[n?.emailAttributeKey?n.emailAttributeKey:"email",[r.Validators.required,r.Validators.maxLength(31)]],firstNameAttributeKey:[n?.firstNameAttributeKey?n.firstNameAttributeKey:"",r.Validators.maxLength(31)],lastNameAttributeKey:[n?.lastNameAttributeKey?n.lastNameAttributeKey:"",r.Validators.maxLength(31)],tenantNameStrategy:[n?.tenantNameStrategy?n.tenantNameStrategy:$.eK.DOMAIN],tenantNamePattern:[t,[r.Validators.required,r.Validators.maxLength(255)]],customerNamePattern:[n?.customerNamePattern?n.customerNamePattern:null,r.Validators.maxLength(255)],defaultDashboardName:[n?.defaultDashboardName?n.defaultDashboardName:null,r.Validators.maxLength(255)],alwaysFullScreen:[!!(0,T.nu)(n?.alwaysFullScreen)&&n.alwaysFullScreen]});return this.subscriptions.push(a.get("tenantNameStrategy").valueChanges.subscribe(o=>{"CUSTOM"===o?a.get("tenantNamePattern").enable():a.get("tenantNamePattern").disable()})),a}formCustomGroup(n){return this.fb.group({url:[n?.url?n.url:null,[r.Validators.required,r.Validators.pattern(this.URL_REGEXP),r.Validators.maxLength(255)]],username:[n?.username?n.username:null,r.Validators.maxLength(255)],password:[n?.password?n.password:null,r.Validators.maxLength(255)]})}buildOAuth2SettingsForm(){this.oauth2SettingsForm=this.fb.group({oauth2ParamsInfos:this.fb.array([]),enabled:[!1]})}initOAuth2Settings(n){n&&(this.oauth2SettingsForm.patchValue({enabled:n.enabled},{emitEvent:!1}),n.oauth2ParamsInfos.forEach(t=>{this.oauth2ParamsInfos.push(this.buildOAuth2ParamsInfoForm(t))}))}uniqueDomainValidator(n){if(n.parent?.value){const t=n.value.name,a=n.parent.getRawValue().filter(o=>o.name===t).map(o=>o.scheme);if(a.length>1&&a.indexOf($.t$.MIXED)>-1||new Set(a).size!==a.length)return{unique:!0}}return null}uniquePkgNameValidator(n){if(n.parent?.value){const t=n.value.pkgName;if(n.parent.getRawValue().filter(o=>o.pkgName===t).length>1)return{unique:!0}}return null}domainListTittle(n){const t=n.get("domainInfos").value;if(t.length){const a=new Set;return t.forEach(o=>{a.add(o.name)}),Array.from(a).join(", ")}return this.translate.instant("admin.oauth2.new-domain")}buildOAuth2ParamsInfoForm(n){const t=this.fb.group({domainInfos:this.fb.array([],r.Validators.required),mobileInfos:this.fb.array([]),clientRegistrations:this.fb.array([],r.Validators.required)});return n?(n.domainInfos.forEach(a=>{this.domainInfos(t).push(this.buildDomainInfoForm(a))}),n.mobileInfos.forEach(a=>{this.mobileInfos(t).push(this.buildMobileInfoForm(a))}),n.clientRegistrations.forEach(a=>{this.clientRegistrations(t).push(this.buildRegistrationForm(a))})):(this.clientRegistrations(t).push(this.buildRegistrationForm()),this.domainInfos(t).push(this.buildDomainInfoForm())),t}buildDomainInfoForm(n){return this.fb.group({name:[n?n.name:this.window.location.hostname,[r.Validators.required,r.Validators.maxLength(255),r.Validators.pattern(this.DOMAIN_AND_PORT_REGEXP)]],scheme:[n?.scheme?n.scheme:$.t$.HTTPS,r.Validators.required]},{validators:this.uniqueDomainValidator})}buildMobileInfoForm(n){return this.fb.group({pkgName:[n?.pkgName,[r.Validators.required]],appSecret:[n?.appSecret,[r.Validators.required,r.Validators.minLength(16),r.Validators.maxLength(2048),r.Validators.pattern(/^[A-Za-z0-9]+$/)]]},{validators:this.uniquePkgNameValidator})}buildRegistrationForm(n){let t=null;(0,T.nu)(n?.additionalInfo)&&(t=n.additionalInfo,-1===this.templateProvider.indexOf(t.providerName)&&(t.providerName="Custom"));let a="Custom";this.templateProvider.indexOf("Google")&&(a="Google");const o=this.fb.group({additionalInfo:this.fb.group({providerName:[t?.providerName?t?.providerName:a,r.Validators.required]}),platforms:[n?.platforms?n.platforms:[]],loginButtonLabel:[n?.loginButtonLabel?n.loginButtonLabel:null,r.Validators.required],loginButtonIcon:[n?.loginButtonIcon?n.loginButtonIcon:null],clientId:[n?.clientId?n.clientId:"",[r.Validators.required,r.Validators.maxLength(255)]],clientSecret:[n?.clientSecret?n.clientSecret:"",[r.Validators.required,r.Validators.maxLength(2048)]],accessTokenUri:[n?.accessTokenUri?n.accessTokenUri:"",[r.Validators.required,r.Validators.pattern(this.URL_REGEXP)]],authorizationUri:[n?.authorizationUri?n.authorizationUri:"",[r.Validators.required,r.Validators.pattern(this.URL_REGEXP)]],scope:this.fb.array(n?.scope?n.scope:[],ot.validateScope),jwkSetUri:[n?.jwkSetUri?n.jwkSetUri:"",r.Validators.pattern(this.URL_REGEXP)],userInfoUri:[n?.userInfoUri?n.userInfoUri:"",[r.Validators.pattern(this.URL_REGEXP)]],clientAuthenticationMethod:[n?.clientAuthenticationMethod?n.clientAuthenticationMethod:$.sq.POST,r.Validators.required],userNameAttributeName:[n?.userNameAttributeName?n.userNameAttributeName:"email",r.Validators.required],mapperConfig:this.fb.group({allowUserCreation:[!(0,T.nu)(n?.mapperConfig?.allowUserCreation)||n.mapperConfig.allowUserCreation],activateUser:[!!(0,T.nu)(n?.mapperConfig?.activateUser)&&n.mapperConfig.activateUser],type:[n?.mapperConfig?.type?n.mapperConfig.type:$.P.BASIC,r.Validators.required]})});return n?this.changeMapperConfigType(o,n.mapperConfig.type,n.mapperConfig):(this.changeMapperConfigType(o,$.P.BASIC),this.setProviderDefaultValue(a,o)),this.subscriptions.push(o.get("mapperConfig.type").valueChanges.subscribe(s=>{this.changeMapperConfigType(o,s)})),this.subscriptions.push(o.get("additionalInfo.providerName").valueChanges.subscribe(s=>{o.get("scope").clear(),this.setProviderDefaultValue(s,o)})),o}setProviderDefaultValue(n,t){if("Custom"===n)t.reset(this.defaultProvider,{emitEvent:!1}),t.get("accessTokenUri").enable(),t.get("authorizationUri").enable(),t.get("jwkSetUri").enable(),t.get("userInfoUri").enable();else{const a=this.templates.get(n);a.clientId="",a.clientSecret="",a.scope.forEach(()=>{t.get("scope").push(this.fb.control(""))}),t.get("accessTokenUri").disable(),t.get("authorizationUri").disable(),t.get("jwkSetUri").disable(),t.get("userInfoUri").disable(),t.patchValue(a)}}changeMapperConfigType(n,t,a){const o=n.get("mapperConfig");t===$.P.CUSTOM?(o.removeControl("basic"),o.addControl("custom",this.formCustomGroup(a?.custom))):(o.removeControl("custom"),o.get("basic")||o.addControl("basic",this.formBasicGroup(a?.basic)),t===$.P.GITHUB?(o.get("basic.emailAttributeKey").disable(),o.get("basic.emailAttributeKey").patchValue(null,{emitEvent:!1})):o.get("basic.emailAttributeKey").enable())}save(){const n=this.oauth2SettingsForm.getRawValue();this.oauth2Service.saveOAuth2Settings(n).subscribe(t=>{this.oauth2Info=t,this.oauth2SettingsForm.patchValue(this.oauth2SettingsForm,{emitEvent:!1}),this.oauth2SettingsForm.markAsUntouched(),this.oauth2SettingsForm.markAsPristine()})}confirmForm(){return this.oauth2SettingsForm}addScope(n,t){const a=n.chipInput.inputElement,o=n.value,s=t.get("scope");""!==o.trim()&&(s.push(this.fb.control(o.trim())),s.markAsDirty()),a&&(a.value="")}removeScope(n,t){const a=t.get("scope");a.removeAt(n),a.markAsTouched(),a.markAsDirty()}addOAuth2ParamsInfo(){this.oauth2ParamsInfos.push(this.buildOAuth2ParamsInfoForm())}deleteOAuth2ParamsInfo(n,t){n&&(n.stopPropagation(),n.preventDefault());const a=this.domainListTittle(this.oauth2ParamsInfos.at(t));this.dialogService.confirm(this.translate.instant("admin.oauth2.delete-domain-title",{domainName:a||""}),this.translate.instant("admin.oauth2.delete-domain-text"),null,this.translate.instant("action.delete")).subscribe(o=>{o&&(this.oauth2ParamsInfos.removeAt(t),this.oauth2ParamsInfos.markAsTouched(),this.oauth2ParamsInfos.markAsDirty())})}clientRegistrations(n){return n.get("clientRegistrations")}domainInfos(n){return n.get("domainInfos")}mobileInfos(n){return n.get("mobileInfos")}addRegistration(n){this.clientRegistrations(n).push(this.buildRegistrationForm())}deleteRegistration(n,t,a){n&&(n.stopPropagation(),n.preventDefault());const o=this.clientRegistrations(t).at(a).get("additionalInfo.providerName").value;this.dialogService.confirm(this.translate.instant("admin.oauth2.delete-registration-title",{name:o||""}),this.translate.instant("admin.oauth2.delete-registration-text"),null,this.translate.instant("action.delete")).subscribe(s=>{s&&(this.clientRegistrations(t).removeAt(a),this.clientRegistrations(t).markAsTouched(),this.clientRegistrations(t).markAsDirty())})}toggleEditMode(n,t){n.get(t).disabled?n.get(t).enable():n.get(t).disable()}getProviderName(n){return n.get("additionalInfo.providerName").value}isCustomProvider(n){return"Custom"===this.getProviderName(n)}getHelpLink(n){const t=n.get("additionalInfo.providerName").value;return null===t||"Custom"===t?"":this.templates.get(t).helpLink}addDomainInfo(n){this.domainInfos(n).push(this.buildDomainInfoForm({name:"",scheme:$.t$.HTTPS}))}removeDomainInfo(n,t,a){n&&(n.stopPropagation(),n.preventDefault()),this.domainInfos(t).removeAt(a),this.domainInfos(t).markAsTouched(),this.domainInfos(t).markAsDirty()}addMobileInfo(n){this.mobileInfos(n).push(this.buildMobileInfoForm({pkgName:"",appSecret:(0,T.PX)(24)}))}removeMobileInfo(n,t,a){n&&(n.stopPropagation(),n.preventDefault()),this.mobileInfos(t).removeAt(a),this.mobileInfos(t).markAsTouched(),this.mobileInfos(t).markAsDirty()}redirectURI(n,t){const a=n.value;if(""!==a.name){let o;return o=(0,T.$K)(t)?t.toLowerCase():a.scheme===$.t$.MIXED?$.t$.HTTPS.toLowerCase():a.scheme.toLowerCase(),`${o}://${a.name}${this.loginProcessingUrl}`}return""}redirectURIMixed(n){return this.redirectURI(n,$.t$.HTTP)}trackByParams(n){return n}trackByItem(n,t){return t}}ot.\u0275fac=function(n){return new(n||ot)(e.\u0275\u0275directiveInject(x.Store),e.\u0275\u0275directiveInject(b.ActivatedRoute),e.\u0275\u0275directiveInject(ao.G),e.\u0275\u0275directiveInject(r.UntypedFormBuilder),e.\u0275\u0275directiveInject(pe.x),e.\u0275\u0275directiveInject(g.TranslateService),e.\u0275\u0275directiveInject(to.m9))},ot.\u0275cmp=e.\u0275\u0275defineComponent({type:ot,selectors:[["tb-oauth2-settings"]],features:[e.\u0275\u0275InheritDefinitionFeature],decls:26,vars:21,consts:[["appearance","outlined",1,"settings-card"],["translate","",1,"mat-headline-5"],["fxFlex",""],["tb-help","oauth2Settings"],["color","warn","mode","indeterminate",4,"ngIf"],["style","height: 4px;",4,"ngIf"],[2,"padding-top","16px"],[3,"formGroup","ngSubmit"],[3,"disabled"],["formControlName","enabled"],["style","margin-top: 1em;",4,"ngIf"],["fxLayout","row","fxLayoutAlign","end center","fxLayoutGap","8px"],["type","button","mat-raised-button","","color","primary",3,"disabled","click",4,"ngIf"],["mat-button","","mat-raised-button","","color","primary","type","submit",3,"disabled"],["color","warn","mode","indeterminate"],[2,"height","4px"],[2,"margin-top","1em"],["formArrayName","oauth2ParamsInfos"],[1,"container"],["multi",""],[4,"ngFor","ngForOf","ngForTrackBy"],[3,"formGroupName"],["fxLayoutAlign","start center"],["fxLayoutAlign","end center"],["mat-icon-button","","type","button","matTooltipPosition","above",3,"matTooltip","click"],["matExpansionPanelContent",""],["dynamicHeight",""],[3,"label"],["formArrayName","domainInfos"],["class","domains-list",4,"ngFor","ngForOf","ngForTrackBy"],["fxLayout","row","fxLayoutAlign","end center",2,"margin-bottom","1.25em"],["mat-button","","mat-raised-button","","color","primary","type","button",3,"disabled","click"],["formArrayName","mobileInfos"],[4,"ngIf"],["class","apps-list",4,"ngFor","ngForOf","ngForTrackBy"],["translate","",1,"mat-h3"],["formArrayName","clientRegistrations"],["class","registration-card mat-elevation-z0",4,"ngFor","ngForOf","ngForTrackBy"],[1,"domains-list"],["fxLayout","row","fxLayoutGap","8px",3,"formGroupName"],["fxFlex","","fxLayout","row","fxLayout.xs","column","fxLayoutGap","8px"],["fxLayout","column","fxFlex.sm","60","fxFlex.gt-sm","50"],["fxLayout","row","fxLayout.xs","column","fxLayout.md","column","fxLayoutGap","8px","fxLayoutGap.md","0px"],["fxFlex","30","fxFlex.md","","fxFlex.xs","",1,"mat-block"],["translate",""],["formControlName","scheme"],[3,"value",4,"ngFor","ngForOf"],["fxFlex","",1,"mat-block"],["matInput","","formControlName","name","required",""],["fxFlex","","fxLayout","column"],["matInput","","readonly","",3,"value"],["matSuffix","","miniButton","false","color","primary","tooltipPosition","above","icon","mdi:clipboard-arrow-left",3,"copyText","tooltipText"],["fxFlex","","class","mat-block",4,"ngIf"],["fxLayout","column","fxLayoutAlign","center start"],["type","button","mat-icon-button","","color","primary","matTooltipPosition","above",3,"disabled","matTooltip","click"],[3,"value"],["fxLayoutAlign","center center","translate","",1,"tb-prompt"],[1,"apps-list"],["fxFlex","","floatLabel","always",1,"mat-block"],["matInput","","formControlName","pkgName","required","",3,"placeholder"],["fxFlex","","fxLayout","row"],["matInput","","formControlName","appSecret","rows","1","required",""],["type","button","mat-icon-button","","color","primary","matTooltipPosition","above",3,"matTooltip","click"],[1,"registration-card","mat-elevation-z0"],["mat-icon-button","","type","button","matTooltipPosition","above",3,"disabled","matTooltip","click"],["fxLayout","row","fxLayout.xs","column","fxLayoutGap.gt-xs","8px"],["fxFlex","","formGroupName","additionalInfo","fxLayout","row"],["formControlName","providerName"],[3,"tb-help",4,"ngIf"],["floatLabel","always","fxFlex","",1,"mat-block"],["formControlName","platforms","multiple","",3,"placeholder"],["matInput","","formControlName","clientId","required",""],["matInput","","formControlName","clientSecret","required",""],[1,"mat-elevation-z0","custom-settings",3,"disabled","expanded"],[3,"fxHide"],[3,"tb-help"],["fxLayout","row","fxLayout.xs","column","fxLayoutGap.gt-xs","8px",2,"margin-top","16px"],["matInput","","formControlName","accessTokenUri","required",""],["mat-icon-button","","matSuffix","","type","button",3,"click",4,"ngIf"],["matInput","","formControlName","authorizationUri","required",""],["matInput","","formControlName","jwkSetUri"],["mat-icon-button","","matSuffix","","type","button","aria-label","Clear",3,"click",4,"ngIf"],["matInput","","formControlName","userInfoUri"],["formControlName","clientAuthenticationMethod"],["fxLayout","row","fxLayout.xs","column","fxLayoutGap.gt-xs","8px",4,"ngIf"],["formGroupName","mapperConfig"],["fxLayout","column","fxLayoutGap","8px",2,"margin-bottom","8px"],["formControlName","allowUserCreation"],["formControlName","activateUser"],["scopeList",""],["removable","",3,"removed",4,"ngFor","ngForOf","ngForTrackBy"],["matChipInputAddOnBlur","",3,"matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputTokenEnd"],[2,"display","block","margin-top","-24px",3,"error"],[1,"mat-block",2,"margin-top","16px"],["matInput","","formControlName","userNameAttributeName","required",""],["formControlName","type"],["formGroupName","basic",4,"ngIf"],["formGroupName","custom",4,"ngIf"],["mat-icon-button","","matSuffix","","type","button",3,"click"],[1,"material-icons"],["mat-icon-button","","matSuffix","","type","button","aria-label","Clear",3,"click"],["matInput","","formControlName","loginButtonLabel","required","",3,"placeholder"],["matInput","","formControlName","loginButtonIcon"],["removable","",3,"removed"],["matChipRemove",""],["formGroupName","basic"],["class","mat-block",4,"ngIf"],["matInput","","formControlName","firstNameAttributeKey"],["matInput","","formControlName","lastNameAttributeKey"],["formControlName","tenantNameStrategy"],["fxFlex","",1,"mat-block",3,"fxShow"],["matInput","","formControlName","tenantNamePattern",3,"required"],["matInput","","formControlName","customerNamePattern"],["matInput","","formControlName","defaultDashboardName"],["fxFlex","","formControlName","alwaysFullScreen",1,"checkbox-row"],[1,"mat-block"],["matInput","","formControlName","emailAttributeKey","required",""],["formGroupName","custom"],["matInput","","formControlName","url","required",""],["matInput","","formControlName","username","autocomplete","new-username"],["matInput","","type","password","formControlName","password","autocomplete","new-password"],["matSuffix",""],["type","button","mat-raised-button","","color","primary",3,"disabled","click"]],template:function(n,t){1&n&&(e.\u0275\u0275elementStart(0,"div")(1,"mat-card",0)(2,"mat-card-header")(3,"mat-card-title")(4,"span",1),e.\u0275\u0275text(5,"admin.oauth2.oauth2"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275element(6,"span",2)(7,"div",3),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(8,el,1,0,"mat-progress-bar",4),e.\u0275\u0275pipe(9,"async"),e.\u0275\u0275template(10,tl,1,0,"div",5),e.\u0275\u0275pipe(11,"async"),e.\u0275\u0275elementStart(12,"mat-card-content",6)(13,"form",7),e.\u0275\u0275listener("ngSubmit",function(){return t.save()}),e.\u0275\u0275elementStart(14,"fieldset",8),e.\u0275\u0275pipe(15,"async"),e.\u0275\u0275elementStart(16,"mat-checkbox",9),e.\u0275\u0275text(17),e.\u0275\u0275pipe(18,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(19,ad,5,2,"section",10),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(20,"div",11),e.\u0275\u0275template(21,od,6,3,"button",12),e.\u0275\u0275elementStart(22,"button",13),e.\u0275\u0275pipe(23,"async"),e.\u0275\u0275text(24),e.\u0275\u0275pipe(25,"translate"),e.\u0275\u0275elementEnd()()()()()()),2&n&&(e.\u0275\u0275advance(8),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(9,9,t.isLoading$)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!e.\u0275\u0275pipeBind1(11,11,t.isLoading$)),e.\u0275\u0275advance(3),e.\u0275\u0275property("formGroup",t.oauth2SettingsForm),e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(15,13,t.isLoading$)),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(18,15,"admin.oauth2.enable")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",t.oauth2SettingsForm.get("enabled").value),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",t.oauth2SettingsForm.get("enabled").value),e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(23,17,t.isLoading$)||t.oauth2SettingsForm.invalid||!t.oauth2SettingsForm.dirty),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(25,19,"action.save")," "))},dependencies:[p.NgForOf,p.NgIf,De.HelpComponent,Zs.TbErrorComponent,S.MatButton,S.MatIconButton,fe.MatCheckbox,F.MatIcon,A.MatCard,A.MatCardContent,A.MatCardHeader,A.MatCardTitle,z.MatProgressBar,O.MatInput,_.MatFormField,_.MatLabel,_.MatHint,_.MatError,_.MatSuffix,ye.MatSelect,X.MatOption,Ln.MatTooltip,H.MatTab,H.MatTabGroup,U.MatAccordion,U.MatExpansionPanel,U.MatExpansionPanelHeader,U.MatExpansionPanelTitle,U.MatExpansionPanelDescription,U.MatExpansionPanelContent,ve.MatChipGrid,ve.MatChipInput,ve.MatChipRemove,ve.MatChipRow,h.DefaultLayoutDirective,h.DefaultLayoutGapDirective,h.DefaultLayoutAlignDirective,h.DefaultFlexDirective,G.DefaultShowHideDirective,r.\u0275NgNoValidate,r.DefaultValueAccessor,r.NgControlStatus,r.NgControlStatusGroup,r.RequiredValidator,r.FormGroupDirective,r.FormControlName,r.FormGroupName,r.FormArrayName,g.TranslateDirective,Io.CopyButtonComponent,no.TogglePasswordComponent,p.AsyncPipe,p.UpperCasePipe,g.TranslatePipe],styles:['@charset "UTF-8";[_nghost-%COMP%]   .checkbox-row[_ngcontent-%COMP%]{margin-top:1em}[_nghost-%COMP%]   .registration-card[_ngcontent-%COMP%]{margin-bottom:.5em;border:1px solid rgba(0,0,0,.2)}[_nghost-%COMP%]   .registration-card[_ngcontent-%COMP%]   .custom-settings[_ngcontent-%COMP%]{font-size:16px}[_nghost-%COMP%]   .registration-card[_ngcontent-%COMP%]   .custom-settings[_ngcontent-%COMP%]   .mat-expansion-panel-header[_ngcontent-%COMP%]{padding:0 2px}[_nghost-%COMP%]   .container[_ngcontent-%COMP%]{margin-bottom:1em}[_nghost-%COMP%]   .container[_ngcontent-%COMP%]   .tb-highlight[_ngcontent-%COMP%]{margin:0}[_nghost-%COMP%]   .container[_ngcontent-%COMP%]   .tb-hint[_ngcontent-%COMP%]{padding-bottom:0}[_nghost-%COMP%]   .mat-expansion-panel[_ngcontent-%COMP%]   .mat-expansion-panel-header.mat-expanded[_ngcontent-%COMP%]{height:48px}[_nghost-%COMP%]     .registration-card .custom-settings .mat-expansion-panel-body{padding:0 2px 1em}[_nghost-%COMP%]     .domains-list, [_nghost-%COMP%]     .apps-list{margin-bottom:1.5em}','@charset "UTF-8";[_nghost-%COMP%]   .mat-mdc-card.settings-card[_ngcontent-%COMP%]{margin:8px}[_nghost-%COMP%]   .mat-mdc-card.settings-card[_ngcontent-%COMP%]   .fields-group[_ngcontent-%COMP%]{padding:0 16px 8px;margin:10px 0;border:1px groove #7c7c7c;border-radius:4px}@media screen and (min-width: 960px) and (max-width: 1279px){[_nghost-%COMP%]   .mat-mdc-card.settings-card[_ngcontent-%COMP%]{width:80%}}@media screen and (min-width: 1280px){[_nghost-%COMP%]   .mat-mdc-card.settings-card[_ngcontent-%COMP%]{width:60%}}']});var C=c(84557),le=c(64510),rt=c(60513),oe=c(17439),oo=c(25568);function rd(i,n){1&i&&e.\u0275\u0275element(0,"mat-progress-bar",17)}function sd(i,n){1&i&&e.\u0275\u0275element(0,"div",18)}function ld(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.sms-message-required")," "))}function dd(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.sms-message-max-length")," "))}class bi extends le.a{constructor(n,t,a,o,s,l,d){super(n,t,l),this.store=n,this.router=t,this.data=a,this.adminService=o,this.translate=s,this.dialogRef=l,this.fb=d,this.phoneNumberPattern=Pe.yk,this.smsProviderConfiguration=this.data.smsProviderConfiguration}ngOnInit(){this.sendTestSmsFormGroup=this.fb.group({numberTo:[null,[r.Validators.required,r.Validators.pattern(Pe.yk)]],message:[null,[r.Validators.required,r.Validators.maxLength(1600)]]})}close(){this.dialogRef.close()}sendTestSms(){const n={providerConfiguration:this.smsProviderConfiguration,numberTo:this.sendTestSmsFormGroup.value.numberTo,message:this.sendTestSmsFormGroup.value.message};this.adminService.sendTestSms(n).subscribe(()=>{this.store.dispatch(new V.zi({message:this.translate.instant("admin.test-sms-sent"),target:"sendTestSmsDialogContent",verticalPosition:"bottom",horizontalPosition:"left",type:"success"}))})}}bi.\u0275fac=function(n){return new(n||bi)(e.\u0275\u0275directiveInject(x.Store),e.\u0275\u0275directiveInject(b.Router),e.\u0275\u0275directiveInject(C.MAT_DIALOG_DATA),e.\u0275\u0275directiveInject(Fa.l),e.\u0275\u0275directiveInject(g.TranslateService),e.\u0275\u0275directiveInject(C.MatDialogRef),e.\u0275\u0275directiveInject(r.UntypedFormBuilder))},bi.\u0275cmp=e.\u0275\u0275defineComponent({type:bi,selectors:[["tb-send-test-sms-dialog"]],features:[e.\u0275\u0275InheritDefinitionFeature],decls:32,vars:29,consts:[[2,"min-width","500px","position","relative",3,"formGroup"],["color","primary"],["translate",""],["fxFlex",""],["mat-icon-button","","type","button",3,"click"],[1,"material-icons"],["color","warn","mode","indeterminate",4,"ngIf"],["style","height: 4px;",4,"ngIf"],["mat-dialog-content","","tb-toast","","toastTarget","sendTestSmsDialogContent"],[3,"disabled"],["required","","formControlName","numberTo",3,"enableFlagsSelect","label"],[1,"mat-block"],["required","","matInput","","rows","3","formControlName","message",3,"maxLength"],[4,"ngIf"],["mat-dialog-actions","","fxLayoutAlign","end center"],["mat-button","","color","primary","type","button","cdkFocusInitial","",3,"disabled","click"],["mat-raised-button","","color","primary","type","button",3,"disabled","click"],["color","warn","mode","indeterminate"],[2,"height","4px"]],template:function(n,t){1&n&&(e.\u0275\u0275elementStart(0,"form",0)(1,"mat-toolbar",1)(2,"h2",2),e.\u0275\u0275text(3,"admin.send-test-sms"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(4,"span",3),e.\u0275\u0275elementStart(5,"button",4),e.\u0275\u0275listener("click",function(){return t.close()}),e.\u0275\u0275elementStart(6,"mat-icon",5),e.\u0275\u0275text(7,"close"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275template(8,rd,1,0,"mat-progress-bar",6),e.\u0275\u0275pipe(9,"async"),e.\u0275\u0275template(10,sd,1,0,"div",7),e.\u0275\u0275pipe(11,"async"),e.\u0275\u0275elementStart(12,"div",8)(13,"fieldset",9),e.\u0275\u0275pipe(14,"async"),e.\u0275\u0275element(15,"tb-phone-input",10),e.\u0275\u0275pipe(16,"translate"),e.\u0275\u0275elementStart(17,"mat-form-field",11)(18,"mat-label",2),e.\u0275\u0275text(19,"admin.sms-message"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(20,"textarea",12),e.\u0275\u0275template(21,ld,3,3,"mat-error",13),e.\u0275\u0275template(22,dd,3,3,"mat-error",13),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(23,"div",14)(24,"button",15),e.\u0275\u0275listener("click",function(){return t.close()}),e.\u0275\u0275pipe(25,"async"),e.\u0275\u0275text(26),e.\u0275\u0275pipe(27,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(28,"button",16),e.\u0275\u0275listener("click",function(){return t.sendTestSms()}),e.\u0275\u0275pipe(29,"async"),e.\u0275\u0275text(30),e.\u0275\u0275pipe(31,"translate"),e.\u0275\u0275elementEnd()()()),2&n&&(e.\u0275\u0275property("formGroup",t.sendTestSmsFormGroup),e.\u0275\u0275advance(8),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(9,13,t.isLoading$)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!e.\u0275\u0275pipeBind1(11,15,t.isLoading$)),e.\u0275\u0275advance(3),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(14,17,t.isLoading$)),e.\u0275\u0275advance(2),e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(16,19,"admin.number-to")),e.\u0275\u0275property("enableFlagsSelect",!1),e.\u0275\u0275advance(5),e.\u0275\u0275property("maxLength",1600),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.sendTestSmsFormGroup.get("message").hasError("required")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.sendTestSmsFormGroup.get("message").hasError("maxLength")),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(25,21,t.isLoading$)),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(27,23,"action.close")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(29,25,t.isLoading$)||t.sendTestSmsFormGroup.invalid),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(31,27,"admin.send-test-sms")," "))},dependencies:[p.NgIf,rt.ToastDirective,S.MatButton,S.MatIconButton,F.MatIcon,z.MatProgressBar,O.MatInput,_.MatFormField,_.MatLabel,_.MatError,oe.MatToolbar,C.MatDialogContent,C.MatDialogActions,h.DefaultLayoutAlignDirective,h.DefaultFlexDirective,r.\u0275NgNoValidate,r.DefaultValueAccessor,r.NgControlStatus,r.NgControlStatusGroup,r.RequiredValidator,r.FormGroupDirective,r.FormControlName,g.TranslateDirective,oo.T,p.AsyncPipe,g.TranslatePipe],encapsulation:2});var qe=c(93121),q=c(33177),cd=c(22028);function pd(i,n){1&i&&e.\u0275\u0275element(0,"mat-progress-bar",22)}function md(i,n){1&i&&e.\u0275\u0275element(0,"div",23)}function ud(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"mat-card",1)(1,"mat-card-header")(2,"mat-card-title")(3,"span",2),e.\u0275\u0275text(4,"admin.sms-provider-settings"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275element(5,"span",3)(6,"div",16),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(7,pd,1,0,"mat-progress-bar",5),e.\u0275\u0275pipe(8,"async"),e.\u0275\u0275template(9,md,1,0,"div",6),e.\u0275\u0275pipe(10,"async"),e.\u0275\u0275elementStart(11,"mat-card-content",7)(12,"form",8),e.\u0275\u0275listener("ngSubmit",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.save())}),e.\u0275\u0275elementStart(13,"fieldset",17),e.\u0275\u0275pipe(14,"async"),e.\u0275\u0275element(15,"tb-sms-provider-configuration",18),e.\u0275\u0275elementStart(16,"div",19)(17,"button",20),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.sendTestSms())}),e.\u0275\u0275pipe(18,"async"),e.\u0275\u0275text(19),e.\u0275\u0275pipe(20,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(21,"button",21),e.\u0275\u0275pipe(22,"async"),e.\u0275\u0275text(23),e.\u0275\u0275pipe(24,"translate"),e.\u0275\u0275elementEnd()()()()()()}if(2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(7),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(8,8,t.isLoading$)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!e.\u0275\u0275pipeBind1(10,10,t.isLoading$)),e.\u0275\u0275advance(3),e.\u0275\u0275property("formGroup",t.smsProvider),e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(14,12,t.isLoading$)),e.\u0275\u0275advance(4),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(18,14,t.isLoading$)||t.smsProvider.invalid),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(20,16,"admin.send-test-sms")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(22,18,t.isLoading$)||t.smsProvider.invalid||!t.smsProvider.dirty),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1("",e.\u0275\u0275pipeBind1(24,20,"action.save")," ")}}function gd(i,n){1&i&&e.\u0275\u0275element(0,"mat-progress-bar",22)}function fd(i,n){1&i&&e.\u0275\u0275element(0,"div",23)}class yi extends se.I{constructor(n,t,a,o,s,l){super(n),this.store=n,this.router=t,this.adminService=a,this.notificationService=o,this.dialog=s,this.fb=l,this.authUser=(0,q.fP)(this.store),this.buildSmsProviderForm(),this.buildGeneralServerSettingsForm(),this.notificationService.getNotificationSettings().subscribe(d=>{this.notificationSettings=d,this.slackSettingsForm.reset(this.notificationSettings)}),this.isSysAdmin()&&this.adminService.getAdminSettings("sms",{ignoreErrors:!0}).subscribe({next:d=>{this.adminSettings=d,this.smsProvider.reset({configuration:this.adminSettings.jsonValue})},error:()=>{this.adminSettings={key:"sms",jsonValue:null},this.smsProvider.reset({configuration:this.adminSettings.jsonValue})}})}buildSmsProviderForm(){this.smsProvider=this.fb.group({configuration:[null,[r.Validators.required]]}),this.registerDisableOnLoadFormControl(this.smsProvider.get("configuration"))}sendTestSms(){this.dialog.open(bi,{disableClose:!0,panelClass:["tb-dialog","tb-fullscreen-dialog"],data:{smsProviderConfiguration:this.smsProvider.value.configuration}})}save(){this.adminSettings.jsonValue=this.smsProvider.value.configuration,this.adminService.saveAdminSettings(this.adminSettings).subscribe(n=>{this.adminSettings=n,this.smsProvider.reset({configuration:this.adminSettings.jsonValue})})}confirmForm(){return this.smsProvider.dirty?this.smsProvider:this.slackSettingsForm}buildGeneralServerSettingsForm(){this.slackSettingsForm=this.fb.group({deliveryMethodsConfigs:this.fb.group({SLACK:this.fb.group({botToken:[""]})})}),this.registerDisableOnLoadFormControl(this.slackSettingsForm.get("deliveryMethodsConfigs"))}saveNotification(){this.notificationSettings=(0,T.se)({...this.notificationSettings,...this.slackSettingsForm.value});for(const n in this.notificationSettings.deliveryMethodsConfigs)Object.keys(this.notificationSettings.deliveryMethodsConfigs[n]).some(a=>(0,T.jH)(this.notificationSettings.deliveryMethodsConfigs[n][a]))?delete this.notificationSettings.deliveryMethodsConfigs[n]:this.notificationSettings.deliveryMethodsConfigs[n].method=n;this.notificationService.saveNotificationSettings(this.notificationSettings).subscribe(n=>{this.notificationSettings=n,this.slackSettingsForm.reset(this.notificationSettings)})}isSysAdmin(){return this.authUser.authority===u.W.SYS_ADMIN}}yi.\u0275fac=function(n){return new(n||yi)(e.\u0275\u0275directiveInject(x.Store),e.\u0275\u0275directiveInject(b.Router),e.\u0275\u0275directiveInject(Fa.l),e.\u0275\u0275directiveInject(qe.g),e.\u0275\u0275directiveInject(C.MatDialog),e.\u0275\u0275directiveInject(r.FormBuilder))},yi.\u0275cmp=e.\u0275\u0275defineComponent({type:yi,selectors:[["tb-sms-provider"]],features:[e.\u0275\u0275InheritDefinitionFeature],decls:26,vars:17,consts:[["appearance","outlined","class","settings-card",4,"ngIf"],["appearance","outlined",1,"settings-card"],["translate","",1,"mat-headline-5"],["fxFlex",""],["tb-help","slackSettings"],["color","warn","mode","indeterminate",4,"ngIf"],["style","height: 4px;",4,"ngIf"],[2,"padding-top","16px"],[3,"formGroup","ngSubmit"],["formGroupName","deliveryMethodsConfigs",3,"disabled"],["formGroupName","SLACK"],[1,"mat-block"],["translate",""],["matInput","","formControlName","botToken"],["fxLayout","row","fxLayoutAlign","end center",1,"layout-wrap"],["mat-button","","mat-raised-button","","color","primary","type","submit",3,"disabled"],["tb-help","smsProviderSettings"],[3,"disabled"],["required","","formControlName","configuration"],["fxLayout","row","fxLayoutAlign","end center","fxLayout.xs","column","fxLayoutAlign.xs","end","fxLayoutGap","16px"],["mat-raised-button","","type","button",3,"disabled","click"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],["color","warn","mode","indeterminate"],[2,"height","4px"]],template:function(n,t){1&n&&(e.\u0275\u0275template(0,ud,25,22,"mat-card",0),e.\u0275\u0275elementStart(1,"mat-card",1)(2,"mat-card-header")(3,"mat-card-title")(4,"span",2),e.\u0275\u0275text(5,"admin.slack-settings"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275element(6,"span",3)(7,"div",4),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(8,gd,1,0,"mat-progress-bar",5),e.\u0275\u0275pipe(9,"async"),e.\u0275\u0275template(10,fd,1,0,"div",6),e.\u0275\u0275pipe(11,"async"),e.\u0275\u0275elementStart(12,"mat-card-content",7)(13,"form",8),e.\u0275\u0275listener("ngSubmit",function(){return t.saveNotification()}),e.\u0275\u0275elementStart(14,"fieldset",9),e.\u0275\u0275pipe(15,"async"),e.\u0275\u0275elementStart(16,"section",10)(17,"mat-form-field",11)(18,"mat-label",12),e.\u0275\u0275text(19,"admin.slack-api-token"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(20,"input",13),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(21,"div",14)(22,"button",15),e.\u0275\u0275pipe(23,"async"),e.\u0275\u0275text(24),e.\u0275\u0275pipe(25,"translate"),e.\u0275\u0275elementEnd()()()()()()),2&n&&(e.\u0275\u0275property("ngIf",t.isSysAdmin()),e.\u0275\u0275advance(8),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(9,7,t.isLoading$)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!e.\u0275\u0275pipeBind1(11,9,t.isLoading$)),e.\u0275\u0275advance(3),e.\u0275\u0275property("formGroup",t.slackSettingsForm),e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(15,11,t.isLoading$)),e.\u0275\u0275advance(8),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(23,13,t.isLoading$)||t.slackSettingsForm.invalid||!t.slackSettingsForm.dirty),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1("",e.\u0275\u0275pipeBind1(25,15,"action.save")," "))},dependencies:[p.NgIf,De.HelpComponent,S.MatButton,A.MatCard,A.MatCardContent,A.MatCardHeader,A.MatCardTitle,z.MatProgressBar,O.MatInput,_.MatFormField,_.MatLabel,h.DefaultLayoutDirective,h.DefaultLayoutGapDirective,h.DefaultLayoutAlignDirective,h.DefaultFlexDirective,r.\u0275NgNoValidate,r.DefaultValueAccessor,r.NgControlStatus,r.NgControlStatusGroup,r.RequiredValidator,r.FormGroupDirective,r.FormControlName,r.FormGroupName,g.TranslateDirective,cd.SmsProviderConfigurationComponent,p.AsyncPipe,g.TranslatePipe],styles:['@charset "UTF-8";','@charset "UTF-8";[_nghost-%COMP%]   .mat-mdc-card.settings-card[_ngcontent-%COMP%]{margin:8px}[_nghost-%COMP%]   .mat-mdc-card.settings-card[_ngcontent-%COMP%]   .fields-group[_ngcontent-%COMP%]{padding:0 16px 8px;margin:10px 0;border:1px groove #7c7c7c;border-radius:4px}@media screen and (min-width: 960px) and (max-width: 1279px){[_nghost-%COMP%]   .mat-mdc-card.settings-card[_ngcontent-%COMP%]{width:80%}}@media screen and (min-width: 1280px){[_nghost-%COMP%]   .mat-mdc-card.settings-card[_ngcontent-%COMP%]{width:60%}}']});var ro=c(38356),hd=c(7531),Ua=c(98288),$e=c(63085),vi=c(53642),Eo=c(52434);function bd(i,n){1&i&&e.\u0275\u0275element(0,"mat-progress-bar",22)}function yd(i,n){1&i&&e.\u0275\u0275element(0,"div",23)}function vd(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-option",24),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){const t=n.$implicit;e.\u0275\u0275property("value",t),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(t.title||t.name)}}function _d(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-option",24),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){const t=n.$implicit;e.\u0275\u0275property("value",t.id.id),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(t.name)}}function xd(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"form",5),e.\u0275\u0275listener("ngSubmit",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.saveConfig())}),e.\u0275\u0275elementStart(1,"section",25)(2,"mat-form-field",18)(3,"mat-label"),e.\u0275\u0275text(4,"Select Theme"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"mat-select",26)(6,"mat-option",27),e.\u0275\u0275text(7,"Light"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(8,"mat-option",28),e.\u0275\u0275text(9,"dark"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(10,"mat-form-field",18)(11,"mat-label"),e.\u0275\u0275text(12,"Profile URL"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(13,"input",29),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(14,"section",25)(15,"div",30),e.\u0275\u0275element(16,"tb-color-input",31),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(17,"div",30),e.\u0275\u0275element(18,"tb-color-input",32),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(19,"section",25)(20,"div",30),e.\u0275\u0275element(21,"tb-color-input",33),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(22,"div",30),e.\u0275\u0275element(23,"tb-color-input",34),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(24,"section",25)(25,"div",30),e.\u0275\u0275element(26,"tb-color-input",35),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(27,"div",30),e.\u0275\u0275element(28,"tb-color-input",36),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(29,"div",30),e.\u0275\u0275element(30,"tb-color-input",37),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(31,"mat-form-field",14)(32,"mat-label"),e.\u0275\u0275text(33,"Powered by html"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(34,"textarea",38),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(35,"div",39)(36,"button",40),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.applyColorToThisDevice())}),e.\u0275\u0275text(37,"Apply color to this device"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(38,"button",12),e.\u0275\u0275pipe(39,"async"),e.\u0275\u0275text(40),e.\u0275\u0275pipe(41,"translate"),e.\u0275\u0275elementEnd()()()}if(2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275property("formGroup",t.publicConfig),e.\u0275\u0275advance(38),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(39,3,t.isLoading$)||null==t.selectedCustomer),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1("",e.\u0275\u0275pipeBind1(41,5,"action.save")," ")}}class _i extends se.I{constructor(n,t,a,o,s,l){super(n),this.store=n,this.router=t,this.dashboardService=a,this.customerService=o,this.cd=s,this.fb=l,this.selectedCustomer=void 0,this.customerDashboards=[],this.pageLink=new Ua.H_(200)}ngOnInit(){this.homeSettings=this.fb.group({dashboardId:[null],hideDashboardToolbar:[!0]}),this.customerHomeSettings=this.fb.group({dashboardId:[null],hideDashboardToolbar:[!0]}),this.publicConfig=this.fb.group({theme:["light",r.Validators.required],primaryToolbarBgColor:["#FF0000"],breadcrumbBgColor:["#000000"],drawerBgColor:["#000000"],drawerLogoBgColor:["#000000"],primaryColor:["#2196f3"],accentColor:["#ffc107"],warnColor:["#f44336"],profileUrl:["/account"],poweredByHtml:['<div style="margin: 0 auto; width: 100%; text-align: center; background-color: #232222;padding: 5px 0;"><div style=" color: white;font-size: 14px;">Powered By Sincos</div></div>']}),this.publicConfig.disable(),this.customerHomeSettings.disable(),this.dashboardService.getTenantHomeDashboardInfo().subscribe(n=>{this.setHomeDashboardInfo(n)}),this.customerService.getCustomers(this.pageLink).subscribe(n=>{this.customerList=n.data})}save(){const n=this.homeSettings.get("dashboardId").value,o={dashboardId:n?new hd.v(n):null,hideDashboardToolbar:this.homeSettings.get("hideDashboardToolbar").value};this.dashboardService.setTenantHomeDashboardInfo(o).subscribe(()=>{this.setHomeDashboardInfo(o)})}confirmForm(){return this.homeSettings}setHomeDashboardInfo(n){this.homeSettings.reset({dashboardId:n?.dashboardId?.id,hideDashboardToolbar:!(0,T.nu)(n?.hideDashboardToolbar)||n?.hideDashboardToolbar})}customerSelected(n){this.selectedCustomer=n.value,this.publicConfig.enable(),this.customerHomeSettings.enable(),this.dashboardService.getCustomerDashboards(this.selectedCustomer.id.id,this.pageLink).subscribe(t=>{this.customerDashboards=t.data}),this.setCustomerDashboard(this.selectedCustomer.additionalInfo);try{let t=JSON.parse(this.selectedCustomer.additionalInfo.satlConfig);this.setPublicInfo(t.publicConfig)}catch{this.setPublicInfo({})}}setPublicInfo(n){console.log(n),this.publicConfig.reset({theme:n.theme||"light",primaryToolbarBgColor:n.primaryToolbarBgColor||"#FF0000",breadcrumbBgColor:n.breadcrumbBgColor||"#000000",drawerBgColor:n.drawerBgColor||"#000000",drawerLogoBgColor:n.drawerLogoBgColor||"#FF0000",primaryColor:n.primaryColor||"#2196f3",accentColor:n.accentColor||"#ffc107",warnColor:n.warnColor||"#f44336",profileUrl:n.profileUrl||"/account",poweredByHtml:decodeURI(n.poweredByHtml)})}saveConfig(){this.selectedCustomer.additionalInfo||(this.selectedCustomer.additionalInfo={}),this.selectedCustomer.additionalInfo.homeDashboardId=this.customerHomeSettings.value.dashboardId,this.selectedCustomer.additionalInfo.homeDashboardHideToolbar=this.customerHomeSettings.value.hideDashboardToolbar;try{this.selectedCustomer.additionalInfo.satlConfig=JSON.parse(this.selectedCustomer.additionalInfo.satlConfig)}catch{this.selectedCustomer.additionalInfo.satlConfig={publicConfig:{}}}this.selectedCustomer.additionalInfo.satlConfig.publicConfig=this.publicConfig.value,this.selectedCustomer.additionalInfo.satlConfig.publicConfig.poweredByHtml=encodeURI(this.publicConfig.value.poweredByHtml),this.selectedCustomer.additionalInfo.satlConfig=JSON.stringify(this.selectedCustomer.additionalInfo.satlConfig),this.customerService.saveCustomer(this.selectedCustomer).subscribe(n=>{this.publicConfig.value.poweredByHtml=decodeURI(this.publicConfig.value.poweredByHtml)},n=>{this.publicConfig.value.poweredByHtml=decodeURI(this.publicConfig.value.poweredByHtml)})}setCustomerDashboard(n){this.customerHomeSettings.reset({dashboardId:n?.homeDashboardId,hideDashboardToolbar:!(0,T.nu)(n?.homeDashboardHideToolbar)||n?.homeDashboardHideToolbar})}applyColorToThisDevice(){localStorage.setItem("satlTheme",this.publicConfig.value.theme||"light"),localStorage.setItem("satlUIPrimaryColor",this.publicConfig.value.primaryColor),localStorage.setItem("satlUIAccentColor",this.publicConfig.value.accentColor),localStorage.setItem("satlUIWarnColor",this.publicConfig.value.warnColor),localStorage.setItem("satlPrimaryToolbar",this.publicConfig.value.primaryToolbarBgColor),localStorage.setItem("satlBreadcrumb",this.publicConfig.value.breadcrumbBgColor),localStorage.setItem("satlDrawerBgColor",this.publicConfig.value.drawerBgColor),localStorage.setItem("satlDrawerLogoBgColor",this.publicConfig.value.drawerLogoBgColor),this.cd.detectChanges()}}_i.\u0275fac=function(n){return new(n||_i)(e.\u0275\u0275directiveInject(x.Store),e.\u0275\u0275directiveInject(b.Router),e.\u0275\u0275directiveInject(ro.s),e.\u0275\u0275directiveInject($e.v),e.\u0275\u0275directiveInject(e.ChangeDetectorRef),e.\u0275\u0275directiveInject(r.UntypedFormBuilder))},_i.\u0275cmp=e.\u0275\u0275defineComponent({type:_i,selectors:[["tb-home-settings"]],features:[e.\u0275\u0275InheritDefinitionFeature],decls:51,vars:34,consts:[["appearance","outlined",1,"settings-card"],["translate","",1,"mat-headline-5"],["color","warn","mode","indeterminate",4,"ngIf"],["style","height: 4px;",4,"ngIf"],[2,"padding-top","16px"],[3,"formGroup","ngSubmit"],[3,"disabled"],["fxFlex","","fxLayout","column",1,"tb-default-dashboard"],["fxFlex","","fxLayout","column","fxLayout.gt-sm","row"],["fxFlex","","formControlName","dashboardId",3,"label","dashboardsScope","selectFirstDashboard"],["fxFlex","","formControlName","hideDashboardToolbar"],["fxLayout","row","fxLayoutAlign","end center",1,"layout-wrap",2,"width","100%"],["mat-button","","mat-raised-button","","color","primary","type","submit",3,"disabled"],[1,"mat-headline-5"],[2,"width","100%"],[3,"selectionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"formGroup"],["fxFlex","49","fxFlex.lt-md","100"],["formControlName","dashboardId"],["fxFlex","49","fxFlex.lt-md","100","formControlName","hideDashboardToolbar"],[3,"formGroup","ngSubmit",4,"ngIf"],["color","warn","mode","indeterminate"],[2,"height","4px"],[3,"value"],["fxLayout","","fxLayout.lt-md","column","fxLayoutGap","10px"],["formControlName","theme"],["value","light"],["value","dark"],["matInput","","formControlName","profileUrl"],["fxFlex",""],["formControlName","primaryToolbarBgColor","asBoxInput","false","openOnInput","true","label","Primary Toolbar Background Color"],["formControlName","breadcrumbBgColor","asBoxInput","false","openOnInput","true","label","Breadcrumb Background Color"],["formControlName","drawerBgColor","asBoxInput","false","openOnInput","true","label","Drawer Background Color"],["formControlName","drawerLogoBgColor","asBoxInput","false","openOnInput","true","label","Drawer Logo Background Color"],["formControlName","primaryColor","asBoxInput","false","openOnInput","true","label","Primary Color"],["formControlName","accentColor","asBoxInput","false","openOnInput","true","label","Accent Color"],["formControlName","warnColor","asBoxInput","false","openOnInput","true","label","Warn Color"],["matInput","","formControlName","poweredByHtml"],["fxLayout","row","fxLayoutAlign","end center","fxLayoutGap","10px",1,"layout-wrap",2,"width","100%"],["mat-raised-button","","color","primary","type","button",3,"click"]],template:function(n,t){1&n&&(e.\u0275\u0275elementStart(0,"div")(1,"mat-card",0)(2,"mat-card-header")(3,"mat-card-title")(4,"span",1),e.\u0275\u0275text(5,"admin.home-settings"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275template(6,bd,1,0,"mat-progress-bar",2),e.\u0275\u0275pipe(7,"async"),e.\u0275\u0275template(8,yd,1,0,"div",3),e.\u0275\u0275pipe(9,"async"),e.\u0275\u0275elementStart(10,"mat-card-content",4)(11,"form",5),e.\u0275\u0275listener("ngSubmit",function(){return t.save()}),e.\u0275\u0275elementStart(12,"fieldset",6),e.\u0275\u0275pipe(13,"async"),e.\u0275\u0275elementStart(14,"section",7)(15,"section",8),e.\u0275\u0275element(16,"tb-dashboard-autocomplete",9),e.\u0275\u0275pipe(17,"translate"),e.\u0275\u0275elementStart(18,"mat-checkbox",10),e.\u0275\u0275text(19),e.\u0275\u0275pipe(20,"translate"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(21,"div",11)(22,"button",12),e.\u0275\u0275pipe(23,"async"),e.\u0275\u0275text(24),e.\u0275\u0275pipe(25,"translate"),e.\u0275\u0275elementEnd()()()()()(),e.\u0275\u0275elementStart(26,"mat-card",0)(27,"mat-card-header")(28,"mat-card-title")(29,"span",13),e.\u0275\u0275text(30,"Public Settings"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(31,"mat-card-content",4)(32,"mat-form-field",14)(33,"mat-label"),e.\u0275\u0275text(34,"Select a customer"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(35,"mat-select",15),e.\u0275\u0275listener("selectionChange",function(o){return t.customerSelected(o)}),e.\u0275\u0275template(36,vd,2,2,"mat-option",16),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(37,"form",17)(38,"fieldset")(39,"section",7)(40,"section",8)(41,"mat-form-field",18)(42,"mat-label"),e.\u0275\u0275text(43),e.\u0275\u0275pipe(44,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(45,"mat-select",19),e.\u0275\u0275template(46,_d,2,2,"mat-option",16),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(47,"mat-checkbox",20),e.\u0275\u0275text(48),e.\u0275\u0275pipe(49,"translate"),e.\u0275\u0275elementEnd()()()()(),e.\u0275\u0275template(50,xd,42,7,"form",21),e.\u0275\u0275elementEnd()()()),2&n&&(e.\u0275\u0275advance(6),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(7,16,t.isLoading$)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!e.\u0275\u0275pipeBind1(9,18,t.isLoading$)),e.\u0275\u0275advance(3),e.\u0275\u0275property("formGroup",t.homeSettings),e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(13,20,t.isLoading$)),e.\u0275\u0275advance(4),e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(17,22,"dashboard.home-dashboard")),e.\u0275\u0275property("dashboardsScope","tenant")("selectFirstDashboard",!1),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(20,24,"dashboard.home-dashboard-hide-toolbar")," "),e.\u0275\u0275advance(3),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(23,26,t.isLoading$)||t.homeSettings.invalid||!t.homeSettings.dirty),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1("",e.\u0275\u0275pipeBind1(25,28,"action.save")," "),e.\u0275\u0275advance(12),e.\u0275\u0275property("ngForOf",t.customerList),e.\u0275\u0275advance(1),e.\u0275\u0275property("formGroup",t.customerHomeSettings),e.\u0275\u0275advance(6),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(44,30,"dashboard.home-dashboard")),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngForOf",t.customerDashboards),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(49,32,"dashboard.home-dashboard-hide-toolbar")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",t.publicConfig))},dependencies:[p.NgForOf,p.NgIf,vi.DashboardAutocompleteComponent,S.MatButton,fe.MatCheckbox,A.MatCard,A.MatCardContent,A.MatCardHeader,A.MatCardTitle,z.MatProgressBar,O.MatInput,_.MatFormField,_.MatLabel,ye.MatSelect,X.MatOption,h.DefaultLayoutDirective,h.DefaultLayoutGapDirective,h.DefaultLayoutAlignDirective,h.DefaultFlexDirective,r.\u0275NgNoValidate,r.DefaultValueAccessor,r.NgControlStatus,r.NgControlStatusGroup,r.FormGroupDirective,r.FormControlName,Eo.ColorInputComponent,g.TranslateDirective,p.AsyncPipe,g.TranslatePipe],styles:['@charset "UTF-8";@media screen and (min-width: 960px){[_nghost-%COMP%]   .tb-default-dashboard[_ngcontent-%COMP%]   tb-dashboard-autocomplete[_ngcontent-%COMP%]{padding-right:12px}}@media screen and (max-width: 959px){[_nghost-%COMP%]   .tb-default-dashboard[_ngcontent-%COMP%]   tb-dashboard-autocomplete[_ngcontent-%COMP%]{padding-bottom:12px}}@media screen and (min-width: 960px){[_nghost-%COMP%]   .tb-default-dashboard[_ngcontent-%COMP%]   .mat-mdc-checkbox[_ngcontent-%COMP%]{margin-top:16px}}','@charset "UTF-8";[_nghost-%COMP%]   .mat-mdc-card.settings-card[_ngcontent-%COMP%]{margin:8px}[_nghost-%COMP%]   .mat-mdc-card.settings-card[_ngcontent-%COMP%]   .fields-group[_ngcontent-%COMP%]{padding:0 16px 8px;margin:10px 0;border:1px groove #7c7c7c;border-radius:4px}@media screen and (min-width: 960px) and (max-width: 1279px){[_nghost-%COMP%]   .mat-mdc-card.settings-card[_ngcontent-%COMP%]{width:80%}}@media screen and (min-width: 1280px){[_nghost-%COMP%]   .mat-mdc-card.settings-card[_ngcontent-%COMP%]{width:60%}}']});var j=c(33109),v=c(1235),ke=c(27818),f=c(96976),P=c(15266),Cd=c(55619),Te=c(37859),La=c(9302),Mo=c(77007),he=c(91610),Do=c(61027);function Td(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-option",16),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i){const t=n.$implicit,a=e.\u0275\u0275nextContext();e.\u0275\u0275property("value",t),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,2,a.resourceTypesTranslationMap.get(t))," ")}}function Sd(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"resource.title-required")," "))}function Id(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"resource.title-max-length")," "))}function wd(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-form-field",10)(1,"mat-label",6),e.\u0275\u0275text(2,"resource.title"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(3,"input",17),e.\u0275\u0275template(4,Sd,3,3,"mat-error",18),e.\u0275\u0275template(5,Id,3,3,"mat-error",18),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(4),e.\u0275\u0275property("ngIf",t.entityForm.get("title").hasError("required")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.entityForm.get("title").hasError("maxlength"))}}function Ed(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"tb-file-input",19),e.\u0275\u0275listener("fileNameChanged",function(o){e.\u0275\u0275restoreView(t);const s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(null==s.entityForm?null:s.entityForm.get("fileName").patchValue(o))}),e.\u0275\u0275pipe(1,"translate"),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()}if(2&i){const t=e.\u0275\u0275nextContext();let a;e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(1,9,t.entityForm.get("resourceType").value===t.resourceType.LWM2M_MODEL?"resource.resource-files":"resource.resource-file")),e.\u0275\u0275propertyInterpolate("dropLabel",e.\u0275\u0275pipeBind1(2,11,"resource.drop-resource-file-or")),e.\u0275\u0275property("readAsBinary",!0)("maxSizeByte",t.maxResourceSize)("allowedExtensions",t.getAllowedExtensions())("contentConvertFunction",t.convertToBase64File)("accept",t.getAcceptType())("multipleFile",t.entityForm.get("resourceType").value===t.resourceType.LWM2M_MODEL)("existingFileName",null==(a=t.entityForm.get("fileName"))?null:a.value)}}function Md(i,n){1&i&&(e.\u0275\u0275elementStart(0,"div",20)(1,"mat-form-field",21)(2,"mat-label",6),e.\u0275\u0275text(3,"resource.file-name"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(4,"input",22),e.\u0275\u0275elementEnd()())}class xi extends Te.r{constructor(n,t,a,o,s,l,d){super(n,s,a,o,l),this.store=n,this.translate=t,this.entityValue=a,this.entitiesTableConfigValue=o,this.fb=s,this.cd=l,this.document=d,this.resourceType=ke._g,this.resourceTypes=Object.values(this.resourceType),this.resourceTypesTranslationMap=ke.EC,this.maxResourceSize=(0,q.dE)(this.store).maxResourceSize,this.destroy$=new be.x,this.rootUrl=this.document.location.protocol+"//"+this.document.location.hostname+":"+this.document.location.port}ngOnInit(){super.ngOnInit(),this.entityForm.get("resourceType").valueChanges.pipe((0,La.O)(ke._g.JS_MODULE),(0,Mo.h)(()=>this.isAdd),(0,Y.R)(this.destroy$)).subscribe(n=>{n===this.resourceType.LWM2M_MODEL?(this.entityForm.get("title").disable({emitEvent:!1}),this.entityForm.patchValue({title:""},{emitEvent:!1})):this.entityForm.get("title").enable({emitEvent:!1}),this.entityForm.patchValue({data:null,fileName:null},{emitEvent:!1})})}ngOnDestroy(){super.ngOnDestroy(),this.destroy$.next(),this.destroy$.complete()}hideDelete(){return!!this.entitiesTableConfig&&!this.entitiesTableConfig.deleteEnabled(this.entity)}buildForm(n){return this.fb.group({title:[n?n.title:"",[r.Validators.required,r.Validators.maxLength(255)]],resourceType:[n?.resourceType?n.resourceType:ke._g.JS_MODULE,r.Validators.required],fileName:[n?n.fileName:null,r.Validators.required],data:[n?n.data:null,r.Validators.required]})}updateForm(n){this.isEdit&&(this.entityForm.get("resourceType").disable({emitEvent:!1}),n.resourceType!==ke._g.JS_MODULE&&(this.entityForm.get("fileName").disable({emitEvent:!1}),this.entityForm.get("data").disable({emitEvent:!1}))),this.entityForm.patchValue({resourceType:n.resourceType,fileName:n.fileName,title:n.title,data:n.data})}prepareFormValue(n){return this.isEdit&&!(0,T.nu)(n.data)&&delete n.data,super.prepareFormValue(n)}getAllowedExtensions(){try{return ke.$M.get(this.entityForm.get("resourceType").value)}catch{return""}}getAcceptType(){try{return ke.xi.get(this.entityForm.get("resourceType").value)}catch{return"*/*"}}convertToBase64File(n){return window.btoa(n)}onResourceIdCopied(){this.store.dispatch(new V.zi({message:this.translate.instant("resource.idCopiedMessage"),type:"success",duration:750,verticalPosition:"bottom",horizontalPosition:"right"}))}onResourceLinkCopied(){this.store.dispatch(new V.zi({message:"Resource link is copied to clipboard!",type:"success",duration:750,verticalPosition:"bottom",horizontalPosition:"right"}))}}xi.\u0275fac=function(n){return new(n||xi)(e.\u0275\u0275directiveInject(x.Store),e.\u0275\u0275directiveInject(g.TranslateService),e.\u0275\u0275directiveInject("entity"),e.\u0275\u0275directiveInject("entitiesTableConfig"),e.\u0275\u0275directiveInject(r.FormBuilder),e.\u0275\u0275directiveInject(e.ChangeDetectorRef),e.\u0275\u0275directiveInject(p.DOCUMENT))},xi.\u0275cmp=e.\u0275\u0275defineComponent({type:xi,selectors:[["tb-resources-library"]],features:[e.\u0275\u0275InheritDefinitionFeature],decls:40,vars:35,consts:[["fxLayout.xs","column",1,"tb-details-buttons"],["mat-raised-button","","color","primary",3,"disabled","fxShow","click"],["mat-raised-button","","color","primary","fxFlex.xs","",3,"disabled","fxShow","click"],["fxLayout","row","fxLayout.xs","column"],["mat-raised-button","","ngxClipboard","",3,"cbContent","fxShow","cbOnSuccess"],["svgIcon","mdi:clipboard-arrow-left"],["translate",""],["fxLayout","column",1,"mat-padding"],[3,"formGroup"],[3,"disabled"],[1,"mat-block"],["formControlName","resourceType","required",""],[3,"value",4,"ngFor","ngForOf"],["class","mat-block",4,"ngIf"],["formControlName","data","required","",3,"label","readAsBinary","maxSizeByte","allowedExtensions","contentConvertFunction","accept","multipleFile","dropLabel","existingFileName","fileNameChanged",4,"ngIf"],["fxLayout","row","fxLayoutGap.gt-md","8px","fxLayoutGap.sm","8px","fxLayout.xs","column","fxLayout.md","column",4,"ngIf"],[3,"value"],["matInput","","formControlName","title","required",""],[4,"ngIf"],["formControlName","data","required","",3,"label","readAsBinary","maxSizeByte","allowedExtensions","contentConvertFunction","accept","multipleFile","dropLabel","existingFileName","fileNameChanged"],["fxLayout","row","fxLayoutGap.gt-md","8px","fxLayoutGap.sm","8px","fxLayout.xs","column","fxLayout.md","column"],["fxFlex",""],["matInput","","formControlName","fileName","type","text"]],template:function(n,t){1&n&&(e.\u0275\u0275elementStart(0,"div",0)(1,"button",1),e.\u0275\u0275listener("click",function(o){return t.onEntityAction(o,"open")}),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275text(3),e.\u0275\u0275pipe(4,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"button",2),e.\u0275\u0275listener("click",function(o){return t.onEntityAction(o,"downloadResource")}),e.\u0275\u0275pipe(6,"async"),e.\u0275\u0275text(7),e.\u0275\u0275pipe(8,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(9,"button",2),e.\u0275\u0275listener("click",function(o){return t.onEntityAction(o,"delete")}),e.\u0275\u0275pipe(10,"async"),e.\u0275\u0275text(11),e.\u0275\u0275pipe(12,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(13,"div",3)(14,"button",4),e.\u0275\u0275listener("cbOnSuccess",function(){return t.onResourceIdCopied()}),e.\u0275\u0275element(15,"mat-icon",5),e.\u0275\u0275elementStart(16,"span",6),e.\u0275\u0275text(17,"resource.copyId"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(18,"button",4),e.\u0275\u0275listener("cbOnSuccess",function(){return t.onResourceLinkCopied()}),e.\u0275\u0275elementStart(19,"mat-icon"),e.\u0275\u0275text(20,"copy_all"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(21,"span",6),e.\u0275\u0275text(22,"Copy absolute link"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(23,"button",4),e.\u0275\u0275listener("cbOnSuccess",function(){return t.onResourceLinkCopied()}),e.\u0275\u0275elementStart(24,"mat-icon"),e.\u0275\u0275text(25,"content_copy"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(26,"span",6),e.\u0275\u0275text(27,"Copy content link"),e.\u0275\u0275elementEnd()()()(),e.\u0275\u0275elementStart(28,"div",7)(29,"form",8)(30,"fieldset",9),e.\u0275\u0275pipe(31,"async"),e.\u0275\u0275elementStart(32,"mat-form-field",10)(33,"mat-label",6),e.\u0275\u0275text(34,"resource.resource-type"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(35,"mat-select",11),e.\u0275\u0275template(36,Td,3,4,"mat-option",12),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(37,wd,6,2,"mat-form-field",13),e.\u0275\u0275template(38,Ed,3,13,"tb-file-input",14),e.\u0275\u0275template(39,Md,5,0,"div",15),e.\u0275\u0275elementEnd()()()),2&n&&(e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(2,21,t.isLoading$))("fxShow",!t.isEdit&&!t.isDetailsPage),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(4,23,"common.open-details-page")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(6,25,t.isLoading$))("fxShow",!t.isEdit),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(8,27,"resource.download")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(10,29,t.isLoading$))("fxShow",!t.hideDelete()&&!t.isEdit),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(12,31,"resource.delete")," "),e.\u0275\u0275advance(3),e.\u0275\u0275property("cbContent",null==t.entity||null==t.entity.id?null:t.entity.id.id)("fxShow",!t.isEdit),e.\u0275\u0275advance(4),e.\u0275\u0275property("cbContent",t.rootUrl+"/api/content/public/"+(null==t.entity?null:t.entity.fileName))("fxShow",!t.isEdit),e.\u0275\u0275advance(5),e.\u0275\u0275property("cbContent","/api/content/public/"+(null==t.entity?null:t.entity.fileName))("fxShow",!t.isEdit),e.\u0275\u0275advance(6),e.\u0275\u0275property("formGroup",t.entityForm),e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(31,33,t.isLoading$)||!t.isEdit),e.\u0275\u0275advance(6),e.\u0275\u0275property("ngForOf",t.resourceTypes),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.entityForm.get("resourceType").value!==t.resourceType.LWM2M_MODEL||!t.isAdd),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.isAdd||t.isEdit&&t.entityForm.get("resourceType").value===t.resourceType.JS_MODULE),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!(t.isAdd||t.isEdit&&t.entityForm.get("resourceType").value===t.resourceType.JS_MODULE)))},dependencies:[p.NgForOf,p.NgIf,S.MatButton,F.MatIcon,O.MatInput,_.MatFormField,_.MatLabel,_.MatError,ye.MatSelect,X.MatOption,he.yb,h.DefaultLayoutDirective,h.DefaultLayoutGapDirective,h.DefaultFlexDirective,G.DefaultShowHideDirective,r.\u0275NgNoValidate,r.DefaultValueAccessor,r.NgControlStatus,r.NgControlStatusGroup,r.RequiredValidator,r.FormGroupDirective,r.FormControlName,Do.FileInputComponent,g.TranslateDirective,p.AsyncPipe,g.TranslatePipe],encapsulation:2});var re=c(48358),He=c(1670);function Dd(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-option",5),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i){const t=n.$implicit,a=e.\u0275\u0275nextContext();e.\u0275\u0275property("value",t),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,2,a.resourceTypesTranslationMap.get(t))," ")}}class Ci extends He.n{constructor(n){super(n),this.store=n,this.resourceTypes=Object.values(ke._g),this.resourceTypesTranslationMap=ke.EC}resourceTypeChanged(n){this.entitiesTableConfig.componentsData.resourceType=n,this.entitiesTableConfig.getTable().resetSortAndFilter(!0)}}Ci.\u0275fac=function(n){return new(n||Ci)(e.\u0275\u0275directiveInject(x.Store))},Ci.\u0275cmp=e.\u0275\u0275defineComponent({type:Ci,selectors:[["tb-resources-table-header"]],features:[e.\u0275\u0275InheritDefinitionFeature],decls:9,vars:8,consts:[["subscriptSizing","dynamic",1,"mat-block"],["translate",""],[3,"ngModel","placeholder","ngModelChange"],["value",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(n,t){1&n&&(e.\u0275\u0275elementStart(0,"mat-form-field",0)(1,"mat-label",1),e.\u0275\u0275text(2,"resource.resource-type"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"mat-select",2),e.\u0275\u0275listener("ngModelChange",function(o){return t.resourceTypeChanged(o)}),e.\u0275\u0275pipe(4,"translate"),e.\u0275\u0275elementStart(5,"mat-option",3),e.\u0275\u0275text(6),e.\u0275\u0275pipe(7,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(8,Dd,3,4,"mat-option",4),e.\u0275\u0275elementEnd()()),2&n&&(e.\u0275\u0275advance(3),e.\u0275\u0275propertyInterpolate("placeholder",e.\u0275\u0275pipeBind1(4,4,"resource.resource-type")),e.\u0275\u0275property("ngModel",t.entitiesTableConfig.componentsData.resourceType),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(7,6,"resource.all-types")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",t.resourceTypes))},dependencies:[p.NgForOf,_.MatFormField,_.MatLabel,ye.MatSelect,X.MatOption,r.NgControlStatus,r.NgModel,g.TranslateDirective,g.TranslatePipe],encapsulation:2});class st{constructor(n,t,a,o,s,l){this.store=n,this.resourceService=t,this.translate=a,this.router=o,this._clipboardService=s,this.datePipe=l,this.config=new v.ap,this.resourceTypesTranslationMap=ke.EC,this.config.entityType=f.py.TB_RESOURCE,this.config.entityComponent=xi,this.config.entityTranslations=f.Jr.get(f.py.TB_RESOURCE),this.config.entityResources=f.CZ.get(f.py.TB_RESOURCE),this.config.headerComponent=Ci,this.config.entityTitle=d=>d?d.title:"",this.config.columns.push(new v.eq("createdTime","common.created-time",this.datePipe,"150px"),new v.QI("title","resource.title","40%"),new v.QI("fileName","File name","40%"),new v.QI("resourceType","resource.resource-type","20%",d=>this.translate.instant(this.resourceTypesTranslationMap.get(d.resourceType)))),this.config.cellActionDescriptors.push({name:this.translate.instant("resource.download"),icon:"file_download",isEnabled:()=>!0,onAction:(d,m)=>this.downloadResource(d,m)}),this.config.cellActionDescriptors.push({name:"Copy absolute link",icon:"copy_all",isEnabled:()=>!0,onAction:(d,m)=>this.copyResource(d,m,"full")}),this.config.cellActionDescriptors.push({name:"Copy content link",icon:"content_copy",isEnabled:()=>!0,onAction:(d,m)=>this.copyResource(d,m,"content")}),this.config.deleteEntityTitle=d=>this.translate.instant("resource.delete-resource-title",{resourceTitle:d.title}),this.config.deleteEntityContent=()=>this.translate.instant("resource.delete-resource-text"),this.config.deleteEntitiesTitle=d=>this.translate.instant("resource.delete-resources-title",{count:d}),this.config.deleteEntitiesContent=()=>this.translate.instant("resource.delete-resources-text"),this.config.entitiesFetchFunction=d=>this.resourceService.getResources(d,this.config.componentsData.resourceType),this.config.loadEntity=d=>this.resourceService.getResourceInfo(d.id),this.config.saveEntity=d=>this.saveResource(d),this.config.deleteEntity=d=>this.resourceService.deleteResource(d.id),this.config.onEntityAction=d=>this.onResourceAction(d)}saveResource(n){if(Array.isArray(n.data)){const t=[];return n.data.forEach((a,o)=>{t.push({resourceType:n.resourceType,data:a,fileName:n.fileName[o],title:n.title})}),this.resourceService.saveResources(t,{resendRequest:!0}).pipe((0,re.U)(a=>a[0]))}return this.resourceService.saveResource(n)}resolve(){this.config.tableTitle=this.translate.instant("resource.resources-library"),this.config.componentsData={resourceType:""};const n=(0,q.fP)(this.store);return this.config.deleteEnabled=t=>this.isResourceEditable(t,n.authority),this.config.entitySelectionEnabled=t=>this.isResourceEditable(t,n.authority),this.config.detailsReadonly=t=>!this.isResourceEditable(t,n.authority),this.config}openResource(n,t){n&&n.stopPropagation();const a=this.router.createUrlTree(["resources","resources-library",t.id.id]);this.router.navigateByUrl(a).then(()=>{})}downloadResource(n,t){n&&n.stopPropagation(),this.resourceService.downloadResource(t.id.id).subscribe()}copyResource(n,t,a){n&&n.stopPropagation();let o=("full"==a?location.protocol+"//"+location.hostname+":"+location.port:"")+"/api/content/public/"+t.fileName;this._clipboardService.copy(o),this.store.dispatch(new V.zi({message:"Resource link is copied to clipboard!",type:"success",duration:750,verticalPosition:"bottom",horizontalPosition:"right"}))}onResourceAction(n){switch(n.action){case"open":return this.openResource(n.event,n.entity),!0;case"downloadResource":return this.downloadResource(n.event,n.entity),!0}return!1}isResourceEditable(n,t){return t===u.W.TENANT_ADMIN?n&&n.tenantId&&n.tenantId.id!==P._:t===u.W.SYS_ADMIN}}st.\u0275fac=function(n){return new(n||st)(e.\u0275\u0275inject(x.Store),e.\u0275\u0275inject(Cd.z),e.\u0275\u0275inject(g.TranslateService),e.\u0275\u0275inject(b.Router),e.\u0275\u0275inject(he.Yv),e.\u0275\u0275inject(p.DatePipe))},st.\u0275prov=e.\u0275\u0275defineInjectable({token:st,factory:st.\u0275fac});var ee=c(62459);const te=(i,n,t)=>{switch(t.entitiesTableConfig.entityType){case f.py.TB_RESOURCE:case f.py.OTA_PACKAGE:return t.entity?.title;default:return t.entity?.name}};var so=c(1622),Pa=c(95332),lt=c(22426),Re=c(77176),Ad=c(34228);class Ti extends Te.r{constructor(n,t,a,o,s,l){super(n,l,a,o,s),this.store=n,this.translate=t,this.entityValue=a,this.entitiesTableConfigValue=o,this.cd=s,this.fb=l,this.entityType=f.py,this.submitStrategies=[],this.processingStrategies=[]}ngOnInit(){super.ngOnInit()}buildForm(n){return this.fb.group({queue:[n]})}hideDelete(){return!!this.entitiesTableConfig&&!this.entitiesTableConfig.deleteEnabled(this.entity)}updateForm(n){this.entityForm.patchValue({queue:n},{emitEvent:!1})}prepareFormValue(n){return super.prepareFormValue(n.queue)}onQueueIdCopied(n){this.store.dispatch(new V.zi({message:this.translate.instant("queue.idCopiedMessage"),type:"success",duration:750,verticalPosition:"bottom",horizontalPosition:"right"}))}}Ti.\u0275fac=function(n){return new(n||Ti)(e.\u0275\u0275directiveInject(x.Store),e.\u0275\u0275directiveInject(g.TranslateService),e.\u0275\u0275directiveInject("entity"),e.\u0275\u0275directiveInject("entitiesTableConfig"),e.\u0275\u0275directiveInject(e.ChangeDetectorRef),e.\u0275\u0275directiveInject(r.UntypedFormBuilder))},Ti.\u0275cmp=e.\u0275\u0275defineComponent({type:Ti,selectors:[["tb-queue"]],features:[e.\u0275\u0275InheritDefinitionFeature],decls:16,vars:19,consts:[["fxLayout.xs","column",1,"tb-details-buttons"],["mat-raised-button","","color","primary",3,"disabled","fxShow","click"],["mat-raised-button","","color","primary","fxFlex.xs","",3,"disabled","fxShow","click"],["fxLayout","row","fxLayout.xs","column"],["mat-raised-button","","ngxClipboard","",3,"cbContent","fxShow","cbOnSuccess"],["svgIcon","mdi:clipboard-arrow-left"],["translate",""],["fxLayout","column",1,"mat-padding",3,"formGroup"],["formControlName","queue",3,"newQueue","systemQueue"]],template:function(n,t){1&n&&(e.\u0275\u0275elementStart(0,"div",0)(1,"button",1),e.\u0275\u0275listener("click",function(o){return t.onEntityAction(o,"open")}),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275text(3),e.\u0275\u0275pipe(4,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"button",2),e.\u0275\u0275listener("click",function(o){return t.onEntityAction(o,"delete")}),e.\u0275\u0275pipe(6,"async"),e.\u0275\u0275text(7),e.\u0275\u0275pipe(8,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(9,"div",3)(10,"button",4),e.\u0275\u0275listener("cbOnSuccess",function(o){return t.onQueueIdCopied(o)}),e.\u0275\u0275element(11,"mat-icon",5),e.\u0275\u0275elementStart(12,"span",6),e.\u0275\u0275text(13,"queue.copyId"),e.\u0275\u0275elementEnd()()()(),e.\u0275\u0275elementStart(14,"div",7),e.\u0275\u0275element(15,"tb-queue-form",8),e.\u0275\u0275elementEnd()),2&n&&(e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(2,11,t.isLoading$))("fxShow",!t.isEdit&&!t.isDetailsPage),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(4,13,"common.open-details-page")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(6,15,t.isLoading$))("fxShow",!t.hideDelete()&&!t.isEdit),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(8,17,"queue.delete")," "),e.\u0275\u0275advance(3),e.\u0275\u0275property("cbContent",null==t.entity||null==t.entity.id?null:t.entity.id.id)("fxShow",!t.isEdit),e.\u0275\u0275advance(4),e.\u0275\u0275property("formGroup",t.entityForm),e.\u0275\u0275advance(1),e.\u0275\u0275property("newQueue",t.isAdd)("systemQueue",!0))},dependencies:[S.MatButton,F.MatIcon,he.yb,h.DefaultLayoutDirective,h.DefaultFlexDirective,G.DefaultShowHideDirective,r.NgControlStatus,r.NgControlStatusGroup,r.FormGroupDirective,r.FormControlName,g.TranslateDirective,Ad.QueueFormComponent,p.AsyncPipe,g.TranslatePipe],encapsulation:2});var Nd=c(27800);class dt{constructor(n,t,a,o,s,l,d,m){this.store=n,this.broadcast=t,this.queueService=a,this.customerService=o,this.dialogService=s,this.homeDialogs=l,this.router=d,this.translate=m,this.queueType=so.UW.TB_RULE_ENGINE,this.config=new v.ap,this.config.entityType=f.py.QUEUE,this.config.entityComponent=Ti,this.config.entityTranslations=f.Jr.get(f.py.QUEUE),this.config.entityResources=f.CZ.get(f.py.QUEUE),this.config.deleteEntityTitle=y=>this.translate.instant("queue.delete-queue-title",{queueName:y.name}),this.config.deleteEntityContent=()=>this.translate.instant("queue.delete-queue-text"),this.config.deleteEntitiesTitle=y=>this.translate.instant("queue.delete-queues-title",{count:y}),this.config.deleteEntitiesContent=()=>this.translate.instant("queue.delete-queues-text"),this.config.onEntityAction=y=>this.onQueueAction(y)}resolve(n){return this.config.componentsData={queueType:this.queueType},this.store.pipe((0,x.select)(q.rk),(0,Re.q)(1)).pipe((0,re.U)(()=>(this.config.tableTitle=this.translate.instant("admin.queues"),this.config.columns=this.configureColumns(),this.configureEntityFunctions(),this.config)))}configureColumns(){return[new v.QI("name","admin.queue-name","25%"),new v.QI("partitions","admin.queue-partitions","25%"),new v.QI("submitStrategy","admin.queue-submit-strategy","25%",n=>this.translate.instant(so.At.get(n.submitStrategy.type).label),()=>({}),!1),new v.QI("processingStrategy","admin.queue-processing-strategy","25%",n=>this.translate.instant(so.oG.get(n.processingStrategy.type).label),()=>({}),!1)]}configureEntityFunctions(){this.config.entitiesFetchFunction=n=>this.queueService.getTenantQueuesByServiceType(n,this.queueType),this.config.loadEntity=n=>this.queueService.getQueueById(n.id),this.config.saveEntity=n=>this.queueService.saveQueue(n,this.queueType).pipe((0,ne.z)(t=>this.queueService.getQueueById(t.id.id))),this.config.deleteEntity=n=>this.queueService.deleteQueue(n.id),this.config.deleteEnabled=n=>n&&"Main"!==n.name,this.config.entitySelectionEnabled=n=>n&&"Main"!==n.name}onQueueAction(n){return"open"===n.action&&(this.openQueue(n.event,n.entity),!0)}openQueue(n,t){n&&n.stopPropagation();const a=this.router.createUrlTree(["settings","queues",t.id.id]);this.router.navigateByUrl(a)}}dt.\u0275fac=function(n){return new(n||dt)(e.\u0275\u0275inject(x.Store),e.\u0275\u0275inject(Pa.M),e.\u0275\u0275inject(Nd.g),e.\u0275\u0275inject($e.v),e.\u0275\u0275inject(pe.x),e.\u0275\u0275inject(lt.U),e.\u0275\u0275inject(b.Router),e.\u0275\u0275inject(g.TranslateService))},dt.\u0275prov=e.\u0275\u0275defineInjectable({token:dt,factory:dt.\u0275fac});var Ao=c(57348);const Fd=["repositorySettingsComponent"];class Si extends se.I{constructor(n){super(n),this.store=n}ngOnInit(){}confirmForm(){return this.repositorySettingsComponent?.repositorySettingsForm}}Si.\u0275fac=function(n){return new(n||Si)(e.\u0275\u0275directiveInject(x.Store))},Si.\u0275cmp=e.\u0275\u0275defineComponent({type:Si,selectors:[["tb-repository-admin-settings"]],viewQuery:function(n,t){if(1&n&&e.\u0275\u0275viewQuery(Fd,5),2&n){let a;e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(t.repositorySettingsComponent=a.first)}},features:[e.\u0275\u0275InheritDefinitionFeature],decls:2,vars:0,consts:[["repositorySettingsComponent",""]],template:function(n,t){1&n&&e.\u0275\u0275element(0,"tb-repository-settings",null,0)},dependencies:[Ao.y],encapsulation:2});var Ld=c(74463);const Pd=["repositorySettingsComponent"],kd=["autoCommitSettingsComponent"];function Rd(i,n){1&i&&e.\u0275\u0275element(0,"tb-repository-settings",null,2)}function Od(i,n){1&i&&e.\u0275\u0275element(0,"tb-auto-commit-settings",null,3)}class Ii extends se.I{constructor(n){super(n),this.store=n,this.hasRepository$=this.store.pipe((0,x.select)(q.yu))}ngOnInit(){}confirmForm(){return this.repositorySettingsComponent?this.repositorySettingsComponent?.repositorySettingsForm:this.autoCommitSettingsComponent?.autoCommitSettingsForm}}Ii.\u0275fac=function(n){return new(n||Ii)(e.\u0275\u0275directiveInject(x.Store))},Ii.\u0275cmp=e.\u0275\u0275defineComponent({type:Ii,selectors:[["tb-auto-commit-admin-settings"]],viewQuery:function(n,t){if(1&n&&(e.\u0275\u0275viewQuery(Pd,5),e.\u0275\u0275viewQuery(kd,5)),2&n){let a;e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(t.repositorySettingsComponent=a.first),e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(t.autoCommitSettingsComponent=a.first)}},features:[e.\u0275\u0275InheritDefinitionFeature],decls:4,vars:4,consts:[[4,"ngIf","ngIfElse"],["autoCommitSettings",""],["repositorySettingsComponent",""],["autoCommitSettingsComponent",""]],template:function(n,t){if(1&n&&(e.\u0275\u0275template(0,Rd,2,0,"tb-repository-settings",0),e.\u0275\u0275pipe(1,"async"),e.\u0275\u0275template(2,Od,2,0,"ng-template",null,1,e.\u0275\u0275templateRefExtractor)),2&n){const a=e.\u0275\u0275reference(3);e.\u0275\u0275property("ngIf",!e.\u0275\u0275pipeBind1(1,2,t.hasRepository$))("ngIfElse",a)}},dependencies:[p.NgIf,Ao.y,Ld.l,p.AsyncPipe],encapsulation:2});var Pn=c(19464),W=c(1157),kn=c(72589);function Bd(i,n){1&i&&e.\u0275\u0275element(0,"mat-progress-bar",25)}function Vd(i,n){1&i&&e.\u0275\u0275element(0,"div",26)}function Ud(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.2fa.issuer-name-required")," "))}function Gd(i,n){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"mat-form-field",13)(2,"mat-label",14),e.\u0275\u0275text(3,"admin.2fa.issuer-name"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(4,"input",32),e.\u0275\u0275template(5,Ud,3,3,"mat-error",16),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()),2&i){const t=e.\u0275\u0275nextContext(2).$implicit;e.\u0275\u0275advance(5),e.\u0275\u0275property("ngIf",t.get("issuerName").hasError("required")||t.get("issuerName").hasError("pattern"))}}function jd(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.2fa.verification-message-template-required")," "))}function Wd(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.2fa.verification-message-template-pattern")," "))}function qd(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.2fa.verification-code-lifetime-required")," "))}function $d(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.2fa.verification-code-lifetime-pattern")," "))}function Hd(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",33)(1,"mat-form-field",13)(2,"mat-label",14),e.\u0275\u0275text(3,"admin.2fa.verification-message-template"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(4,"input",34),e.\u0275\u0275template(5,jd,3,3,"mat-error",16),e.\u0275\u0275template(6,Wd,3,3,"mat-error",16),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(7,"mat-form-field",13)(8,"mat-label",14),e.\u0275\u0275text(9,"admin.2fa.verification-code-lifetime"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(10,"input",35),e.\u0275\u0275template(11,qd,3,3,"mat-error",16),e.\u0275\u0275template(12,$d,3,3,"mat-error",16),e.\u0275\u0275elementEnd()()),2&i){const t=e.\u0275\u0275nextContext(2).$implicit;e.\u0275\u0275advance(5),e.\u0275\u0275property("ngIf",t.get("smsVerificationMessageTemplate").hasError("required")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.get("smsVerificationMessageTemplate").hasError("pattern")),e.\u0275\u0275advance(5),e.\u0275\u0275property("ngIf",t.get("verificationCodeLifetime").hasError("required")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.get("verificationCodeLifetime").hasError("min")||t.get("verificationCodeLifetime").hasError("pattern"))}}function zd(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.2fa.verification-code-lifetime-required")," "))}function Kd(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.2fa.verification-code-lifetime-pattern")," "))}function Yd(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div")(1,"mat-form-field",13)(2,"mat-label",14),e.\u0275\u0275text(3,"admin.2fa.verification-code-lifetime"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(4,"input",35),e.\u0275\u0275template(5,zd,3,3,"mat-error",16),e.\u0275\u0275template(6,Kd,3,3,"mat-error",16),e.\u0275\u0275elementEnd()()),2&i){const t=e.\u0275\u0275nextContext(2).$implicit;e.\u0275\u0275advance(5),e.\u0275\u0275property("ngIf",t.get("verificationCodeLifetime").hasError("required")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.get("verificationCodeLifetime").hasError("min")||t.get("verificationCodeLifetime").hasError("pattern"))}}function Jd(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.2fa.number-of-codes-required")," "))}function Qd(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.2fa.number-of-codes-pattern")," "))}function Xd(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div")(1,"mat-form-field",13)(2,"mat-label",14),e.\u0275\u0275text(3,"admin.2fa.number-of-codes"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(4,"input",36),e.\u0275\u0275template(5,Jd,3,3,"mat-error",16),e.\u0275\u0275template(6,Qd,3,3,"mat-error",16),e.\u0275\u0275elementEnd()()),2&i){const t=e.\u0275\u0275nextContext(2).$implicit;e.\u0275\u0275advance(5),e.\u0275\u0275property("ngIf",t.get("codesQuantity").hasError("required")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.get("codesQuantity").hasError("min")||t.get("codesQuantity").hasError("pattern"))}}function Zd(i,n){if(1&i&&(e.\u0275\u0275elementContainerStart(0,29),e.\u0275\u0275template(1,Gd,6,1,"ng-container",30),e.\u0275\u0275template(2,Hd,13,4,"div",31),e.\u0275\u0275template(3,Yd,7,2,"div",30),e.\u0275\u0275template(4,Xd,7,2,"div",30),e.\u0275\u0275elementContainerEnd()),2&i){const t=e.\u0275\u0275nextContext().$implicit,a=e.\u0275\u0275nextContext();e.\u0275\u0275property("ngSwitch",t.get("providerType").value),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase",a.twoFactorAuthProviderType.TOTP),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase",a.twoFactorAuthProviderType.SMS),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase",a.twoFactorAuthProviderType.EMAIL),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase",a.twoFactorAuthProviderType.BACKUP_CODE)}}function ec(i,n){1&i&&e.\u0275\u0275element(0,"mat-divider")}function tc(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"mat-expansion-panel",27)(2,"mat-expansion-panel-header")(3,"mat-panel-title",20)(4,"mat-slide-toggle",28),e.\u0275\u0275listener("mousedown",function(o){const s=e.\u0275\u0275restoreView(t),l=s.index,d=s.$implicit,m=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(m.toggleExtensionPanel(o,l,d.get("enable").value))}),e.\u0275\u0275text(5),e.\u0275\u0275pipe(6,"translate"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275template(7,Zd,5,5,"ng-template",22),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(8,ec,1,0,"mat-divider",16),e.\u0275\u0275elementContainerEnd()}if(2&i){const t=n.$implicit,a=n.index,o=n.last,s=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("formGroupName",a),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(6,3,s.twoFactorAuthProvidersData.get(t.value.providerType).name)," "),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",!o)}}function nc(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.2fa.total-allowed-time-for-verification-required")," "))}function ic(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.2fa.total-allowed-time-for-verification-pattern")," "))}function ac(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.2fa.retry-verification-code-period-required")," "))}function oc(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.2fa.retry-verification-code-period-pattern")," "))}function rc(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.2fa.max-verification-failures-before-user-lockout-pattern")," "))}function sc(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.2fa.number-of-checking-attempts-required")," "))}function lc(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.2fa.number-of-checking-attempts-pattern")," "))}function dc(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.2fa.within-time-required")," "))}function cc(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"admin.2fa.within-time-pattern")," "))}function pc(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",33)(1,"mat-form-field",13)(2,"mat-label",14),e.\u0275\u0275text(3,"admin.2fa.number-of-checking-attempts"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(4,"input",37),e.\u0275\u0275template(5,sc,3,3,"mat-error",16),e.\u0275\u0275template(6,lc,3,3,"mat-error",16),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(7,"mat-form-field",13)(8,"mat-label",14),e.\u0275\u0275text(9,"admin.2fa.within-time"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(10,"input",38),e.\u0275\u0275template(11,dc,3,3,"mat-error",16),e.\u0275\u0275template(12,cc,3,3,"mat-error",16),e.\u0275\u0275elementEnd()()),2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(5),e.\u0275\u0275property("ngIf",t.twoFaFormGroup.get("verificationCodeCheckRateLimitNumber").hasError("required")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.twoFaFormGroup.get("verificationCodeCheckRateLimitNumber").hasError("pattern")||t.twoFaFormGroup.get("verificationCodeCheckRateLimitNumber").hasError("min")),e.\u0275\u0275advance(5),e.\u0275\u0275property("ngIf",t.twoFaFormGroup.get("verificationCodeCheckRateLimitTime").hasError("required")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.twoFaFormGroup.get("verificationCodeCheckRateLimitTime").hasError("pattern")||t.twoFaFormGroup.get("verificationCodeCheckRateLimitTime").hasError("min"))}}class wi extends se.I{constructor(n,t,a){super(n),this.store=n,this.twoFaService=t,this.fb=a,this.destroy$=new be.x,this.posIntValidation=[r.Validators.required,r.Validators.min(1),r.Validators.pattern(/^\d*$/)],this.twoFactorAuthProviderType=W.hs,this.twoFactorAuthProvidersData=W.Zc}ngOnInit(){this.build2faSettingsForm(),this.twoFaService.getTwoFaSettings().subscribe(n=>{this.setAuthConfigFormValue(n)})}ngOnDestroy(){super.ngOnDestroy(),this.destroy$.next(),this.destroy$.complete()}confirmForm(){return this.twoFaFormGroup}save(){if(this.twoFaFormGroup.valid){const n=this.twoFaFormGroup.getRawValue();this.joinRateLimit(n,"verificationCodeCheckRateLimit");const t=n.providers.filter(o=>o.enable);t.forEach(o=>delete o.enable);const a=Object.assign(n,{providers:t});this.twoFaService.saveTwoFaSettings(a).subscribe(o=>{this.setAuthConfigFormValue(o),this.twoFaFormGroup.markAsUntouched(),this.twoFaFormGroup.markAsPristine()})}else Object.keys(this.twoFaFormGroup.controls).forEach(n=>{this.twoFaFormGroup.get(n).markAsTouched({onlySelf:!0})})}toggleExtensionPanel(n,t,a){n&&n.stopPropagation(),a?this.getByIndexPanel(t).open():this.getByIndexPanel(t).close()}trackByElement(n,t){return t}get providersForm(){return this.twoFaFormGroup.get("providers")}build2faSettingsForm(){this.twoFaFormGroup=this.fb.group({maxVerificationFailuresBeforeUserLockout:[30,[r.Validators.pattern(/^\d*$/),r.Validators.min(0),r.Validators.max(65535)]],totalAllowedTimeForVerification:[3600,[r.Validators.required,r.Validators.min(60),r.Validators.pattern(/^\d*$/)]],verificationCodeCheckRateLimitEnable:[!1],verificationCodeCheckRateLimitNumber:[{value:3,disabled:!0},this.posIntValidation],verificationCodeCheckRateLimitTime:[{value:900,disabled:!0},this.posIntValidation],minVerificationCodeSendPeriod:["30",[r.Validators.required,r.Validators.min(5),r.Validators.pattern(/^\d*$/)]],providers:this.fb.array([])}),Object.values(W.hs).forEach(n=>{this.buildProvidersSettingsForm(n)}),this.twoFaFormGroup.get("verificationCodeCheckRateLimitEnable").valueChanges.pipe((0,Y.R)(this.destroy$)).subscribe(n=>{n?(this.twoFaFormGroup.get("verificationCodeCheckRateLimitNumber").enable({emitEvent:!1}),this.twoFaFormGroup.get("verificationCodeCheckRateLimitTime").enable({emitEvent:!1})):(this.twoFaFormGroup.get("verificationCodeCheckRateLimitNumber").disable({emitEvent:!1}),this.twoFaFormGroup.get("verificationCodeCheckRateLimitTime").disable({emitEvent:!1}))}),this.providersForm.valueChanges.pipe((0,Y.R)(this.destroy$)).subscribe(n=>{const t=n.filter(o=>o.enable),a=Object.values(W.hs).indexOf(W.hs.BACKUP_CODE);!t.length||1===t.length&&t[0].providerType===W.hs.BACKUP_CODE?(this.providersForm.at(a).get("enable").setValue(!1,{emitEvent:!1}),this.providersForm.at(a).disable({emitEvent:!1}),this.providersForm.at(a).get("providerType").enable({emitEvent:!1})):this.providersForm.at(a).get("enable").enable({emitEvent:!1})})}setAuthConfigFormValue(n){const[t,a]=this.splitRateLimit(n?.verificationCodeCheckRateLimit),o=n?.providers.map(l=>l.providerType)||[],s=Object.assign({},n,{verificationCodeCheckRateLimitEnable:t>0,verificationCodeCheckRateLimitNumber:t||3,verificationCodeCheckRateLimitTime:a||900,providers:[]});t>0&&this.getByIndexPanel(this.providersForm.length).open(),Object.values(W.hs).forEach((l,d)=>{const m=o.indexOf(l);m>-1?(s.providers.push(Object.assign(n.providers[m],{enable:!0})),this.getByIndexPanel(d).open()):s.providers.push({enable:!1})}),this.twoFaFormGroup.patchValue(s)}buildProvidersSettingsForm(n){const t={providerType:[n],enable:[!1]};switch(n){case W.hs.TOTP:t.issuerName=[{value:"ThingsBoard",disabled:!0},[r.Validators.required,r.Validators.pattern(/^(?!^\s+$).*$/)]];break;case W.hs.SMS:t.smsVerificationMessageTemplate=[{value:"Verification code: ${code}",disabled:!0},[r.Validators.required,r.Validators.pattern(/\${code}/)]],t.verificationCodeLifetime=[{value:120,disabled:!0},this.posIntValidation];break;case W.hs.EMAIL:t.verificationCodeLifetime=[{value:120,disabled:!0},this.posIntValidation];break;case W.hs.BACKUP_CODE:t.codesQuantity=[{value:10,disabled:!0},this.posIntValidation]}const a=this.fb.group(t);a.get("enable").valueChanges.pipe((0,Y.R)(this.destroy$)).subscribe(o=>{o?a.enable({emitEvent:!1}):(a.disable({emitEvent:!1}),a.get("enable").enable({emitEvent:!1}),a.get("providerType").enable({emitEvent:!1}))}),this.providersForm.push(a,{emitEvent:!1})}getByIndexPanel(n){return this.expansionPanel.find((t,a)=>a===n)}splitRateLimit(n){if((0,T.XE)(n)){const[t,a]=n.split(":");return[parseInt(t,10),parseInt(a,10)]}return[0,0]}joinRateLimit(n,t){n[`${t}Enable`]&&(n[t]=[n[`${t}Number`],n[`${t}Time`]].join(":")),delete n[`${t}Enable`],delete n[`${t}Number`],delete n[`${t}Time`]}}wi.\u0275fac=function(n){return new(n||wi)(e.\u0275\u0275directiveInject(x.Store),e.\u0275\u0275directiveInject(Pn.b),e.\u0275\u0275directiveInject(r.UntypedFormBuilder))},wi.\u0275cmp=e.\u0275\u0275defineComponent({type:wi,selectors:[["tb-2fa-settings"]],viewQuery:function(n,t){if(1&n&&e.\u0275\u0275viewQuery(U.MatExpansionPanel,5),2&n){let a;e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(t.expansionPanel=a)}},features:[e.\u0275\u0275InheritDefinitionFeature],decls:54,vars:26,consts:[["appearance","outlined",1,"settings-card"],["translate","",1,"mat-headline-5"],["fxFlex",""],["tb-help","twoFactorAuthentication"],["color","warn","mode","indeterminate",4,"ngIf"],["style","height: 4px;",4,"ngIf"],[3,"formGroup","ngSubmit"],[3,"disabled"],["formArrayName","providers",1,"fields-group"],["translate","",1,"group-title"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"fields-group"],["fxLayout","row","fxLayout.xs","column","fxLayoutGap.gt-xs","8px",1,"input-row"],["fxFlex","",1,"mat-block"],["translate",""],["matInput","","required","","formControlName","totalAllowedTimeForVerification","type","number","step","1","min","60"],[4,"ngIf"],["matInput","","required","","formControlName","minVerificationCodeSendPeriod","type","number","step","1","min","5"],["matInput","","formControlName","maxVerificationFailuresBeforeUserLockout","type","number","step","1","min","0","max","65535"],[1,"provider"],["fxLayoutAlign","start center"],["formControlName","verificationCodeCheckRateLimitEnable",3,"mousedown"],["matExpansionPanelContent",""],["fxLayout","row","fxLayoutAlign","end center","fxLayoutGap","8px"],["mat-button","","mat-raised-button","","color","primary","type","submit",3,"disabled"],["color","warn","mode","indeterminate"],[2,"height","4px"],[1,"provider",3,"formGroupName"],["formControlName","enable",3,"mousedown"],[3,"ngSwitch"],[4,"ngSwitchCase"],["fxLayout","row","fxLayout.xs","column","fxLayoutGap.gt-xs","8px",4,"ngSwitchCase"],["matInput","","formControlName","issuerName","required",""],["fxLayout","row","fxLayout.xs","column","fxLayoutGap.gt-xs","8px"],["matInput","","formControlName","smsVerificationMessageTemplate","required",""],["matInput","","formControlName","verificationCodeLifetime","type","number","step","1","min","1","required",""],["matInput","","formControlName","codesQuantity","type","number","step","1","min","1","required",""],["matInput","","formControlName","verificationCodeCheckRateLimitNumber","required","","type","number","step","1","min","1"],["matInput","","formControlName","verificationCodeCheckRateLimitTime","required","","type","number","step","1","min","1"]],template:function(n,t){1&n&&(e.\u0275\u0275elementStart(0,"div")(1,"mat-card",0)(2,"mat-card-header")(3,"mat-card-title")(4,"span",1),e.\u0275\u0275text(5,"admin.2fa.2fa"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275element(6,"span",2)(7,"div",3),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(8,Bd,1,0,"mat-progress-bar",4),e.\u0275\u0275pipe(9,"async"),e.\u0275\u0275template(10,Vd,1,0,"div",5),e.\u0275\u0275pipe(11,"async"),e.\u0275\u0275elementStart(12,"mat-card-content")(13,"form",6),e.\u0275\u0275listener("ngSubmit",function(){return t.save()}),e.\u0275\u0275elementStart(14,"fieldset",7),e.\u0275\u0275pipe(15,"async"),e.\u0275\u0275elementStart(16,"div")(17,"fieldset",8)(18,"legend",9),e.\u0275\u0275text(19,"admin.2fa.available-providers"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(20,tc,9,5,"ng-container",10),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(21,"fieldset",11)(22,"legend",9),e.\u0275\u0275text(23,"admin.2fa.verification-limitations"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(24,"div",12)(25,"mat-form-field",13)(26,"mat-label",14),e.\u0275\u0275text(27,"admin.2fa.total-allowed-time-for-verification"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(28,"input",15),e.\u0275\u0275template(29,nc,3,3,"mat-error",16),e.\u0275\u0275template(30,ic,3,3,"mat-error",16),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(31,"mat-form-field",13)(32,"mat-label",14),e.\u0275\u0275text(33,"admin.2fa.retry-verification-code-period"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(34,"input",17),e.\u0275\u0275template(35,ac,3,3,"mat-error",16),e.\u0275\u0275template(36,oc,3,3,"mat-error",16),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(37,"mat-form-field",13)(38,"mat-label",14),e.\u0275\u0275text(39,"admin.2fa.max-verification-failures-before-user-lockout"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(40,"input",18),e.\u0275\u0275template(41,rc,3,3,"mat-error",16),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(42,"mat-expansion-panel",19)(43,"mat-expansion-panel-header")(44,"mat-panel-title",20)(45,"mat-slide-toggle",21),e.\u0275\u0275listener("mousedown",function(o){return t.toggleExtensionPanel(o,t.providersForm.length,t.twoFaFormGroup.get("verificationCodeCheckRateLimitEnable").value)}),e.\u0275\u0275elementEnd(),e.\u0275\u0275text(46),e.\u0275\u0275pipe(47,"translate"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(48,pc,13,4,"ng-template",22),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(49,"div",23)(50,"button",24),e.\u0275\u0275pipe(51,"async"),e.\u0275\u0275text(52),e.\u0275\u0275pipe(53,"translate"),e.\u0275\u0275elementEnd()()()()()()()),2&n&&(e.\u0275\u0275advance(8),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(9,14,t.isLoading$)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!e.\u0275\u0275pipeBind1(11,16,t.isLoading$)),e.\u0275\u0275advance(3),e.\u0275\u0275property("formGroup",t.twoFaFormGroup),e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(15,18,t.isLoading$)),e.\u0275\u0275advance(6),e.\u0275\u0275property("ngForOf",t.providersForm.controls)("ngForTrackBy",t.trackByElement),e.\u0275\u0275advance(9),e.\u0275\u0275property("ngIf",t.twoFaFormGroup.get("totalAllowedTimeForVerification").hasError("required")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.twoFaFormGroup.get("totalAllowedTimeForVerification").hasError("pattern")||t.twoFaFormGroup.get("totalAllowedTimeForVerification").hasError("min")),e.\u0275\u0275advance(5),e.\u0275\u0275property("ngIf",t.twoFaFormGroup.get("minVerificationCodeSendPeriod").hasError("required")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.twoFaFormGroup.get("minVerificationCodeSendPeriod").hasError("pattern")||t.twoFaFormGroup.get("minVerificationCodeSendPeriod").hasError("min")),e.\u0275\u0275advance(5),e.\u0275\u0275property("ngIf",t.twoFaFormGroup.get("maxVerificationFailuresBeforeUserLockout").hasError("pattern")||t.twoFaFormGroup.get("maxVerificationFailuresBeforeUserLockout").hasError("min")||t.twoFaFormGroup.get("maxVerificationFailuresBeforeUserLockout").hasError("max")),e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(47,20,"admin.2fa.verification-code-check-rate-limit")," "),e.\u0275\u0275advance(4),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(51,22,t.isLoading$)||t.twoFaFormGroup.invalid||!t.twoFaFormGroup.dirty),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(53,24,"action.save")," "))},dependencies:[p.NgForOf,p.NgIf,p.NgSwitch,p.NgSwitchCase,De.HelpComponent,S.MatButton,A.MatCard,A.MatCardContent,A.MatCardHeader,A.MatCardTitle,z.MatProgressBar,O.MatInput,_.MatFormField,_.MatLabel,_.MatError,kn.MatDivider,Ce.MatSlideToggle,U.MatExpansionPanel,U.MatExpansionPanelHeader,U.MatExpansionPanelTitle,U.MatExpansionPanelContent,h.DefaultLayoutDirective,h.DefaultLayoutGapDirective,h.DefaultLayoutAlignDirective,h.DefaultFlexDirective,r.\u0275NgNoValidate,r.DefaultValueAccessor,r.NumberValueAccessor,r.NgControlStatus,r.NgControlStatusGroup,r.RequiredValidator,r.MinValidator,r.MaxValidator,r.FormGroupDirective,r.FormControlName,r.FormGroupName,r.FormArrayName,g.TranslateDirective,p.AsyncPipe,g.TranslatePipe],styles:['@charset "UTF-8";[_nghost-%COMP%]   .mat-mdc-card.settings-card[_ngcontent-%COMP%]{margin:8px}[_nghost-%COMP%]   .mat-mdc-card.settings-card[_ngcontent-%COMP%]   .fields-group[_ngcontent-%COMP%]{padding:0 16px 8px;margin:10px 0;border:1px groove #7c7c7c;border-radius:4px}@media screen and (min-width: 960px) and (max-width: 1279px){[_nghost-%COMP%]   .mat-mdc-card.settings-card[_ngcontent-%COMP%]{width:80%}}@media screen and (min-width: 1280px){[_nghost-%COMP%]   .mat-mdc-card.settings-card[_ngcontent-%COMP%]{width:60%}}','@charset "UTF-8";@media screen and (min-width: 960px) and (max-width: 1279px){[_nghost-%COMP%]   .mat-mdc-card.settings-card[_ngcontent-%COMP%]{width:90%}}[_nghost-%COMP%]   .mat-mdc-card.settings-card[_ngcontent-%COMP%]   .fields-group[_ngcontent-%COMP%]{margin:8px 0;border:1px groove rgba(0,0,0,.25);border-radius:4px;position:relative;padding-bottom:8px}[_nghost-%COMP%]   .mat-mdc-card.settings-card[_ngcontent-%COMP%]   .fields-group[_ngcontent-%COMP%]   legend[_ngcontent-%COMP%]{color:#000000b3;width:-moz-fit-content;width:fit-content;margin:0 8px}[_nghost-%COMP%]   .mat-mdc-card.settings-card[_ngcontent-%COMP%]   .fields-group[_ngcontent-%COMP%]   .input-row[_ngcontent-%COMP%]{padding:8px 8px 0}[_nghost-%COMP%]   .mat-mdc-card.settings-card[_ngcontent-%COMP%]   .fields-group[_ngcontent-%COMP%]:last-of-type{margin-bottom:24px}[_nghost-%COMP%]   .mat-mdc-card.settings-card[_ngcontent-%COMP%]   .mat-expansion-panel[_ngcontent-%COMP%]{box-shadow:none;margin:1px 0 0}[_nghost-%COMP%]   .mat-mdc-card.settings-card[_ngcontent-%COMP%]   .mat-expansion-panel.provider[_ngcontent-%COMP%]{overflow:inherit}[_nghost-%COMP%]   .mat-mdc-card.settings-card[_ngcontent-%COMP%]   .mat-expansion-panel.provider[_ngcontent-%COMP%]   .mat-expansion-panel-header[_ngcontent-%COMP%]{padding:0 24px 0 8px}[_nghost-%COMP%]   .mat-mdc-card.settings-card[_ngcontent-%COMP%]   .mat-expansion-panel.provider[_ngcontent-%COMP%]   .mat-expansion-panel-header.mat-expanded[_ngcontent-%COMP%]{height:48px}[_nghost-%COMP%]   .mat-mdc-card.settings-card[_ngcontent-%COMP%]   .mat-expansion-panel.provider[_ngcontent-%COMP%]   .mat-expansion-panel-header[_ngcontent-%COMP%]   .mat-mdc-slide-toggle[_ngcontent-%COMP%]{margin-right:8px}[_nghost-%COMP%]   .mat-mdc-card.settings-card[_ngcontent-%COMP%]   .mat-expansion-panel.provider[_ngcontent-%COMP%]   .mat-expansion-panel-header-title[_ngcontent-%COMP%]{height:40px}[_nghost-%COMP%]     .mat-mdc-form-field .mat-mdc-form-field-infix{width:100%}[_nghost-%COMP%]     .mat-expansion-panel .mat-expansion-panel-content{font-size:16px}[_nghost-%COMP%]     .mat-expansion-panel.provider .mat-expansion-panel-header>.mat-content{overflow:inherit}[_nghost-%COMP%]     .mat-expansion-panel.provider .mat-expansion-panel-body{padding:0 16px 8px 8px}']});var ze=c(80923),lo=c(16682);function mc(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"widgets-bundle.title-required")," "))}function uc(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"widgets-bundle.title-max-length")," "))}class Ei extends Te.r{constructor(n,t,a,o,s){super(n,o,t,a,s),this.store=n,this.entityValue=t,this.entitiesTableConfigValue=a,this.fb=o,this.cd=s}hideDelete(){return!!this.entitiesTableConfig&&!this.entitiesTableConfig.deleteEnabled(this.entity)}buildForm(n){return this.fb.group({title:[n?n.title:"",[r.Validators.required,r.Validators.maxLength(255)]],image:[n?n.image:""],description:[n?n.description:"",r.Validators.maxLength(1024)],order:[n?n.order:null]})}updateForm(n){this.entityForm.patchValue({title:n.title,image:n.image,description:n.description,order:n.order})}}Ei.\u0275fac=function(n){return new(n||Ei)(e.\u0275\u0275directiveInject(x.Store),e.\u0275\u0275directiveInject("entity"),e.\u0275\u0275directiveInject("entitiesTableConfig"),e.\u0275\u0275directiveInject(r.UntypedFormBuilder),e.\u0275\u0275directiveInject(e.ChangeDetectorRef))},Ei.\u0275cmp=e.\u0275\u0275defineComponent({type:Ei,selectors:[["tb-widgets-bundle"]],features:[e.\u0275\u0275InheritDefinitionFeature],decls:40,vars:38,consts:[["fxLayout.xs","column",1,"tb-details-buttons"],["mat-raised-button","","color","primary",3,"disabled","fxShow","click"],["fxLayout","column",1,"mat-padding"],[3,"formGroup"],[3,"disabled"],[1,"mat-block"],["translate",""],["matInput","","formControlName","title","required",""],[4,"ngIf"],["fxFlex","","formControlName","image",3,"label"],["matInput","","formControlName","description","rows","2","maxlength","1024"],["descriptionInput",""],["align","end"],["matInput","","type","number","step","1","formControlName","order"]],template:function(n,t){if(1&n&&(e.\u0275\u0275elementStart(0,"div",0)(1,"button",1),e.\u0275\u0275listener("click",function(o){return t.onEntityAction(o,"open")}),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275text(3),e.\u0275\u0275pipe(4,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"button",1),e.\u0275\u0275listener("click",function(o){return t.onEntityAction(o,"openDetails")}),e.\u0275\u0275pipe(6,"async"),e.\u0275\u0275text(7),e.\u0275\u0275pipe(8,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(9,"button",1),e.\u0275\u0275listener("click",function(o){return t.onEntityAction(o,"export")}),e.\u0275\u0275pipe(10,"async"),e.\u0275\u0275text(11),e.\u0275\u0275pipe(12,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(13,"button",1),e.\u0275\u0275listener("click",function(o){return t.onEntityAction(o,"delete")}),e.\u0275\u0275pipe(14,"async"),e.\u0275\u0275text(15),e.\u0275\u0275pipe(16,"translate"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(17,"div",2)(18,"form",3)(19,"fieldset",4),e.\u0275\u0275pipe(20,"async"),e.\u0275\u0275elementStart(21,"mat-form-field",5)(22,"mat-label",6),e.\u0275\u0275text(23,"widgets-bundle.title"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(24,"input",7),e.\u0275\u0275template(25,mc,3,3,"mat-error",8),e.\u0275\u0275template(26,uc,3,3,"mat-error",8),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(27,"tb-gallery-image-input",9),e.\u0275\u0275pipe(28,"translate"),e.\u0275\u0275elementStart(29,"mat-form-field",5)(30,"mat-label",6),e.\u0275\u0275text(31,"widgets-bundle.description"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(32,"textarea",10,11),e.\u0275\u0275elementStart(34,"mat-hint",12),e.\u0275\u0275text(35),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(36,"mat-form-field",5)(37,"mat-label",6),e.\u0275\u0275text(38,"widgets-bundle.order"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(39,"input",13),e.\u0275\u0275elementEnd()()()()),2&n){const a=e.\u0275\u0275reference(33);e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(2,18,t.isLoading$))("fxShow",!t.isEdit),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(4,20,"widgets-bundle.open-widgets-bundle")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(6,22,t.isLoading$))("fxShow",!t.isEdit&&!t.isDetailsPage),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(8,24,"common.open-details-page")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(10,26,t.isLoading$))("fxShow",!t.isEdit),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(12,28,"widgets-bundle.export")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(14,30,t.isLoading$))("fxShow",!t.hideDelete()&&!t.isEdit),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(16,32,"widgets-bundle.delete")," "),e.\u0275\u0275advance(3),e.\u0275\u0275property("formGroup",t.entityForm),e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(20,34,t.isLoading$)||!t.isEdit),e.\u0275\u0275advance(6),e.\u0275\u0275property("ngIf",t.entityForm.get("title").hasError("required")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.entityForm.get("title").hasError("maxlength")),e.\u0275\u0275advance(1),e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(28,36,"widgets-bundle.image-preview")),e.\u0275\u0275advance(8),e.\u0275\u0275textInterpolate1("",(null==a.value?null:a.value.length)||0,"/1024")}},dependencies:[p.NgIf,S.MatButton,O.MatInput,_.MatFormField,_.MatLabel,_.MatHint,_.MatError,h.DefaultLayoutDirective,h.DefaultFlexDirective,G.DefaultShowHideDirective,r.\u0275NgNoValidate,r.DefaultValueAccessor,r.NumberValueAccessor,r.NgControlStatus,r.NgControlStatusGroup,r.RequiredValidator,r.MaxLengthValidator,r.FormGroupDirective,r.FormControlName,g.TranslateDirective,lo.GalleryImageInputComponent,p.AsyncPipe,g.TranslatePipe],styles:['@charset "UTF-8";']});var ct=c(42421),pt=c(64230),_e=c(5825),Ae=c(98361);function gc(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"mat-tab",1,2),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementStart(3,"tb-version-control",3),e.\u0275\u0275listener("versionRestored",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.entitiesTableConfig.updateData())}),e.\u0275\u0275elementEnd()()}if(2&i){const t=e.\u0275\u0275reference(1),a=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(2,5,"version-control.version-control")),e.\u0275\u0275advance(3),e.\u0275\u0275property("active",t.isActive)("entityId",a.entity.id)("entityName",a.entity.title)("externalEntityId",a.entity.externalId||a.entity.id)}}class Mi extends _e.l{constructor(n){super(n),this.store=n}isTenantWidgetsBundle(){return this.entity&&this.entity.tenantId.id!==P._}ngOnInit(){super.ngOnInit()}}Mi.\u0275fac=function(n){return new(n||Mi)(e.\u0275\u0275directiveInject(x.Store))},Mi.\u0275cmp=e.\u0275\u0275defineComponent({type:Mi,selectors:[["tb-widgets-bundle-tabs"]],features:[e.\u0275\u0275InheritDefinitionFeature],decls:1,vars:1,consts:[[3,"label",4,"ngIf"],[3,"label"],["versionControlTab","matTab"],["detailsMode","true","singleEntityMode","true",3,"active","entityId","entityName","externalEntityId","versionRestored"]],template:function(n,t){1&n&&e.\u0275\u0275template(0,gc,4,7,"mat-tab",0),2&n&&e.\u0275\u0275property("ngIf",t.isTenantWidgetsBundle()&&t.authUser.authority===t.authorities.TENANT_ADMIN)},dependencies:[p.NgIf,H.MatTab,Ae.s,g.TranslatePipe],encapsulation:2});class mt{constructor(n,t,a,o,s,l,d){this.store=n,this.dialogService=t,this.widgetsService=a,this.translate=o,this.importExport=s,this.datePipe=l,this.router=d,this.config=new v.ap,this.config.entityType=f.py.WIDGETS_BUNDLE,this.config.entityComponent=Ei,this.config.entityTabsComponent=Mi,this.config.entityTranslations=f.Jr.get(f.py.WIDGETS_BUNDLE),this.config.entityResources=f.CZ.get(f.py.WIDGETS_BUNDLE),this.config.defaultSortOrder={property:"title",direction:pt.N.ASC},this.config.rowPointer=!0,this.config.entityTitle=m=>m?m.title:"",this.config.columns.push(new v.eq("createdTime","common.created-time",this.datePipe,"150px"),new v.QI("title","widgets-bundle.title","100%"),new v.QI("tenantId","widgets-bundle.system","60px",m=>(0,v.Gj)(m.tenantId.id===P._))),this.config.addActionDescriptors.push({name:this.translate.instant("widgets-bundle.create-new-widgets-bundle"),icon:"insert_drive_file",isEnabled:()=>!0,onAction:m=>this.config.getTable().addEntity(m)},{name:this.translate.instant("widgets-bundle.import"),icon:"file_upload",isEnabled:()=>!0,onAction:m=>this.importWidgetsBundle(m)}),this.config.cellActionDescriptors.push({name:this.translate.instant("widgets-bundle.export"),icon:"file_download",isEnabled:()=>!0,onAction:(m,y)=>this.exportWidgetsBundle(m,y)},{name:this.translate.instant("widgets-bundle.widgets-bundle-details"),icon:"edit",isEnabled:()=>!0,onAction:(m,y)=>this.config.toggleEntityDetails(m,y)}),this.config.deleteEntityTitle=m=>this.translate.instant("widgets-bundle.delete-widgets-bundle-title",{widgetsBundleTitle:m.title}),this.config.deleteEntityContent=()=>this.translate.instant("widgets-bundle.delete-widgets-bundle-text"),this.config.deleteEntitiesTitle=m=>this.translate.instant("widgets-bundle.delete-widgets-bundles-title",{count:m}),this.config.deleteEntitiesContent=()=>this.translate.instant("widgets-bundle.delete-widgets-bundles-text"),this.config.loadEntity=m=>this.widgetsService.getWidgetsBundle(m.id),this.config.saveEntity=m=>this.widgetsService.saveWidgetsBundle(m),this.config.deleteEntity=m=>this.widgetsService.deleteWidgetsBundle(m.id),this.config.onEntityAction=m=>this.onWidgetsBundleAction(m,this.config),this.config.handleRowClick=(m,y)=>(this.config.isDetailsOpen()?this.config.toggleEntityDetails(m,y):this.openWidgetsBundle(m,y),!0),this.config.entityAdded=m=>{this.openWidgetsBundle(null,m)}}resolve(){this.config.tableTitle=this.translate.instant("widgets-bundle.widgets-bundles");const n=(0,q.fP)(this.store);this.config.deleteEnabled=a=>this.isWidgetsBundleEditable(a,n.authority),this.config.entitySelectionEnabled=a=>this.isWidgetsBundleEditable(a,n.authority),this.config.detailsReadonly=a=>!this.isWidgetsBundleEditable(a,n.authority);(0,q.dE)(this.store);return this.config.entitiesFetchFunction=a=>this.widgetsService.getWidgetBundles(a),this.config}isWidgetsBundleEditable(n,t){return t===u.W.TENANT_ADMIN?n&&n.tenantId&&n.tenantId.id!==P._:t===u.W.SYS_ADMIN}importWidgetsBundle(n){this.importExport.importWidgetsBundle().subscribe(t=>{t&&this.config.updateData()})}openWidgetsBundle(n,t){n&&n.stopPropagation(),this.router.navigateByUrl(`resources/widgets-bundles/${t.id.id}/widgetTypes`)}openWidgetsBundleDetails(n,t,a){n&&n.stopPropagation();const o=this.router.createUrlTree(["details",t.id.id],{relativeTo:a.getActivatedRoute()});this.router.navigateByUrl(o)}exportWidgetsBundle(n,t){n&&n.stopPropagation(),this.importExport.exportWidgetsBundle(t.id.id)}onWidgetsBundleAction(n,t){switch(n.action){case"open":return this.openWidgetsBundle(n.event,n.entity),!0;case"openDetails":return this.openWidgetsBundleDetails(n.event,n.entity,t),!0;case"export":return this.exportWidgetsBundle(n.event,n.entity),!0}return!1}}mt.\u0275fac=function(n){return new(n||mt)(e.\u0275\u0275inject(x.Store),e.\u0275\u0275inject(pe.x),e.\u0275\u0275inject(ze.i),e.\u0275\u0275inject(g.TranslateService),e.\u0275\u0275inject(ct.s),e.\u0275\u0275inject(p.DatePipe),e.\u0275\u0275inject(b.Router))},mt.\u0275prov=e.\u0275\u0275defineInjectable({token:mt,factory:mt.\u0275fac});var No=c(41554),Se=c(50147),me=c(37849),co=c(60134),Fo=c(32624),fc=c(55824),hc=c(19212);function bc(i,n){1&i&&e.\u0275\u0275element(0,"mat-progress-bar",16)}function yc(i,n){1&i&&e.\u0275\u0275element(0,"div",17)}function vc(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"widget.title-required")," "))}class Di extends le.a{constructor(n,t,a,o){super(n,t,a),this.store=n,this.router=t,this.dialogRef=a,this.fb=o,(0,q.fP)(n).authority===u.W.TENANT_ADMIN?this.bundlesScope="tenant":this.bundlesScope="system"}ngOnInit(){this.saveWidgetTypeAsFormGroup=this.fb.group({title:[null,[r.Validators.required]],widgetsBundle:[null]})}cancel(){this.dialogRef.close(null)}saveAs(){const n=this.saveWidgetTypeAsFormGroup.get("title").value,t=this.saveWidgetTypeAsFormGroup.get("widgetsBundle").value?.id?.id,a={widgetName:n,widgetBundleId:t};this.dialogRef.close(a)}}Di.\u0275fac=function(n){return new(n||Di)(e.\u0275\u0275directiveInject(x.Store),e.\u0275\u0275directiveInject(b.Router),e.\u0275\u0275directiveInject(C.MatDialogRef),e.\u0275\u0275directiveInject(r.FormBuilder))},Di.\u0275cmp=e.\u0275\u0275defineComponent({type:Di,selectors:[["tb-save-widget-type-as-dialog"]],features:[e.\u0275\u0275InheritDefinitionFeature],decls:30,vars:21,consts:[[2,"width","360px",3,"formGroup","ngSubmit"],["color","primary"],["translate",""],["fxFlex",""],["mat-icon-button","","type","button",3,"click"],[1,"material-icons"],["color","warn","mode","indeterminate",4,"ngIf"],["style","height: 4px;",4,"ngIf"],["mat-dialog-content",""],[1,"mat-block"],["matInput","","formControlName","title","required",""],[4,"ngIf"],["formControlName","widgetsBundle",3,"bundlesScope"],["mat-dialog-actions","","fxLayoutAlign","end center"],["mat-button","","color","primary","type","button","cdkFocusInitial","",3,"disabled","click"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],["color","warn","mode","indeterminate"],[2,"height","4px"]],template:function(n,t){1&n&&(e.\u0275\u0275elementStart(0,"form",0),e.\u0275\u0275listener("ngSubmit",function(){return t.saveAs()}),e.\u0275\u0275elementStart(1,"mat-toolbar",1)(2,"h2",2),e.\u0275\u0275text(3,"widget.save-widget-as"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(4,"span",3),e.\u0275\u0275elementStart(5,"button",4),e.\u0275\u0275listener("click",function(){return t.cancel()}),e.\u0275\u0275elementStart(6,"mat-icon",5),e.\u0275\u0275text(7,"close"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275template(8,bc,1,0,"mat-progress-bar",6),e.\u0275\u0275pipe(9,"async"),e.\u0275\u0275template(10,yc,1,0,"div",7),e.\u0275\u0275pipe(11,"async"),e.\u0275\u0275elementStart(12,"div",8)(13,"span",2),e.\u0275\u0275text(14,"widget.save-widget-as-text"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(15,"mat-form-field",9)(16,"mat-label",2),e.\u0275\u0275text(17,"widget.title"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(18,"input",10),e.\u0275\u0275template(19,vc,3,3,"mat-error",11),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(20,"tb-widgets-bundle-select",12),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(21,"div",13)(22,"button",14),e.\u0275\u0275listener("click",function(){return t.cancel()}),e.\u0275\u0275pipe(23,"async"),e.\u0275\u0275text(24),e.\u0275\u0275pipe(25,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(26,"button",15),e.\u0275\u0275pipe(27,"async"),e.\u0275\u0275text(28),e.\u0275\u0275pipe(29,"translate"),e.\u0275\u0275elementEnd()()()),2&n&&(e.\u0275\u0275property("formGroup",t.saveWidgetTypeAsFormGroup),e.\u0275\u0275advance(8),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(9,9,t.isLoading$)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!e.\u0275\u0275pipeBind1(11,11,t.isLoading$)),e.\u0275\u0275advance(9),e.\u0275\u0275property("ngIf",t.saveWidgetTypeAsFormGroup.get("title").hasError("required")),e.\u0275\u0275advance(1),e.\u0275\u0275propertyInterpolate("bundlesScope",t.bundlesScope),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(23,13,t.isLoading$)),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(25,15,"action.cancel")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(27,17,t.isLoading$)||t.saveWidgetTypeAsFormGroup.invalid||!t.saveWidgetTypeAsFormGroup.dirty),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(29,19,"action.saveAs")," "))},dependencies:[p.NgIf,hc.WidgetsBundleSelectComponent,S.MatButton,S.MatIconButton,F.MatIcon,z.MatProgressBar,O.MatInput,_.MatFormField,_.MatLabel,_.MatError,oe.MatToolbar,C.MatDialogContent,C.MatDialogActions,h.DefaultLayoutAlignDirective,h.DefaultFlexDirective,r.\u0275NgNoValidate,r.DefaultValueAccessor,r.NgControlStatus,r.NgControlStatusGroup,r.RequiredValidator,r.FormGroupDirective,r.FormControlName,g.TranslateDirective,p.AsyncPipe,g.TranslatePipe],encapsulation:2});var _c=c(34598),xc=c(62530),Lo=c(23790),Cc=c(45581);const Tc={self:{description:"Built-in variable <b>self</b> that is a reference to the widget instance",type:'<a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/modules/home/models/widget-component.models.ts#L350">WidgetTypeInstance</a>',meta:"object",children:{onInit:{description:"The first function which is called when widget is ready for initialization.<br>Should be used to prepare widget DOM, process widget settings and initial subscription information.",meta:"function"},onDataUpdated:{description:'Called when the new data is available from the widget subscription.<br>Latest data can be accessed from the <code>defaultSubscription</code> property of <a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/modules/home/models/widget-component.models.ts#L83">widget context (<code>ctx</code>)</a>.',meta:"function"},onResize:{description:'Called when widget container is resized. Latest <code>width</code> and <code>height</code> can be obtained from <a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/modules/home/models/widget-component.models.ts#L83">widget context (<code>ctx</code>)</a>.',meta:"function"},onEditModeChanged:{description:'Called when dashboard editing mode is changed. Latest mode is handled by <code>isEdit</code> property of <a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/modules/home/models/widget-component.models.ts#L83">widget context (<code>ctx</code>)</a>.',meta:"function"},onMobileModeChanged:{description:'Called when dashboard view width crosses mobile breakpoint. Latest state is handled by <code>isMobile</code> property of <a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/modules/home/models/widget-component.models.ts#L83">widget context (<code>ctx</code>)</a>.',meta:"function"},onDestroy:{description:"Called when widget element is destroyed. Should be used to cleanup all resources if necessary.",meta:"function"},getSettingsSchema:{description:'Optional function returning widget settings schema json as alternative to <b>Settings tab</b> of <a href="https://thingsboard.io/docs/user-guide/contribution/widgets-development/#settings-schema-section">Settings schema section</a>.',meta:"function",return:{description:"An widget settings schema json",type:"object"}},getDataKeySettingsSchema:{description:'Optional function returning particular data key settings schema json as alternative to <b>Data key settings schema</b> of <a href="https://thingsboard.io/docs/user-guide/contribution/widgets-development/#settings-schema-section">Settings schema section</a>.',meta:"function",return:{description:"A particular data key settings schema json",type:"object"}},typeParameters:{description:"Returns object describing widget datasource parameters.",meta:"function",return:{description:"An object describing widget datasource parameters.",type:'<a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/shared/models/widget.models.ts#L146">WidgetTypeParameters</a>'}},actionSources:{description:"Returns map describing available widget action sources used to define user actions.",meta:"function",return:{description:"A map of action sources by action source id.",type:'{[actionSourceId: string]: <a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/shared/models/widget.models.ts#L118">WidgetActionSource</a>}'}},...Lo.n}},...Lo.n,...Cc.iU},Sc=new xc.E(Tc);var Ai=c(84935),Po=c(20485),Ic=c(55778),ko=c(2105),Ro=c(21442),Oo=c(80504),po=c(51422),Oe=c(99778),Ga=c(45445),wc=c(76548),Ec=c(70970);const Mc=["topPanel"],Dc=["topLeftPanel"],Ac=["topRightPanel"],Nc=["bottomPanel"],Fc=["javascriptPanel"],Lc=["framePanel"],Pc=["htmlInput"],kc=["cssInput"],Rc=["settingsJsonInput"],Oc=["dataKeySettingsJsonInput"],Bc=["latestDataKeySettingsJsonInput"],Vc=["javascriptInput"],Uc=["widgetIFrame"];function Gc(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-option",72),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i){const t=n.$implicit,a=e.\u0275\u0275nextContext();e.\u0275\u0275property("value",t),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,2,a.widgetTypesDataMap.get(a.widgetTypes[t]).name)," ")}}function jc(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",14),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.saveWidget())}),e.\u0275\u0275pipe(1,"async"),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementStart(3,"mat-icon"),e.\u0275\u0275text(4,"save"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"span",11),e.\u0275\u0275text(6,"action.save"),e.\u0275\u0275elementEnd()()}if(2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate1("matTooltip","",e.\u0275\u0275pipeBind1(2,5,"widget.save")," (CTRL + S)"),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(1,3,t.isLoading$)||t.saveDisabled())("tb-circular-progress",t.saveWidgetPending)}}function Wc(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",20),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.saveWidget())}),e.\u0275\u0275pipe(1,"async"),e.\u0275\u0275elementStart(2,"mat-icon"),e.\u0275\u0275text(3,"save"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"span",11),e.\u0275\u0275text(5,"action.save"),e.\u0275\u0275elementEnd()()}if(2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(1,1,t.isLoading$)||t.saveDisabled())}}function qc(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",73)(1,"tb-resource-autocomplete",74),e.\u0275\u0275listener("ngModelChange",function(o){const l=e.\u0275\u0275restoreView(t).$implicit;return e.\u0275\u0275resetView(l.url=o)})("ngModelChange",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.isDirty=!0)}),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"mat-checkbox",75),e.\u0275\u0275listener("ngModelChange",function(o){const l=e.\u0275\u0275restoreView(t).$implicit;return e.\u0275\u0275resetView(l.isModule=o)})("ngModelChange",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.isDirty=!0)}),e.\u0275\u0275text(4),e.\u0275\u0275pipe(5,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(6,"button",76),e.\u0275\u0275listener("click",function(){const s=e.\u0275\u0275restoreView(t).index,l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.removeResource(s))}),e.\u0275\u0275pipe(7,"async"),e.\u0275\u0275pipe(8,"translate"),e.\u0275\u0275elementStart(9,"mat-icon"),e.\u0275\u0275text(10,"close"),e.\u0275\u0275elementEnd()()()}if(2&i){const t=n.$implicit,a=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275propertyInterpolate("placeholder",e.\u0275\u0275pipeBind1(2,7,"widget.resource-url")),e.\u0275\u0275property("allowAutocomplete",t.isModule)("ngModel",t.url),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngModel",t.isModule),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(5,9,"widget.resource-is-module")," "),e.\u0275\u0275advance(2),e.\u0275\u0275propertyInterpolate("matTooltip",e.\u0275\u0275pipeBind1(8,13,"widget.remove-resource")),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(7,11,a.isLoading$))}}function $c(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",77),e.\u0275\u0275listener("click",function(){const s=e.\u0275\u0275restoreView(t).$implicit,l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.changeTheme(s))}),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()}if(2&i){const t=n.$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(t)}}function Hc(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"mat-form-field",51)(1,"mat-label",11),e.\u0275\u0275text(2,"widget.latest-data-key-settings-form-selector"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"input",57),e.\u0275\u0275listener("ngModelChange",function(o){e.\u0275\u0275restoreView(t);const s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.widget.latestDataKeySettingsDirective=o)})("ngModelChange",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.isDirty=!0)}),e.\u0275\u0275elementEnd()()}if(2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(3),e.\u0275\u0275property("ngModel",t.widget.latestDataKeySettingsDirective)}}function zc(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"mat-form-field",51)(1,"mat-label",11),e.\u0275\u0275text(2,"widget.basic-mode-form-selector"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"input",57),e.\u0275\u0275listener("ngModelChange",function(o){e.\u0275\u0275restoreView(t);const s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.widget.basicModeDirective=o)})("ngModelChange",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.isDirty=!0)}),e.\u0275\u0275elementEnd()()}if(2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(3),e.\u0275\u0275property("ngModel",t.widget.basicModeDirective)}}function Kc(i,n){1&i&&(e.\u0275\u0275elementStart(0,"div",78),e.\u0275\u0275element(1,"mat-spinner",79),e.\u0275\u0275elementEnd())}const Yc=function(){return{maxWidth:"1200px"}};class Ni extends se.I{get isDirty(){return this._isDirty||this.isEditModeWidget}set isDirty(n){n||(this.isEditModeWidget=!1),this._isDirty=n}constructor(n,t,a,o,s,l,d,m){super(n),this.store=n,this.window=t,this.route=a,this.router=o,this.widgetService=s,this.translate=l,this.raf=d,this.dialog=m,this.widgetTypes=Se.oS,this.allWidgetTypes=Object.keys(Se.oS),this.widgetTypesDataMap=Se.eO,this.isEditModeWidget=!1,this._isDirty=!1,this.fullscreen=!1,this.htmlFullscreen=!1,this.cssFullscreen=!1,this.jsonSettingsFullscreen=!1,this.jsonDataKeySettingsFullscreen=!1,this.jsonLatestDataKeySettingsFullscreen=!1,this.javascriptFullscreen=!1,this.iFrameFullscreen=!1,this.aceEditors=[],this.editorsResizeCafs={},this.onWindowMessageListener=this.onWindowMessage.bind(this),this.iframeWidgetEditModeInited=!1,this.saveWidgetPending=!1,this.saveWidgetAsPending=!1,this.gotError=!1,this.errorMarkers=[],this.errorAnnotationId=-1,this.hotKeys=[],this.updateBreadcrumbs=new e.EventEmitter,this.rxSubscriptions=new Array,this.themeName=localStorage.getItem("ace_theme")||"Monokai",this.themeList=["Textmate","Github","Ambiance","Monokai","Chaos","Dracula","Eclipse","Terminal","Tomorrow","Tomorrow_night","Twilight","xCode"],this.authUser=(0,q.fP)(n),this.rxSubscriptions.push(this.route.data.subscribe(y=>{this.init(y)})),this.initHotKeys()}init(n){if(this.widgetTypeDetails=n.widgetEditorData.widgetTypeDetails,this.widget=n.widgetEditorData.widget,this.authUser.authority===u.W.TENANT_ADMIN?this.isReadOnly=this.widgetTypeDetails&&this.widgetTypeDetails.tenantId.id===P._:this.isReadOnly=this.authUser.authority!==u.W.SYS_ADMIN,this.widgetTypeDetails){const t=JSON.parse(this.widget.defaultConfig);this.widget.defaultConfig=JSON.stringify(t)}this.origWidget=(0,T.I8)(this.widget),this.widgetTypeDetails||(this.isDirty=!0)}ngOnInit(){this.initSplitLayout(),this.initAceEditors(),this.iframe=Ec(this.widgetIFrameElmRef.nativeElement),this.window.addEventListener("message",this.onWindowMessageListener),this.iframe.attr("data-widget",JSON.stringify(this.widget)),this.iframe.attr("src","/widget-editor")}ngOnDestroy(){this.window.removeEventListener("message",this.onWindowMessageListener),this.aceEditors.forEach(n=>n.destroy()),this.aceResize$.disconnect(),this.rxSubscriptions.forEach(n=>{n.unsubscribe()}),this.rxSubscriptions.length=0}initHotKeys(){this.hotKeys.push(new me.qm("ctrl+q",n=>(!(0,co.Oc)(this.store)&&!this.undoDisabled()&&(n.preventDefault(),this.undoWidget()),!1),["INPUT","SELECT","TEXTAREA"],this.translate.instant("widget.undo"))),this.hotKeys.push(new me.qm("ctrl+s",n=>(!(0,co.Oc)(this.store)&&!this.saveDisabled()&&(n.preventDefault(),this.saveWidget()),!1),["INPUT","SELECT","TEXTAREA"],this.translate.instant("widget.save"))),this.hotKeys.push(new me.qm("shift+ctrl+s",n=>(!(0,co.Oc)(this.store)&&!this.saveAsDisabled()&&(n.preventDefault(),this.saveWidgetAs()),!1),["INPUT","SELECT","TEXTAREA"],this.translate.instant("widget.saveAs"))),this.hotKeys.push(new me.qm("shift+ctrl+f",n=>(n.preventDefault(),this.fullscreen=!this.fullscreen,!1),["INPUT","SELECT","TEXTAREA"],this.translate.instant("widget.toggle-fullscreen"))),this.hotKeys.push(new me.qm("ctrl+enter",n=>(n.preventDefault(),this.applyWidgetScript(),!1),["INPUT","SELECT","TEXTAREA"],this.translate.instant("widget.run")))}initSplitLayout(){Split([this.topPanelElmRef.nativeElement,this.bottomPanelElmRef.nativeElement],{sizes:[35,65],gutterSize:8,cursor:"row-resize",direction:"vertical"}),Split([this.topLeftPanelElmRef.nativeElement,this.topRightPanelElmRef.nativeElement],{sizes:[50,50],gutterSize:8,cursor:"col-resize"}),Split([this.javascriptPanelElmRef.nativeElement,this.framePanelElmRef.nativeElement],{sizes:[50,50],gutterSize:8,cursor:"col-resize"})}initAceEditors(){this.aceResize$=new _c.do(t=>{t.forEach(a=>{const o=this.aceEditors.find(s=>s.container===a.target);this.onAceEditorResize(o)})});const n=[];n.push(this.createAceEditor(this.htmlInputElmRef,"html").pipe((0,Z.b)(t=>{this.htmlEditor=t,this.htmlEditor.on("input",()=>{const a=this.htmlEditor.getValue();this.widget.templateHtml!==a&&(this.widget.templateHtml=a,this.isDirty=!0)})}))),n.push(this.createAceEditor(this.cssInputElmRef,"css").pipe((0,Z.b)(t=>{this.cssEditor=t,this.cssEditor.on("input",()=>{const a=this.cssEditor.getValue();this.widget.templateCss!==a&&(this.widget.templateCss=a,this.isDirty=!0)})}))),n.push(this.createAceEditor(this.settingsJsonInputElmRef,"json").pipe((0,Z.b)(t=>{this.jsonSettingsEditor=t,this.jsonSettingsEditor.on("input",()=>{const a=this.jsonSettingsEditor.getValue();this.widget.settingsSchema!==a&&(this.widget.settingsSchema=a,this.isDirty=!0)})}))),n.push(this.createAceEditor(this.dataKeySettingsJsonInputElmRef,"json").pipe((0,Z.b)(t=>{this.dataKeyJsonSettingsEditor=t,this.dataKeyJsonSettingsEditor.on("input",()=>{const a=this.dataKeyJsonSettingsEditor.getValue();this.widget.dataKeySettingsSchema!==a&&(this.widget.dataKeySettingsSchema=a,this.isDirty=!0)})}))),n.push(this.createAceEditor(this.latestDataKeySettingsJsonInputElmRef,"json").pipe((0,Z.b)(t=>{this.latestDataKeyJsonSettingsEditor=t,this.latestDataKeyJsonSettingsEditor.on("input",()=>{const a=this.latestDataKeyJsonSettingsEditor.getValue();this.widget.latestDataKeySettingsSchema!==a&&(this.widget.latestDataKeySettingsSchema=a,this.isDirty=!0)})}))),n.push(this.createAceEditor(this.javascriptInputElmRef,"javascript").pipe((0,Z.b)(t=>{this.jsEditor=t,this.jsEditor.on("input",()=>{const a=this.jsEditor.getValue();this.widget.controllerScript!==a&&(this.widget.controllerScript=a,this.isDirty=!0)}),this.jsEditor.on("change",()=>{this.cleanupJsErrors()}),this.jsEditor.completers=[Sc,...this.jsEditor.completers||[]]}))),(0,xe.D)(n).subscribe(()=>{this.setAceEditorValues()})}setAceEditorValues(){this.htmlEditor.setValue(this.widget.templateHtml?this.widget.templateHtml:"",-1),this.cssEditor.setValue(this.widget.templateCss?this.widget.templateCss:"",-1),this.jsonSettingsEditor.setValue(this.widget.settingsSchema?this.widget.settingsSchema:"",-1),this.dataKeyJsonSettingsEditor.setValue(this.widget.dataKeySettingsSchema?this.widget.dataKeySettingsSchema:"",-1),this.latestDataKeyJsonSettingsEditor.setValue(this.widget.latestDataKeySettingsSchema?this.widget.latestDataKeySettingsSchema:"",-1),this.jsEditor.setValue(this.widget.controllerScript?this.widget.controllerScript:"",-1)}createAceEditor(n,t){const a=n.nativeElement;let o={mode:`ace/mode/${t}`,showGutter:!0,showPrintMargin:!0};return o={...o,enableSnippets:!0,enableBasicAutocompletion:!0,enableLiveAutocompletion:!0},(0,Fo.Ln)().pipe((0,re.U)(l=>{const d=l.edit(a,o);return localStorage.getItem("ace_theme")?d.setTheme("ace/theme/"+localStorage.getItem("ace_theme")):d.setTheme("ace/theme/monokai"),d.session.setUseWrapMode(!0),this.aceEditors.push(d),this.aceResize$.observe(a),d}))}onAceEditorResize(n){this.editorsResizeCafs[n.id]&&(this.editorsResizeCafs[n.id](),delete this.editorsResizeCafs[n.id]),this.editorsResizeCafs[n.id]=this.raf.raf(()=>{n.resize(),n.renderer.updateFull()})}onWindowMessage(n){let t;if(n.data)try{t=JSON.parse(n.data)}catch{}if(t)switch(t.type){case"widgetException":this.onWidgetException(t.data);break;case"widgetEditModeInited":this.onWidgetEditModeInited();break;case"widgetEditUpdated":this.onWidgetEditUpdated(t.data),this.onWidgetEditModeToggled(!1);break;case"widgetEditModeToggle":this.onWidgetEditModeToggled(t.data)}}onWidgetEditModeInited(){this.iframeWidgetEditModeInited=!0,(this.saveWidgetPending||this.saveWidgetAsPending)&&(this.saveWidgetTimeout||(this.saveWidgetTimeout=setTimeout(()=>{this.gotError?(this.store.dispatch(new V.zi({message:this.translate.instant("widget.unable-to-save-widget-error"),type:"error"})),this.saveWidgetPending=!1,this.saveWidgetAsPending=!1):this.saveWidgetPending?this.commitSaveWidget():this.saveWidgetAsPending&&this.commitSaveWidgetAs(),this.saveWidgetTimeout=void 0},1500)))}onWidgetEditUpdated(n){this.widget.sizeX=n.sizeX/2,this.widget.sizeY=n.sizeY/2,this.widget.defaultConfig=JSON.stringify(n.config),this.iframe.attr("data-widget",JSON.stringify(this.widget)),this.isDirty=!0}onWidgetEditModeToggled(n){this.isEditModeWidget=n}onWidgetException(n){if(!this.gotError){this.gotError=!0;let t="Error:";if(n.message&&(t+=" "+n.message),n.lineNumber&&(t+="<br>Line "+n.lineNumber,n.columnNumber&&(t+=" column "+n.columnNumber),t+=" of script."),!this.saveWidgetPending&&!this.saveWidgetAsPending&&this.store.dispatch(new V.zi({message:t,type:"error",target:"javascriptPanel"})),n.lineNumber){const a=n.lineNumber-1;let o=0;n.columnNumber&&(o=n.columnNumber);const s=this.jsEditor.session.addMarker(new Fo.e6(a,0,a,1/0),"ace_active-line","screenLine");this.errorMarkers.push(s);const l=this.jsEditor.session.getAnnotations(),d={row:a,column:o,text:n.message,type:"error"};this.errorAnnotationId=l.push(d)-1,this.jsEditor.session.setAnnotations(l)}}}cleanupJsErrors(){if(this.store.dispatch(new V.VD({})),this.errorMarkers.forEach(n=>{this.jsEditor.session.removeMarker(n)}),this.errorMarkers.length=0,this.errorAnnotationId>-1){const n=this.jsEditor.session.getAnnotations();n.splice(this.errorAnnotationId,1),this.jsEditor.session.setAnnotations(n),this.errorAnnotationId=-1}}commitSaveWidget(){const n=this.widgetTypeDetails&&this.widgetTypeDetails.id?this.widgetTypeDetails.id:void 0,t=this.widgetTypeDetails&&this.widgetTypeDetails.createdTime?this.widgetTypeDetails.createdTime:void 0;this.widgetService.saveWidgetTypeDetails(this.widget,n,t).pipe((0,ne.z)(a=>{const o=this.route.snapshot.params.widgetsBundleId;return o&&!n?this.widgetService.addWidgetFqnToWidgetBundle(o,a.fqn).pipe((0,re.U)(()=>a)):(0,J.of)(a)})).subscribe({next:a=>{this.saveWidgetPending=!1,this.widgetTypeDetails?.id?this.setWidgetTypeDetails(a):(this.isDirty=!1,this.router.navigate(["..",a.id.id],{relativeTo:this.route})),this.store.dispatch(new V.zi({message:this.translate.instant("widget.widget-saved"),type:"success",duration:500}))},error:()=>{this.saveWidgetPending=!1}})}commitSaveWidgetAs(){this.dialog.open(Di,{disableClose:!0,panelClass:["tb-dialog","tb-fullscreen-dialog"]}).afterClosed().subscribe(n=>{if(n){this.widget.widgetName=n.widgetName,this.widget.fullFqn=void 0;const t=JSON.parse(this.widget.defaultConfig);t.title=this.widget.widgetName,this.widget.defaultConfig=JSON.stringify(t),this.isDirty=!1,this.widgetService.saveWidgetTypeDetails(this.widget,void 0,void 0).pipe((0,ne.z)(a=>n.widgetBundleId?this.widgetService.addWidgetFqnToWidgetBundle(n.widgetBundleId,a.fqn).pipe((0,re.U)(()=>a)):(0,J.of)(a))).subscribe({next:a=>{this.saveWidgetAsPending=!1,n.widgetBundleId?this.router.navigate(["resources","widgets-library","widgets-bundles",n.widgetBundleId,a.id.id]):this.router.navigate(["resources","widgets-library","widget-types",a.id.id])},error:()=>{this.saveWidgetAsPending=!1}})}else this.saveWidgetAsPending=!1})}setWidgetTypeDetails(n){this.widgetTypeDetails=n,this.widget=(0,No.cJ)(this.widgetTypeDetails);const t=JSON.parse(this.widget.defaultConfig);this.widget.defaultConfig=JSON.stringify(t),this.origWidget=(0,T.I8)(this.widget),this.isDirty=!1,this.updateBreadcrumbs.emit()}applyWidgetScript(){this.cleanupJsErrors(),this.gotError=!1,this.iframeWidgetEditModeInited=!1;const n=JSON.parse(this.widget.defaultConfig);n.title||(n.title=this.widget.widgetName),this.widget.defaultConfig=JSON.stringify(n),this.iframe.attr("data-widget",JSON.stringify(this.widget)),this.iframe[0].contentWindow.location.reload(!0)}undoWidget(){this.widget=(0,T.I8)(this.origWidget),this.setAceEditorValues(),this.isDirty=!1,this.applyWidgetScript()}saveWidget(){this.widget.widgetName?(this.saveWidgetPending=!0,this.applyWidgetScript()):this.store.dispatch(new V.zi({message:this.translate.instant("widget.missing-widget-title-error"),type:"error"}))}saveWidgetAs(){this.saveWidgetAsPending=!0,this.applyWidgetScript()}undoDisabled(){return!this._isDirty||!this.iframeWidgetEditModeInited||this.saveWidgetPending||this.saveWidgetAsPending}saveDisabled(){return this.isReadOnly||!this._isDirty||!this.iframeWidgetEditModeInited||this.saveWidgetPending||this.saveWidgetAsPending}saveAsDisabled(){return!this.iframeWidgetEditModeInited||this.saveWidgetPending||this.saveWidgetAsPending}beautifyCss(){(0,Ai.RF)(this.widget.templateCss,{indent_size:4}).subscribe(n=>{this.widget.templateCss!==n&&(this.isDirty=!0,this.widget.templateCss=n,this.cssEditor.setValue(this.widget.templateCss?this.widget.templateCss:"",-1))})}beautifyHtml(){(0,Ai.S7)(this.widget.templateHtml,{indent_size:4,wrap_line_length:60}).subscribe(n=>{this.widget.templateHtml!==n&&(this.isDirty=!0,this.widget.templateHtml=n,this.htmlEditor.setValue(this.widget.templateHtml?this.widget.templateHtml:"",-1))})}beautifyJson(){(0,Ai.Jx)(this.widget.settingsSchema,{indent_size:4}).subscribe(n=>{this.widget.settingsSchema!==n&&(this.isDirty=!0,this.widget.settingsSchema=n,this.jsonSettingsEditor.setValue(this.widget.settingsSchema?this.widget.settingsSchema:"",-1))})}beautifyDataKeyJson(){(0,Ai.Jx)(this.widget.dataKeySettingsSchema,{indent_size:4}).subscribe(n=>{this.widget.dataKeySettingsSchema!==n&&(this.isDirty=!0,this.widget.dataKeySettingsSchema=n,this.dataKeyJsonSettingsEditor.setValue(this.widget.dataKeySettingsSchema?this.widget.dataKeySettingsSchema:"",-1))})}beautifyLatestDataKeyJson(){(0,Ai.Jx)(this.widget.latestDataKeySettingsSchema,{indent_size:4}).subscribe(n=>{this.widget.latestDataKeySettingsSchema!==n&&(this.isDirty=!0,this.widget.latestDataKeySettingsSchema=n,this.latestDataKeyJsonSettingsEditor.setValue(this.widget.latestDataKeySettingsSchema?this.widget.latestDataKeySettingsSchema:"",-1))})}beautifyJs(){(0,Ai.Jx)(this.widget.controllerScript,{indent_size:4,wrap_line_length:60}).subscribe(n=>{this.widget.controllerScript!==n&&(this.isDirty=!0,this.widget.controllerScript=n,this.jsEditor.setValue(this.widget.controllerScript?this.widget.controllerScript:"",-1))})}removeResource(n){n>-1&&this.widget.resources.splice(n,1).length>0&&(this.isDirty=!0)}addResource(){this.widget.resources.push({url:""}),this.isDirty=!0}widetTypeChanged(){const n=JSON.parse(this.widget.defaultConfig);this.widget.type!==Se.oS.rpc&&this.widget.type!==Se.oS.alarm?(n.targetDeviceAliases&&delete n.targetDeviceAliases,n.alarmSource&&delete n.alarmSource,n.datasources||(n.datasources=[]),n.timewindow||(n.timewindow={realtime:{timewindowMs:6e4}})):this.widget.type===Se.oS.rpc?(n.datasources&&delete n.datasources,n.alarmSource&&delete n.alarmSource,n.timewindow&&delete n.timewindow,n.targetDeviceAliases||(n.targetDeviceAliases=[])):(n.datasources&&delete n.datasources,n.targetDeviceAliases&&delete n.targetDeviceAliases,n.alarmSource||(n.alarmSource={}),n.timewindow||(n.timewindow={realtime:{timewindowMs:864e5}})),this.widget.defaultConfig=JSON.stringify(n),this.isDirty=!0}get confirmOnExitMessage(){return this.isEditModeWidget&&!this._isDirty?this.translate.instant("widget.confirm-to-exit-editor-html"):""}changeTheme(n){localStorage.setItem("ace_theme",n.toLowerCase()),this.aceEditors.forEach(t=>{t.setTheme("ace/theme/"+n.toLowerCase())}),this.store.dispatch(new V.zi({message:"Theme is changed to "+n,type:"success"}))}}Ni.\u0275fac=function(n){return new(n||Ni)(e.\u0275\u0275directiveInject(x.Store),e.\u0275\u0275directiveInject(to.m9),e.\u0275\u0275directiveInject(b.ActivatedRoute),e.\u0275\u0275directiveInject(b.Router),e.\u0275\u0275directiveInject(ze.i),e.\u0275\u0275directiveInject(g.TranslateService),e.\u0275\u0275directiveInject(fc.i),e.\u0275\u0275directiveInject(C.MatDialog))},Ni.\u0275cmp=e.\u0275\u0275defineComponent({type:Ni,selectors:[["tb-widget-editor"]],viewQuery:function(n,t){if(1&n&&(e.\u0275\u0275viewQuery(Mc,7),e.\u0275\u0275viewQuery(Dc,7),e.\u0275\u0275viewQuery(Ac,7),e.\u0275\u0275viewQuery(Nc,7),e.\u0275\u0275viewQuery(Fc,7),e.\u0275\u0275viewQuery(Lc,7),e.\u0275\u0275viewQuery(Pc,7),e.\u0275\u0275viewQuery(kc,7),e.\u0275\u0275viewQuery(Rc,7),e.\u0275\u0275viewQuery(Oc,7),e.\u0275\u0275viewQuery(Bc,7),e.\u0275\u0275viewQuery(Vc,7),e.\u0275\u0275viewQuery(Uc,7)),2&n){let a;e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(t.topPanelElmRef=a.first),e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(t.topLeftPanelElmRef=a.first),e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(t.topRightPanelElmRef=a.first),e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(t.bottomPanelElmRef=a.first),e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(t.javascriptPanelElmRef=a.first),e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(t.framePanelElmRef=a.first),e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(t.htmlInputElmRef=a.first),e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(t.cssInputElmRef=a.first),e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(t.settingsJsonInputElmRef=a.first),e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(t.dataKeySettingsJsonInputElmRef=a.first),e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(t.latestDataKeySettingsJsonInputElmRef=a.first),e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(t.javascriptInputElmRef=a.first),e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(t.widgetIFrameElmRef=a.first)}},features:[e.\u0275\u0275InheritDefinitionFeature],decls:215,vars:159,consts:[["fxFlex","","fxLayout","column"],["fxFlex","","fxLayout","column","tb-fullscreen","","tb-hotkeys","",3,"fullscreen","hotkeys","cheatSheet"],["cheatSheetComponent",""],["fxLayoutGap","16px","fxLayoutGap.lt-xl","8px",1,"mat-elevation-z1","tb-edit-toolbar","mat-hue-3"],[1,"tb-widget-title","tb-appearance-transparent"],["matInput","","required","","maxlength","255",3,"disabled","ngModel","placeholder","ngModelChange"],[1,"tb-appearance-transparent"],["matInput","",3,"disabled","placeholder","ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["fxFlex",""],["mat-button","","fxHide.lt-md","","matTooltipPosition","below",3,"disabled","matTooltip","click"],["translate",""],["mat-raised-button","","fxHide.lt-md","","matTooltipPosition","below",3,"disabled","matTooltip","click"],["mat-raised-button","","fxHide.lt-md","","matTooltipPosition","below",3,"disabled","tb-circular-progress","matTooltip","click",4,"ngIf"],["mat-raised-button","","fxHide.lt-md","","matTooltipPosition","below",3,"disabled","tb-circular-progress","matTooltip","click"],["mat-button","","fxHide.lt-lg","","matTooltipPosition","below",3,"matTooltip","click"],["mat-icon-button","","fxHide","","fxShow.md","","matTooltipPosition","below",3,"matTooltip","click"],["mat-icon-button","","fxHide.gt-sm","",3,"matMenuTriggerFor"],["xPosition","before"],["widgetEditMenu","matMenu"],["mat-menu-item","",3,"disabled","click"],["mat-menu-item","",3,"disabled","click",4,"ngIf"],["fxFlex","",2,"position","relative"],[1,"tb-editor","tb-absolute-fill"],[1,"tb-split","tb-split-vertical"],["topPanel",""],[1,"tb-split","tb-content",2,"position","relative"],["topLeftPanel",""],["mat-stretch-tabs","false","selectedIndex","1","dynamicHeight","true",2,"width","100%","height","100%"],[3,"label"],[1,"tb-resize-container"],[1,"mat-padding"],["fxFlex","","fxLayout","row","style","max-height: 40px;","fxLayoutAlign","start center",4,"ngFor","ngForOf"],["mat-raised-button","","color","primary","matTooltipPosition","above",2,"margin-top","8px",3,"disabled","matTooltip","click"],["tb-fullscreen","",1,"tb-resize-container",3,"fullscreen"],[1,"tb-editor-area-title-panel"],["mat-button","",3,"click"],["mat-icon-button","","matTooltipPosition","above",1,"tb-mat-32",3,"matTooltip","click"],["htmlInput",""],["cssInput",""],["mat-stroked-button","","color","primary","fxHide.lt-md","","fxShow","",2,"position","absolute","top","6px","right","5px",3,"matMenuTriggerFor"],["menu","matMenu"],["mat-menu-item","",3,"click",4,"ngFor","ngForOf"],[1,"tb-split","tb-content"],["topRightPanel",""],["mat-stretch-tabs","false","dynamicHeight","true",2,"width","100%","height","100%"],["settingsJsonInput",""],["dataKeySettingsJsonInput",""],[3,"aria-labelledby","label"],["latestDataKeySettingsJsonInput",""],["fxFlex","",3,"label","ngModel","ngModelChange"],[1,"mat-block"],["matInput","","rows","2","maxlength","255",3,"ngModel","ngModelChange"],["descriptionInput",""],["align","end"],[3,"label","ngModel","ngModelChange"],[1,"mat-block",2,"padding-bottom","16px",3,"ngModel","ngModelChange"],["matInput","",3,"ngModel","ngModelChange"],["class","mat-block",4,"ngIf"],["bottomPanel",""],["tb-toast","","toastTarget","javascriptPanel",1,"tb-split","tb-content"],["javascriptPanel",""],["tb-help-popup","widget/editor/widget_js_fn","tb-help-popup-placement","top",3,"tb-help-popup-style"],["javascriptInput",""],[1,"tb-split","tb-content",2,"overflow-y","hidden","position","relative"],["framePanel",""],["class","mat-content tb-progress-cover","fxFlex","","fxLayout","column","fxLayoutAlign","center center",4,"ngIf"],["tb-fullscreen","",2,"width","100%","height","100%",3,"fullscreen"],["frameborder","0","height","100%","width","100%"],["widgetIFrame",""],[2,"position","absolute","top","10px","left","10px","bottom","initial"],["mat-icon-button","","matTooltipPosition","above",1,"tb-fullscreen-button-style",3,"matTooltip","click"],[3,"value"],["fxFlex","","fxLayout","row","fxLayoutAlign","start center",2,"max-height","40px"],["fxFlex","","hideRequiredMarker","","required","","subscriptSizing","dynamic",1,"mat-block","resource-field",3,"allowAutocomplete","ngModel","placeholder","ngModelChange"],[3,"ngModel","ngModelChange"],["mat-icon-button","","color","primary","matTooltipPosition","above",3,"disabled","matTooltip","click"],["mat-menu-item","",3,"click"],["fxFlex","","fxLayout","column","fxLayoutAlign","center center",1,"mat-content","tb-progress-cover"],["diameter","100","mode","indeterminate","color","warn"]],template:function(n,t){if(1&n&&(e.\u0275\u0275elementStart(0,"div",0)(1,"div",1),e.\u0275\u0275element(2,"tb-hotkeys-cheatsheet",null,2),e.\u0275\u0275elementStart(4,"mat-toolbar",3)(5,"mat-form-field",4)(6,"input",5),e.\u0275\u0275listener("ngModelChange",function(o){return t.widget.widgetName=o})("ngModelChange",function(){return t.isDirty=!0}),e.\u0275\u0275pipe(7,"translate"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(8,"mat-form-field",6)(9,"mat-select",7),e.\u0275\u0275listener("ngModelChange",function(o){return t.widget.type=o})("ngModelChange",function(){return t.widetTypeChanged()}),e.\u0275\u0275pipe(10,"translate"),e.\u0275\u0275template(11,Gc,3,4,"mat-option",8),e.\u0275\u0275elementEnd()(),e.\u0275\u0275element(12,"span",9),e.\u0275\u0275elementStart(13,"button",10),e.\u0275\u0275listener("click",function(){return t.applyWidgetScript()}),e.\u0275\u0275pipe(14,"translate"),e.\u0275\u0275elementStart(15,"mat-icon"),e.\u0275\u0275text(16,"play_arrow"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(17,"span",11),e.\u0275\u0275text(18,"action.run"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(19,"button",12),e.\u0275\u0275listener("click",function(){return t.undoWidget()}),e.\u0275\u0275pipe(20,"async"),e.\u0275\u0275pipe(21,"translate"),e.\u0275\u0275elementStart(22,"mat-icon"),e.\u0275\u0275text(23,"undo"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(24,"span",11),e.\u0275\u0275text(25,"action.undo"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(26,jc,7,7,"button",13),e.\u0275\u0275elementStart(27,"button",14),e.\u0275\u0275listener("click",function(){return t.saveWidgetAs()}),e.\u0275\u0275pipe(28,"async"),e.\u0275\u0275pipe(29,"translate"),e.\u0275\u0275elementStart(30,"mat-icon"),e.\u0275\u0275text(31,"save_as"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(32,"span",11),e.\u0275\u0275text(33,"action.saveAs"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(34,"button",15),e.\u0275\u0275listener("click",function(){return t.fullscreen=!t.fullscreen}),e.\u0275\u0275pipe(35,"translate"),e.\u0275\u0275elementStart(36,"mat-icon"),e.\u0275\u0275text(37),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(38,"span",11),e.\u0275\u0275text(39,"widget.toggle-fullscreen"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(40,"button",16),e.\u0275\u0275listener("click",function(){return t.fullscreen=!t.fullscreen}),e.\u0275\u0275pipe(41,"translate"),e.\u0275\u0275elementStart(42,"mat-icon"),e.\u0275\u0275text(43),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(44,"button",17)(45,"mat-icon"),e.\u0275\u0275text(46,"more_vert"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(47,"mat-menu",18,19)(49,"button",20),e.\u0275\u0275listener("click",function(){return t.applyWidgetScript()}),e.\u0275\u0275elementStart(50,"mat-icon"),e.\u0275\u0275text(51,"play_arrow"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(52,"span",11),e.\u0275\u0275text(53,"action.run"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(54,"button",20),e.\u0275\u0275listener("click",function(){return t.undoWidget()}),e.\u0275\u0275pipe(55,"async"),e.\u0275\u0275elementStart(56,"mat-icon"),e.\u0275\u0275text(57,"undo"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(58,"span",11),e.\u0275\u0275text(59,"action.undo"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(60,Wc,6,3,"button",21),e.\u0275\u0275elementStart(61,"button",20),e.\u0275\u0275listener("click",function(){return t.saveWidgetAs()}),e.\u0275\u0275pipe(62,"async"),e.\u0275\u0275elementStart(63,"mat-icon"),e.\u0275\u0275text(64,"save_as"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(65,"span",11),e.\u0275\u0275text(66,"action.saveAs"),e.\u0275\u0275elementEnd()()()(),e.\u0275\u0275elementStart(67,"div",22)(68,"div",23)(69,"div",24,25)(71,"div",26,27)(73,"mat-tab-group",28)(74,"mat-tab",29),e.\u0275\u0275pipe(75,"translate"),e.\u0275\u0275elementStart(76,"div",30)(77,"div",31),e.\u0275\u0275template(78,qc,11,15,"div",32),e.\u0275\u0275elementStart(79,"button",33),e.\u0275\u0275listener("click",function(){return t.addResource()}),e.\u0275\u0275pipe(80,"async"),e.\u0275\u0275pipe(81,"translate"),e.\u0275\u0275elementStart(82,"span",11),e.\u0275\u0275text(83,"action.add"),e.\u0275\u0275elementEnd()()()()(),e.\u0275\u0275elementStart(84,"mat-tab",29),e.\u0275\u0275pipe(85,"translate"),e.\u0275\u0275elementStart(86,"div",34)(87,"div",35)(88,"button",36),e.\u0275\u0275listener("click",function(){return t.beautifyHtml()}),e.\u0275\u0275text(89),e.\u0275\u0275pipe(90,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(91,"button",37),e.\u0275\u0275listener("click",function(){return t.htmlFullscreen=!t.htmlFullscreen}),e.\u0275\u0275pipe(92,"translate"),e.\u0275\u0275elementStart(93,"mat-icon"),e.\u0275\u0275text(94),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275element(95,"div",null,38),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(97,"mat-tab",29),e.\u0275\u0275pipe(98,"translate"),e.\u0275\u0275elementStart(99,"div",34)(100,"div",35)(101,"button",36),e.\u0275\u0275listener("click",function(){return t.beautifyCss()}),e.\u0275\u0275text(102),e.\u0275\u0275pipe(103,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(104,"button",37),e.\u0275\u0275listener("click",function(){return t.cssFullscreen=!t.cssFullscreen}),e.\u0275\u0275pipe(105,"translate"),e.\u0275\u0275elementStart(106,"mat-icon"),e.\u0275\u0275text(107),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275element(108,"div",null,39),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(110,"button",40),e.\u0275\u0275text(111),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(112,"mat-menu",null,41),e.\u0275\u0275template(114,$c,2,1,"button",42),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(115,"div",43,44)(117,"mat-tab-group",45)(118,"mat-tab",29),e.\u0275\u0275pipe(119,"translate"),e.\u0275\u0275elementStart(120,"div",34)(121,"div",35)(122,"button",36),e.\u0275\u0275listener("click",function(){return t.beautifyJson()}),e.\u0275\u0275text(123),e.\u0275\u0275pipe(124,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(125,"button",37),e.\u0275\u0275listener("click",function(){return t.jsonSettingsFullscreen=!t.jsonSettingsFullscreen}),e.\u0275\u0275pipe(126,"translate"),e.\u0275\u0275elementStart(127,"mat-icon"),e.\u0275\u0275text(128),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275element(129,"div",null,46),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(131,"mat-tab",29),e.\u0275\u0275pipe(132,"translate"),e.\u0275\u0275elementStart(133,"div",34)(134,"div",35)(135,"button",36),e.\u0275\u0275listener("click",function(){return t.beautifyDataKeyJson()}),e.\u0275\u0275text(136),e.\u0275\u0275pipe(137,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(138,"button",37),e.\u0275\u0275listener("click",function(){return t.jsonDataKeySettingsFullscreen=!t.jsonDataKeySettingsFullscreen}),e.\u0275\u0275pipe(139,"translate"),e.\u0275\u0275elementStart(140,"mat-icon"),e.\u0275\u0275text(141),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275element(142,"div",null,47),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(144,"mat-tab",48),e.\u0275\u0275pipe(145,"translate"),e.\u0275\u0275elementStart(146,"div",34)(147,"div",35)(148,"button",36),e.\u0275\u0275listener("click",function(){return t.beautifyLatestDataKeyJson()}),e.\u0275\u0275text(149),e.\u0275\u0275pipe(150,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(151,"button",37),e.\u0275\u0275listener("click",function(){return t.jsonLatestDataKeySettingsFullscreen=!t.jsonLatestDataKeySettingsFullscreen}),e.\u0275\u0275pipe(152,"translate"),e.\u0275\u0275elementStart(153,"mat-icon"),e.\u0275\u0275text(154),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275element(155,"div",null,49),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(157,"mat-tab",29),e.\u0275\u0275pipe(158,"translate"),e.\u0275\u0275elementStart(159,"div",30)(160,"div",31)(161,"tb-gallery-image-input",50),e.\u0275\u0275listener("ngModelChange",function(o){return t.widget.image=o})("ngModelChange",function(){return t.isDirty=!0}),e.\u0275\u0275pipe(162,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(163,"mat-form-field",51)(164,"mat-label",11),e.\u0275\u0275text(165,"widget.description"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(166,"textarea",52,53),e.\u0275\u0275listener("ngModelChange",function(o){return t.widget.description=o})("ngModelChange",function(){return t.isDirty=!0}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(168,"mat-hint",54),e.\u0275\u0275text(169),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(170,"tb-string-items-list",55),e.\u0275\u0275listener("ngModelChange",function(o){return t.widget.tags=o})("ngModelChange",function(){return t.isDirty=!0}),e.\u0275\u0275pipe(171,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(172,"mat-slide-toggle",56),e.\u0275\u0275listener("ngModelChange",function(o){return t.widget.deprecated=o})("ngModelChange",function(){return t.isDirty=!0}),e.\u0275\u0275text(173),e.\u0275\u0275pipe(174,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(175,"mat-form-field",51)(176,"mat-label",11),e.\u0275\u0275text(177,"widget.settings-form-selector"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(178,"input",57),e.\u0275\u0275listener("ngModelChange",function(o){return t.widget.settingsDirective=o})("ngModelChange",function(){return t.isDirty=!0}),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(179,"mat-form-field",51)(180,"mat-label",11),e.\u0275\u0275text(181,"widget.data-key-settings-form-selector"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(182,"input",57),e.\u0275\u0275listener("ngModelChange",function(o){return t.widget.dataKeySettingsDirective=o})("ngModelChange",function(){return t.isDirty=!0}),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(183,Hc,4,1,"mat-form-field",58),e.\u0275\u0275elementStart(184,"mat-slide-toggle",56),e.\u0275\u0275listener("ngModelChange",function(o){return t.widget.hasBasicMode=o})("ngModelChange",function(){return t.isDirty=!0}),e.\u0275\u0275text(185),e.\u0275\u0275pipe(186,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(187,zc,4,1,"mat-form-field",58),e.\u0275\u0275elementEnd()()()()()(),e.\u0275\u0275elementStart(188,"div",24,59)(190,"div",60,61)(192,"div",34)(193,"div",35)(194,"button",36),e.\u0275\u0275listener("click",function(){return t.beautifyJs()}),e.\u0275\u0275text(195),e.\u0275\u0275pipe(196,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(197,"span",62),e.\u0275\u0275elementStart(198,"button",37),e.\u0275\u0275listener("click",function(){return t.javascriptFullscreen=!t.javascriptFullscreen}),e.\u0275\u0275pipe(199,"translate"),e.\u0275\u0275elementStart(200,"mat-icon"),e.\u0275\u0275text(201),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275element(202,"div",null,63),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(204,"div",64,65),e.\u0275\u0275template(206,Kc,2,0,"div",66),e.\u0275\u0275elementStart(207,"div",67),e.\u0275\u0275element(208,"iframe",68,69),e.\u0275\u0275elementStart(210,"div",70)(211,"button",71),e.\u0275\u0275listener("click",function(){return t.iFrameFullscreen=!t.iFrameFullscreen}),e.\u0275\u0275pipe(212,"translate"),e.\u0275\u0275elementStart(213,"mat-icon"),e.\u0275\u0275text(214),e.\u0275\u0275elementEnd()()()()()()()()()()),2&n){const a=e.\u0275\u0275reference(3),o=e.\u0275\u0275reference(48),s=e.\u0275\u0275reference(113),l=e.\u0275\u0275reference(167);e.\u0275\u0275advance(1),e.\u0275\u0275property("fullscreen",t.fullscreen)("hotkeys",t.hotKeys)("cheatSheet",a),e.\u0275\u0275advance(5),e.\u0275\u0275propertyInterpolate("placeholder",e.\u0275\u0275pipeBind1(7,84,"widget.widget-title")),e.\u0275\u0275property("disabled",t.isReadOnly)("ngModel",t.widget.widgetName),e.\u0275\u0275advance(3),e.\u0275\u0275propertyInterpolate("placeholder",e.\u0275\u0275pipeBind1(10,86,"widget.type")),e.\u0275\u0275property("disabled",t.isReadOnly)("ngModel",t.widget.type),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",t.allWidgetTypes),e.\u0275\u0275advance(2),e.\u0275\u0275propertyInterpolate1("matTooltip","",e.\u0275\u0275pipeBind1(14,88,"widget.run")," (CTRL + Return)"),e.\u0275\u0275property("disabled",!t.iframeWidgetEditModeInited),e.\u0275\u0275advance(6),e.\u0275\u0275propertyInterpolate1("matTooltip","",e.\u0275\u0275pipeBind1(21,92,"widget.undo")," (CTRL + Q)"),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(20,90,t.isLoading$)||t.undoDisabled()),e.\u0275\u0275advance(7),e.\u0275\u0275property("ngIf",!t.isReadOnly),e.\u0275\u0275advance(1),e.\u0275\u0275propertyInterpolate1("matTooltip","",e.\u0275\u0275pipeBind1(29,96,"widget.saveAs")," (Shift + CTRL + S)"),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(28,94,t.isLoading$)||t.saveAsDisabled())("tb-circular-progress",t.saveWidgetAsPending),e.\u0275\u0275advance(7),e.\u0275\u0275propertyInterpolate1("matTooltip","",e.\u0275\u0275pipeBind1(35,98,"widget.toggle-fullscreen")," (Shift + CTRL + F)"),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(t.fullscreen?"fullscreen_exit":"fullscreen"),e.\u0275\u0275advance(3),e.\u0275\u0275propertyInterpolate1("matTooltip","",e.\u0275\u0275pipeBind1(41,100,"widget.toggle-fullscreen")," (Shift + CTRL + F)"),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(t.fullscreen?"fullscreen_exit":"fullscreen"),e.\u0275\u0275advance(1),e.\u0275\u0275property("matMenuTriggerFor",o),e.\u0275\u0275advance(5),e.\u0275\u0275property("disabled",!t.iframeWidgetEditModeInited),e.\u0275\u0275advance(5),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(55,102,t.isLoading$)||t.undoDisabled()),e.\u0275\u0275advance(6),e.\u0275\u0275property("ngIf",!t.isReadOnly),e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(62,104,t.isLoading$)||t.saveAsDisabled()),e.\u0275\u0275advance(13),e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(75,106,"widget.resources")),e.\u0275\u0275advance(4),e.\u0275\u0275property("ngForOf",t.widget.resources),e.\u0275\u0275advance(1),e.\u0275\u0275propertyInterpolate("matTooltip",e.\u0275\u0275pipeBind1(81,110,"widget.add-resource")),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(80,108,t.isLoading$)),e.\u0275\u0275advance(5),e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(85,112,"widget.html")),e.\u0275\u0275advance(2),e.\u0275\u0275property("fullscreen",t.htmlFullscreen),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(90,114,"widget.tidy")," "),e.\u0275\u0275advance(2),e.\u0275\u0275propertyInterpolate("matTooltip",e.\u0275\u0275pipeBind1(92,116,t.htmlFullscreen?"fullscreen.exit":"fullscreen.expand")),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(t.htmlFullscreen?"fullscreen_exit":"fullscreen"),e.\u0275\u0275advance(3),e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(98,118,"widget.css")),e.\u0275\u0275advance(2),e.\u0275\u0275property("fullscreen",t.cssFullscreen),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(103,120,"widget.tidy")," "),e.\u0275\u0275advance(2),e.\u0275\u0275propertyInterpolate("matTooltip",e.\u0275\u0275pipeBind1(105,122,t.cssFullscreen?"fullscreen.exit":"fullscreen.expand")),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(t.cssFullscreen?"fullscreen_exit":"fullscreen"),e.\u0275\u0275advance(3),e.\u0275\u0275property("matMenuTriggerFor",s),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(t.themeName),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngForOf",t.themeList),e.\u0275\u0275advance(4),e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(119,124,"widget.settings-schema")),e.\u0275\u0275advance(2),e.\u0275\u0275property("fullscreen",t.jsonSettingsFullscreen),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(124,126,"widget.tidy")," "),e.\u0275\u0275advance(2),e.\u0275\u0275propertyInterpolate("matTooltip",e.\u0275\u0275pipeBind1(126,128,t.jsonSettingsFullscreen?"fullscreen.exit":"fullscreen.expand")),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(t.jsonSettingsFullscreen?"fullscreen_exit":"fullscreen"),e.\u0275\u0275advance(3),e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(132,130,"widget.datakey-settings-schema")),e.\u0275\u0275advance(2),e.\u0275\u0275property("fullscreen",t.jsonDataKeySettingsFullscreen),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(137,132,"widget.tidy")," "),e.\u0275\u0275advance(2),e.\u0275\u0275propertyInterpolate("matTooltip",e.\u0275\u0275pipeBind1(139,134,t.jsonDataKeySettingsFullscreen?"fullscreen.exit":"fullscreen.expand")),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(t.jsonDataKeySettingsFullscreen?"fullscreen_exit":"fullscreen"),e.\u0275\u0275advance(3),e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(145,136,"widget.latest-datakey-settings-schema")),e.\u0275\u0275property("aria-labelledby",t.widget.type!==t.widgetTypes.timeseries?"hidden":""),e.\u0275\u0275advance(2),e.\u0275\u0275property("fullscreen",t.jsonLatestDataKeySettingsFullscreen),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(150,138,"widget.tidy")," "),e.\u0275\u0275advance(2),e.\u0275\u0275propertyInterpolate("matTooltip",e.\u0275\u0275pipeBind1(152,140,t.jsonLatestDataKeySettingsFullscreen?"fullscreen.exit":"fullscreen.expand")),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(t.jsonLatestDataKeySettingsFullscreen?"fullscreen_exit":"fullscreen"),e.\u0275\u0275advance(3),e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(158,142,"widget.widget-settings")),e.\u0275\u0275advance(4),e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(162,144,"widget.image-preview")),e.\u0275\u0275property("ngModel",t.widget.image),e.\u0275\u0275advance(5),e.\u0275\u0275property("ngModel",t.widget.description),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1("",(null==l.value?null:l.value.length)||0,"/255"),e.\u0275\u0275advance(1),e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(171,146,"widget.tags")),e.\u0275\u0275property("ngModel",t.widget.tags),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngModel",t.widget.deprecated),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(174,148,"widget.deprecated")," "),e.\u0275\u0275advance(5),e.\u0275\u0275property("ngModel",t.widget.settingsDirective),e.\u0275\u0275advance(4),e.\u0275\u0275property("ngModel",t.widget.dataKeySettingsDirective),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.widget.type===t.widgetTypes.timeseries),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngModel",t.widget.hasBasicMode),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(186,150,"widget.has-basic-mode")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",t.widget.hasBasicMode),e.\u0275\u0275advance(5),e.\u0275\u0275property("fullscreen",t.javascriptFullscreen),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(196,152,"widget.tidy")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("tb-help-popup-style",e.\u0275\u0275pureFunction0(158,Yc)),e.\u0275\u0275advance(1),e.\u0275\u0275propertyInterpolate("matTooltip",e.\u0275\u0275pipeBind1(199,154,t.javascriptFullscreen?"fullscreen.exit":"fullscreen.expand")),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(t.javascriptFullscreen?"fullscreen_exit":"fullscreen"),e.\u0275\u0275advance(5),e.\u0275\u0275property("ngIf",!t.iframeWidgetEditModeInited),e.\u0275\u0275advance(1),e.\u0275\u0275property("fullscreen",t.iFrameFullscreen),e.\u0275\u0275advance(4),e.\u0275\u0275propertyInterpolate("matTooltip",e.\u0275\u0275pipeBind1(212,156,t.iFrameFullscreen?"fullscreen.exit":"fullscreen.expand")),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(t.iFrameFullscreen?"fullscreen_exit":"fullscreen")}},dependencies:[p.NgForOf,p.NgIf,rt.ToastDirective,Po.FullscreenDirective,Ic.CircularProgressDirective,ko.TbHotkeysDirective,Ro.HelpPopupComponent,Oo.TbCheatSheetComponent,po.StringItemsListComponent,S.MatButton,S.MatIconButton,fe.MatCheckbox,F.MatIcon,O.MatInput,_.MatFormField,_.MatLabel,_.MatHint,oe.MatToolbar,Oe.MatMenu,Oe.MatMenuItem,Oe.MatMenuTrigger,ye.MatSelect,X.MatOption,Ln.MatTooltip,Ga.MatProgressSpinner,H.MatTab,H.MatTabGroup,Ce.MatSlideToggle,h.DefaultLayoutDirective,h.DefaultLayoutGapDirective,h.DefaultLayoutAlignDirective,h.DefaultFlexDirective,G.DefaultShowHideDirective,r.DefaultValueAccessor,r.NgControlStatus,r.RequiredValidator,r.MaxLengthValidator,r.NgModel,me.cy,g.TranslateDirective,wc.O,lo.GalleryImageInputComponent,p.AsyncPipe,g.TranslatePipe],styles:['@charset "UTF-8";tb-widget-editor{flex:1;display:flex;flex-direction:column}.tb-editor .tb-split{box-sizing:border-box;overflow-x:hidden;overflow-y:auto}.tb-editor .resource-field mat-form-field .mat-mdc-text-field-wrapper{padding-bottom:0;height:40px}.tb-editor .resource-field mat-form-field .mat-mdc-text-field-wrapper .mat-mdc-form-field-flex{max-height:40px}.tb-editor .resource-field mat-form-field .mat-mdc-text-field-wrapper .mat-mdc-form-field-flex .mat-mdc-form-field-infix{border:0;padding-top:7px;padding-bottom:7px;min-height:32px}.tb-editor .ace_editor{font-size:14px!important}.tb-editor .tb-content{border:1px solid #c0c0c0}.tb-editor .gutter{background-color:transparent;background-repeat:no-repeat;background-position:50%}.tb-editor .gutter.gutter-horizontal{cursor:col-resize;background-image:url(vertical.f18b560a84f60603.png)}.tb-editor .gutter.gutter-vertical{cursor:row-resize;background-image:url(horizontal.d1475b32efe518a2.png)}.tb-editor .tb-split.tb-split-horizontal,.tb-editor .gutter.gutter-horizontal{float:left;height:100%}.tb-editor .tb-split.tb-split-vertical{display:flex}.tb-editor .tb-split.tb-split-vertical .tb-split.tb-content{height:100%}.tb-editor .container{width:100%;height:100%}.tb-editor .mdc-tab[aria-labelledby=hidden]{width:0!important;min-width:0;padding:0;overflow:hidden}.tb-split-vertical .mat-mdc-tab-group .mat-mdc-tab-body-wrapper{height:calc(100% - 49px)}.tb-split-vertical .mat-mdc-tab-group .mat-mdc-tab-body-wrapper .mat-mdc-tab-body{height:100%}.tb-split-vertical .mat-mdc-tab-group .mat-mdc-tab-body-wrapper .mat-mdc-tab-body>div{height:100%}div.tb-editor-area-title-panel{position:absolute;top:5px;right:20px;z-index:5;font-size:.8rem;font-weight:500}div.tb-editor-area-title-panel>*:not(:last-child){margin-right:4px}div.tb-editor-area-title-panel label{padding:4px;color:#00acc1;background:rgba(220,220,220,.35);border-radius:5px}div.tb-editor-area-title-panel button.mat-mdc-button-base,div.tb-editor-area-title-panel button.mat-mdc-button-base.tb-mat-32{align-items:center;vertical-align:middle;min-width:32px;min-height:15px;padding:4px;font-size:.8rem;line-height:15px;background:rgba(220,220,220,.35)}div.tb-editor-area-title-panel button.mat-mdc-button-base:not(.tb-help-popup-button),div.tb-editor-area-title-panel button.mat-mdc-button-base.tb-mat-32:not(.tb-help-popup-button){color:#7b7b7b}div.tb-editor-area-title-panel button.mat-mdc-button-base:not(.mat-mdc-icon-button){height:23px}div.tb-editor-area-title-panel .tb-help-popup-button-loading{background:#f3f3f3}.tb-resize-container{position:relative;width:100%;height:100%;overflow-y:auto}.tb-resize-container .ace_editor{height:100%}mat-toolbar.tb-edit-toolbar{min-height:40px!important;max-height:40px!important}mat-toolbar.tb-edit-toolbar button.mat-mdc-button-base:not(.mat-mdc-icon-button){font-size:12px;line-height:28px;padding:0 8px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;height:28px}mat-toolbar.tb-edit-toolbar button.mat-mdc-button-base:not(.mat-mdc-icon-button) .mat-icon{height:20px;width:20px;font-size:20px}mat-toolbar.tb-edit-toolbar .mat-mdc-form-field input,mat-toolbar.tb-edit-toolbar .mat-mdc-form-field .mat-mdc-select{font-size:1.1rem;font-weight:400;letter-spacing:.005em}mat-toolbar.tb-edit-toolbar .mat-mdc-form-field.tb-widget-title{min-width:250px}@media screen and (max-width: 1279px){mat-toolbar.tb-edit-toolbar .mat-mdc-form-field.tb-widget-title{min-width:0}}\n'],encapsulation:2});var ja=c(85268);function Jc(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"widget.title-required")," "))}function Qc(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"widget.title-max-length")," "))}class Fi extends Te.r{constructor(n,t,a,o,s){super(n,o,t,a,s),this.store=n,this.entityValue=t,this.entitiesTableConfigValue=a,this.fb=o,this.cd=s}hideDelete(){return!!this.entitiesTableConfig&&!this.entitiesTableConfig.deleteEnabled(this.entity)}buildForm(n){return this.fb.group({name:[n?n.name:"",[r.Validators.required,r.Validators.maxLength(255)]],image:[n?n.image:""],description:[n?n.description:"",r.Validators.maxLength(1024)],tags:[n?n.tags:[]],deprecated:[!!n&&n.deprecated]})}updateForm(n){this.entityForm.patchValue({name:n.name,image:n.image,description:n.description,tags:n.tags,deprecated:n.deprecated})}}function Xc(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"mat-tab",1,2),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementStart(3,"tb-version-control",3),e.\u0275\u0275listener("versionRestored",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.entitiesTableConfig.updateData())}),e.\u0275\u0275elementEnd()()}if(2&i){const t=e.\u0275\u0275reference(1),a=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(2,5,"version-control.version-control")),e.\u0275\u0275advance(3),e.\u0275\u0275property("active",t.isActive)("entityId",a.entity.id)("entityName",a.entity.name)("externalEntityId",a.entity.externalId||a.entity.id)}}Fi.\u0275fac=function(n){return new(n||Fi)(e.\u0275\u0275directiveInject(x.Store),e.\u0275\u0275directiveInject("entity"),e.\u0275\u0275directiveInject("entitiesTableConfig"),e.\u0275\u0275directiveInject(r.UntypedFormBuilder),e.\u0275\u0275directiveInject(e.ChangeDetectorRef))},Fi.\u0275cmp=e.\u0275\u0275defineComponent({type:Fi,selectors:[["tb-widget-type"]],features:[e.\u0275\u0275InheritDefinitionFeature],decls:41,vars:44,consts:[["fxLayout.xs","column",1,"tb-details-buttons"],["mat-raised-button","","color","primary",3,"disabled","fxShow","click"],["fxLayout","column",1,"mat-padding"],[3,"formGroup"],[3,"disabled"],[1,"mat-block"],["translate",""],["matInput","","formControlName","name","required",""],[4,"ngIf"],["fxFlex","","formControlName","image",3,"label"],["matInput","","formControlName","description","rows","2","maxlength","1024"],["descriptionInput",""],["align","end"],["formControlName","tags",3,"label"],["formControlName","deprecated"]],template:function(n,t){if(1&n&&(e.\u0275\u0275elementStart(0,"div",0)(1,"button",1),e.\u0275\u0275listener("click",function(o){return t.onEntityAction(o,"edit")}),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275text(3),e.\u0275\u0275pipe(4,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"button",1),e.\u0275\u0275listener("click",function(o){return t.onEntityAction(o,"openDetails")}),e.\u0275\u0275pipe(6,"async"),e.\u0275\u0275text(7),e.\u0275\u0275pipe(8,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(9,"button",1),e.\u0275\u0275listener("click",function(o){return t.onEntityAction(o,"export")}),e.\u0275\u0275pipe(10,"async"),e.\u0275\u0275text(11),e.\u0275\u0275pipe(12,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(13,"button",1),e.\u0275\u0275listener("click",function(o){return t.onEntityAction(o,"delete")}),e.\u0275\u0275pipe(14,"async"),e.\u0275\u0275text(15),e.\u0275\u0275pipe(16,"translate"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(17,"div",2)(18,"form",3)(19,"fieldset",4),e.\u0275\u0275pipe(20,"async"),e.\u0275\u0275elementStart(21,"mat-form-field",5)(22,"mat-label",6),e.\u0275\u0275text(23,"widget.title"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(24,"input",7),e.\u0275\u0275template(25,Jc,3,3,"mat-error",8),e.\u0275\u0275template(26,Qc,3,3,"mat-error",8),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(27,"tb-gallery-image-input",9),e.\u0275\u0275pipe(28,"translate"),e.\u0275\u0275elementStart(29,"mat-form-field",5)(30,"mat-label",6),e.\u0275\u0275text(31,"widget.description"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(32,"textarea",10,11),e.\u0275\u0275elementStart(34,"mat-hint",12),e.\u0275\u0275text(35),e.\u0275\u0275elementEnd()(),e.\u0275\u0275element(36,"tb-string-items-list",13),e.\u0275\u0275pipe(37,"translate"),e.\u0275\u0275elementStart(38,"mat-slide-toggle",14),e.\u0275\u0275text(39),e.\u0275\u0275pipe(40,"translate"),e.\u0275\u0275elementEnd()()()()),2&n){const a=e.\u0275\u0275reference(33);e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(2,20,t.isLoading$))("fxShow",!t.isEdit),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(4,22,"widget.edit")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(6,24,t.isLoading$))("fxShow",!t.isEdit&&!t.isDetailsPage),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(8,26,"common.open-details-page")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(10,28,t.isLoading$))("fxShow",!t.isEdit),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(12,30,"widget.export")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(14,32,t.isLoading$))("fxShow",!t.hideDelete()&&!t.isEdit),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(16,34,"widget.delete-widget")," "),e.\u0275\u0275advance(3),e.\u0275\u0275property("formGroup",t.entityForm),e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(20,36,t.isLoading$)||!t.isEdit),e.\u0275\u0275advance(6),e.\u0275\u0275property("ngIf",t.entityForm.get("name").hasError("required")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.entityForm.get("name").hasError("maxlength")),e.\u0275\u0275advance(1),e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(28,38,"widget.image-preview")),e.\u0275\u0275advance(8),e.\u0275\u0275textInterpolate1("",(null==a.value?null:a.value.length)||0,"/1024"),e.\u0275\u0275advance(1),e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(37,40,"widget.tags")),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(40,42,"widget.deprecated")," ")}},dependencies:[p.NgIf,po.StringItemsListComponent,S.MatButton,O.MatInput,_.MatFormField,_.MatLabel,_.MatHint,_.MatError,Ce.MatSlideToggle,h.DefaultLayoutDirective,h.DefaultFlexDirective,G.DefaultShowHideDirective,r.\u0275NgNoValidate,r.DefaultValueAccessor,r.NgControlStatus,r.NgControlStatusGroup,r.RequiredValidator,r.MaxLengthValidator,r.FormGroupDirective,r.FormControlName,g.TranslateDirective,lo.GalleryImageInputComponent,p.AsyncPipe,g.TranslatePipe],encapsulation:2});class Li extends _e.l{constructor(n){super(n),this.store=n}isTenantWidgetType(){return this.entity&&this.entity.tenantId.id!==P._}ngOnInit(){super.ngOnInit()}}Li.\u0275fac=function(n){return new(n||Li)(e.\u0275\u0275directiveInject(x.Store))},Li.\u0275cmp=e.\u0275\u0275defineComponent({type:Li,selectors:[["tb-widget-type-tabs"]],features:[e.\u0275\u0275InheritDefinitionFeature],decls:1,vars:1,consts:[[3,"label",4,"ngIf"],[3,"label"],["versionControlTab","matTab"],["detailsMode","true","singleEntityMode","true",3,"active","entityId","entityName","externalEntityId","versionRestored"]],template:function(n,t){1&n&&e.\u0275\u0275template(0,Xc,4,7,"mat-tab",0),2&n&&e.\u0275\u0275property("ngIf",t.isTenantWidgetType()&&t.authUser.authority===t.authorities.TENANT_ADMIN)},dependencies:[p.NgIf,H.MatTab,Ae.s,g.TranslatePipe],encapsulation:2});var Wa=c(84773);function Zc(i,n){1&i&&e.\u0275\u0275element(0,"mat-progress-bar",14)}function ep(i,n){1&i&&e.\u0275\u0275element(0,"div",15)}function tp(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",16),e.\u0275\u0275listener("click",function(){const s=e.\u0275\u0275restoreView(t).$implicit,l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.typeSelected(l.widgetTypes[s]))}),e.\u0275\u0275elementStart(1,"tb-icon",17),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"span",2),e.\u0275\u0275text(4),e.\u0275\u0275elementEnd()()}if(2&i){const t=n.$implicit,a=e.\u0275\u0275nextContext();e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",a.widgetTypesDataMap.get(a.widgetTypes[t]).icon," "),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(a.widgetTypesDataMap.get(a.widgetTypes[t]).name)}}class Rn extends le.a{constructor(n,t,a){super(n,t,a),this.store=n,this.router=t,this.dialogRef=a,this.widgetTypes=Se.oS,this.allWidgetTypes=Object.keys(Se.oS),this.widgetTypesDataMap=Se.eO}cancel(){this.dialogRef.close(null)}typeSelected(n){this.dialogRef.close(n)}}Rn.\u0275fac=function(n){return new(n||Rn)(e.\u0275\u0275directiveInject(x.Store),e.\u0275\u0275directiveInject(b.Router),e.\u0275\u0275directiveInject(C.MatDialogRef))},Rn.\u0275cmp=e.\u0275\u0275defineComponent({type:Rn,selectors:[["tb-select-widget-type-dialog"]],features:[e.\u0275\u0275InheritDefinitionFeature],decls:22,vars:16,consts:[[2,"width","800px"],["color","primary"],["translate",""],["fxFlex",""],["mat-icon-button","","type","button",3,"click"],[1,"material-icons"],["color","warn","mode","indeterminate",4,"ngIf"],["style","height: 4px;",4,"ngIf"],["mat-dialog-content",""],[3,"disabled"],["fxLayout","column","fxLayoutGap","16px","fxLayout.gt-sm","row","fxLayoutAlign","center center"],["class","tb-card-button","mat-raised-button","","color","primary","type","button",3,"click",4,"ngFor","ngForOf"],["mat-dialog-actions","","fxLayoutAlign","end center"],["mat-button","","color","primary","type","button","cdkFocusInitial","",3,"disabled","click"],["color","warn","mode","indeterminate"],[2,"height","4px"],["mat-raised-button","","color","primary","type","button",1,"tb-card-button",3,"click"],["matButtonIcon","",1,"tb-mat-96"]],template:function(n,t){1&n&&(e.\u0275\u0275elementStart(0,"form",0)(1,"mat-toolbar",1)(2,"h2",2),e.\u0275\u0275text(3,"widget.select-widget-type"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(4,"span",3),e.\u0275\u0275elementStart(5,"button",4),e.\u0275\u0275listener("click",function(){return t.cancel()}),e.\u0275\u0275elementStart(6,"mat-icon",5),e.\u0275\u0275text(7,"close"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275template(8,Zc,1,0,"mat-progress-bar",6),e.\u0275\u0275pipe(9,"async"),e.\u0275\u0275template(10,ep,1,0,"div",7),e.\u0275\u0275pipe(11,"async"),e.\u0275\u0275elementStart(12,"div",8)(13,"fieldset",9),e.\u0275\u0275pipe(14,"async"),e.\u0275\u0275elementStart(15,"div",10),e.\u0275\u0275template(16,tp,5,2,"button",11),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(17,"div",12)(18,"button",13),e.\u0275\u0275listener("click",function(){return t.cancel()}),e.\u0275\u0275pipe(19,"async"),e.\u0275\u0275text(20),e.\u0275\u0275pipe(21,"translate"),e.\u0275\u0275elementEnd()()()),2&n&&(e.\u0275\u0275advance(8),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(9,6,t.isLoading$)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!e.\u0275\u0275pipeBind1(11,8,t.isLoading$)),e.\u0275\u0275advance(3),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(14,10,t.isLoading$)),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngForOf",t.allWidgetTypes),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(19,12,t.isLoading$)),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(21,14,"action.cancel")," "))},dependencies:[p.NgForOf,p.NgIf,S.MatButton,S.MatIconButton,F.MatIcon,z.MatProgressBar,oe.MatToolbar,C.MatDialogContent,C.MatDialogActions,h.DefaultLayoutDirective,h.DefaultLayoutGapDirective,h.DefaultLayoutAlignDirective,h.DefaultFlexDirective,r.\u0275NgNoValidate,r.NgControlStatusGroup,r.NgForm,g.TranslateDirective,Wa.TbIconComponent,p.AsyncPipe,g.TranslatePipe],styles:['@charset "UTF-8";[_nghost-%COMP%]     .mat-mdc-button-base.tb-card-button{width:100%;height:100%;max-width:240px;display:flex;flex-direction:column;align-items:center}[_nghost-%COMP%]     .mat-mdc-button-base.tb-card-button .mat-icon{margin:auto}[_nghost-%COMP%]     .mat-mdc-button-base.tb-card-button span.mdc-button__label{height:18px;min-height:18px;max-height:18px;margin:0 0 20px;font-size:18px;font-weight:400;line-height:18px;white-space:normal}[_nghost-%COMP%]     .mat-mdc-button-base.tb-card-button.mat-mdc-raised-button.mat-primary .mat-ripple-element{opacity:.3;background-color:#ffffff4d}']});class ut{constructor(n,t,a,o,s,l,d){this.store=n,this.dialog=t,this.widgetsService=a,this.translate=o,this.importExport=s,this.datePipe=l,this.router=d,this.config=new v.ap,this.config.entityType=f.py.WIDGETS_BUNDLE,this.config.entityComponent=Fi,this.config.entityTabsComponent=Li,this.config.entityTranslations=f.Jr.get(f.py.WIDGET_TYPE),this.config.entityResources=f.CZ.get(f.py.WIDGET_TYPE),this.config.defaultSortOrder={property:"tenantId",direction:pt.N.DESC},this.config.rowPointer=!0,this.config.entityTitle=m=>m?m.name:"",this.config.columns.push(new v.eq("createdTime","common.created-time",this.datePipe,"150px"),new v.QI("name","widget.title","100%"),new v.QI("widgetType","widget.type","150px",m=>m?.widgetType?this.translate.instant(Se.eO.get(m.widgetType).name):"",void 0,!1),new v.QI("tenantId","widget.system","60px",m=>(0,v.Gj)(m.tenantId.id===P._)),new v.QI("deprecated","widget.deprecated","60px",m=>(0,v.Gj)(m.deprecated))),this.config.addActionDescriptors.push({name:this.translate.instant("dashboard.create-new-widget"),icon:"insert_drive_file",isEnabled:()=>!0,onAction:m=>this.addWidgetType(m)},{name:this.translate.instant("widget.import"),icon:"file_upload",isEnabled:()=>!0,onAction:m=>this.importWidgetType(m)}),this.config.cellActionDescriptors.push({name:this.translate.instant("widget.export"),icon:"file_download",isEnabled:()=>!0,onAction:(m,y)=>this.exportWidgetType(m,y)},{name:this.translate.instant("widget.widget-details"),icon:"edit",isEnabled:()=>!0,onAction:(m,y)=>this.config.toggleEntityDetails(m,y)}),this.config.groupActionDescriptors.push({name:this.translate.instant("widget.export-widgets"),icon:"file_download",isEnabled:!0,onAction:(m,y)=>this.exportWidgetTypes(m,y)}),this.config.deleteEntityTitle=m=>this.translate.instant("widget.delete-widget-title",{widgetName:m.name}),this.config.deleteEntityContent=()=>this.translate.instant("widget.delete-widget-text"),this.config.deleteEntitiesTitle=m=>this.translate.instant("widget.delete-widgets-title",{count:m}),this.config.deleteEntitiesContent=()=>this.translate.instant("widget.delete-widgets-text"),this.config.loadEntity=m=>this.widgetsService.getWidgetTypeById(m.id),this.config.saveEntity=m=>this.widgetsService.saveWidgetType(m),this.config.deleteEntity=m=>this.widgetsService.deleteWidgetType(m.id),this.config.onEntityAction=m=>this.onWidgetTypeAction(m,this.config),this.config.handleRowClick=(m,y)=>(this.config.isDetailsOpen()?this.config.toggleEntityDetails(m,y):this.openWidgetEditor(m,y),!0)}resolve(){this.config.tableTitle=this.translate.instant("widget.widgets");const n=(0,q.fP)(this.store);return this.config.deleteEnabled=t=>this.isWidgetTypeEditable(t,n.authority),this.config.entitySelectionEnabled=t=>this.isWidgetTypeEditable(t,n.authority),this.config.detailsReadonly=t=>!this.isWidgetTypeEditable(t,n.authority),this.config.entitiesFetchFunction=t=>this.widgetsService.getWidgetTypes(t),this.config}isWidgetTypeEditable(n,t){return t===u.W.TENANT_ADMIN?n&&n.tenantId&&n.tenantId.id!==P._:t===u.W.SYS_ADMIN}addWidgetType(n){n&&n.stopPropagation(),this.dialog.open(Rn,{disableClose:!0,panelClass:["tb-dialog","tb-fullscreen-dialog"]}).afterClosed().subscribe(t=>{t&&this.router.navigateByUrl(`resources/widgets-library/widget-types/${t}`)})}importWidgetType(n){this.importExport.importWidgetType().subscribe(t=>{t&&this.config.updateData()})}openWidgetEditor(n,t){n&&n.stopPropagation(),this.router.navigateByUrl(`resources/widgets-library/widget-types/${t.id.id}`)}openWidgetTypeDetails(n,t,a){n&&n.stopPropagation();const o=this.router.createUrlTree(["details",t.id.id],{relativeTo:a.getActivatedRoute()});this.router.navigateByUrl(o)}exportWidgetType(n,t){n&&n.stopPropagation(),this.importExport.exportWidgetType(t.id.id)}exportWidgetTypes(n,t){n&&n.stopPropagation(),this.importExport.exportWidgetTypes(t.map(a=>a.id.id)).subscribe(()=>{this.config.getTable().clearSelection()})}onWidgetTypeAction(n,t){switch(n.action){case"edit":return this.openWidgetEditor(n.event,n.entity),!0;case"openDetails":return this.openWidgetTypeDetails(n.event,n.entity,t),!0;case"export":return this.exportWidgetType(n.event,n.entity),!0}return!1}}ut.\u0275fac=function(n){return new(n||ut)(e.\u0275\u0275inject(x.Store),e.\u0275\u0275inject(C.MatDialog),e.\u0275\u0275inject(ze.i),e.\u0275\u0275inject(g.TranslateService),e.\u0275\u0275inject(ct.s),e.\u0275\u0275inject(p.DatePipe),e.\u0275\u0275inject(b.Router))},ut.\u0275prov=e.\u0275\u0275defineInjectable({token:ut,factory:ut.\u0275fac});var mo=c(56769),gt=c(70655),Bo=c(3358),uo=c(49887),Vo=c(21160),Uo=c(42569),Go=c(9249),np=c(10995),qa=c(40841),jo=c(91823),ka=c(66306),Wo=c(86731);const ip=["widgetTypeInput"];function ap(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-label"),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(t.label)}}function op(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",9),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.clear())}),e.\u0275\u0275elementStart(1,"mat-icon",10),e.\u0275\u0275text(2,"close"),e.\u0275\u0275elementEnd()()}}function rp(i,n){1&i&&(e.\u0275\u0275elementStart(0,"div",17),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(2,1,"widget.deprecated")))}function sp(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-option",11)(1,"div",12),e.\u0275\u0275element(2,"img",13),e.\u0275\u0275elementStart(3,"div",14),e.\u0275\u0275element(4,"div",15),e.\u0275\u0275pipe(5,"highlight"),e.\u0275\u0275template(6,rp,3,3,"div",16),e.\u0275\u0275elementEnd()()()),2&i){const t=n.$implicit,a=e.\u0275\u0275nextContext();e.\u0275\u0275property("value",t),e.\u0275\u0275advance(2),e.\u0275\u0275propertyInterpolate("alt",t.name),e.\u0275\u0275property("src",a.getPreviewImage(t.image),e.\u0275\u0275sanitizeUrl),e.\u0275\u0275advance(2),e.\u0275\u0275property("innerHTML",e.\u0275\u0275pipeBind3(5,5,t.name,a.searchText,!0),e.\u0275\u0275sanitizeHtml),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",t.deprecated)}}const lp=function(i){return{entity:i}};function dp(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-option",11)(1,"span"),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"async"),e.\u0275\u0275elementEnd()()),2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275property("value",null),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(3,2,t.translate.get("widget.no-widgets-matching",e.\u0275\u0275pureFunction1(4,lp,t.searchText)))," ")}}const cp=[[["","tb-error",""]],[["","tb-hint",""]]];class ft{constructor(n,t,a,o,s){this.store=n,this.translate=t,this.widgetService=a,this.sanitizer=o,this.fb=s,this.dirty=!1,this.label=this.translate.instant("widget.widget"),this.floatLabel="auto",this.appearance="fill",this.subscriptSizing="fixed",this.searchText="",this.propagateChange=l=>{},this.selectWidgetTypeFormGroup=this.fb.group({widgetType:[null]})}registerOnChange(n){this.propagateChange=n}registerOnTouched(n){}ngOnInit(){this.filteredWidgetTypes=this.selectWidgetTypeFormGroup.get("widgetType").valueChanges.pipe((0,Bo.b)(150),(0,Z.b)(n=>{let t;t="string"!=typeof n&&n?n:null,this.updateView(t)}),(0,re.U)(n=>n?"string"==typeof n?n:n.name:""),(0,uo.x)(),(0,Vo.w)(n=>this.fetchWidgetTypes(n)),(0,Uo.B)())}ngAfterViewInit(){}setDisabledState(n){this.disabled=n,this.disabled?this.selectWidgetTypeFormGroup.disable({emitEvent:!1}):this.selectWidgetTypeFormGroup.enable({emitEvent:!1})}writeValue(n){this.searchText="",null!=n?"string"==typeof n?this.widgetService.getWidgetTypeInfoById(n).subscribe(t=>{this.modelValue=t,this.selectWidgetTypeFormGroup.get("widgetType").patchValue(t,{emitEvent:!1})}):(this.modelValue=n,this.selectWidgetTypeFormGroup.get("widgetType").patchValue(n,{emitEvent:!1})):(this.modelValue=null,this.selectWidgetTypeFormGroup.get("widgetType").patchValue("",{emitEvent:!1})),this.dirty=!0}updateView(n){this.modelValue!==n&&(this.modelValue=n,this.propagateChange(this.modelValue))}displayWidgetTypeFn(n){return n?n.name:void 0}getPreviewImage(n){return(0,T.nu)(n)?this.sanitizer.bypassSecurityTrustUrl(n):"/assets/widget-preview-empty.svg"}fetchWidgetTypes(n){this.searchText=n;const t=new Ua.H_(10,0,n,{property:"name",direction:pt.N.ASC});return this.getWidgetTypes(t)}getWidgetTypes(n,t=[]){return this.widgetService.getWidgetTypes(n,!0).pipe((0,Go.K)(()=>(0,J.of)((0,np.n)())),(0,Vo.w)(a=>{if(this.excludeWidgetTypeIds?.length){const o=a.data.filter(s=>!this.excludeWidgetTypeIds.includes(s.id.id));t=t.concat(o)}else t=a.data;return t.length>=n.pageSize||!this.excludeWidgetTypeIds?.length||!a.hasNext?(0,J.of)(t):this.getWidgetTypes(n.nextPageLink(),t)}))}onFocus(){this.dirty&&(this.selectWidgetTypeFormGroup.get("widgetType").updateValueAndValidity({onlySelf:!0}),this.dirty=!1)}clear(){this.selectWidgetTypeFormGroup.get("widgetType").patchValue(""),setTimeout(()=>{this.widgetTypeInput.nativeElement.blur(),this.widgetTypeInput.nativeElement.focus()},0)}}ft.\u0275fac=function(n){return new(n||ft)(e.\u0275\u0275directiveInject(x.Store),e.\u0275\u0275directiveInject(g.TranslateService),e.\u0275\u0275directiveInject(ze.i),e.\u0275\u0275directiveInject(jo.DomSanitizer),e.\u0275\u0275directiveInject(r.UntypedFormBuilder))},ft.\u0275cmp=e.\u0275\u0275defineComponent({type:ft,selectors:[["tb-widget-type-autocomplete"]],viewQuery:function(n,t){if(1&n&&e.\u0275\u0275viewQuery(ip,7),2&n){let a;e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(t.widgetTypeInput=a.first)}},inputs:{label:"label",placeholder:"placeholder",floatLabel:"floatLabel",appearance:"appearance",subscriptSizing:"subscriptSizing",required:"required",disabled:"disabled",excludeWidgetTypeIds:"excludeWidgetTypeIds"},features:[e.\u0275\u0275ProvidersFeature([{provide:r.NG_VALUE_ACCESSOR,useExisting:(0,e.forwardRef)(()=>ft),multi:!0}])],ngContentSelectors:["[tb-error]","[tb-hint]"],decls:15,vars:16,consts:[[1,"mat-block",3,"formGroup","floatLabel","appearance","subscriptSizing"],[4,"ngIf"],["matInput","","type","text","formControlName","widgetType",3,"placeholder","required","matAutocomplete","focusin"],["widgetTypeInput",""],["type","button","matSuffix","","mat-icon-button","","aria-label","Clear",3,"click",4,"ngIf"],[1,"tb-autocomplete","tb-widget-type-autocomplete",3,"displayWith"],["widgetTypeAutocomplete",""],[3,"value",4,"ngFor","ngForOf"],[3,"value",4,"ngIf"],["type","button","matSuffix","","mat-icon-button","","aria-label","Clear",3,"click"],[1,"material-icons"],[3,"value"],[1,"tb-widget-type-option-container"],[1,"tb-widget-type-option-image-preview",3,"src","alt"],[1,"tb-widget-type-option-details"],[1,"tb-widget-type-option-text",3,"innerHTML"],["class","tb-widget-type-option-deprecated",4,"ngIf"],[1,"tb-widget-type-option-deprecated"]],template:function(n,t){if(1&n&&(e.\u0275\u0275projectionDef(cp),e.\u0275\u0275elementStart(0,"mat-form-field",0),e.\u0275\u0275template(1,ap,2,1,"mat-label",1),e.\u0275\u0275elementStart(2,"input",2,3),e.\u0275\u0275listener("focusin",function(){return t.onFocus()}),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(4,op,3,0,"button",4),e.\u0275\u0275elementStart(5,"mat-autocomplete",5,6),e.\u0275\u0275template(7,sp,7,9,"mat-option",7),e.\u0275\u0275pipe(8,"async"),e.\u0275\u0275template(9,dp,4,6,"mat-option",8),e.\u0275\u0275pipe(10,"async"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(11,"mat-error"),e.\u0275\u0275projection(12),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(13,"mat-hint"),e.\u0275\u0275projection(14,1),e.\u0275\u0275elementEnd()()),2&n){const a=e.\u0275\u0275reference(6);let o;e.\u0275\u0275property("formGroup",t.selectWidgetTypeFormGroup)("floatLabel",t.floatLabel)("appearance",t.appearance)("subscriptSizing",t.subscriptSizing),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.label),e.\u0275\u0275advance(1),e.\u0275\u0275propertyInterpolate("placeholder",t.placeholder),e.\u0275\u0275property("required",t.required)("matAutocomplete",a),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",t.selectWidgetTypeFormGroup.get("widgetType").value&&!t.disabled),e.\u0275\u0275advance(1),e.\u0275\u0275property("displayWith",t.displayWidgetTypeFn),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",e.\u0275\u0275pipeBind1(8,12,t.filteredWidgetTypes)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!(null!=(o=e.\u0275\u0275pipeBind1(10,14,t.filteredWidgetTypes))&&o.length))}},dependencies:[p.NgForOf,p.NgIf,S.MatIconButton,F.MatIcon,O.MatInput,_.MatFormField,_.MatLabel,_.MatHint,_.MatError,_.MatSuffix,X.MatOption,ka.MatAutocomplete,ka.MatAutocompleteTrigger,r.DefaultValueAccessor,r.NgControlStatus,r.NgControlStatusGroup,r.RequiredValidator,r.FormGroupDirective,r.FormControlName,p.AsyncPipe,Wo.HighlightPipe,g.TranslatePipe],styles:['@charset "UTF-8";.tb-widget-type-autocomplete .mat-mdc-option .mdc-list-item__primary-text{width:100%}.tb-widget-type-autocomplete .mat-mdc-option .mdc-list-item__primary-text .tb-widget-type-option-container{display:flex;gap:8px;align-items:center}.tb-widget-type-autocomplete .mat-mdc-option .mdc-list-item__primary-text .tb-widget-type-option-image-preview{width:36px;max-height:100%;object-fit:contain;border-radius:6px}.tb-widget-type-autocomplete .mat-mdc-option .mdc-list-item__primary-text .tb-widget-type-option-details{flex:1;display:flex;align-items:center;justify-content:space-between}.tb-widget-type-autocomplete .mat-mdc-option .mdc-list-item__primary-text .tb-widget-type-option-details .tb-widget-type-option-text{font-size:14px;font-weight:400;letter-spacing:.2px}.tb-widget-type-autocomplete .mat-mdc-option .mdc-list-item__primary-text .tb-widget-type-option-details .tb-widget-type-option-deprecated{font-size:13px;font-weight:400;color:#0000008a}\n'],encapsulation:2}),(0,gt.__decorate)([(0,qa.coerceBoolean)(),(0,gt.__metadata)("design:type",Boolean)],ft.prototype,"required",void 0);var mp=c(31931);function up(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"button",19),e.\u0275\u0275pipe(1,"async"),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementStart(3,"mat-icon"),e.\u0275\u0275text(4,"add"),e.\u0275\u0275elementEnd()()),2&i){const t=e.\u0275\u0275nextContext(),a=e.\u0275\u0275reference(14);e.\u0275\u0275propertyInterpolate("matTooltip",e.\u0275\u0275pipeBind1(2,5,"widget.add-new-widget")),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(1,3,t.isLoading$))("matMenuTriggerFor",a)}}function gp(i,n){1&i&&e.\u0275\u0275element(0,"mat-progress-bar",20)}function fp(i,n){1&i&&e.\u0275\u0275element(0,"div",21)}function hp(i,n){1&i&&(e.\u0275\u0275elementStart(0,"div",30),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(2,1,"widget.deprecated")))}function bp(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",2),e.\u0275\u0275listener("click",function(o){e.\u0275\u0275restoreView(t);const s=e.\u0275\u0275nextContext().$implicit,l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.openWidgetEditor(o,s))}),e.\u0275\u0275pipe(1,"translate"),e.\u0275\u0275elementStart(2,"mat-icon"),e.\u0275\u0275text(3,"edit"),e.\u0275\u0275elementEnd()()}2&i&&e.\u0275\u0275propertyInterpolate("matTooltip",e.\u0275\u0275pipeBind1(1,1,"widget.edit"))}function yp(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",2),e.\u0275\u0275listener("click",function(o){e.\u0275\u0275restoreView(t);const s=e.\u0275\u0275nextContext().$implicit,l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.exportWidgetType(o,s))}),e.\u0275\u0275pipe(1,"translate"),e.\u0275\u0275elementStart(2,"mat-icon"),e.\u0275\u0275text(3,"file_download"),e.\u0275\u0275elementEnd()()}2&i&&e.\u0275\u0275propertyInterpolate("matTooltip",e.\u0275\u0275pipeBind1(1,1,"widget.export"))}function vp(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",2),e.\u0275\u0275listener("click",function(o){e.\u0275\u0275restoreView(t);const s=e.\u0275\u0275nextContext().$implicit,l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.removeWidgetType(o,s))}),e.\u0275\u0275pipe(1,"translate"),e.\u0275\u0275elementStart(2,"mat-icon"),e.\u0275\u0275text(3,"delete"),e.\u0275\u0275elementEnd()()}2&i&&e.\u0275\u0275propertyInterpolate("matTooltip",e.\u0275\u0275pipeBind1(1,1,"widget.remove"))}function _p(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"button",31),e.\u0275\u0275pipe(1,"translate"),e.\u0275\u0275elementStart(2,"tb-icon"),e.\u0275\u0275text(3,"drag_indicator"),e.\u0275\u0275elementEnd()()),2&i){const t=e.\u0275\u0275nextContext(2);e.\u0275\u0275propertyInterpolate("matTooltip",e.\u0275\u0275pipeBind1(1,2,"action.drag")),e.\u0275\u0275property("fxShow",(null==t.widgets?null:t.widgets.length)>1)}}const xp=function(){return{preview:!0,emptyUrl:"/assets/widget-preview-empty.svg"}};function Cp(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",22)(1,"div",23),e.\u0275\u0275element(2,"img",24),e.\u0275\u0275pipe(3,"async"),e.\u0275\u0275pipe(4,"image"),e.\u0275\u0275elementStart(5,"div",25)(6,"div",26),e.\u0275\u0275text(7),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(8,hp,3,3,"div",27),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(9,bp,4,3,"button",28),e.\u0275\u0275template(10,yp,4,3,"button",28),e.\u0275\u0275template(11,vp,4,3,"button",28),e.\u0275\u0275template(12,_p,4,4,"button",29),e.\u0275\u0275elementEnd()),2&i){const t=n.$implicit,a=e.\u0275\u0275nextContext();e.\u0275\u0275advance(2),e.\u0275\u0275propertyInterpolate("alt",t.name),e.\u0275\u0275property("src",e.\u0275\u0275pipeBind1(3,8,e.\u0275\u0275pipeBind2(4,10,t.image,e.\u0275\u0275pureFunction0(13,xp))),e.\u0275\u0275sanitizeUrl),e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate(t.name),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.deprecated),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!a.editMode),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!a.editMode),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",a.editMode&&!a.addMode),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",a.editMode)}}function Tp(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",32),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.addWidgetMode())}),e.\u0275\u0275pipe(1,"translate"),e.\u0275\u0275elementStart(2,"tb-icon",33),e.\u0275\u0275text(3,"add"),e.\u0275\u0275elementEnd()()}2&i&&e.\u0275\u0275propertyInterpolate("matTooltip",e.\u0275\u0275pipeBind1(1,1,"widget.add-existing-widget"))}function Sp(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",34)(1,"div",35),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.addWidgetMode())}),e.\u0275\u0275elementStart(2,"tb-icon",33),e.\u0275\u0275text(3,"add"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"div",36),e.\u0275\u0275text(5,"widget.add-existing-widget"),e.\u0275\u0275elementEnd()()()}}function Ip(i,n){1&i&&(e.\u0275\u0275elementStart(0,"div",37),e.\u0275\u0275element(1,"div",38),e.\u0275\u0275elementStart(2,"div",39),e.\u0275\u0275text(3,"widget.no-widgets"),e.\u0275\u0275elementEnd()())}function wp(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",40),e.\u0275\u0275element(1,"tb-widget-type-autocomplete",41),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementStart(3,"div",42)(4,"button",43),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.cancelAddWidgetMode())}),e.\u0275\u0275pipe(5,"async"),e.\u0275\u0275text(6),e.\u0275\u0275pipe(7,"translate"),e.\u0275\u0275elementEnd()()()}if(2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275propertyInterpolate("placeholder",e.\u0275\u0275pipeBind1(2,5,"widget.select-widget")),e.\u0275\u0275property("excludeWidgetTypeIds",t.excludeWidgetTypeIds)("formControl",t.addWidgetFormControl),e.\u0275\u0275advance(3),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(5,7,t.isLoading$)),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1("",e.\u0275\u0275pipeBind1(7,9,"action.cancel")," ")}}function Ep(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",43),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.cancel())}),e.\u0275\u0275pipe(1,"async"),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"translate"),e.\u0275\u0275elementEnd()}if(2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(1,2,t.isLoading$)),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1("",e.\u0275\u0275pipeBind1(3,4,"action.cancel")," ")}}function Mp(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",44),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.save())}),e.\u0275\u0275pipe(1,"async"),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"translate"),e.\u0275\u0275elementEnd()}if(2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(1,2,t.isLoading$)||!t.isDirty),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1("",e.\u0275\u0275pipeBind1(3,4,"action.save")," ")}}function Dp(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",44),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.edit())}),e.\u0275\u0275pipe(1,"async"),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"translate"),e.\u0275\u0275elementEnd()}if(2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(1,2,t.isLoading$)),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1("",e.\u0275\u0275pipeBind1(3,4,"action.edit")," ")}}class Pi extends se.I{constructor(n,t,a,o,s,l,d){super(n),this.store=n,this.router=t,this.route=a,this.widgetsService=o,this.importExport=s,this.cd=l,this.dialog=d,this.editMode=!1,this.addMode=!1,this.isDirty=!1,this.addWidgetFormControl=new r.FormControl(null,[r.Validators.required]),this.authUser=(0,q.fP)(this.store),this.widgetsBundle=this.route.snapshot.data.widgetsBundle,this.widgets=[...this.route.snapshot.data.widgets],this.authUser.authority===u.W.TENANT_ADMIN?this.isReadOnly=!this.widgetsBundle||this.widgetsBundle.tenantId.id===P._:this.isReadOnly=this.authUser.authority!==u.W.SYS_ADMIN,!this.isReadOnly&&!this.widgets.length&&(this.editMode=!0),this.addWidgetFormControl.valueChanges.subscribe(m=>{m&&this.addWidget(m)})}ngOnInit(){}trackByWidget(n,t){return t}widgetDrop(n){const t=this.widgets[n.previousIndex];this.widgets.splice(n.previousIndex,1),this.widgets.splice(n.currentIndex,0,t),this.isDirty=!0}addWidgetMode(){this.addWidgetFormControl.patchValue(null,{emitEvent:!1}),this.excludeWidgetTypeIds=this.widgets.map(n=>n.id.id),this.addMode=!0}cancelAddWidgetMode(){this.addMode=!1}addWidget(n){this.widgets.push(n),this.isDirty=!0,this.addMode=!1}openWidgetEditor(n,t){n&&n.stopPropagation(),this.router.navigate([t.id.id],{relativeTo:this.route}).then(()=>{})}exportWidgetType(n,t){n&&n.stopPropagation(),this.importExport.exportWidgetType(t.id.id)}removeWidgetType(n,t){n&&n.stopPropagation();const a=this.widgets.indexOf(t);this.widgets.splice(a,1),this.isDirty=!0}goBack(){this.router.navigate([".."],{relativeTo:this.route})}exportWidgetsBundle(){this.importExport.exportWidgetsBundle(this.widgetsBundle.id.id)}edit(){this.editMode=!0}cancel(){this.isDirty?this.widgetsService.getBundleWidgetTypeInfosList(this.widgetsBundle.id.id).subscribe(n=>{this.widgets=[...n],this.isDirty=!1,this.addMode=!1,this.editMode=!this.widgets.length,this.cd.markForCheck()}):(this.addMode=!1,this.editMode=!this.widgets.length)}save(){const n=this.widgets.map(t=>t.id.id);this.widgetsService.updateWidgetsBundleWidgetTypes(this.widgetsBundle.id.id,n).subscribe(()=>{this.isDirty=!1,this.editMode=!1,this.addMode=!1})}addWidgetType(n){n&&n.stopPropagation(),this.dialog.open(Rn,{disableClose:!0,panelClass:["tb-dialog","tb-fullscreen-dialog"]}).afterClosed().subscribe(t=>{t&&this.router.navigate([t],{relativeTo:this.route}).then(()=>{})})}importWidgetType(){this.importExport.importWidgetType().subscribe(n=>{if(n){const t=this.widgets.some(a=>a.id.id===n.id.id);t&&(this.widgets=this.widgets.map(a=>a.id.id!==n.id.id?a:n)),this.editMode?(this.widgets.push(n),this.isDirty=!0,this.cd.markForCheck()):t||this.widgetsService.addWidgetFqnToWidgetBundle(this.widgetsBundle.id.id,n.fqn).subscribe(()=>{this.widgets.push(n),this.cd.markForCheck()})}})}}Pi.\u0275fac=function(n){return new(n||Pi)(e.\u0275\u0275directiveInject(x.Store),e.\u0275\u0275directiveInject(b.Router),e.\u0275\u0275directiveInject(b.ActivatedRoute),e.\u0275\u0275directiveInject(ze.i),e.\u0275\u0275directiveInject(ct.s),e.\u0275\u0275directiveInject(e.ChangeDetectorRef),e.\u0275\u0275directiveInject(C.MatDialog))},Pi.\u0275cmp=e.\u0275\u0275defineComponent({type:Pi,selectors:[["tb-widgets-bundle-widget"]],features:[e.\u0275\u0275InheritDefinitionFeature],decls:46,vars:33,consts:[["appearance","outlined",1,"tb-bundle-widgets-card"],[1,"title-container"],["mat-icon-button","","matTooltipPosition","above",3,"matTooltip","click"],[1,"mat-headline-5"],["fxFlex",""],["mat-icon-button","","matTooltipPosition","above",3,"disabled","matTooltip","matMenuTriggerFor",4,"ngIf"],["xPosition","before"],["addWidgetMenu","matMenu"],["mat-menu-item","",3,"click"],["color","warn","mode","indeterminate",4,"ngIf"],["style","height: 4px;",4,"ngIf"],["cdkDropList","","cdkDropListOrientation","vertical",1,"tb-drop-list","tb-bundle-widgets-container",3,"cdkDropListDisabled","cdkDropListDropped"],["cdkDrag","","class","tb-draggable tb-bundle-widget-row",4,"ngFor","ngForOf","ngForTrackBy"],["class","tb-add-widget-button","matTooltipPosition","above",3,"matTooltip","click",4,"ngIf"],["class","tb-add-widget-button-panel",4,"ngIf"],["class","tb-no-data-available",4,"ngIf"],["class","tb-add-bundle-widget-form",4,"ngIf"],["mat-button","","color","primary",3,"disabled","click",4,"ngIf"],["mat-raised-button","","color","primary",3,"disabled","click",4,"ngIf"],["mat-icon-button","","matTooltipPosition","above",3,"disabled","matTooltip","matMenuTriggerFor"],["color","warn","mode","indeterminate"],[2,"height","4px"],["cdkDrag","",1,"tb-draggable","tb-bundle-widget-row"],[1,"tb-bundle-widget-row-details"],[1,"tb-bundle-widget-image-preview",3,"src","alt"],[1,"tb-bundle-widget-details"],[1,"tb-bundle-widget-title"],["class","tb-bundle-widget-deprecated",4,"ngIf"],["mat-icon-button","","matTooltipPosition","above",3,"matTooltip","click",4,"ngIf"],["cdkDragHandle","","mat-icon-button","","matTooltipPosition","above","class","tb-drag-handle",3,"fxShow","matTooltip",4,"ngIf"],[1,"tb-bundle-widget-deprecated"],["cdkDragHandle","","mat-icon-button","","matTooltipPosition","above",1,"tb-drag-handle",3,"fxShow","matTooltip"],["matTooltipPosition","above",1,"tb-add-widget-button",3,"matTooltip","click"],["color","primary",1,"tb-add-widget-icon"],[1,"tb-add-widget-button-panel"],[1,"tb-add-widget-button-with-text",3,"click"],["translate","",1,"tb-add-widget-button-text"],[1,"tb-no-data-available"],[1,"tb-no-data-bg"],["translate","",1,"tb-no-data-text"],[1,"tb-add-bundle-widget-form"],["required","",3,"placeholder","excludeWidgetTypeIds","formControl"],[1,"tb-add-bundle-widget-actions"],["mat-button","","color","primary",3,"disabled","click"],["mat-raised-button","","color","primary",3,"disabled","click"]],template:function(n,t){1&n&&(e.\u0275\u0275elementStart(0,"mat-card",0)(1,"mat-card-header")(2,"mat-card-title")(3,"div",1)(4,"button",2),e.\u0275\u0275listener("click",function(){return t.goBack()}),e.\u0275\u0275pipe(5,"translate"),e.\u0275\u0275elementStart(6,"mat-icon"),e.\u0275\u0275text(7,"arrow_back"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(8,"span",3),e.\u0275\u0275text(9),e.\u0275\u0275pipe(10,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(11,"span",4),e.\u0275\u0275template(12,up,5,7,"button",5),e.\u0275\u0275elementStart(13,"mat-menu",6,7)(15,"button",8),e.\u0275\u0275listener("click",function(o){return t.addWidgetType(o)}),e.\u0275\u0275elementStart(16,"mat-icon"),e.\u0275\u0275text(17,"insert_drive_file"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(18,"span"),e.\u0275\u0275text(19),e.\u0275\u0275pipe(20,"translate"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(21,"button",8),e.\u0275\u0275listener("click",function(){return t.importWidgetType()}),e.\u0275\u0275elementStart(22,"mat-icon"),e.\u0275\u0275text(23,"file_upload"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(24,"span"),e.\u0275\u0275text(25),e.\u0275\u0275pipe(26,"translate"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(27,"button",2),e.\u0275\u0275listener("click",function(){return t.exportWidgetsBundle()}),e.\u0275\u0275pipe(28,"translate"),e.\u0275\u0275elementStart(29,"mat-icon"),e.\u0275\u0275text(30,"file_download"),e.\u0275\u0275elementEnd()()()()(),e.\u0275\u0275template(31,gp,1,0,"mat-progress-bar",9),e.\u0275\u0275pipe(32,"async"),e.\u0275\u0275template(33,fp,1,0,"div",10),e.\u0275\u0275pipe(34,"async"),e.\u0275\u0275elementStart(35,"mat-card-content")(36,"div",11),e.\u0275\u0275listener("cdkDropListDropped",function(o){return t.widgetDrop(o)}),e.\u0275\u0275template(37,Cp,13,14,"div",12),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(38,Tp,4,3,"div",13),e.\u0275\u0275template(39,Sp,6,0,"div",14),e.\u0275\u0275template(40,Ip,4,0,"div",15),e.\u0275\u0275template(41,wp,8,11,"div",16),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(42,"mat-card-actions"),e.\u0275\u0275template(43,Ep,4,6,"button",17),e.\u0275\u0275template(44,Mp,4,6,"button",18),e.\u0275\u0275template(45,Dp,4,6,"button",18),e.\u0275\u0275elementEnd()()),2&n&&(e.\u0275\u0275advance(4),e.\u0275\u0275propertyInterpolate("matTooltip",e.\u0275\u0275pipeBind1(5,19,"action.back")),e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate2("",t.widgetsBundle.title,": ",e.\u0275\u0275pipeBind1(10,21,"widget.widgets"),""),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",!t.isReadOnly),e.\u0275\u0275advance(7),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(20,23,"dashboard.create-new-widget")),e.\u0275\u0275advance(6),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(26,25,"widget.import")),e.\u0275\u0275advance(2),e.\u0275\u0275propertyInterpolate("matTooltip",e.\u0275\u0275pipeBind1(28,27,"widgets-bundle.export")),e.\u0275\u0275advance(4),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(32,29,t.isLoading$)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!1===e.\u0275\u0275pipeBind1(34,31,t.isLoading$)),e.\u0275\u0275advance(3),e.\u0275\u0275property("cdkDropListDisabled",!t.editMode||(null==t.widgets?null:t.widgets.length)<2),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",t.widgets)("ngForTrackBy",t.trackByWidget),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.editMode&&!t.addMode&&(null==t.widgets?null:t.widgets.length)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.editMode&&!t.addMode&&!(null!=t.widgets&&t.widgets.length)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.isReadOnly&&!(null!=t.widgets&&t.widgets.length)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.addMode),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",t.editMode&&((null==t.widgets?null:t.widgets.length)||t.isDirty)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.editMode&&((null==t.widgets?null:t.widgets.length)||t.isDirty)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!t.isReadOnly&&!t.editMode))},dependencies:[p.NgForOf,p.NgIf,S.MatButton,S.MatIconButton,F.MatIcon,A.MatCard,A.MatCardActions,A.MatCardContent,A.MatCardHeader,A.MatCardTitle,z.MatProgressBar,Oe.MatMenu,Oe.MatMenuItem,Oe.MatMenuTrigger,Ln.MatTooltip,mo.CdkDropList,mo.CdkDrag,mo.CdkDragHandle,h.DefaultFlexDirective,G.DefaultShowHideDirective,r.NgControlStatus,r.RequiredValidator,r.FormControlDirective,g.TranslateDirective,Wa.TbIconComponent,ft,p.AsyncPipe,mp.ImagePipe,g.TranslatePipe],styles:['@charset "UTF-8";[_nghost-%COMP%]{width:100%;height:100%;padding:8px}[_nghost-%COMP%]     .tb-bundle-widgets-card .mat-mdc-card-header-text{flex:1}.tb-bundle-widgets-card[_ngcontent-%COMP%]{padding:0;width:100%;height:100%;display:flex;flex-direction:column}@media screen and (min-width: 960px) and (max-width: 1279px){.tb-bundle-widgets-card[_ngcontent-%COMP%]{width:80%}}@media screen and (min-width: 1280px){.tb-bundle-widgets-card[_ngcontent-%COMP%]{width:60%}}.tb-bundle-widgets-card[_ngcontent-%COMP%]   .title-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;gap:8px}.tb-bundle-widgets-card[_ngcontent-%COMP%]   .title-container[_ngcontent-%COMP%]   .mat-headline-5[_ngcontent-%COMP%]{margin:0}.tb-bundle-widgets-card[_ngcontent-%COMP%]   .mat-mdc-card-content[_ngcontent-%COMP%]{flex:1;padding:16px;min-height:0;overflow:hidden;display:flex;flex-direction:column;gap:8px}.tb-bundle-widgets-card[_ngcontent-%COMP%]   .tb-add-widget-button[_ngcontent-%COMP%]{min-height:56px;cursor:pointer;display:flex;flex-direction:column;justify-content:center;align-items:center;padding:8px;border:2px dashed rgba(0,0,0,.08);border-radius:10px}.tb-bundle-widgets-card[_ngcontent-%COMP%]   .tb-add-widget-button-panel[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center}.tb-bundle-widgets-card[_ngcontent-%COMP%]   .tb-add-widget-button-panel[_ngcontent-%COMP%]   .tb-add-widget-button-with-text[_ngcontent-%COMP%]{cursor:pointer;display:flex;padding:24px 40px 24px 24px;justify-content:center;align-items:center;gap:8px;border:2px dashed rgba(0,0,0,.12);border-radius:10px}.tb-bundle-widgets-card[_ngcontent-%COMP%]   .tb-add-widget-button-panel[_ngcontent-%COMP%]   .tb-add-widget-button-with-text[_ngcontent-%COMP%]   .tb-add-widget-button-text[_ngcontent-%COMP%]{font-size:16px;font-style:normal;font-weight:500;line-height:24px;letter-spacing:.25px;color:#424242}.tb-bundle-widgets-card[_ngcontent-%COMP%]   .tb-add-bundle-widget-form[_ngcontent-%COMP%]{display:flex;padding:16px;flex-direction:column;gap:12px;border-radius:10px;border:1px solid rgba(0,0,0,.05);box-shadow:0 5px 16px #0000000a}.tb-bundle-widgets-card[_ngcontent-%COMP%]   .tb-add-bundle-widget-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;align-items:flex-start;gap:16px}.tb-bundle-widgets-card[_ngcontent-%COMP%]   .mat-mdc-card-actions[_ngcontent-%COMP%]{justify-content:end;gap:8px}.tb-bundle-widgets-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px;min-height:0;overflow:auto;padding-top:8px;padding-bottom:8px}.tb-bundle-widget-row[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;padding:6px 12px 6px 6px;gap:12px;border-radius:10px;border:1px solid rgba(0,0,0,.05);box-shadow:0 5px 16px #0000000a}.tb-bundle-widget-row[_ngcontent-%COMP%]   .tb-bundle-widget-row-details[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:row;align-items:center;gap:12px}.tb-bundle-widget-row[_ngcontent-%COMP%]   .tb-bundle-widget-row-details[_ngcontent-%COMP%]   .tb-bundle-widget-image-preview[_ngcontent-%COMP%]{width:64px;max-height:52px;height:100%;object-fit:contain;border-radius:6px}.tb-bundle-widget-row[_ngcontent-%COMP%]   .tb-bundle-widget-row-details[_ngcontent-%COMP%]   .tb-bundle-widget-details[_ngcontent-%COMP%]{padding:18px 0;flex:1;display:flex;flex-direction:row;align-items:center;justify-content:space-between}.tb-bundle-widget-row[_ngcontent-%COMP%]   .tb-bundle-widget-row-details[_ngcontent-%COMP%]   .tb-bundle-widget-details[_ngcontent-%COMP%]   .tb-bundle-widget-title[_ngcontent-%COMP%]{font-size:14px;font-weight:400;letter-spacing:.2px}.tb-bundle-widget-row[_ngcontent-%COMP%]   .tb-bundle-widget-row-details[_ngcontent-%COMP%]   .tb-bundle-widget-details[_ngcontent-%COMP%]   .tb-bundle-widget-deprecated[_ngcontent-%COMP%]{font-size:13px;font-weight:400}']});const qo=[{path:":widgetTypeId",component:Ni,canDeactivate:[N.P],data:{auth:[u.W.SYS_ADMIN,u.W.TENANT_ADMIN],title:"widget.editor",breadcrumb:{labelFunction:(i,n,t)=>t?.widget?.widgetName?t.widget.widgetName+(t.widget.deprecated?` (${n.instant("widget.deprecated")})`:""):"",icon:"insert_chart"},hideTabs:!0},resolve:{widgetEditorData:i=>{const n=i.params.widgetTypeId;if(!n||Object.keys(Se.oS).includes(n)){let t=n;return t||(t=Se.oS.timeseries),(0,e.inject)(ze.i).getWidgetTemplate(t).pipe((0,re.U)(a=>(a.widgetName=null,{widgetTypeDetails:null,widget:a})))}return(0,e.inject)(ze.i).getWidgetTypeById(n).pipe((0,re.U)(t=>({widgetTypeDetails:t,widget:(0,No.cJ)(t)})))}}}],kp=[{path:"widget-types",data:{breadcrumb:{label:"widget.widgets",icon:"now_widgets"}},children:[{path:"",component:j.EntitiesTableComponent,data:{auth:[u.W.SYS_ADMIN,u.W.TENANT_ADMIN],title:"widget.widgets"},resolve:{entitiesTableConfig:ut}},{path:"details",children:[{path:":entityId",component:ee.Y,canDeactivate:[N.P],data:{breadcrumb:{labelFunction:te,icon:"now_widgets"},auth:[u.W.SYS_ADMIN,u.W.TENANT_ADMIN],title:"widget.widgets",hideTabs:!0,backNavigationCommands:["../.."]},resolve:{entitiesTableConfig:ut}}]},...qo]}],Rp=[{path:"widgets-bundles",data:{breadcrumb:{label:"widgets-bundle.widgets-bundles",icon:"now_widgets"}},children:[{path:"",component:j.EntitiesTableComponent,data:{auth:[u.W.SYS_ADMIN,u.W.TENANT_ADMIN],title:"widgets-bundle.widgets-bundles"},resolve:{entitiesTableConfig:mt}},{path:"details",children:[{path:":entityId",component:ee.Y,canDeactivate:[N.P],data:{breadcrumb:{labelFunction:te,icon:"now_widgets"},auth:[u.W.SYS_ADMIN,u.W.TENANT_ADMIN],title:"widgets-bundle.widgets-bundles",hideTabs:!0,backNavigationCommands:["../.."]},resolve:{entitiesTableConfig:mt}}]},{path:":widgetsBundleId",data:{breadcrumb:{labelFunction:i=>i.data.widgetsBundle.title,icon:"now_widgets"}},resolve:{widgetsBundle:i=>{const n=i.params.widgetsBundleId;return(0,e.inject)(ze.i).getWidgetsBundle(n)}},children:[{path:"",component:Pi,canDeactivate:[N.P],data:{auth:[u.W.SYS_ADMIN,u.W.TENANT_ADMIN],title:"widgets-bundle.widgets-bundle-widgets",hideTabs:!0},resolve:{widgets:i=>{const n=i.params.widgetsBundleId;return(0,e.inject)(ze.i).getBundleWidgetTypeInfosList(n)}}},...qo]}]}],Op=[{path:"widgets-library",component:ja.x,data:{auth:[u.W.SYS_ADMIN,u.W.TENANT_ADMIN],breadcrumb:{label:"widget.widget-library",icon:"now_widgets"}},children:[{path:"",children:[],data:{auth:[u.W.SYS_ADMIN,u.W.TENANT_ADMIN],redirectTo:"/resources/widgets-library/widget-types"}},...kp,...Rp]}];class ht{}ht.\u0275fac=function(n){return new(n||ht)},ht.\u0275mod=e.\u0275\u0275defineNgModule({type:ht}),ht.\u0275inj=e.\u0275\u0275defineInjector({providers:[ut,mt],imports:[b.RouterModule.forChild([{path:"widgets-bundles",pathMatch:"full",redirectTo:"/resources/widgets-library/widgets-bundles"},{path:"resources/widgets-bundles",pathMatch:"full",redirectTo:"/resources/widgets-library/widgets-bundles"},{path:"widgets-bundles/:widgetsBundleId/widgetTypes",pathMatch:"full",redirectTo:"/resources/widgets-library/widgets-bundles/:widgetsBundleId"},{path:"resources/widgets-bundles/:widgetsBundleId/widgetTypes",pathMatch:"full",redirectTo:"/resources/widgets-library/widgets-bundles/:widgetsBundleId"},{path:"widgets-bundles/:widgetsBundleId/widgetTypes/:widgetTypeId",pathMatch:"full",redirectTo:"/resources/widgets-library/widget-types/:widgetTypeId"},{path:"resources/widgets-bundles/:widgetsBundleId/widgetTypes/:widgetTypeId",pathMatch:"full",redirectTo:"/resources/widgets-library/widget-types/:widgetTypeId"},{path:"widgets-bundles/:widgetsBundleId/widgetTypes/add/:widgetType",redirectTo:"/resources/widgets-library/widget-types/:widgetType"},{path:"resources/widgets-bundles/:widgetsBundleId/widgetTypes/add/:widgetType",redirectTo:"/resources/widgets-library/widget-types/:widgetType"}]),b.RouterModule]}),(typeof ngJitMode>"u"||ngJitMode)&&e.\u0275\u0275setNgModuleScope(ht,{imports:[b.RouterModule],exports:[b.RouterModule]});var Be=c(32428);const Vp=[{path:"auditLogs",component:Be.AuditLogTableComponent,data:{auth:[u.W.TENANT_ADMIN],title:"audit-log.audit-logs",breadcrumb:{label:"audit-log.audit-logs",icon:"track_changes"},isPage:!0}}];class bt{}bt.\u0275fac=function(n){return new(n||bt)},bt.\u0275mod=e.\u0275\u0275defineNgModule({type:bt}),bt.\u0275inj=e.\u0275\u0275defineInjector({imports:[b.RouterModule.forChild([{path:"auditLogs",redirectTo:"/security-settings/auditLogs"}]),b.RouterModule]}),(typeof ngJitMode>"u"||ngJitMode)&&e.\u0275\u0275setNgModuleScope(bt,{imports:[b.RouterModule],exports:[b.RouterModule]});var Gp=c(85482),go=c(75266),$a=c(82153),fo=c(9933);function jp(i,n){1&i&&e.\u0275\u0275element(0,"mat-progress-bar",24)}function Wp(i,n){1&i&&e.\u0275\u0275element(0,"div",25)}function qp(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-option",26),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){const t=n.$implicit;e.\u0275\u0275property("value",t),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(t.title||t.name)}}function $p(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"span"),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275nextContext().$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1("(",t.uname,")")}}function Hp(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"span",38)(1,"mat-form-field")(2,"mat-label"),e.\u0275\u0275text(3,"Icon"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"input",39),e.\u0275\u0275listener("input",function(o){e.\u0275\u0275restoreView(t);const s=e.\u0275\u0275nextContext().$implicit,l=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(l.inputMenuData(o,s.id,"icon"))}),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(5,"mat-form-field")(6,"mat-label"),e.\u0275\u0275text(7,"Name"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(8,"input",40),e.\u0275\u0275listener("input",function(o){e.\u0275\u0275restoreView(t);const s=e.\u0275\u0275nextContext().$implicit,l=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(l.inputMenuData(o,s.id,"title"))}),e.\u0275\u0275elementEnd()()()}if(2&i){const t=e.\u0275\u0275nextContext().$implicit;e.\u0275\u0275advance(4),e.\u0275\u0275property("value",t.icon),e.\u0275\u0275advance(4),e.\u0275\u0275property("value",t.name)}}function zp(i,n){1&i&&e.\u0275\u0275elementContainer(0)}const $o=function(i){return{$implicit:i}};function Kp(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"mat-list",41),e.\u0275\u0275listener("dndDrop",function(o){e.\u0275\u0275restoreView(t);const s=e.\u0275\u0275nextContext().$implicit,l=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(l.onDrop(o,s.pages))}),e.\u0275\u0275template(1,zp,1,0,"ng-container",22),e.\u0275\u0275elementEnd()}if(2&i){const t=e.\u0275\u0275nextContext().$implicit;e.\u0275\u0275nextContext(2);const a=e.\u0275\u0275reference(23);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngTemplateOutlet",a)("ngTemplateOutletContext",e.\u0275\u0275pureFunction1(2,$o,t.pages))}}function Yp(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",29)(1,"mat-list-item",30),e.\u0275\u0275listener("dndMoved",function(){const s=e.\u0275\u0275restoreView(t).$implicit,l=e.\u0275\u0275nextContext().$implicit,d=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(d.onDragged(s,l,"move"))}),e.\u0275\u0275elementStart(2,"span",31)(3,"span",32)(4,"mat-icon"),e.\u0275\u0275text(5),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(6,"span"),e.\u0275\u0275text(7),e.\u0275\u0275pipe(8,"translate"),e.\u0275\u0275template(9,$p,2,1,"span",33),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(10,"div")(11,"button",34),e.\u0275\u0275listener("click",function(){const s=e.\u0275\u0275restoreView(t).$implicit,l=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(l.updateMenuItem(s))}),e.\u0275\u0275elementStart(12,"mat-icon"),e.\u0275\u0275text(13),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(14,"button",35),e.\u0275\u0275listener("click",function(){const s=e.\u0275\u0275restoreView(t).$implicit,l=e.\u0275\u0275nextContext().$implicit,d=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(d.removeItemFromMenu(s,l))}),e.\u0275\u0275elementStart(15,"mat-icon"),e.\u0275\u0275text(16,"delete"),e.\u0275\u0275elementEnd()()()(),e.\u0275\u0275template(17,Hp,9,2,"span",36),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(18,Kp,2,4,"mat-list",37),e.\u0275\u0275elementEnd()}if(2&i){const t=n.$implicit,a=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275styleProp("height",(null==a.editMenuItem?null:a.editMenuItem.id)==t.id?"100px":"auto"),e.\u0275\u0275property("dndDraggable",t),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate(t.icon),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1("",e.\u0275\u0275pipeBind1(8,9,t.name)," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",null==t?null:t.uname),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate((null==a.editMenuItem?null:a.editMenuItem.id)==t.id?"save":"edit"),e.\u0275\u0275advance(4),e.\u0275\u0275property("ngIf",(null==a.editMenuItem?null:a.editMenuItem.id)==t.id),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.pages)}}function Jp(i,n){if(1&i&&(e.\u0275\u0275element(0,"mat-list-item",27),e.\u0275\u0275template(1,Yp,19,11,"div",28)),2&i){const t=n.$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",t)}}function Qp(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div")(1,"mat-list")(2,"mat-list-item",42)(3,"span",31)(4,"span"),e.\u0275\u0275text(5),e.\u0275\u0275pipe(6,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(7,"button",43),e.\u0275\u0275listener("click",function(){const s=e.\u0275\u0275restoreView(t).$implicit,l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.sendPredefinedMenuToMenu(s))}),e.\u0275\u0275elementStart(8,"mat-icon"),e.\u0275\u0275text(9,"add"),e.\u0275\u0275elementEnd()()()()()()}if(2&i){const t=n.$implicit;e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(6,1,t.name))}}function Xp(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div")(1,"mat-list")(2,"mat-list-item",42)(3,"span",31)(4,"span"),e.\u0275\u0275text(5),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(6,"button",43),e.\u0275\u0275listener("click",function(){const s=e.\u0275\u0275restoreView(t).$implicit,l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.sendToMenu(s))}),e.\u0275\u0275elementStart(7,"mat-icon"),e.\u0275\u0275text(8,"add"),e.\u0275\u0275elementEnd()()()()()()}if(2&i){const t=n.$implicit;e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate(t.name)}}function Zp(i,n){1&i&&(e.\u0275\u0275elementStart(0,"p",44),e.\u0275\u0275text(1,"Select a customer to see available dashboards"),e.\u0275\u0275elementEnd())}function em(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"p",44),e.\u0275\u0275text(1,"To avail the menu here, assigned the "),e.\u0275\u0275elementStart(2,"a",45),e.\u0275\u0275text(3,"dashboard"),e.\u0275\u0275elementEnd(),e.\u0275\u0275text(4),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate1(" to '",t.selectedCustomer.name,"' customer.")}}function tm(i,n){1&i&&e.\u0275\u0275elementContainer(0)}class ki extends se.I{constructor(n,t,a,o,s,l){super(n),this.store=n,this.router=t,this.dashboardService=a,this.customerService=o,this.tenantService=s,this.fb=l,this.draggableList=[],this.dashboards=[],this.selectedCustomer=void 0,this.predefinedMenu=[{id:"home",name:"Home",type:"link",path:"/home",icon:"home",pages:[]},{id:"alarms",name:"Alarms",type:"link",path:"/alarms",icon:"warning",pages:[]},{id:"notification_inbox",name:"Notification",fullName:"Notification Inbox",type:"link",path:"/notification/inbox",icon:"inbox",pages:[]}],this.authState=(0,q.dE)(this.store)}ngOnInit(){const n=new Ua.H_(200);this.customerService.getCustomers(n).subscribe(t=>{this.customerList=t.data})}onDragged(n,t,a){if("move"===a){const o=t.indexOf(n);t.splice(o,1)}}onDrop(n,t){if(t&&("copy"===n.dropEffect||"move"===n.dropEffect)){let a=n.index;typeof a>"u"&&(a=t.length),t.splice(a,0,n.data)}}confirmForm(){}removeItemFromMenu(n,t){this.deleteObjectById(this.draggableList,n.id)}deleteObjectById(n,t){for(let a=0;a<n.length;a++){const o=n[a];if(o.id===t)return n.splice(a,1),!0;if(o.pages&&o.pages.length>0&&this.deleteObjectById(o.pages,t))return!0}return!1}sendToMenu(n){this.draggableList.push({id:(new Date).getTime(),uname:n.name,name:n.title,icon:"link",path:"/dashboards/"+n.id.id,type:n.type||"link",pages:[]})}sendPredefinedMenuToMenu(n){this.draggableList.push(n)}updateMenuItem(n){void 0===this.editMenuItem?this.editMenuItem=n:this.editMenuItem=void 0}inputMenuData(n,t,a){this.updateObjectById(this.draggableList,t,a,n.target.value)}updateObjectById(n,t,a,o){for(let s=0;s<n.length;s++){const l=n[s];l.id===t?"title"===a?n[s].name=o:n[s].icon=o:l.children&&l.children.length>0&&this.updateObjectById(l.children,t,a,o)}}saveMenu(){try{this.selectedCustomer.additionalInfo.satlConfig=JSON.parse(this.selectedCustomer.additionalInfo.satlConfig)}catch{this.selectedCustomer.additionalInfo.satlConfig={}}this.selectedCustomer.additionalInfo.satlConfig.menu=this.draggableList,this.selectedCustomer.additionalInfo.satlConfig=JSON.stringify(this.selectedCustomer.additionalInfo.satlConfig),this.customerService.saveCustomer(this.selectedCustomer).subscribe(()=>{this.store.dispatch(new V.zi({message:"Menu is saved to selected customer",type:"success",duration:750,verticalPosition:"top",horizontalPosition:"right"}))})}addPageToMenu(){this.draggableList.push({id:(new Date).getTime(),uname:"No link",name:"Untitled",icon:"home",path:"",type:"toggle",pages:[]})}customerSelected(n){this.selectedCustomer=n.value;try{const a=JSON.parse(this.selectedCustomer.additionalInfo.satlConfig);this.draggableList=a.menu||[]}catch{this.draggableList=[]}const t=new Ua.H_(200);this.dashboardService.getCustomerDashboards(this.selectedCustomer.id.id,t).subscribe(a=>{this.dashboards=a.data})}saveMenuToCurrentTenant(){localStorage.setItem("dev_menu",JSON.stringify(this.draggableList)),this.store.dispatch(new V.zi({message:"Menu set to current tenant",type:"success",duration:750,verticalPosition:"top",horizontalPosition:"right"}))}}ki.\u0275fac=function(n){return new(n||ki)(e.\u0275\u0275directiveInject(x.Store),e.\u0275\u0275directiveInject(b.Router),e.\u0275\u0275directiveInject(ro.s),e.\u0275\u0275directiveInject($e.v),e.\u0275\u0275directiveInject(go.a),e.\u0275\u0275directiveInject(r.UntypedFormBuilder))},ki.\u0275cmp=e.\u0275\u0275defineComponent({type:ki,selectors:[["tb-menu-config-admin-settings"]],features:[e.\u0275\u0275InheritDefinitionFeature],decls:48,vars:19,consts:[["appearance","outlined",1,"settings-card"],["fxLayout","","fxLayoutAlign","space-between center"],[1,"mat-headline-5"],["mat-raised-button","","color","primary",3,"click"],["mat-icon-button","","color","primary",3,"disabled","click"],["color","warn","mode","indeterminate",4,"ngIf"],["style","height: 4px;",4,"ngIf"],[2,"padding-top","16px"],[1,"container-fluid"],[2,"width","100%"],[3,"selectionChange"],[3,"value",4,"ngFor","ngForOf"],["recursiveList",""],["fxLayout","","fxLayout.lt-lg","column"],["fxFlex","25","fxFlex.lt-lg","100",1,"px-1"],[1,"text-xl","bg-cyan-700","p-2","text-white"],[4,"ngFor","ngForOf"],["class","text-slate-400 hover:text-sky-400 text-xs",4,"ngIf"],["fxFlex","50","fxFlex.lt-lg","100",1,"px-1"],["fxLayout","","fxLayoutAlign","space-between center",1,"text-xl","bg-cyan-700","p-2","text-white"],["mat-icon-button","","color","primary",2,"width","30px","height","30px","padding","0",3,"click"],["dndDropzone","","dndEffectAllowed","move",1,"d-flex","flex-column","bg-light","gap-1",3,"dndDrop"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["fxFlex","25","fxFlex.lt-lg","100",1,"px-1",2,"font-size","12px"],["color","warn","mode","indeterminate"],[2,"height","4px"],[3,"value"],["dndPlaceholderRef","",1,"dndPlaceholder","border","bg-opacity-25","mb-1"],["class","",4,"ngFor","ngForOf"],[1,""],["dndEffectAllowed","move",1,"border","bg-white","ms-n3",3,"dndDraggable","dndMoved"],["matListItemTitle","","fxLayout","","fxLayoutAlign","space-between center"],["fxLayout","","fxLayoutAlign","start center","fxLayoutGap","5px"],[4,"ngIf"],["mat-icon-button","","color","accent",3,"click"],["mat-icon-button","","color","warn",3,"click"],["matListItemLine","","style","margin-top: 10px","fxLayout","","fxLayoutGap","5px",4,"ngIf"],["class","d-flex flex-column bg-light pt-2 pb-0 ps-2","style","min-height: unset; padding-left: 30px;","dndDropzone","","dndEffectAllowed","move",3,"dndDrop",4,"ngIf"],["matListItemLine","","fxLayout","","fxLayoutGap","5px",2,"margin-top","10px"],["matInput","","placeholder","Enter icon",3,"value","input"],["matInput","","placeholder","Enter name",3,"value","input"],["dndDropzone","","dndEffectAllowed","move",1,"d-flex","flex-column","bg-light","pt-2","pb-0","ps-2",2,"min-height","unset","padding-left","30px",3,"dndDrop"],[1,"border","bg-white","ms-n3",2,"position","relative"],["mat-icon-button","","color","primary",2,"background-color","transparent","position","absolute","top","0","right","0",3,"click"],[1,"text-slate-400","hover:text-sky-400","text-xs"],["routerLink","/dashboards"]],template:function(n,t){if(1&n&&(e.\u0275\u0275elementStart(0,"mat-card",0)(1,"mat-card-header",1)(2,"mat-card-title")(3,"span",2),e.\u0275\u0275text(4,"Menu Configuration"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(5,"div")(6,"button",3),e.\u0275\u0275listener("click",function(){return t.saveMenuToCurrentTenant()}),e.\u0275\u0275text(7," Save to current tenant "),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(8,"button",4),e.\u0275\u0275listener("click",function(){return t.saveMenu()}),e.\u0275\u0275elementStart(9,"mat-icon"),e.\u0275\u0275text(10,"save"),e.\u0275\u0275elementEnd()()()(),e.\u0275\u0275template(11,jp,1,0,"mat-progress-bar",5),e.\u0275\u0275pipe(12,"async"),e.\u0275\u0275template(13,Wp,1,0,"div",6),e.\u0275\u0275pipe(14,"async"),e.\u0275\u0275elementStart(15,"mat-card-content",7)(16,"div",8)(17,"mat-form-field",9)(18,"mat-label"),e.\u0275\u0275text(19,"Select a customer"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(20,"mat-select",10),e.\u0275\u0275listener("selectionChange",function(o){return t.customerSelected(o)}),e.\u0275\u0275template(21,qp,2,2,"mat-option",11),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(22,Jp,2,1,"ng-template",null,12,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementStart(24,"div",13)(25,"div",14)(26,"div",15),e.\u0275\u0275text(27,"Available Dashboards"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(28,"div"),e.\u0275\u0275template(29,Qp,10,3,"div",16),e.\u0275\u0275template(30,Xp,9,1,"div",16),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(31,Zp,2,0,"p",17),e.\u0275\u0275template(32,em,5,1,"p",17),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(33,"div",18)(34,"div",19)(35,"span"),e.\u0275\u0275text(36,"Menu"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(37,"button",20),e.\u0275\u0275listener("click",function(){return t.addPageToMenu()}),e.\u0275\u0275elementStart(38,"mat-icon"),e.\u0275\u0275text(39,"add"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(40,"mat-list",21),e.\u0275\u0275listener("dndDrop",function(o){return t.onDrop(o,t.draggableList)}),e.\u0275\u0275template(41,tm,1,0,"ng-container",22),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(42,"div",23)(43,"div",15),e.\u0275\u0275text(44,"JSON Schema"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(45,"pre"),e.\u0275\u0275text(46),e.\u0275\u0275pipe(47,"json"),e.\u0275\u0275elementEnd()()()()()()),2&n){const a=e.\u0275\u0275reference(23);e.\u0275\u0275advance(8),e.\u0275\u0275property("disabled",null==t.selectedCustomer),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(12,11,t.isLoading$)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!e.\u0275\u0275pipeBind1(14,13,t.isLoading$)),e.\u0275\u0275advance(8),e.\u0275\u0275property("ngForOf",t.customerList),e.\u0275\u0275advance(8),e.\u0275\u0275property("ngForOf",t.predefinedMenu),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",t.dashboards),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!t.dashboards.length),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.dashboards.length),e.\u0275\u0275advance(9),e.\u0275\u0275property("ngTemplateOutlet",a)("ngTemplateOutletContext",e.\u0275\u0275pureFunction1(17,$o,t.draggableList)),e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(47,15,t.draggableList))}},dependencies:[p.NgForOf,p.NgIf,p.NgTemplateOutlet,S.MatButton,S.MatIconButton,F.MatIcon,A.MatCard,A.MatCardContent,A.MatCardHeader,A.MatCardTitle,z.MatProgressBar,O.MatInput,_.MatFormField,_.MatLabel,ye.MatSelect,X.MatOption,$a.MatList,$a.MatListItem,$a.MatListItemLine,$a.MatListItemTitle,h.DefaultLayoutDirective,h.DefaultLayoutGapDirective,h.DefaultLayoutAlignDirective,h.DefaultFlexDirective,fo.jk,fo.Q4,fo.s1,b.RouterLink,p.AsyncPipe,p.JsonPipe,g.TranslatePipe],styles:['@charset "UTF-8";mat-card[_ngcontent-%COMP%]{width:100%!important}.dndDraggingSource[_ngcontent-%COMP%]{opacity:.5;transform:scale(.98);pointer-events:none}.dndDraggingSource[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{pointer-events:none}','@charset "UTF-8";[_nghost-%COMP%]   .mat-mdc-card.settings-card[_ngcontent-%COMP%]{margin:8px}[_nghost-%COMP%]   .mat-mdc-card.settings-card[_ngcontent-%COMP%]   .fields-group[_ngcontent-%COMP%]{padding:0 16px 8px;margin:10px 0;border:1px groove #7c7c7c;border-radius:4px}@media screen and (min-width: 960px) and (max-width: 1279px){[_nghost-%COMP%]   .mat-mdc-card.settings-card[_ngcontent-%COMP%]{width:80%}}@media screen and (min-width: 1280px){[_nghost-%COMP%]   .mat-mdc-card.settings-card[_ngcontent-%COMP%]{width:60%}}']});class On{constructor(n){this.oauth2Service=n}resolve(){return this.oauth2Service.getLoginProcessingUrl()}}On.\u0275fac=function(n){return new(n||On)(e.\u0275\u0275inject(ao.G))},On.\u0275prov=e.\u0275\u0275defineInjectable({token:On,factory:On.\u0275fac});const nm=[{path:"resources",data:{auth:[u.W.SYS_ADMIN,u.W.TENANT_ADMIN],breadcrumb:{label:"admin.resources",icon:"folder"}},children:[{path:"",children:[],data:{auth:[u.W.SYS_ADMIN,u.W.TENANT_ADMIN],redirectTo:"/resources/widgets-library"}},...Op,{path:"images",data:{breadcrumb:{label:"image.gallery",icon:"filter"}},children:[{path:"",component:Gp.K,data:{auth:[u.W.TENANT_ADMIN,u.W.SYS_ADMIN],title:"image.gallery"}}]},{path:"resources-library",data:{breadcrumb:{label:"resource.resources-library",icon:"mdi:rhombus-split"}},children:[{path:"",component:j.EntitiesTableComponent,data:{auth:[u.W.TENANT_ADMIN,u.W.SYS_ADMIN],title:"resource.resources-library"},resolve:{entitiesTableConfig:st}},{path:":entityId",component:ee.Y,canDeactivate:[N.P],data:{breadcrumb:{labelFunction:te,icon:"mdi:rhombus-split"},auth:[u.W.TENANT_ADMIN,u.W.SYS_ADMIN],title:"resource.resources-library"},resolve:{entitiesTableConfig:st}}]}]},{path:"settings",component:ja.x,data:{auth:[u.W.SYS_ADMIN,u.W.TENANT_ADMIN],breadcrumb:{label:"admin.settings",icon:"settings"}},children:[{path:"",children:[],data:{auth:[u.W.SYS_ADMIN,u.W.TENANT_ADMIN],redirectTo:{SYS_ADMIN:"/settings/general",TENANT_ADMIN:"/settings/home"}}},{path:"general",component:fi,canDeactivate:[N.P],data:{auth:[u.W.SYS_ADMIN],title:"admin.general-settings",breadcrumb:{label:"admin.general",icon:"settings_applications"}}},{path:"menu-config",component:ki,canDeactivate:[N.P],data:{auth:[u.W.SYS_ADMIN,u.W.TENANT_ADMIN],title:"Menu Configuration",breadcrumb:{label:"Menu Configuration",icon:"menu"}}},{path:"outgoing-mail",component:ui,canDeactivate:[N.P],data:{auth:[u.W.SYS_ADMIN],title:"admin.outgoing-mail-settings",breadcrumb:{label:"admin.outgoing-mail",icon:"mail"}}},{path:"notifications",component:yi,canDeactivate:[N.P],data:{auth:[u.W.SYS_ADMIN,u.W.TENANT_ADMIN],title:"admin.notifications-settings",breadcrumb:{label:"admin.notifications",icon:"mdi:message-badge"}}},{path:"queues",data:{breadcrumb:{label:"admin.queues",icon:"swap_calls"}},children:[{path:"",component:j.EntitiesTableComponent,data:{auth:[u.W.SYS_ADMIN],title:"admin.queues"},resolve:{entitiesTableConfig:dt}},{path:":entityId",component:ee.Y,canDeactivate:[N.P],data:{breadcrumb:{labelFunction:te,icon:"swap_calls"},auth:[u.W.SYS_ADMIN],title:"admin.queues"},resolve:{entitiesTableConfig:dt}}]},{path:"home",component:_i,canDeactivate:[N.P],data:{auth:[u.W.TENANT_ADMIN],title:"admin.home-settings",breadcrumb:{label:"admin.home",icon:"settings_applications"}}},{path:"repository",component:Si,canDeactivate:[N.P],data:{auth:[u.W.TENANT_ADMIN],title:"admin.repository-settings",breadcrumb:{label:"admin.repository",icon:"manage_history"}}},{path:"auto-commit",component:Ii,canDeactivate:[N.P],data:{auth:[u.W.TENANT_ADMIN],title:"admin.auto-commit-settings",breadcrumb:{label:"admin.auto-commit",icon:"settings_backup_restore"}}},{path:"security-settings",redirectTo:"/security-settings/general"},{path:"oauth2",redirectTo:"/security-settings/oauth2"},{path:"resources-library",pathMatch:"full",redirectTo:"/resources/resources-library"},{path:"resources-library/:entityId",redirectTo:"/resources/resources-library/:entityId"},{path:"2fa",redirectTo:"/security-settings/2fa"},{path:"sms-provider",redirectTo:"/settings/notifications"}]},{path:"security-settings",data:{auth:[u.W.SYS_ADMIN,u.W.TENANT_ADMIN],breadcrumb:{label:"security.security",icon:"security"}},children:[{path:"",children:[],data:{auth:[u.W.SYS_ADMIN,u.W.TENANT_ADMIN],redirectTo:{SYS_ADMIN:"/security-settings/general",TENANT_ADMIN:"/security-settings/auditLogs"}}},{path:"general",component:hi,canDeactivate:[N.P],data:{auth:[u.W.SYS_ADMIN],title:"admin.general",breadcrumb:{label:"admin.general",icon:"settings_applications"}}},{path:"2fa",component:wi,canDeactivate:[N.P],data:{auth:[u.W.SYS_ADMIN],title:"admin.2fa.2fa",breadcrumb:{label:"admin.2fa.2fa",icon:"mdi:two-factor-authentication"}}},{path:"oauth2",component:ot,canDeactivate:[N.P],data:{auth:[u.W.SYS_ADMIN],title:"admin.oauth2.oauth2",breadcrumb:{label:"admin.oauth2.oauth2",icon:"mdi:shield-account"}},resolve:{loginProcessingUrl:On}},...Vp]}];class yt{}yt.\u0275fac=function(n){return new(n||yt)},yt.\u0275mod=e.\u0275\u0275defineNgModule({type:yt}),yt.\u0275inj=e.\u0275\u0275defineInjector({providers:[On,st,dt],imports:[b.RouterModule.forChild(nm),b.RouterModule]}),(typeof ngJitMode>"u"||ngJitMode)&&e.\u0275\u0275setNgModuleScope(yt,{imports:[b.RouterModule],exports:[b.RouterModule]});var M=c(40399),k=c(11295);class vt{}vt.\u0275fac=function(n){return new(n||vt)},vt.\u0275mod=e.\u0275\u0275defineNgModule({type:vt}),vt.\u0275inj=e.\u0275\u0275defineInjector({imports:[p.CommonModule,M.m,k.W,yt]}),(typeof ngJitMode>"u"||ngJitMode)&&e.\u0275\u0275setNgModuleScope(vt,{declarations:[fi,ui,yi,bi,hi,ot,_i,ki,xi,Ci,Ti,Si,Ii,wi],imports:[p.CommonModule,M.m,k.W,yt]});var im=c(8977),Ri=c(16009),Ho=c(80374),zo=c(13667),Ha=c(87645);function am(i,n){if(1&i&&e.\u0275\u0275element(0,"tb-dashboard-page",2),2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275property("embedded",!0)("dashboard",t.homeDashboard)("hideToolbar",t.homeDashboard.hideDashboardToolbar)}}function om(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-grid-tile")(1,"a",10)(2,"tb-icon",11),e.\u0275\u0275text(3),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"span",12),e.\u0275\u0275text(5),e.\u0275\u0275elementEnd()()()),2&i){const t=n.$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275propertyInterpolate("routerLink",t.path),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(t.icon),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(t.name)}}function rm(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-grid-tile",5)(1,"mat-card",6)(2,"mat-card-title")(3,"span",7),e.\u0275\u0275text(4),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(5,"mat-card-content")(6,"mat-grid-list",8),e.\u0275\u0275template(7,om,6,3,"mat-grid-tile",9),e.\u0275\u0275elementEnd()()()()),2&i){const t=n.$implicit,a=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("colspan",a.sectionColspan(t)),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate(t.name),e.\u0275\u0275advance(2),e.\u0275\u0275property("cols",t.places.length),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",t.places)}}function sm(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-grid-list",3),e.\u0275\u0275template(1,rm,8,4,"mat-grid-tile",4),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275property("cols",t.cols),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",e.\u0275\u0275pipeBind1(2,2,t.homeSections$))}}class Oi{constructor(n,t,a,o){this.menuService=n,this.breakpointObserver=t,this.cd=a,this.route=o,this.homeSections$=this.menuService.homeSections(),this.cols=2,this.homeDashboard=this.route.snapshot.data.homeDashboard}ngOnInit(){this.homeDashboard||(this.updateColumnCount(),this.breakpointObserver.observe([Ri.tr.lg,Ri.tr["gt-lg"]]).subscribe(n=>this.updateColumnCount()))}updateColumnCount(){this.cols=2,this.breakpointObserver.isMatched(Ri.tr.lg)&&(this.cols=3),this.breakpointObserver.isMatched(Ri.tr["gt-lg"])&&(this.cols=4),this.cd.detectChanges()}sectionColspan(n){if(this.breakpointObserver.isMatched(Ri.tr["gt-sm"])){let t=this.cols;return n&&n.places&&n.places.length<=t&&(t=n.places.length),t}return 2}}Oi.\u0275fac=function(n){return new(n||Oi)(e.\u0275\u0275directiveInject(im.h),e.\u0275\u0275directiveInject(Ho.BreakpointObserver),e.\u0275\u0275directiveInject(e.ChangeDetectorRef),e.\u0275\u0275directiveInject(b.ActivatedRoute))},Oi.\u0275cmp=e.\u0275\u0275defineComponent({type:Oi,selectors:[["tb-home-links"]],decls:3,vars:2,consts:[[3,"embedded","dashboard","hideToolbar",4,"ngIf","ngIfElse"],["homeLinks",""],[3,"embedded","dashboard","hideToolbar"],["rowHeight","280px",1,"tb-home-links",3,"cols"],[3,"colspan",4,"ngFor","ngForOf"],[3,"colspan"],["appearance","outlined",2,"width","100%"],["translate","",1,"mat-headline-5"],["rowHeight","170px",3,"cols"],[4,"ngFor","ngForOf"],["mat-raised-button","","color","primary",1,"tb-card-button",3,"routerLink"],["matButtonIcon","",1,"tb-mat-96"],["translate",""]],template:function(n,t){if(1&n&&(e.\u0275\u0275template(0,am,1,3,"tb-dashboard-page",0),e.\u0275\u0275template(1,sm,3,4,"ng-template",null,1,e.\u0275\u0275templateRefExtractor)),2&n){const a=e.\u0275\u0275reference(2);e.\u0275\u0275property("ngIf",t.homeDashboard)("ngIfElse",a)}},dependencies:[p.NgForOf,p.NgIf,S.MatAnchor,A.MatCard,A.MatCardContent,A.MatCardTitle,zo.MatGridList,zo.MatGridTile,b.RouterLink,g.TranslateDirective,Wa.TbIconComponent,Ha.DashboardPageComponent,p.AsyncPipe],styles:['@charset "UTF-8";[_nghost-%COMP%]{width:100%;height:100%}[_nghost-%COMP%]     .tb-home-links .mat-headline-5{font-size:20px}@media screen and (min-width: 1600px){[_nghost-%COMP%]     .tb-home-links .mat-headline-5{font-size:24px}}[_nghost-%COMP%]     .tb-home-links .mat-mdc-card{padding:0;margin:8px}[_nghost-%COMP%]     .tb-home-links .mat-mdc-card .mat-mdc-card-title{margin:0;padding:24px 16px 16px}[_nghost-%COMP%]     .tb-home-links .mat-mdc-card .mat-mdc-card-title+.mat-mdc-card-content{padding-top:0}[_nghost-%COMP%]     .tb-home-links .mat-mdc-card .mat-mdc-card-content{padding:16px}[_nghost-%COMP%]     .tb-home-links .tb-card-button{width:100%;height:100%;max-width:240px;display:flex;flex-direction:column;align-items:center}[_nghost-%COMP%]     .tb-home-links .tb-card-button:hover{border-bottom:none}[_nghost-%COMP%]     .tb-home-links .tb-card-button:focus{border-bottom:none}[_nghost-%COMP%]     .tb-home-links .tb-card-button .mat-icon{margin:auto}[_nghost-%COMP%]     .tb-home-links .tb-card-button span.mdc-button__label{height:18px;min-height:36px;max-height:36px;padding:0 0 20px;margin:auto;font-size:18px;font-weight:400;line-height:18px;white-space:normal;text-align:center}[_nghost-%COMP%]     .tb-home-links .tb-card-button.mat-mdc-raised-button.mat-primary .mat-ripple-element{opacity:.3;background-color:#ffffff4d}'],changeDetection:0});var lm=c(53226),Ko=c(3414);const Yo=(i,n)=>i.pipe((0,x.select)(q.un)).pipe((0,ne.z)(t=>n.pipe((0,re.U)(a=>{if(t)for(const o of Object.keys(a.configuration.filters))["Active Devices","Inactive Devices"].includes(a.configuration.filters[o].filter)&&(a.configuration.filters[o].keyFilters[0].key.type=lm.Y1.TIME_SERIES);return a})))),um=[{path:"home",component:Oi,data:{auth:[u.W.SYS_ADMIN,u.W.TENANT_ADMIN,u.W.CUSTOMER_USER],title:"home.home",breadcrumb:{label:"home.home",icon:"home"}},resolve:{homeDashboard:(i,n,t=(0,e.inject)(ro.s),a=(0,e.inject)(Ko.z),o=(0,e.inject)(x.Store))=>t.getHomeDashboard().pipe((0,ne.z)(s=>{if(!s){let l;switch((0,q.fP)(o).authority){case u.W.SYS_ADMIN:l=a.loadJsonResource("/assets/dashboard/sys_admin_home_page.json");break;case u.W.TENANT_ADMIN:l=Yo(o,a.loadJsonResource("/assets/dashboard/tenant_admin_home_page.json"));break;case u.W.CUSTOMER_USER:l=Yo(o,a.loadJsonResource("/assets/dashboard/customer_user_home_page.json"))}if(l)return l.pipe((0,re.U)(m=>(m.hideDashboardToolbar=!0,m)))}return(0,J.of)(s)}))}}];class _t{}_t.\u0275fac=function(n){return new(n||_t)},_t.\u0275mod=e.\u0275\u0275defineNgModule({type:_t}),_t.\u0275inj=e.\u0275\u0275defineInjector({imports:[b.RouterModule.forChild(um),b.RouterModule]}),(typeof ngJitMode>"u"||ngJitMode)&&e.\u0275\u0275setNgModuleScope(_t,{imports:[b.RouterModule],exports:[b.RouterModule]});class xt{}xt.\u0275fac=function(n){return new(n||xt)},xt.\u0275mod=e.\u0275\u0275defineNgModule({type:xt}),xt.\u0275inj=e.\u0275\u0275defineInjector({imports:[p.CommonModule,M.m,k.W,_t]}),(typeof ngJitMode>"u"||ngJitMode)&&e.\u0275\u0275setNgModuleScope(xt,{declarations:[Oi],imports:[p.CommonModule,M.m,k.W,_t]});var Ra=c(72390),ho=c(94920),gm=c(86193),fm=c(92526);function hm(i,n){1&i&&e.\u0275\u0275element(0,"mat-progress-bar",22)}function bm(i,n){1&i&&e.\u0275\u0275element(0,"div",23)}function ym(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"user.email-required")," "))}function vm(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"user.invalid-email-format")," "))}function _m(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"section",24),e.\u0275\u0275element(1,"tb-dashboard-autocomplete",25),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementStart(3,"mat-checkbox",26),e.\u0275\u0275text(4),e.\u0275\u0275pipe(5,"translate"),e.\u0275\u0275elementEnd()()),2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(2,6,"dashboard.home-dashboard")),e.\u0275\u0275property("dashboardsScope",(null==t.user?null:t.user.authority)===t.authorities.TENANT_ADMIN?"tenant":"customer")("tenantId",null==t.user||null==t.user.tenantId?null:t.user.tenantId.id)("customerId",null==t.user||null==t.user.customerId?null:t.user.customerId.id)("selectFirstDashboard",!1),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(5,8,"dashboard.home-dashboard-hide-toolbar")," ")}}class Bi extends se.I{constructor(n,t,a,o,s,l){super(n),this.store=n,this.route=t,this.userService=a,this.authService=o,this.translate=s,this.fb=l,this.authorities=u.W,this.languageList=gm.N.supportedLangs,this.authUser=(0,q.fP)(this.store)}ngOnInit(){this.buildProfileForm(),this.userLoaded(this.route.snapshot.data.user)}buildProfileForm(){this.profile=this.fb.group({email:["",[r.Validators.required,r.Validators.email]],firstName:[""],lastName:[""],phone:[""],language:[""],homeDashboardId:[null],homeDashboardHideToolbar:[!0]})}save(){this.user={...this.user,...this.profile.value},this.user.additionalInfo||(this.user.additionalInfo={}),this.user.additionalInfo.lang=this.profile.get("language").value,this.user.additionalInfo.homeDashboardId=this.profile.get("homeDashboardId").value,this.user.additionalInfo.homeDashboardHideToolbar=this.profile.get("homeDashboardHideToolbar").value,this.userService.saveUser(this.user).subscribe(n=>{this.userLoaded(n),this.store.dispatch(new ho.bW({userDetails:{additionalInfo:{...n.additionalInfo},authority:n.authority,createdTime:n.createdTime,tenantId:n.tenantId,customerId:n.customerId,email:n.email,phone:n.phone,firstName:n.firstName,id:n.id,lastName:n.lastName}})),this.store.dispatch(new fm.N({userLang:n.additionalInfo.lang})),this.authService.refreshJwtToken(!1)})}userLoaded(n){this.user=n,this.profile.reset(n);let t,a,o=!0;n.additionalInfo&&(n.additionalInfo.lang&&(t=n.additionalInfo.lang),a=n.additionalInfo.homeDashboardId,(0,T.nu)(n.additionalInfo.homeDashboardHideToolbar)&&(o=n.additionalInfo.homeDashboardHideToolbar)),t||(t=this.translate.currentLang),this.profile.get("language").setValue(t),this.profile.get("homeDashboardId").setValue(a),this.profile.get("homeDashboardHideToolbar").setValue(o)}confirmForm(){return this.profile}isSysAdmin(){return this.authUser.authority===u.W.SYS_ADMIN}}Bi.\u0275fac=function(n){return new(n||Bi)(e.\u0275\u0275directiveInject(x.Store),e.\u0275\u0275directiveInject(b.ActivatedRoute),e.\u0275\u0275directiveInject(Ra.K),e.\u0275\u0275directiveInject(pi.e),e.\u0275\u0275directiveInject(g.TranslateService),e.\u0275\u0275directiveInject(r.UntypedFormBuilder))},Bi.\u0275cmp=e.\u0275\u0275defineComponent({type:Bi,selectors:[["tb-profile"]],features:[e.\u0275\u0275InheritDefinitionFeature],decls:43,vars:24,consts:[["appearance","outlined",1,"profile-card"],["fxFlex","","fxLayout","row","fxLayout.xs","column","fxLayoutGap.xs","8px","fxLayoutAlign","space-between start","fxLayoutAlign.xs","start start"],["fxFlex","","fxLayout","column"],["translate","",1,"mat-headline-5"],[1,"profile-email",2,"opacity","0.7"],["fxLayout","column"],["translate","",1,"mat-mdc-subheader"],[1,"profile-last-login-ts",2,"opacity","0.7"],["color","warn","mode","indeterminate",4,"ngIf"],["style","height: 4px;",4,"ngIf"],[2,"padding-top","16px"],[3,"formGroup","ngSubmit"],[3,"disabled"],[1,"mat-block"],["translate",""],["matInput","","type","email","formControlName","email","required",""],[4,"ngIf"],["matInput","","formControlName","firstName"],["matInput","","formControlName","lastName"],["class","tb-home-dashboard","fxFlex","","fxLayout","column","fxLayout.gt-sm","row",4,"ngIf"],["fxLayout","row","fxLayoutAlign","end start"],["mat-button","","mat-raised-button","","color","primary","type","submit",3,"disabled"],["color","warn","mode","indeterminate"],[2,"height","4px"],["fxFlex","","fxLayout","column","fxLayout.gt-sm","row",1,"tb-home-dashboard"],["fxFlex","","formControlName","homeDashboardId",3,"label","dashboardsScope","tenantId","customerId","selectFirstDashboard"],["fxFlex","","formControlName","homeDashboardHideToolbar"]],template:function(n,t){1&n&&(e.\u0275\u0275elementStart(0,"div")(1,"mat-card",0)(2,"mat-card-header")(3,"div",1)(4,"div",2)(5,"span",3),e.\u0275\u0275text(6,"profile.profile"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(7,"span",4),e.\u0275\u0275text(8),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(9,"div",5)(10,"span",6),e.\u0275\u0275text(11,"profile.last-login-time"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(12,"span",7),e.\u0275\u0275text(13),e.\u0275\u0275pipe(14,"date"),e.\u0275\u0275elementEnd()()()(),e.\u0275\u0275template(15,hm,1,0,"mat-progress-bar",8),e.\u0275\u0275pipe(16,"async"),e.\u0275\u0275template(17,bm,1,0,"div",9),e.\u0275\u0275pipe(18,"async"),e.\u0275\u0275elementStart(19,"mat-card-content",10)(20,"form",11),e.\u0275\u0275listener("ngSubmit",function(){return t.save()}),e.\u0275\u0275elementStart(21,"fieldset",12),e.\u0275\u0275pipe(22,"async"),e.\u0275\u0275elementStart(23,"mat-form-field",13)(24,"mat-label",14),e.\u0275\u0275text(25,"user.email"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(26,"input",15),e.\u0275\u0275template(27,ym,3,3,"mat-error",16),e.\u0275\u0275template(28,vm,3,3,"mat-error",16),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(29,"mat-form-field",13)(30,"mat-label",14),e.\u0275\u0275text(31,"user.first-name"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(32,"input",17),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(33,"mat-form-field",13)(34,"mat-label",14),e.\u0275\u0275text(35,"user.last-name"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(36,"input",18),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(37,_m,6,10,"section",19),e.\u0275\u0275elementStart(38,"div",20)(39,"button",21),e.\u0275\u0275pipe(40,"async"),e.\u0275\u0275text(41),e.\u0275\u0275pipe(42,"translate"),e.\u0275\u0275elementEnd()()()()()()()),2&n&&(e.\u0275\u0275advance(8),e.\u0275\u0275textInterpolate(t.profile?t.profile.get("email").value:""),e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind2(14,11,null==t.user||null==t.user.additionalInfo?null:t.user.additionalInfo.lastLoginTs,"yyyy-MM-dd HH:mm:ss")),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(16,14,t.isLoading$)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!e.\u0275\u0275pipeBind1(18,16,t.isLoading$)),e.\u0275\u0275advance(3),e.\u0275\u0275property("formGroup",t.profile),e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(22,18,t.isLoading$)),e.\u0275\u0275advance(6),e.\u0275\u0275property("ngIf",t.profile.get("email").hasError("required")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.profile.get("email").hasError("email")),e.\u0275\u0275advance(9),e.\u0275\u0275property("ngIf",!t.isSysAdmin()),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(40,20,t.isLoading$)||t.profile.invalid||!t.profile.dirty),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(42,22,"action.save")," "))},dependencies:[p.NgIf,vi.DashboardAutocompleteComponent,S.MatButton,fe.MatCheckbox,A.MatCard,A.MatCardContent,A.MatCardHeader,z.MatProgressBar,O.MatInput,_.MatFormField,_.MatLabel,_.MatError,h.DefaultLayoutDirective,h.DefaultLayoutGapDirective,h.DefaultLayoutAlignDirective,h.DefaultFlexDirective,r.\u0275NgNoValidate,r.DefaultValueAccessor,r.NgControlStatus,r.NgControlStatusGroup,r.RequiredValidator,r.FormGroupDirective,r.FormControlName,g.TranslateDirective,p.AsyncPipe,p.DatePipe,g.TranslatePipe],styles:['@charset "UTF-8";[_nghost-%COMP%]   .mat-mdc-card.profile-card[_ngcontent-%COMP%]{margin:8px}@media screen and (min-width: 960px){[_nghost-%COMP%]   .mat-mdc-card.profile-card[_ngcontent-%COMP%]{width:60%}}[_nghost-%COMP%]   .mat-mdc-card.profile-card[_ngcontent-%COMP%]   .mat-headline-5[_ngcontent-%COMP%]{margin:0}[_nghost-%COMP%]   .mat-mdc-card.profile-card[_ngcontent-%COMP%]   .profile-email[_ngcontent-%COMP%]{font-size:16px;font-weight:400}[_nghost-%COMP%]   .mat-mdc-card.profile-card[_ngcontent-%COMP%]   .mat-mdc-subheader[_ngcontent-%COMP%]{line-height:24px;font-size:14px;font-weight:400}[_nghost-%COMP%]   .mat-mdc-card.profile-card[_ngcontent-%COMP%]   .profile-last-login-ts[_ngcontent-%COMP%]{font-size:16px;font-weight:400}@media screen and (min-width: 960px){[_nghost-%COMP%]   .mat-mdc-card.profile-card[_ngcontent-%COMP%]   .tb-home-dashboard[_ngcontent-%COMP%]   tb-dashboard-autocomplete[_ngcontent-%COMP%]{padding-right:12px}}@media screen and (max-width: 959px){[_nghost-%COMP%]   .mat-mdc-card.profile-card[_ngcontent-%COMP%]   .tb-home-dashboard[_ngcontent-%COMP%]   tb-dashboard-autocomplete[_ngcontent-%COMP%]{padding-bottom:12px}}@media screen and (min-width: 960px){[_nghost-%COMP%]   .mat-mdc-card.profile-card[_ngcontent-%COMP%]   .tb-home-dashboard[_ngcontent-%COMP%]   .mat-mdc-checkbox[_ngcontent-%COMP%]{margin-top:16px}}']});class Bn{constructor(n,t){this.store=n,this.userService=t}resolve(){const n=(0,q.fP)(this.store).userId;return this.userService.getUser(n)}}Bn.\u0275fac=function(n){return new(n||Bn)(e.\u0275\u0275inject(x.Store),e.\u0275\u0275inject(Ra.K))},Bn.\u0275prov=e.\u0275\u0275defineInjectable({token:Bn,factory:Bn.\u0275fac});const xm=[{path:"profile",component:Bi,canDeactivate:[N.P],data:{auth:[u.W.SYS_ADMIN,u.W.TENANT_ADMIN,u.W.CUSTOMER_USER],title:"profile.profile",breadcrumb:{label:"profile.profile",icon:"account_circle"}},resolve:{user:Bn}}];class Ct{}Ct.\u0275fac=function(n){return new(n||Ct)},Ct.\u0275mod=e.\u0275\u0275defineNgModule({type:Ct}),Ct.\u0275inj=e.\u0275\u0275defineInjector({providers:[Bn],imports:[b.RouterModule.forChild([{path:"profile",redirectTo:"account/profile"}]),b.RouterModule]}),(typeof ngJitMode>"u"||ngJitMode)&&e.\u0275\u0275setNgModuleScope(Ct,{imports:[b.RouterModule],exports:[b.RouterModule]});class Tt{}Tt.\u0275fac=function(n){return new(n||Tt)},Tt.\u0275mod=e.\u0275\u0275defineNgModule({type:Tt}),Tt.\u0275inj=e.\u0275\u0275defineInjector({imports:[p.CommonModule,M.m,Ct]}),(typeof ngJitMode>"u"||ngJitMode)&&e.\u0275\u0275setNgModuleScope(Tt,{declarations:[Bi],imports:[p.CommonModule,M.m,Ct]});var Q=c(27509);const Tm=["stepper"],Sm=["canvas"];function Im(i,n){1&i&&e.\u0275\u0275element(0,"mat-progress-bar",29)}function wm(i,n){1&i&&e.\u0275\u0275element(0,"div",30)}function Em(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-icon"),e.\u0275\u0275text(1,"done"),e.\u0275\u0275elementEnd())}function Mm(i,n){1&i&&(e.\u0275\u0275text(0),e.\u0275\u0275pipe(1,"translate")),2&i&&e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(1,1,"security.2fa.dialog.totp-step-label"))}function Dm(i,n){1&i&&(e.\u0275\u0275text(0),e.\u0275\u0275pipe(1,"translate")),2&i&&e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(1,1,"security.2fa.dialog.verification-step-label"))}function Am(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"security.2fa.dialog.verification-code-invalid")," "))}function Nm(i,n){1&i&&(e.\u0275\u0275text(0),e.\u0275\u0275pipe(1,"translate")),2&i&&e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(1,1,"security.2fa.dialog.activation-step-label"))}const Fm=function(i){return{display:i}};class Vi extends le.a{constructor(n,t,a,o,s){super(n,t,o),this.store=n,this.router=t,this.twoFaService=a,this.dialogRef=o,this.fb=s,this.twoFaService.generateTwoFaAccountConfig(W.hs.TOTP).subscribe(l=>{this.authAccountConfig=l,this.totpAuthURL=this.authAccountConfig.authUrl,this.authAccountConfig.useByDefault=!0,c.e(3766).then(c.t.bind(c,73766,19)).then(d=>{d.toCanvas(this.canvasRef.nativeElement,this.totpAuthURL),this.canvasRef.nativeElement.style.width="auto",this.canvasRef.nativeElement.style.height="auto"})}),this.totpConfigForm=this.fb.group({verificationCode:["",[r.Validators.required,r.Validators.minLength(6),r.Validators.maxLength(6),r.Validators.pattern(/^\d*$/)]]})}onSaveConfig(){this.totpConfigForm.valid?this.twoFaService.verifyAndSaveTwoFaAccountConfig(this.authAccountConfig,this.totpConfigForm.get("verificationCode").value).subscribe(n=>{this.config=n,this.stepper.next()}):Object.keys(this.totpConfigForm.controls).forEach(n=>{this.totpConfigForm.get(n).markAsTouched({onlySelf:!0})})}closeDialog(){return this.dialogRef.close(this.config)}}Vi.\u0275fac=function(n){return new(n||Vi)(e.\u0275\u0275directiveInject(x.Store),e.\u0275\u0275directiveInject(b.Router),e.\u0275\u0275directiveInject(Pn.b),e.\u0275\u0275directiveInject(C.MatDialogRef),e.\u0275\u0275directiveInject(r.UntypedFormBuilder))},Vi.\u0275cmp=e.\u0275\u0275defineComponent({type:Vi,selectors:[["tb-totp-auth-dialog"]],viewQuery:function(n,t){if(1&n&&(e.\u0275\u0275viewQuery(Tm,5),e.\u0275\u0275viewQuery(Sm,5)),2&n){let a;e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(t.stepper=a.first),e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(t.canvasRef=a.first)}},features:[e.\u0275\u0275InheritDefinitionFeature],decls:55,vars:27,consts:[["fxLayout","row","color","primary"],["translate",""],["fxFlex",""],["mat-icon-button","","type","button",3,"click"],[1,"material-icons"],["color","warn","mode","indeterminate",4,"ngIf"],["style","height: 4px;",4,"ngIf"],["mat-dialog-content","","tb-toast","",2,"padding","0"],["linear",""],["stepper",""],["matStepperIcon","edit"],["matStepLabel",""],["translate","",1,"mat-body-2"],["fxLayout","row","fxLayoutAlign","end center"],["mat-raised-button","","type","button","color","primary","matStepperNext",""],[3,"stepControl"],["fxLayoutAlign","start center","fxLayout","column",3,"formGroup","ngSubmit"],["translate","",1,"mat-body","qr-code-description"],["fxFlex","",3,"ngStyle"],["canvas",""],["translate","",1,"mat-body","qr-code-description",2,"margin-top","30px"],["fxFlex","",1,"mat-block","code-container"],["matInput","","formControlName","verificationCode","maxlength","6","type","text","required","","inputmode","numeric","pattern","[0-9]*","autocomplete","off",3,"placeholder"],[4,"ngIf"],["mat-raised-button","","type","button","color","primary",3,"disabled","click"],["matStepLabel","","matStepperIcon","done"],["translate","",1,"result-title"],["translate","",1,"mat-body","result-description"],["mat-raised-button","","type","button","color","primary",3,"click"],["color","warn","mode","indeterminate"],[2,"height","4px"]],template:function(n,t){1&n&&(e.\u0275\u0275elementStart(0,"mat-toolbar",0)(1,"h2",1),e.\u0275\u0275text(2,"security.2fa.dialog.enable-totp-title"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(3,"span",2),e.\u0275\u0275elementStart(4,"button",3),e.\u0275\u0275listener("click",function(){return t.closeDialog()}),e.\u0275\u0275elementStart(5,"mat-icon",4),e.\u0275\u0275text(6,"close"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275template(7,Im,1,0,"mat-progress-bar",5),e.\u0275\u0275pipe(8,"async"),e.\u0275\u0275template(9,wm,1,0,"div",6),e.\u0275\u0275pipe(10,"async"),e.\u0275\u0275elementStart(11,"div",7)(12,"mat-stepper",8,9),e.\u0275\u0275template(14,Em,2,0,"ng-template",10),e.\u0275\u0275elementStart(15,"mat-step"),e.\u0275\u0275template(16,Mm,2,3,"ng-template",11),e.\u0275\u0275elementStart(17,"div")(18,"p",12),e.\u0275\u0275text(19,"security.2fa.dialog.totp-step-description-open"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(20,"p",12),e.\u0275\u0275text(21,"security.2fa.dialog.totp-step-description-install"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(22,"div",13)(23,"button",14),e.\u0275\u0275text(24),e.\u0275\u0275pipe(25,"translate"),e.\u0275\u0275elementEnd()()()(),e.\u0275\u0275elementStart(26,"mat-step",15),e.\u0275\u0275template(27,Dm,2,3,"ng-template",11),e.\u0275\u0275elementStart(28,"form",16),e.\u0275\u0275listener("ngSubmit",function(){return t.onSaveConfig()}),e.\u0275\u0275elementStart(29,"p",17),e.\u0275\u0275text(30,"security.2fa.dialog.scan-qr-code"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(31,"canvas",18,19),e.\u0275\u0275elementStart(33,"p",20),e.\u0275\u0275text(34,"security.2fa.dialog.enter-verification-code"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(35,"mat-form-field",21),e.\u0275\u0275element(36,"input",22),e.\u0275\u0275pipe(37,"translate"),e.\u0275\u0275template(38,Am,3,3,"mat-error",23),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(39,"div",13)(40,"button",24),e.\u0275\u0275listener("click",function(){return t.onSaveConfig()}),e.\u0275\u0275pipe(41,"async"),e.\u0275\u0275text(42),e.\u0275\u0275pipe(43,"translate"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(44,"mat-step"),e.\u0275\u0275template(45,Nm,2,3,"ng-template",25),e.\u0275\u0275elementStart(46,"div")(47,"h3",26),e.\u0275\u0275text(48,"security.2fa.dialog.success"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(49,"p",27),e.\u0275\u0275text(50,"security.2fa.dialog.activation-step-description-totp"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(51,"div",13)(52,"button",28),e.\u0275\u0275listener("click",function(){return t.closeDialog()}),e.\u0275\u0275text(53),e.\u0275\u0275pipe(54,"translate"),e.\u0275\u0275elementEnd()()()()()()),2&n&&(e.\u0275\u0275advance(7),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(8,11,t.isLoading$)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!e.\u0275\u0275pipeBind1(10,13,t.isLoading$)),e.\u0275\u0275advance(15),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(25,15,"security.2fa.dialog.next")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("stepControl",t.totpConfigForm),e.\u0275\u0275advance(2),e.\u0275\u0275property("formGroup",t.totpConfigForm),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngStyle",e.\u0275\u0275pureFunction1(25,Fm,t.totpAuthURL?"block":"none")),e.\u0275\u0275advance(5),e.\u0275\u0275propertyInterpolate("placeholder",e.\u0275\u0275pipeBind1(37,17,"security.2fa.dialog.verification-code")),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",t.totpConfigForm.get("verificationCode").invalid),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(41,19,t.isLoading$)||t.totpConfigForm.invalid),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(43,21,"security.2fa.dialog.next")," "),e.\u0275\u0275advance(11),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(54,23,"action.done")," "))},dependencies:[p.NgIf,p.NgStyle,rt.ToastDirective,S.MatButton,S.MatIconButton,F.MatIcon,z.MatProgressBar,O.MatInput,_.MatFormField,_.MatError,oe.MatToolbar,C.MatDialogContent,Q.MatStep,Q.MatStepLabel,Q.MatStepper,Q.MatStepperNext,Q.MatStepperIcon,h.DefaultLayoutDirective,h.DefaultLayoutAlignDirective,h.DefaultFlexDirective,G.DefaultStyleDirective,r.\u0275NgNoValidate,r.DefaultValueAccessor,r.NgControlStatus,r.NgControlStatusGroup,r.RequiredValidator,r.MaxLengthValidator,r.PatternValidator,r.FormGroupDirective,r.FormControlName,g.TranslateDirective,p.AsyncPipe,g.TranslatePipe],styles:['@charset "UTF-8";[_nghost-%COMP%]   .mat-toolbar[_ngcontent-%COMP%] > h2[_ngcontent-%COMP%]{font-weight:400;letter-spacing:.25px}[_nghost-%COMP%]   form[_ngcontent-%COMP%]{display:block}[_nghost-%COMP%]   .mat-body-2[_ngcontent-%COMP%]{margin-bottom:0;letter-spacing:.25px}[_nghost-%COMP%]   .mat-body-2[_ngcontent-%COMP%]:not(:first-of-type){margin:0 0 8px}[_nghost-%COMP%]   .mat-body-2.description[_ngcontent-%COMP%]{margin:0;color:#0000008a}[_nghost-%COMP%]   .mat-body-2.description[_ngcontent-%COMP%]:last-of-type{margin-bottom:24px}[_nghost-%COMP%]   .input-container[_ngcontent-%COMP%]{max-width:290px}[_nghost-%COMP%]   .code-container[_ngcontent-%COMP%]{max-width:170px}@media screen and (max-width: 599px){[_nghost-%COMP%]   .code-container.full-width-xs[_ngcontent-%COMP%]{max-width:100%;width:100%}}[_nghost-%COMP%]   .result-title[_ngcontent-%COMP%]{font:500 18px/24px Roboto,Helvetica Neue,sans-serif;letter-spacing:.1px;margin:8px 0;text-align:center}[_nghost-%COMP%]   .result-description[_ngcontent-%COMP%]{text-align:center;margin:0 0 16px;letter-spacing:.25px;max-width:500px}[_nghost-%COMP%]   .step-description[_ngcontent-%COMP%]{max-width:450px}[_nghost-%COMP%]   .step-description.input[_ngcontent-%COMP%]{margin:12px 0 0}[_nghost-%COMP%]   .qr-code-description[_ngcontent-%COMP%]{text-align:center;max-width:180px;letter-spacing:.25px;color:#000000de;margin-bottom:0}[_nghost-%COMP%]   .backup-code[_ngcontent-%COMP%]{max-width:500px}[_nghost-%COMP%]   .backup-code[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]{max-width:500px;margin:40px 0 8px}[_nghost-%COMP%]   .backup-code[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .code[_ngcontent-%COMP%]{letter-spacing:.25px;padding:0 24px;margin-bottom:16px;font-family:Roboto Mono,Helvetica Neue,monospace}[_nghost-%COMP%]   .backup-code[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .code.even[_ngcontent-%COMP%]{text-align:right}[_nghost-%COMP%]   .backup-code[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]{margin-bottom:40px}[_nghost-%COMP%]     .mat-horizontal-stepper-header{pointer-events:none!important}']});const Lm=["stepper"];function Pm(i,n){1&i&&e.\u0275\u0275element(0,"mat-progress-bar",30)}function km(i,n){1&i&&e.\u0275\u0275element(0,"div",31)}function Rm(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-icon"),e.\u0275\u0275text(1,"done"),e.\u0275\u0275elementEnd())}function Om(i,n){1&i&&(e.\u0275\u0275text(0),e.\u0275\u0275pipe(1,"translate")),2&i&&e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(1,1,"security.2fa.dialog.sms-step-label"))}function Bm(i,n){1&i&&(e.\u0275\u0275text(0),e.\u0275\u0275pipe(1,"translate")),2&i&&e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(1,1,"security.2fa.dialog.verification-step-label"))}function Vm(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"security.2fa.dialog.verification-code-invalid")," "))}function Um(i,n){1&i&&(e.\u0275\u0275text(0),e.\u0275\u0275pipe(1,"translate")),2&i&&e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(1,1,"security.2fa.dialog.activation-step-label"))}const Gm=function(i){return{address:i}};class Ui extends le.a{constructor(n,t,a,o,s){super(n,t,o),this.store=n,this.router=t,this.twoFaService=a,this.dialogRef=o,this.fb=s,this.phoneNumberPattern=Pe.yk,this.smsConfigForm=this.fb.group({phone:["",[r.Validators.required,r.Validators.pattern(Pe.yk)]]}),this.smsVerificationForm=this.fb.group({verificationCode:["",[r.Validators.required,r.Validators.minLength(6),r.Validators.maxLength(6),r.Validators.pattern(/^\d*$/)]]})}nextStep(){switch(this.stepper.selectedIndex){case 0:this.smsConfigForm.valid?(this.authAccountConfig={providerType:W.hs.SMS,useByDefault:!0,phoneNumber:this.smsConfigForm.get("phone").value},this.twoFaService.submitTwoFaAccountConfig(this.authAccountConfig).subscribe(()=>{this.stepper.next()})):this.showFormErrors(this.smsConfigForm);break;case 1:this.smsVerificationForm.valid?this.twoFaService.verifyAndSaveTwoFaAccountConfig(this.authAccountConfig,this.smsVerificationForm.get("verificationCode").value).subscribe(n=>{this.config=n,this.stepper.next()}):this.showFormErrors(this.smsVerificationForm)}}closeDialog(){return this.dialogRef.close(this.config)}showFormErrors(n){Object.keys(n.controls).forEach(t=>{n.get(t).markAsTouched({onlySelf:!0})})}}Ui.\u0275fac=function(n){return new(n||Ui)(e.\u0275\u0275directiveInject(x.Store),e.\u0275\u0275directiveInject(b.Router),e.\u0275\u0275directiveInject(Pn.b),e.\u0275\u0275directiveInject(C.MatDialogRef),e.\u0275\u0275directiveInject(r.UntypedFormBuilder))},Ui.\u0275cmp=e.\u0275\u0275defineComponent({type:Ui,selectors:[["tb-sms-auth-dialog"]],viewQuery:function(n,t){if(1&n&&e.\u0275\u0275viewQuery(Lm,5),2&n){let a;e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(t.stepper=a.first)}},features:[e.\u0275\u0275InheritDefinitionFeature],decls:58,vars:45,consts:[["fxLayout","row","color","primary"],["translate",""],["fxFlex",""],["mat-icon-button","","type","button",3,"click"],[1,"material-icons"],["color","warn","mode","indeterminate",4,"ngIf"],["style","height: 4px;",4,"ngIf"],["mat-dialog-content","","tb-toast","",2,"padding","0"],["linear",""],["stepper",""],["matStepperIcon","edit"],[3,"stepControl"],["matStepLabel",""],[3,"formGroup","ngSubmit"],["translate","",1,"mat-body","step-description","input"],["fxLayout","row","fxLayoutAlign","space-between center","fxLayoutGap","15px"],["fxFlex","","formControlName","phone",3,"floatLabel","placeholder"],["mat-raised-button","","type","submit","color","primary",3,"disabled"],[1,"mat-body","step-description","input"],["fxLayout","row","fxLayout.xs","column","fxLayoutAlign","space-between center","fxLayoutAlign.xs","start end"],["fxFlex","",1,"mat-block","code-container","full-width-xs"],["matInput","","formControlName","verificationCode","maxlength","6","type","text","required","","inputmode","numeric","pattern","[0-9]*","autocomplete","off",3,"placeholder"],[4,"ngIf"],["fxLayoutGap","8px"],["mat-button","","matStepperPrevious","",3,"disabled"],["matStepLabel","","matStepperIcon","done"],["translate","",1,"result-title"],["translate","",1,"mat-body","result-description"],["fxLayout","row","fxLayoutAlign","end center"],["mat-raised-button","","type","button","color","primary",3,"click"],["color","warn","mode","indeterminate"],[2,"height","4px"]],template:function(n,t){1&n&&(e.\u0275\u0275elementStart(0,"mat-toolbar",0)(1,"h2",1),e.\u0275\u0275text(2,"security.2fa.dialog.enable-sms-title"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(3,"span",2),e.\u0275\u0275elementStart(4,"button",3),e.\u0275\u0275listener("click",function(){return t.closeDialog()}),e.\u0275\u0275elementStart(5,"mat-icon",4),e.\u0275\u0275text(6,"close"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275template(7,Pm,1,0,"mat-progress-bar",5),e.\u0275\u0275pipe(8,"async"),e.\u0275\u0275template(9,km,1,0,"div",6),e.\u0275\u0275pipe(10,"async"),e.\u0275\u0275elementStart(11,"div",7)(12,"mat-stepper",8,9),e.\u0275\u0275template(14,Rm,2,0,"ng-template",10),e.\u0275\u0275elementStart(15,"mat-step",11),e.\u0275\u0275template(16,Om,2,3,"ng-template",12),e.\u0275\u0275elementStart(17,"form",13),e.\u0275\u0275listener("ngSubmit",function(){return t.nextStep()}),e.\u0275\u0275elementStart(18,"p",14),e.\u0275\u0275text(19,"security.2fa.dialog.sms-step-description"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(20,"div",15),e.\u0275\u0275element(21,"tb-phone-input",16),e.\u0275\u0275pipe(22,"translate"),e.\u0275\u0275elementStart(23,"button",17),e.\u0275\u0275pipe(24,"async"),e.\u0275\u0275text(25),e.\u0275\u0275pipe(26,"translate"),e.\u0275\u0275elementEnd()()()(),e.\u0275\u0275elementStart(27,"mat-step",11),e.\u0275\u0275template(28,Bm,2,3,"ng-template",12),e.\u0275\u0275elementStart(29,"form",13),e.\u0275\u0275listener("ngSubmit",function(){return t.nextStep()}),e.\u0275\u0275elementStart(30,"p",18),e.\u0275\u0275text(31),e.\u0275\u0275pipe(32,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(33,"div",19)(34,"mat-form-field",20),e.\u0275\u0275element(35,"input",21),e.\u0275\u0275pipe(36,"translate"),e.\u0275\u0275template(37,Vm,3,3,"mat-error",22),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(38,"div",23)(39,"button",24),e.\u0275\u0275pipe(40,"async"),e.\u0275\u0275text(41),e.\u0275\u0275pipe(42,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(43,"button",17),e.\u0275\u0275pipe(44,"async"),e.\u0275\u0275text(45),e.\u0275\u0275pipe(46,"translate"),e.\u0275\u0275elementEnd()()()()(),e.\u0275\u0275elementStart(47,"mat-step"),e.\u0275\u0275template(48,Um,2,3,"ng-template",25),e.\u0275\u0275elementStart(49,"div")(50,"h3",26),e.\u0275\u0275text(51,"security.2fa.dialog.success"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(52,"p",27),e.\u0275\u0275text(53,"security.2fa.dialog.activation-step-description-sms"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(54,"div",28)(55,"button",29),e.\u0275\u0275listener("click",function(){return t.closeDialog()}),e.\u0275\u0275text(56),e.\u0275\u0275pipe(57,"translate"),e.\u0275\u0275elementEnd()()()()()()),2&n&&(e.\u0275\u0275advance(7),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(8,18,t.isLoading$)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!e.\u0275\u0275pipeBind1(10,20,t.isLoading$)),e.\u0275\u0275advance(6),e.\u0275\u0275property("stepControl",t.smsConfigForm),e.\u0275\u0275advance(2),e.\u0275\u0275property("formGroup",t.smsConfigForm),e.\u0275\u0275advance(4),e.\u0275\u0275propertyInterpolate("placeholder",e.\u0275\u0275pipeBind1(22,22,"security.2fa.dialog.sms-step-label")),e.\u0275\u0275property("floatLabel","never"),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(24,24,t.isLoading$)||t.smsConfigForm.invalid),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(26,26,"security.2fa.dialog.send-code")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("stepControl",t.smsVerificationForm),e.\u0275\u0275advance(2),e.\u0275\u0275property("formGroup",t.smsVerificationForm),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind2(32,28,"security.2fa.dialog.verification-step-description",e.\u0275\u0275pureFunction1(43,Gm,t.smsConfigForm.get("phone").value))," "),e.\u0275\u0275advance(4),e.\u0275\u0275propertyInterpolate("placeholder",e.\u0275\u0275pipeBind1(36,31,"security.2fa.dialog.verification-code")),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",t.smsVerificationForm.get("verificationCode").invalid),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(40,33,t.isLoading$)),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(42,35,"action.back")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(44,37,t.isLoading$)||t.smsVerificationForm.invalid),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(46,39,"action.activate")," "),e.\u0275\u0275advance(11),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(57,41,"action.done")," "))},dependencies:[p.NgIf,rt.ToastDirective,S.MatButton,S.MatIconButton,F.MatIcon,z.MatProgressBar,O.MatInput,_.MatFormField,_.MatError,oe.MatToolbar,C.MatDialogContent,Q.MatStep,Q.MatStepLabel,Q.MatStepper,Q.MatStepperPrevious,Q.MatStepperIcon,h.DefaultLayoutDirective,h.DefaultLayoutGapDirective,h.DefaultLayoutAlignDirective,h.DefaultFlexDirective,r.\u0275NgNoValidate,r.DefaultValueAccessor,r.NgControlStatus,r.NgControlStatusGroup,r.RequiredValidator,r.MaxLengthValidator,r.PatternValidator,r.FormGroupDirective,r.FormControlName,g.TranslateDirective,oo.T,p.AsyncPipe,g.TranslatePipe],styles:['@charset "UTF-8";[_nghost-%COMP%]   .mat-toolbar[_ngcontent-%COMP%] > h2[_ngcontent-%COMP%]{font-weight:400;letter-spacing:.25px}[_nghost-%COMP%]   form[_ngcontent-%COMP%]{display:block}[_nghost-%COMP%]   .mat-body-2[_ngcontent-%COMP%]{margin-bottom:0;letter-spacing:.25px}[_nghost-%COMP%]   .mat-body-2[_ngcontent-%COMP%]:not(:first-of-type){margin:0 0 8px}[_nghost-%COMP%]   .mat-body-2.description[_ngcontent-%COMP%]{margin:0;color:#0000008a}[_nghost-%COMP%]   .mat-body-2.description[_ngcontent-%COMP%]:last-of-type{margin-bottom:24px}[_nghost-%COMP%]   .input-container[_ngcontent-%COMP%]{max-width:290px}[_nghost-%COMP%]   .code-container[_ngcontent-%COMP%]{max-width:170px}@media screen and (max-width: 599px){[_nghost-%COMP%]   .code-container.full-width-xs[_ngcontent-%COMP%]{max-width:100%;width:100%}}[_nghost-%COMP%]   .result-title[_ngcontent-%COMP%]{font:500 18px/24px Roboto,Helvetica Neue,sans-serif;letter-spacing:.1px;margin:8px 0;text-align:center}[_nghost-%COMP%]   .result-description[_ngcontent-%COMP%]{text-align:center;margin:0 0 16px;letter-spacing:.25px;max-width:500px}[_nghost-%COMP%]   .step-description[_ngcontent-%COMP%]{max-width:450px}[_nghost-%COMP%]   .step-description.input[_ngcontent-%COMP%]{margin:12px 0 0}[_nghost-%COMP%]   .qr-code-description[_ngcontent-%COMP%]{text-align:center;max-width:180px;letter-spacing:.25px;color:#000000de;margin-bottom:0}[_nghost-%COMP%]   .backup-code[_ngcontent-%COMP%]{max-width:500px}[_nghost-%COMP%]   .backup-code[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]{max-width:500px;margin:40px 0 8px}[_nghost-%COMP%]   .backup-code[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .code[_ngcontent-%COMP%]{letter-spacing:.25px;padding:0 24px;margin-bottom:16px;font-family:Roboto Mono,Helvetica Neue,monospace}[_nghost-%COMP%]   .backup-code[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .code.even[_ngcontent-%COMP%]{text-align:right}[_nghost-%COMP%]   .backup-code[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]{margin-bottom:40px}[_nghost-%COMP%]     .mat-horizontal-stepper-header{pointer-events:none!important}']});const jm=["stepper"];function Wm(i,n){1&i&&e.\u0275\u0275element(0,"mat-progress-bar",31)}function qm(i,n){1&i&&e.\u0275\u0275element(0,"div",32)}function $m(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-icon"),e.\u0275\u0275text(1,"done"),e.\u0275\u0275elementEnd())}function Hm(i,n){1&i&&(e.\u0275\u0275text(0),e.\u0275\u0275pipe(1,"translate")),2&i&&e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(1,1,"security.2fa.dialog.email-step-label"))}function zm(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"user.email-required")," "))}function Km(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"user.invalid-email-format")," "))}function Ym(i,n){1&i&&(e.\u0275\u0275text(0),e.\u0275\u0275pipe(1,"translate")),2&i&&e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(1,1,"security.2fa.dialog.verification-step-label"))}function Jm(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"security.2fa.dialog.verification-code-invalid")," "))}function Qm(i,n){1&i&&(e.\u0275\u0275text(0),e.\u0275\u0275pipe(1,"translate")),2&i&&e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(1,1,"security.2fa.dialog.activation-step-label"))}const Xm=function(i){return{address:i}};class Gi extends le.a{constructor(n,t,a,o,s,l){super(n,t,s),this.store=n,this.router=t,this.twoFaService=a,this.data=o,this.dialogRef=s,this.fb=l,this.emailConfigForm=this.fb.group({email:[this.data.email,[r.Validators.required,r.Validators.email]]}),this.emailVerificationForm=this.fb.group({verificationCode:["",[r.Validators.required,r.Validators.minLength(6),r.Validators.maxLength(6),r.Validators.pattern(/^\d*$/)]]})}nextStep(){switch(this.stepper.selectedIndex){case 0:this.emailConfigForm.valid?(this.authAccountConfig={providerType:W.hs.EMAIL,useByDefault:!0,email:this.emailConfigForm.get("email").value},this.twoFaService.submitTwoFaAccountConfig(this.authAccountConfig).subscribe(()=>{this.stepper.next()})):this.showFormErrors(this.emailConfigForm);break;case 1:this.emailVerificationForm.valid?this.twoFaService.verifyAndSaveTwoFaAccountConfig(this.authAccountConfig,this.emailVerificationForm.get("verificationCode").value).subscribe(n=>{this.config=n,this.stepper.next()}):this.showFormErrors(this.emailVerificationForm)}}closeDialog(){return this.dialogRef.close(this.config)}showFormErrors(n){Object.keys(n.controls).forEach(t=>{n.get(t).markAsTouched({onlySelf:!0})})}}Gi.\u0275fac=function(n){return new(n||Gi)(e.\u0275\u0275directiveInject(x.Store),e.\u0275\u0275directiveInject(b.Router),e.\u0275\u0275directiveInject(Pn.b),e.\u0275\u0275directiveInject(C.MAT_DIALOG_DATA),e.\u0275\u0275directiveInject(C.MatDialogRef),e.\u0275\u0275directiveInject(r.UntypedFormBuilder))},Gi.\u0275cmp=e.\u0275\u0275defineComponent({type:Gi,selectors:[["tb-email-auth-dialog"]],viewQuery:function(n,t){if(1&n&&e.\u0275\u0275viewQuery(jm,5),2&n){let a;e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(t.stepper=a.first)}},features:[e.\u0275\u0275InheritDefinitionFeature],decls:61,vars:47,consts:[["fxLayout","row","color","primary"],["translate",""],["fxFlex",""],["mat-icon-button","","type","button",3,"click"],[1,"material-icons"],["color","warn","mode","indeterminate",4,"ngIf"],["style","height: 4px;",4,"ngIf"],["mat-dialog-content","","tb-toast","",2,"padding","0"],[3,"linear"],["stepper",""],["matStepperIcon","edit"],[3,"stepControl"],["matStepLabel",""],[3,"formGroup","ngSubmit"],["translate","",1,"mat-body","step-description","input"],["fxLayout","row","fxLayoutAlign","space-between center","fxLayoutGap","8px"],["fxFlex","",1,"mat-block","input-container"],["matInput","","formControlName","email","type","email","required","",3,"placeholder"],[4,"ngIf"],["mat-raised-button","","type","submit","color","primary",3,"disabled"],[1,"mat-body","step-description","input"],["fxLayout","row","fxLayout.xs","column","fxLayoutAlign","space-between center","fxLayoutAlign.xs","start end"],["fxFlex","",1,"mat-block","code-container","full-width-xs"],["matInput","","formControlName","verificationCode","maxlength","6","type","text","required","","inputmode","numeric","pattern","[0-9]*","autocomplete","off",3,"placeholder"],["fxLayoutGap","8px"],["mat-button","","matStepperPrevious","",3,"disabled"],["matStepLabel","","matStepperIcon","done"],["translate","",1,"result-title"],["translate","",1,"mat-body","result-description"],["fxLayout","row","fxLayoutAlign","end center"],["mat-raised-button","","type","button","color","primary",3,"click"],["color","warn","mode","indeterminate"],[2,"height","4px"]],template:function(n,t){1&n&&(e.\u0275\u0275elementStart(0,"mat-toolbar",0)(1,"h2",1),e.\u0275\u0275text(2,"security.2fa.dialog.enable-email-title"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(3,"span",2),e.\u0275\u0275elementStart(4,"button",3),e.\u0275\u0275listener("click",function(){return t.closeDialog()}),e.\u0275\u0275elementStart(5,"mat-icon",4),e.\u0275\u0275text(6,"close"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275template(7,Wm,1,0,"mat-progress-bar",5),e.\u0275\u0275pipe(8,"async"),e.\u0275\u0275template(9,qm,1,0,"div",6),e.\u0275\u0275pipe(10,"async"),e.\u0275\u0275elementStart(11,"div",7)(12,"mat-stepper",8,9),e.\u0275\u0275template(14,$m,2,0,"ng-template",10),e.\u0275\u0275elementStart(15,"mat-step",11),e.\u0275\u0275template(16,Hm,2,3,"ng-template",12),e.\u0275\u0275elementStart(17,"form",13),e.\u0275\u0275listener("ngSubmit",function(){return t.nextStep()}),e.\u0275\u0275elementStart(18,"p",14),e.\u0275\u0275text(19,"security.2fa.dialog.email-step-description"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(20,"div",15)(21,"mat-form-field",16),e.\u0275\u0275element(22,"input",17),e.\u0275\u0275pipe(23,"translate"),e.\u0275\u0275template(24,zm,3,3,"mat-error",18),e.\u0275\u0275template(25,Km,3,3,"mat-error",18),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(26,"button",19),e.\u0275\u0275pipe(27,"async"),e.\u0275\u0275text(28),e.\u0275\u0275pipe(29,"translate"),e.\u0275\u0275elementEnd()()()(),e.\u0275\u0275elementStart(30,"mat-step",11),e.\u0275\u0275template(31,Ym,2,3,"ng-template",12),e.\u0275\u0275elementStart(32,"form",13),e.\u0275\u0275listener("ngSubmit",function(){return t.nextStep()}),e.\u0275\u0275elementStart(33,"p",20),e.\u0275\u0275text(34),e.\u0275\u0275pipe(35,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(36,"div",21)(37,"mat-form-field",22),e.\u0275\u0275element(38,"input",23),e.\u0275\u0275pipe(39,"translate"),e.\u0275\u0275template(40,Jm,3,3,"mat-error",18),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(41,"div",24)(42,"button",25),e.\u0275\u0275pipe(43,"async"),e.\u0275\u0275text(44),e.\u0275\u0275pipe(45,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(46,"button",19),e.\u0275\u0275pipe(47,"async"),e.\u0275\u0275text(48),e.\u0275\u0275pipe(49,"translate"),e.\u0275\u0275elementEnd()()()()(),e.\u0275\u0275elementStart(50,"mat-step"),e.\u0275\u0275template(51,Qm,2,3,"ng-template",26),e.\u0275\u0275elementStart(52,"div")(53,"h3",27),e.\u0275\u0275text(54,"security.2fa.dialog.success"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(55,"p",28),e.\u0275\u0275text(56,"security.2fa.dialog.activation-step-description-email"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(57,"div",29)(58,"button",30),e.\u0275\u0275listener("click",function(){return t.closeDialog()}),e.\u0275\u0275text(59),e.\u0275\u0275pipe(60,"translate"),e.\u0275\u0275elementEnd()()()()()()),2&n&&(e.\u0275\u0275advance(7),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(8,20,t.isLoading$)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!e.\u0275\u0275pipeBind1(10,22,t.isLoading$)),e.\u0275\u0275advance(3),e.\u0275\u0275property("linear",!0),e.\u0275\u0275advance(3),e.\u0275\u0275property("stepControl",t.emailConfigForm),e.\u0275\u0275advance(2),e.\u0275\u0275property("formGroup",t.emailConfigForm),e.\u0275\u0275advance(5),e.\u0275\u0275propertyInterpolate("placeholder",e.\u0275\u0275pipeBind1(23,24,"security.2fa.dialog.email-step-label")),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",t.emailConfigForm.get("email").hasError("required")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.emailConfigForm.get("email").hasError("email")),e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(27,26,t.isLoading$)||t.emailConfigForm.invalid),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(29,28,"security.2fa.dialog.send-code")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("stepControl",t.emailVerificationForm),e.\u0275\u0275advance(2),e.\u0275\u0275property("formGroup",t.emailVerificationForm),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind2(35,30,"security.2fa.dialog.verification-step-description",e.\u0275\u0275pureFunction1(45,Xm,t.emailConfigForm.get("email").value))," "),e.\u0275\u0275advance(4),e.\u0275\u0275propertyInterpolate("placeholder",e.\u0275\u0275pipeBind1(39,33,"security.2fa.dialog.verification-code")),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",t.emailVerificationForm.get("verificationCode").invalid),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(43,35,t.isLoading$)),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(45,37,"action.back")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(47,39,t.isLoading$)||t.emailVerificationForm.invalid),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(49,41,"action.activate")," "),e.\u0275\u0275advance(11),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(60,43,"action.done")," "))},dependencies:[p.NgIf,rt.ToastDirective,S.MatButton,S.MatIconButton,F.MatIcon,z.MatProgressBar,O.MatInput,_.MatFormField,_.MatError,oe.MatToolbar,C.MatDialogContent,Q.MatStep,Q.MatStepLabel,Q.MatStepper,Q.MatStepperPrevious,Q.MatStepperIcon,h.DefaultLayoutDirective,h.DefaultLayoutGapDirective,h.DefaultLayoutAlignDirective,h.DefaultFlexDirective,r.\u0275NgNoValidate,r.DefaultValueAccessor,r.NgControlStatus,r.NgControlStatusGroup,r.RequiredValidator,r.MaxLengthValidator,r.PatternValidator,r.FormGroupDirective,r.FormControlName,g.TranslateDirective,p.AsyncPipe,g.TranslatePipe],styles:['@charset "UTF-8";[_nghost-%COMP%]   .mat-toolbar[_ngcontent-%COMP%] > h2[_ngcontent-%COMP%]{font-weight:400;letter-spacing:.25px}[_nghost-%COMP%]   form[_ngcontent-%COMP%]{display:block}[_nghost-%COMP%]   .mat-body-2[_ngcontent-%COMP%]{margin-bottom:0;letter-spacing:.25px}[_nghost-%COMP%]   .mat-body-2[_ngcontent-%COMP%]:not(:first-of-type){margin:0 0 8px}[_nghost-%COMP%]   .mat-body-2.description[_ngcontent-%COMP%]{margin:0;color:#0000008a}[_nghost-%COMP%]   .mat-body-2.description[_ngcontent-%COMP%]:last-of-type{margin-bottom:24px}[_nghost-%COMP%]   .input-container[_ngcontent-%COMP%]{max-width:290px}[_nghost-%COMP%]   .code-container[_ngcontent-%COMP%]{max-width:170px}@media screen and (max-width: 599px){[_nghost-%COMP%]   .code-container.full-width-xs[_ngcontent-%COMP%]{max-width:100%;width:100%}}[_nghost-%COMP%]   .result-title[_ngcontent-%COMP%]{font:500 18px/24px Roboto,Helvetica Neue,sans-serif;letter-spacing:.1px;margin:8px 0;text-align:center}[_nghost-%COMP%]   .result-description[_ngcontent-%COMP%]{text-align:center;margin:0 0 16px;letter-spacing:.25px;max-width:500px}[_nghost-%COMP%]   .step-description[_ngcontent-%COMP%]{max-width:450px}[_nghost-%COMP%]   .step-description.input[_ngcontent-%COMP%]{margin:12px 0 0}[_nghost-%COMP%]   .qr-code-description[_ngcontent-%COMP%]{text-align:center;max-width:180px;letter-spacing:.25px;color:#000000de;margin-bottom:0}[_nghost-%COMP%]   .backup-code[_ngcontent-%COMP%]{max-width:500px}[_nghost-%COMP%]   .backup-code[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]{max-width:500px;margin:40px 0 8px}[_nghost-%COMP%]   .backup-code[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .code[_ngcontent-%COMP%]{letter-spacing:.25px;padding:0 24px;margin-bottom:16px;font-family:Roboto Mono,Helvetica Neue,monospace}[_nghost-%COMP%]   .backup-code[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .code.even[_ngcontent-%COMP%]{text-align:right}[_nghost-%COMP%]   .backup-code[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]{margin-bottom:40px}[_nghost-%COMP%]     .mat-horizontal-stepper-header{pointer-events:none!important}']});const Zm='<html lang="en">\r\n<head>\r\n    <meta name="viewport" content="width=device-width" />\r\n    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />\r\n    <title>Backup code</title>\r\n\r\n    <style>\r\n        .code-block {\r\n            display: flex;\r\n            flex-wrap: wrap;\r\n            margin-bottom: 16px;\r\n        }\r\n        .code-row {\r\n            margin: 0 6px 8px;\r\n            display: flex;\r\n            min-width: 130px;\r\n        }\r\n        .code {\r\n            font: 400 16px / 20px Roboto Mono, "Helvetica Neue", monospace;\r\n            margin-left: 6px;\r\n        }\r\n        input[type="checkbox"] {\r\n            -webkit-appearance: none;\r\n            appearance: none;\r\n            background-color: #fff;\r\n            margin: 0;\r\n            font: inherit;\r\n            color: currentColor;\r\n            width: 1em;\r\n            height: 1em;\r\n            border: 0.1em solid currentColor;\r\n            border-radius: 0.15em;\r\n            transform: translateY(0em);\r\n        }\r\n    </style>\r\n</head>\r\n\r\n<body style="margin: 0">\r\n    <div style="margin: 8px; max-width: 286px">\r\n        <div style="border: #d0d7de solid 1px; border-radius:4px">\r\n            <h3 style="padding: 16px 24px; margin: 0; font: 500 20px / 24px Roboto, \'Helvetica Neue\', sans-serif; text-align: center">\r\n                Backup codes\r\n            </h3>\r\n            <div class="code-block">\r\n                ${codesBlock}\r\n            </div>\r\n        </div>\r\n    </div>\r\n</body>\r\n</html>\r\n';function eu(i,n){1&i&&e.\u0275\u0275element(0,"mat-progress-bar",15)}function tu(i,n){1&i&&e.\u0275\u0275element(0,"div",16)}const nu=function(i){return{even:i}};function iu(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",17),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){const t=n.$implicit,a=n.even;e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction1(2,nu,a)),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",t," ")}}class ji extends le.a{constructor(n,t,a,o,s,l){super(n,t,s),this.store=n,this.router=t,this.twoFaService=a,this.importExportService=o,this.dialogRef=s,this.fb=l,this.twoFaService.generateTwoFaAccountConfig(W.hs.BACKUP_CODE).pipe((0,Z.b)(d=>this.backupCode=d),(0,ne.z)(d=>this.twoFaService.verifyAndSaveTwoFaAccountConfig(d,null,{ignoreLoading:!0}))).subscribe(d=>{this.config=d})}closeDialog(){this.dialogRef.close(this.config)}downloadFile(){this.importExportService.exportText(this.backupCode.codes,"backup-codes")}printCode(){const n=(0,T.I8)(this.backupCode.codes).map(o=>`<div class="code-row"><input type="checkbox"><span class="code">${o}</span></div>`).join(""),t=Zm.replace("${codesBlock}",n),a=window.open("","Print backup code");a.document.open(),a.document.write(t),setTimeout(()=>{a.print(),a.document.close(),setTimeout(()=>{a.close()},10)},0)}}ji.\u0275fac=function(n){return new(n||ji)(e.\u0275\u0275directiveInject(x.Store),e.\u0275\u0275directiveInject(b.Router),e.\u0275\u0275directiveInject(Pn.b),e.\u0275\u0275directiveInject(ct.s),e.\u0275\u0275directiveInject(C.MatDialogRef),e.\u0275\u0275directiveInject(r.UntypedFormBuilder))},ji.\u0275cmp=e.\u0275\u0275defineComponent({type:ji,selectors:[["tb-backup-code-auth-dialog"]],features:[e.\u0275\u0275InheritDefinitionFeature],decls:29,vars:16,consts:[["fxLayout","row","color","primary"],["translate",""],["fxFlex",""],["mat-icon-button","","type","button",3,"click"],[1,"material-icons"],["color","warn","mode","indeterminate",4,"ngIf"],["style","height: 4px;",4,"ngIf"],["mat-dialog-content","","tb-toast","",1,"backup-code"],["translate","",1,"mat-body-2","description"],["fxLayout","row wrap",1,"container"],["fxFlex","50","class","code",3,"ngClass",4,"ngFor","ngForOf"],["fxLayout","row","fxLayoutAlign","center start","fxLayoutGap","16px",1,"action-buttons"],["type","button","mat-stroked-button","","color","primary",3,"click"],["type","button","mat-raised-button","","color","primary",3,"click"],["fxLayout","row","fxLayoutAlign","end start"],["color","warn","mode","indeterminate"],[2,"height","4px"],["fxFlex","50",1,"code",3,"ngClass"]],template:function(n,t){1&n&&(e.\u0275\u0275elementStart(0,"mat-toolbar",0)(1,"h2",1),e.\u0275\u0275text(2,"security.2fa.dialog.get-backup-code-title"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(3,"span",2),e.\u0275\u0275elementStart(4,"button",3),e.\u0275\u0275listener("click",function(){return t.closeDialog()}),e.\u0275\u0275elementStart(5,"mat-icon",4),e.\u0275\u0275text(6,"close"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275template(7,eu,1,0,"mat-progress-bar",5),e.\u0275\u0275pipe(8,"async"),e.\u0275\u0275template(9,tu,1,0,"div",6),e.\u0275\u0275pipe(10,"async"),e.\u0275\u0275elementStart(11,"div",7)(12,"p",8),e.\u0275\u0275text(13,"security.2fa.dialog.backup-code-description"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(14,"div",9),e.\u0275\u0275template(15,iu,2,4,"div",10),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(16,"div",11)(17,"button",12),e.\u0275\u0275listener("click",function(){return t.downloadFile()}),e.\u0275\u0275text(18),e.\u0275\u0275pipe(19,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(20,"button",13),e.\u0275\u0275listener("click",function(){return t.printCode()}),e.\u0275\u0275text(21),e.\u0275\u0275pipe(22,"translate"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(23,"p",8),e.\u0275\u0275text(24,"security.2fa.dialog.backup-code-warn"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(25,"div",14)(26,"button",13),e.\u0275\u0275listener("click",function(){return t.closeDialog()}),e.\u0275\u0275text(27),e.\u0275\u0275pipe(28,"translate"),e.\u0275\u0275elementEnd()()()),2&n&&(e.\u0275\u0275advance(7),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(8,6,t.isLoading$)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!e.\u0275\u0275pipeBind1(10,8,t.isLoading$)),e.\u0275\u0275advance(6),e.\u0275\u0275property("ngForOf",null==t.backupCode?null:t.backupCode.codes),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(19,10,"security.2fa.dialog.download-txt")," "),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(22,12,"action.print")," "),e.\u0275\u0275advance(6),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(28,14,"action.done")," "))},dependencies:[p.NgClass,p.NgForOf,p.NgIf,rt.ToastDirective,S.MatButton,S.MatIconButton,F.MatIcon,z.MatProgressBar,oe.MatToolbar,C.MatDialogContent,h.DefaultLayoutDirective,h.DefaultLayoutGapDirective,h.DefaultLayoutAlignDirective,h.DefaultFlexDirective,G.DefaultClassDirective,g.TranslateDirective,p.AsyncPipe,g.TranslatePipe],styles:['@charset "UTF-8";[_nghost-%COMP%]   .mat-toolbar[_ngcontent-%COMP%] > h2[_ngcontent-%COMP%]{font-weight:400;letter-spacing:.25px}[_nghost-%COMP%]   form[_ngcontent-%COMP%]{display:block}[_nghost-%COMP%]   .mat-body-2[_ngcontent-%COMP%]{margin-bottom:0;letter-spacing:.25px}[_nghost-%COMP%]   .mat-body-2[_ngcontent-%COMP%]:not(:first-of-type){margin:0 0 8px}[_nghost-%COMP%]   .mat-body-2.description[_ngcontent-%COMP%]{margin:0;color:#0000008a}[_nghost-%COMP%]   .mat-body-2.description[_ngcontent-%COMP%]:last-of-type{margin-bottom:24px}[_nghost-%COMP%]   .input-container[_ngcontent-%COMP%]{max-width:290px}[_nghost-%COMP%]   .code-container[_ngcontent-%COMP%]{max-width:170px}@media screen and (max-width: 599px){[_nghost-%COMP%]   .code-container.full-width-xs[_ngcontent-%COMP%]{max-width:100%;width:100%}}[_nghost-%COMP%]   .result-title[_ngcontent-%COMP%]{font:500 18px/24px Roboto,Helvetica Neue,sans-serif;letter-spacing:.1px;margin:8px 0;text-align:center}[_nghost-%COMP%]   .result-description[_ngcontent-%COMP%]{text-align:center;margin:0 0 16px;letter-spacing:.25px;max-width:500px}[_nghost-%COMP%]   .step-description[_ngcontent-%COMP%]{max-width:450px}[_nghost-%COMP%]   .step-description.input[_ngcontent-%COMP%]{margin:12px 0 0}[_nghost-%COMP%]   .qr-code-description[_ngcontent-%COMP%]{text-align:center;max-width:180px;letter-spacing:.25px;color:#000000de;margin-bottom:0}[_nghost-%COMP%]   .backup-code[_ngcontent-%COMP%]{max-width:500px}[_nghost-%COMP%]   .backup-code[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]{max-width:500px;margin:40px 0 8px}[_nghost-%COMP%]   .backup-code[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .code[_ngcontent-%COMP%]{letter-spacing:.25px;padding:0 24px;margin-bottom:16px;font-family:Roboto Mono,Helvetica Neue,monospace}[_nghost-%COMP%]   .backup-code[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .code.even[_ngcontent-%COMP%]{text-align:right}[_nghost-%COMP%]   .backup-code[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]{margin-bottom:40px}[_nghost-%COMP%]     .mat-horizontal-stepper-header{pointer-events:none!important}']});const au=new Map([[W.hs.TOTP,Vi],[W.hs.SMS,Ui],[W.hs.EMAIL,Gi],[W.hs.BACKUP_CODE,ji]]);function ou(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"security.password-requirement.incorrect-password-try-again")," "))}function ru(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"security.password-requirement.password-not-meet-requirements")," "))}function su(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",t.changePassword.get("newPassword").getError("alreadyUsed")," ")}}function lu(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"security.password-requirement.password-should-difference")," "))}function du(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"security.password-requirement.password-should-not-contain-spaces")," "))}function cu(i,n){1&i&&e.\u0275\u0275elementContainer(0)}function pu(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"security.password-requirement.new-passwords-not-match")," "))}function mu(i,n){1&i&&e.\u0275\u0275elementContainer(0)}const Wi=function(i){return{count:i}};function uu(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"p",36)(1,"tb-icon",37),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd(),e.\u0275\u0275text(3),e.\u0275\u0275pipe(4,"translate"),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275nextContext(3);e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",t.changePassword.get("newPassword").hasError("notUpperCase")?"mdi:circle-small":"mdi:check"," "),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind2(4,2,"security.password-requirement.uppercase-letter",e.\u0275\u0275pureFunction1(5,Wi,t.passwordPolicy.minimumUppercaseLetters))," ")}}function gu(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"p",36)(1,"tb-icon",37),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd(),e.\u0275\u0275text(3),e.\u0275\u0275pipe(4,"translate"),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275nextContext(3);e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",t.changePassword.get("newPassword").hasError("notLowerCase")?"mdi:circle-small":"mdi:check"," "),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind2(4,2,"security.password-requirement.lowercase-letter",e.\u0275\u0275pureFunction1(5,Wi,t.passwordPolicy.minimumLowercaseLetters))," ")}}function fu(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"p",36)(1,"tb-icon",37),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd(),e.\u0275\u0275text(3),e.\u0275\u0275pipe(4,"translate"),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275nextContext(3);e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",t.changePassword.get("newPassword").hasError("notNumeric")?"mdi:circle-small":"mdi:check"," "),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind2(4,2,"security.password-requirement.digit",e.\u0275\u0275pureFunction1(5,Wi,t.passwordPolicy.minimumDigits))," ")}}function hu(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"p",36)(1,"tb-icon",37),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd(),e.\u0275\u0275text(3),e.\u0275\u0275pipe(4,"translate"),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275nextContext(3);e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",t.changePassword.get("newPassword").hasError("notSpecial")?"mdi:circle-small":"mdi:check"," "),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind2(4,2,"security.password-requirement.special-character",e.\u0275\u0275pureFunction1(5,Wi,t.passwordPolicy.minimumSpecialCharacters))," ")}}function bu(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"p",36)(1,"tb-icon",37),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd(),e.\u0275\u0275text(3),e.\u0275\u0275pipe(4,"translate"),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275nextContext(3);e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",t.changePassword.get("newPassword").hasError("minLength")?"mdi:circle-small":"mdi:check"," "),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind2(4,2,"security.password-requirement.character",e.\u0275\u0275pureFunction1(5,Wi,t.passwordPolicy.minimumLength))," ")}}function yu(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",33)(1,"h4",34),e.\u0275\u0275text(2,"security.password-requirement.at-most"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"p",36),e.\u0275\u0275element(4,"mat-icon",38),e.\u0275\u0275text(5),e.\u0275\u0275pipe(6,"translate"),e.\u0275\u0275elementEnd()()),2&i){const t=e.\u0275\u0275nextContext(3);e.\u0275\u0275advance(4),e.\u0275\u0275property("svgIcon",t.changePassword.get("newPassword").hasError("maxLength")?"mdi:circle-small":"mdi:check"),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind2(6,2,"security.password-requirement.character",e.\u0275\u0275pureFunction1(5,Wi,t.passwordPolicy.maximumLength))," ")}}function vu(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",33)(1,"h3",13),e.\u0275\u0275text(2,"security.password-requirement.password-requirements"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"h4",34),e.\u0275\u0275text(4,"security.password-requirement.at-least"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(5,uu,5,7,"p",35),e.\u0275\u0275template(6,gu,5,7,"p",35),e.\u0275\u0275template(7,fu,5,7,"p",35),e.\u0275\u0275template(8,hu,5,7,"p",35),e.\u0275\u0275template(9,bu,5,7,"p",35),e.\u0275\u0275template(10,yu,7,7,"div",32),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(5),e.\u0275\u0275property("ngIf",t.passwordPolicy.minimumUppercaseLetters>0),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.passwordPolicy.minimumLowercaseLetters>0),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.passwordPolicy.minimumDigits>0),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.passwordPolicy.minimumSpecialCharacters>0),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.passwordPolicy.minimumLength>0),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.passwordPolicy.maximumLength>0)}}function _u(i,n){if(1&i&&e.\u0275\u0275template(0,vu,11,6,"div",32),2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275property("ngIf",t.passwordPolicy)}}function xu(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",54),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275nextContext().$implicit,a=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,a.providersData.get(t).description)," ")}}function Cu(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",54),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275nextContext().$implicit,a=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind2(2,1,a.providersData.get(t).activatedHint,a.providerDataInfo(t))," ")}}function Tu(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"mat-checkbox",55),e.\u0275\u0275listener("change",function(o){e.\u0275\u0275restoreView(t);const s=e.\u0275\u0275nextContext().$implicit,l=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(l.changeDefaultProvider(o,s))}),e.\u0275\u0275pipe(1,"async"),e.\u0275\u0275elementStart(2,"span",56),e.\u0275\u0275text(3,"security.2fa.main-2fa-method"),e.\u0275\u0275elementEnd()()}if(2&i){const t=e.\u0275\u0275nextContext().$implicit,a=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("value",t)("checked",a.useByDefault===t)("disabled",e.\u0275\u0275pipeBind1(1,3,a.isLoading$))}}function Su(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",57),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(o.generateNewBackupCode())}),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()}2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"security.2fa.get-new-code")," "))}function Iu(i,n){1&i&&e.\u0275\u0275element(0,"mat-divider")}function wu(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"div",46)(2,"h4",47),e.\u0275\u0275text(3),e.\u0275\u0275pipe(4,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"div",48),e.\u0275\u0275template(6,xu,3,3,"div",49),e.\u0275\u0275template(7,Cu,3,4,"ng-template",null,50,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementStart(9,"mat-slide-toggle",51),e.\u0275\u0275listener("mousedown",function(o){const l=e.\u0275\u0275restoreView(t).$implicit,d=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(d.confirm2FAChange(o,l))}),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(10,Tu,4,5,"mat-checkbox",52),e.\u0275\u0275template(11,Su,3,3,"button",53),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(12,Iu,1,0,"mat-divider",18),e.\u0275\u0275elementContainerEnd()}if(2&i){const t=n.$implicit,a=n.last,o=e.\u0275\u0275reference(8),s=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(4,7,s.providersData.get(t).name)),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",!s.twoFactorAuth.get(t).value)("ngIfElse",o),e.\u0275\u0275advance(3),e.\u0275\u0275property("formControlName",t),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",s.twoFactorAuth.get(t).value&&t!==s.twoFactorAuthProviderType.BACKUP_CODE&&!s.activeSingleProvider),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",s.twoFactorAuth.get(t).value&&t===s.twoFactorAuthProviderType.BACKUP_CODE),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!a)}}function Eu(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-card",39)(1,"mat-card-title",40)(2,"span",3),e.\u0275\u0275text(3,"admin.2fa.2fa"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(4,"mat-card-subtitle",41)(5,"div",42),e.\u0275\u0275text(6,"security.2fa.2fa-description"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(7,"h3",43),e.\u0275\u0275text(8,"security.2fa.authenticate-with"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(9,"form",44),e.\u0275\u0275template(10,wu,13,9,"ng-container",45),e.\u0275\u0275elementEnd()()),2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(9),e.\u0275\u0275property("formGroup",t.twoFactorAuth),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",t.allowTwoFactorProviders)("ngForTrackBy",t.trackByProvider)}}class qi extends se.I{get jwtToken(){return`Bearer ${localStorage.getItem("jwt_token")}`}get jwtTokenExpiration(){return localStorage.getItem("jwt_token_expiration")}get expirationJwtData(){const n=this.datePipe.transform(this.jwtTokenExpiration,"yyyy-MM-dd HH:mm:ss");return this.translate.instant("profile.valid-till",{expirationData:n})}constructor(n,t,a,o,s,l,d,m,y,I){super(n),this.store=n,this.route=t,this.translate=a,this.twoFaService=o,this.dialog=s,this.dialogService=l,this.fb=d,this.datePipe=m,this.authService=y,this.clipboardService=I,this.destroy$=new be.x,this.allowTwoFactorProviders=[],this.providersData=W.Zc,this.twoFactorAuthProviderType=W.hs,this.useByDefault=null,this.activeSingleProvider=!0}ngOnInit(){this.buildTwoFactorForm(),this.user=this.route.snapshot.data.user,this.twoFactorLoad(this.route.snapshot.data.providers),this.buildChangePasswordForm(),this.loadPasswordPolicy()}ngOnDestroy(){super.ngOnDestroy(),this.destroy$.next(),this.destroy$.complete()}buildTwoFactorForm(){this.twoFactorAuth=this.fb.group({TOTP:[!1],SMS:[!1],EMAIL:[!1],BACKUP_CODE:[{value:!1,disabled:!0}]}),this.twoFactorAuth.valueChanges.pipe((0,Y.R)(this.destroy$)).subscribe(n=>{const t=Object.keys(n).filter(a=>n[a]&&a!==W.hs.BACKUP_CODE);this.activeSingleProvider=t.length<2,t.length?this.twoFactorAuth.get("BACKUP_CODE").enable({emitEvent:!1}):this.twoFactorAuth.get("BACKUP_CODE").disable({emitEvent:!1})})}twoFactorLoad(n){n.length&&(this.twoFaService.getAccountTwoFaSettings().subscribe(t=>this.processTwoFactorAuthConfig(t)),Object.values(W.hs).forEach(t=>{n.includes(t)&&this.allowTwoFactorProviders.push(t)}))}processTwoFactorAuthConfig(n){this.accountConfig=n?.configs||{},Object.values(W.hs).forEach(t=>{this.accountConfig[t]?(this.twoFactorAuth.get(t).setValue(!0),this.accountConfig[t].useByDefault&&(this.useByDefault=t)):this.twoFactorAuth.get(t).setValue(!1)})}buildChangePasswordForm(){this.changePassword=this.fb.group({currentPassword:[""],newPassword:["",r.Validators.required],newPassword2:["",this.samePasswordValidation(!1,"newPassword")]})}loadPasswordPolicy(){this.authService.getUserPasswordPolicy().subscribe(n=>{this.passwordPolicy=n,this.changePassword.get("newPassword").setValidators([this.passwordStrengthValidator(),this.samePasswordValidation(!0,"currentPassword"),r.Validators.required]),this.changePassword.get("newPassword").updateValueAndValidity({emitEvent:!1})})}passwordStrengthValidator(){return n=>{const t=n.value,a={};return this.passwordPolicy.minimumUppercaseLetters>0&&!new RegExp(`(?:.*?[A-Z]){${this.passwordPolicy.minimumUppercaseLetters}}`).test(t)&&(a.notUpperCase=!0),this.passwordPolicy.minimumLowercaseLetters>0&&!new RegExp(`(?:.*?[a-z]){${this.passwordPolicy.minimumLowercaseLetters}}`).test(t)&&(a.notLowerCase=!0),this.passwordPolicy.minimumDigits>0&&!new RegExp(`(?:.*?\\d){${this.passwordPolicy.minimumDigits}}`).test(t)&&(a.notNumeric=!0),this.passwordPolicy.minimumSpecialCharacters>0&&!new RegExp(`(?:.*?[\\W_]){${this.passwordPolicy.minimumSpecialCharacters}}`).test(t)&&(a.notSpecial=!0),!this.passwordPolicy.allowWhitespaces&&/\s/.test(t)&&(a.hasWhitespaces=!0),this.passwordPolicy.minimumLength>0&&t.length<this.passwordPolicy.minimumLength&&(a.minLength=!0),(!t.length||this.passwordPolicy.maximumLength>0&&t.length>this.passwordPolicy.maximumLength)&&(a.maxLength=!0),(0,T.Xy)(a,{})?null:a}}samePasswordValidation(n,t){return a=>{const o=a.value,s=a.parent?.value[t];return n?o===s?{samePassword:!0}:null:o!==s?{differencePassword:!0}:null}}trackByProvider(n,t){return t}copyToken(){+this.jwtTokenExpiration<Date.now()?this.store.dispatch(new V.zi({message:this.translate.instant("profile.tokenCopiedWarnMessage"),type:"warn",duration:1500,verticalPosition:"bottom",horizontalPosition:"right"})):(this.clipboardService.copyFromContent(this.jwtToken),this.store.dispatch(new V.zi({message:this.translate.instant("profile.tokenCopiedSuccessMessage"),type:"success",duration:750,verticalPosition:"bottom",horizontalPosition:"right"})))}confirm2FAChange(n,t){if(n.stopPropagation(),n.preventDefault(),!this.twoFactorAuth.get(t).disabled)if(this.twoFactorAuth.get(t).value){const a=this.translate.instant(`security.2fa.provider.${t.toLowerCase()}`);this.dialogService.confirm(this.translate.instant("security.2fa.disable-2fa-provider-title",{name:a}),this.translate.instant("security.2fa.disable-2fa-provider-text",{name:a})).subscribe(o=>{o&&(this.twoFactorAuth.disable({emitEvent:!1}),this.twoFaService.deleteTwoFaAccountConfig(t).pipe((0,Z.b)(()=>this.twoFactorAuth.enable({emitEvent:!1}))).subscribe(s=>this.processTwoFactorAuthConfig(s)))})}else this.createdNewAuthConfig(t)}createdNewAuthConfig(n){const t=n===W.hs.EMAIL?{email:this.user.email}:{};this.dialog.open(au.get(n),{disableClose:!0,panelClass:["tb-dialog","tb-fullscreen-dialog"],data:t}).afterClosed().subscribe(a=>{(0,T.nu)(a)&&this.processTwoFactorAuthConfig(a)})}changeDefaultProvider(n,t){this.useByDefault!==t?(this.twoFactorAuth.disable({emitEvent:!1}),this.twoFaService.updateTwoFaAccountConfig(t,!0).pipe((0,Z.b)(()=>this.twoFactorAuth.enable({emitEvent:!1}))).subscribe(a=>this.processTwoFactorAuthConfig(a))):n.source.checked=!0}generateNewBackupCode(){const n=this.accountConfig[W.hs.BACKUP_CODE].codesLeft;let t;t=n?this.dialogService.confirm("Get new set of backup codes?",`If you get new backup codes, ${n} remaining codes you have left will be unusable.`,"","Get new codes"):(0,J.of)(!0),t.subscribe(a=>{a&&(this.twoFactorAuth.disable({emitEvent:!1}),this.twoFaService.deleteTwoFaAccountConfig(W.hs.BACKUP_CODE).pipe((0,Z.b)(()=>this.twoFactorAuth.enable({emitEvent:!1}))).subscribe(()=>this.createdNewAuthConfig(W.hs.BACKUP_CODE)))})}providerDataInfo(n){const t={info:null},a=this.accountConfig[n];if((0,T.nu)(a))switch(n){case W.hs.EMAIL:t.info=a.email;break;case W.hs.SMS:t.info=a.phoneNumber;break;case W.hs.BACKUP_CODE:t.info=a.codesLeft}return t}onChangePassword(n){this.changePassword.valid?this.authService.changePassword(this.changePassword.get("currentPassword").value,this.changePassword.get("newPassword").value,{ignoreErrors:!0}).subscribe(()=>{this.discardChanges(n)},t=>{400===t.status&&"Current password doesn't match!"===t.error.message?this.changePassword.get("currentPassword").setErrors({differencePassword:!0}):400===t.status&&t.error.message.startsWith("Password must")?this.loadPasswordPolicy():400===t.status&&t.error.message.startsWith("Password was already used")?this.changePassword.get("newPassword").setErrors({alreadyUsed:t.error.message}):this.store.dispatch(new V.zi({message:t.error.message,type:"error",target:"changePassword"}))}):this.changePassword.markAllAsTouched()}discardChanges(n,t){t&&t.stopPropagation(),n.resetForm({currentPassword:"",newPassword:"",newPassword2:""})}}qi.\u0275fac=function(n){return new(n||qi)(e.\u0275\u0275directiveInject(x.Store),e.\u0275\u0275directiveInject(b.ActivatedRoute),e.\u0275\u0275directiveInject(g.TranslateService),e.\u0275\u0275directiveInject(Pn.b),e.\u0275\u0275directiveInject(C.MatDialog),e.\u0275\u0275directiveInject(pe.x),e.\u0275\u0275directiveInject(r.UntypedFormBuilder),e.\u0275\u0275directiveInject(p.DatePipe),e.\u0275\u0275directiveInject(pi.e),e.\u0275\u0275directiveInject(he.Yv))},qi.\u0275cmp=e.\u0275\u0275defineComponent({type:qi,selectors:[["tb-security"]],features:[e.\u0275\u0275InheritDefinitionFeature],decls:63,vars:37,consts:[["fxLayout","column","fxLayoutGap","8px",1,"profile-container"],["appearance","outlined","fxLayout","column",1,"profile-card"],[2,"margin-bottom","8px"],["translate","",1,"mat-headline-5","card-title"],["fxLayout","row","fxLayoutAlign","space-between center"],[1,"token-text"],[1,"date"],["mat-raised-button","","color","primary","type","button",3,"click"],["tb-toast","","toastTarget","changePassword",1,"change-password"],[3,"formGroup","ngSubmit"],["changePasswordForm","ngForm"],["fxLayout","row","fxLayout.xs","column","fxLayoutGap","25px","fxLayoutGap.xs","0"],["fxFlex","290px","fxFlex.sm","250px","fxFlex.xs","100"],["translate","",1,"card-title"],["appearance","fill","color","primary",1,"mat-block","same-color"],["translate",""],["matInput","","type","password","name","current-password","formControlName","currentPassword","autocomplete","current-password"],["matSuffix","",3,"fxShow"],[4,"ngIf"],["hideRequiredMarker","","appearance","fill","color","primary","subscriptSizing","dynamic",1,"mat-block","same-color"],["matInput","","type","password","name","new-password","formControlName","newPassword","autocomplete","new-password","required",""],["fxFlex","","fxHide","","fxShow.xs","","fxLayoutAlign","start center"],[4,"ngTemplateOutlet"],["hideRequiredMarker","","appearance","fill","color","primary",1,"mat-block","same-color"],["matInput","","type","password","name","new-password","formControlName","newPassword2","autocomplete","new-password","required",""],[3,"vertical"],["fxFlex","","fxHide.xs","","fxLayoutAlign","start start"],["passwordRequirements",""],["fxLayout","row","fxLayoutGap","8px",2,"margin-top","18px",3,"fxShow"],["mat-button","","color","primary","type","button",3,"disabled","click"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],["appearance","outlined","class","profile-card",4,"ngIf"],["class","password-requirements",4,"ngIf"],[1,"password-requirements"],["translate","",1,"mat-h4"],["class","mat-body",4,"ngIf"],[1,"mat-body"],[1,"tb-mat-20"],[1,"tb-mat-20",3,"svgIcon"],["appearance","outlined",1,"profile-card"],[2,"margin-bottom","20px"],[2,"margin-bottom","40px"],["translate","",1,"mat-body-2","description"],["translate","",1,"mat-h3","auth-title"],[3,"formGroup"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"provider"],[1,"provider-title"],["fxLayout","row","fxLayoutAlign","space-between start"],["class","mat-body-2 description",4,"ngIf","ngIfElse"],["providerInfo",""],[3,"formControlName","mousedown"],[3,"value","checked","disabled","change",4,"ngIf"],["type","button","mat-stroked-button","","color","primary",3,"click",4,"ngIf"],[1,"mat-body-2","description"],[3,"value","checked","disabled","change"],["translate","",1,"checkbox-label"],["type","button","mat-stroked-button","","color","primary",3,"click"]],template:function(n,t){if(1&n){const a=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",0)(1,"mat-card",1)(2,"mat-card-title",2)(3,"span",3),e.\u0275\u0275text(4,"profile.jwt-token"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(5,"div",4)(6,"div",5),e.\u0275\u0275text(7),e.\u0275\u0275pipe(8,"translate"),e.\u0275\u0275elementStart(9,"span",6),e.\u0275\u0275text(10),e.\u0275\u0275pipe(11,"date"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(12,"button",7),e.\u0275\u0275listener("click",function(){return t.copyToken()}),e.\u0275\u0275elementStart(13,"span"),e.\u0275\u0275text(14),e.\u0275\u0275pipe(15,"translate"),e.\u0275\u0275elementEnd()()()(),e.\u0275\u0275elementStart(16,"mat-card",1)(17,"div",8)(18,"form",9,10),e.\u0275\u0275listener("ngSubmit",function(){e.\u0275\u0275restoreView(a);const s=e.\u0275\u0275reference(19);return e.\u0275\u0275resetView(t.onChangePassword(s))}),e.\u0275\u0275elementStart(20,"div",11)(21,"div",12)(22,"h3",13),e.\u0275\u0275text(23,"profile.change-password"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(24,"mat-form-field",14)(25,"mat-label",15),e.\u0275\u0275text(26,"profile.current-password"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(27,"input",16)(28,"tb-toggle-password",17),e.\u0275\u0275template(29,ou,3,3,"mat-error",18),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(30,"mat-form-field",19)(31,"mat-label",15),e.\u0275\u0275text(32,"login.new-password"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(33,"input",20)(34,"tb-toggle-password",17)(35,"mat-hint"),e.\u0275\u0275template(36,ru,3,3,"mat-error",18),e.\u0275\u0275template(37,su,2,1,"mat-error",18),e.\u0275\u0275template(38,lu,3,3,"mat-error",18),e.\u0275\u0275template(39,du,3,3,"mat-error",18),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(40,"div",21),e.\u0275\u0275template(41,cu,1,0,"ng-container",22),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(42,"mat-form-field",23)(43,"mat-label",15),e.\u0275\u0275text(44,"login.new-password-again"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(45,"input",24)(46,"tb-toggle-password",17),e.\u0275\u0275template(47,pu,3,3,"mat-error",18),e.\u0275\u0275elementEnd()(),e.\u0275\u0275element(48,"mat-divider",25),e.\u0275\u0275elementStart(49,"div",26),e.\u0275\u0275template(50,mu,1,0,"ng-container",22),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(51,_u,1,1,"ng-template",null,27,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementStart(53,"div",28)(54,"button",29),e.\u0275\u0275listener("click",function(s){e.\u0275\u0275restoreView(a);const l=e.\u0275\u0275reference(19);return e.\u0275\u0275resetView(t.discardChanges(l,s))}),e.\u0275\u0275pipe(55,"async"),e.\u0275\u0275text(56),e.\u0275\u0275pipe(57,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(58,"button",30),e.\u0275\u0275pipe(59,"async"),e.\u0275\u0275text(60),e.\u0275\u0275pipe(61,"translate"),e.\u0275\u0275elementEnd()()()()(),e.\u0275\u0275template(62,Eu,11,3,"mat-card",31),e.\u0275\u0275elementEnd()}if(2&n){const a=e.\u0275\u0275reference(52);e.\u0275\u0275advance(7),e.\u0275\u0275textInterpolate1("",e.\u0275\u0275pipeBind1(8,22,"profile.token-valid-till")," "),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind2(11,24,t.jwtTokenExpiration,"yyyy-MM-dd HH:mm:ss")),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(15,27,"profile.copy-jwt-token")),e.\u0275\u0275advance(4),e.\u0275\u0275property("formGroup",t.changePassword),e.\u0275\u0275advance(10),e.\u0275\u0275property("fxShow",t.changePassword.get("currentPassword").dirty||t.changePassword.get("currentPassword").touched),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.changePassword.get("currentPassword").hasError("differencePassword")),e.\u0275\u0275advance(5),e.\u0275\u0275property("fxShow",t.changePassword.get("newPassword").dirty||t.changePassword.get("newPassword").touched),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",t.changePassword.get("newPassword").errors&&!t.changePassword.get("newPassword").hasError("alreadyUsed")&&!t.changePassword.get("newPassword").hasError("hasWhitespaces")&&!t.changePassword.get("newPassword").hasError("samePassword")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.changePassword.get("newPassword").hasError("alreadyUsed")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.changePassword.get("newPassword").hasError("samePassword")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.changePassword.get("newPassword").hasError("hasWhitespaces")),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngTemplateOutlet",a),e.\u0275\u0275advance(5),e.\u0275\u0275property("fxShow",t.changePassword.get("newPassword2").dirty||t.changePassword.get("newPassword2").touched),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.changePassword.get("newPassword2").hasError("differencePassword")),e.\u0275\u0275advance(1),e.\u0275\u0275property("vertical",!0),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngTemplateOutlet",a),e.\u0275\u0275advance(3),e.\u0275\u0275property("fxShow",t.changePassword.dirty||t.changePassword.touched),e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(55,29,t.isLoading$)),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(57,31,"action.discard-changes")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(59,33,t.isLoading$)),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(61,35,"profile.change-password")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",t.allowTwoFactorProviders.length)}},dependencies:[p.NgForOf,p.NgIf,p.NgTemplateOutlet,rt.ToastDirective,S.MatButton,fe.MatCheckbox,F.MatIcon,A.MatCard,A.MatCardSubtitle,A.MatCardTitle,O.MatInput,_.MatFormField,_.MatLabel,_.MatHint,_.MatError,_.MatSuffix,kn.MatDivider,Ce.MatSlideToggle,h.DefaultLayoutDirective,h.DefaultLayoutGapDirective,h.DefaultLayoutAlignDirective,h.DefaultFlexDirective,G.DefaultShowHideDirective,r.\u0275NgNoValidate,r.DefaultValueAccessor,r.NgControlStatus,r.NgControlStatusGroup,r.RequiredValidator,r.FormGroupDirective,r.FormControlName,g.TranslateDirective,no.TogglePasswordComponent,Wa.TbIconComponent,p.AsyncPipe,p.DatePipe,g.TranslatePipe],styles:['@charset "UTF-8";[_nghost-%COMP%]   .profile-container[_ngcontent-%COMP%]{padding:8px}[_nghost-%COMP%]   .mat-mdc-card.profile-card[_ngcontent-%COMP%]{padding:24px}@media screen and (min-width: 960px){[_nghost-%COMP%]   .mat-mdc-card.profile-card[_ngcontent-%COMP%]{width:80%}}@media screen and (min-width: 1280px){[_nghost-%COMP%]   .mat-mdc-card.profile-card[_ngcontent-%COMP%]{width:55%}}@media screen and (min-width: 1920px){[_nghost-%COMP%]   .mat-mdc-card.profile-card[_ngcontent-%COMP%]{width:45%}}[_nghost-%COMP%]   .mat-mdc-card.profile-card[_ngcontent-%COMP%]   .card-title[_ngcontent-%COMP%]{font:500 18px/24px Roboto,Helvetica Neue,sans-serif;letter-spacing:.15px;margin-top:0}[_nghost-%COMP%]   .mat-mdc-card.profile-card[_ngcontent-%COMP%]   .mat-h4[_ngcontent-%COMP%]{font-weight:500;font-size:14px;letter-spacing:.25px;margin:0 0 4px}[_nghost-%COMP%]   .mat-mdc-card.profile-card[_ngcontent-%COMP%]   .change-password[_ngcontent-%COMP%]{margin:0}[_nghost-%COMP%]   .mat-mdc-card.profile-card[_ngcontent-%COMP%]   .change-password[_ngcontent-%COMP%]   .mat-divider.mat-divider-vertical[_ngcontent-%COMP%]{margin-bottom:25px}[_nghost-%COMP%]   .mat-mdc-card.profile-card[_ngcontent-%COMP%]   .change-password[_ngcontent-%COMP%]   .mat-mdc-form-field[_ngcontent-%COMP%]{margin-bottom:4px}[_nghost-%COMP%]   .mat-mdc-card.profile-card[_ngcontent-%COMP%]   .change-password[_ngcontent-%COMP%]   .password-requirements[_ngcontent-%COMP%] > p[_ngcontent-%COMP%]{margin:0 0 8px;letter-spacing:.25px}[_nghost-%COMP%]   .mat-mdc-card.profile-card[_ngcontent-%COMP%]   .change-password[_ngcontent-%COMP%]   .mat-icon[data-mat-icon-name=check][_ngcontent-%COMP%]{color:#24a148}[_nghost-%COMP%]   .mat-mdc-card.profile-card[_ngcontent-%COMP%]   .auth-title[_ngcontent-%COMP%]{font-weight:500;margin:0}[_nghost-%COMP%]   .mat-mdc-card.profile-card[_ngcontent-%COMP%]   .token-text[_ngcontent-%COMP%]{font:400 14px/16px Roboto,Helvetica Neue,sans-serif;letter-spacing:.25px;padding:8px 0}[_nghost-%COMP%]   .mat-mdc-card.profile-card[_ngcontent-%COMP%]   .token-text[_ngcontent-%COMP%] > .date[_ngcontent-%COMP%]{opacity:.7}[_nghost-%COMP%]   .description[_ngcontent-%COMP%]{color:#0000008a;letter-spacing:.25px;margin-right:8px}[_nghost-%COMP%]   .mat-divider-horizontal[_ngcontent-%COMP%]{left:16px;right:16px;width:auto}[_nghost-%COMP%]   .provider[_ngcontent-%COMP%]{padding:24px 0}[_nghost-%COMP%]   .provider[_ngcontent-%COMP%]   .provider-title[_ngcontent-%COMP%]{font:400 14px/16px Roboto,Helvetica Neue,sans-serif;letter-spacing:.25px;margin:0 0 8px}[_nghost-%COMP%]   .provider[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{max-width:85%}[_nghost-%COMP%]   .provider[_ngcontent-%COMP%]   .checkbox-label[_ngcontent-%COMP%]{font-size:14px;letter-spacing:.25px;opacity:.87}[_nghost-%COMP%]   .provider[_ngcontent-%COMP%]   .mat-mdc-checkbox[_ngcontent-%COMP%]{margin-top:8px}[_nghost-%COMP%]   .provider[_ngcontent-%COMP%]   .mat-mdc-outlined-button[_ngcontent-%COMP%]{margin-top:8px}']});class Vn{constructor(n,t){this.store=n,this.userService=t}resolve(){const n=(0,q.fP)(this.store).userId;return this.userService.getUser(n)}}Vn.\u0275fac=function(n){return new(n||Vn)(e.\u0275\u0275inject(x.Store),e.\u0275\u0275inject(Ra.K))},Vn.\u0275prov=e.\u0275\u0275defineInjectable({token:Vn,factory:Vn.\u0275fac});class Un{constructor(n){this.twoFactorAuthService=n}resolve(){return this.twoFactorAuthService.getAvailableTwoFaProviders()}}Un.\u0275fac=function(n){return new(n||Un)(e.\u0275\u0275inject(Pn.b))},Un.\u0275prov=e.\u0275\u0275defineInjectable({token:Un,factory:Un.\u0275fac});const Mu=[{path:"security",component:qi,canDeactivate:[N.P],data:{auth:[u.W.SYS_ADMIN,u.W.TENANT_ADMIN,u.W.CUSTOMER_USER],title:"security.security",breadcrumb:{label:"security.security",icon:"lock"}},resolve:{user:Vn,providers:Un}}];class St{}St.\u0275fac=function(n){return new(n||St)},St.\u0275mod=e.\u0275\u0275defineNgModule({type:St}),St.\u0275inj=e.\u0275\u0275defineInjector({providers:[Vn,Un],imports:[b.RouterModule.forChild([{path:"security",redirectTo:"/account/security"}]),b.RouterModule]}),(typeof ngJitMode>"u"||ngJitMode)&&e.\u0275\u0275setNgModuleScope(St,{imports:[b.RouterModule],exports:[b.RouterModule]});class It{}It.\u0275fac=function(n){return new(n||It)},It.\u0275mod=e.\u0275\u0275defineNgModule({type:It}),It.\u0275inj=e.\u0275\u0275defineInjector({imports:[p.CommonModule,M.m,St]}),(typeof ngJitMode>"u"||ngJitMode)&&e.\u0275\u0275setNgModuleScope(It,{declarations:[qi,Vi,Ui,Gi,ji],imports:[p.CommonModule,M.m,St]});var Jo=c(35471);class Oa extends Te.r{constructor(n,t,a,o,s){super(n,t,a,o,s),this.store=n,this.fb=t,this.entityValue=a,this.entitiesTableConfigValue=o,this.cd=s}buildForm(n){const t=this.buildEntityForm(n);return t.addControl("country",this.fb.control(n?n.country:"",[r.Validators.maxLength(255)])),t.addControl("city",this.fb.control(n?n.city:"",[r.Validators.maxLength(255)])),t.addControl("state",this.fb.control(n?n.state:"",[r.Validators.maxLength(255)])),t.addControl("zip",this.fb.control(n?n.zip:"",this.zipValidators(n?n.country:""))),t.addControl("address",this.fb.control(n?n.address:"",[])),t.addControl("address2",this.fb.control(n?n.address2:"",[])),t.addControl("phone",this.fb.control(n?n.phone:"",[r.Validators.maxLength(255)])),t.addControl("email",this.fb.control(n?n.email:"",[r.Validators.email])),t}updateForm(n){this.updateEntityForm(n),this.entityForm.patchValue({country:n.country}),this.entityForm.patchValue({city:n.city}),this.entityForm.patchValue({state:n.state}),this.entityForm.get("zip").setValidators(this.zipValidators(n.country)),this.entityForm.patchValue({zip:n.zip}),this.entityForm.patchValue({address:n.address}),this.entityForm.patchValue({address2:n.address2}),this.entityForm.patchValue({phone:n.phone}),this.entityForm.patchValue({email:n.email})}ngAfterViewInit(){this.entityForm.get("country").valueChanges.subscribe(n=>{this.entityForm.get("zip").setValidators(this.zipValidators(n)),this.entityForm.get("zip").updateValueAndValidity({onlySelf:!0}),this.entityForm.get("zip").markAsTouched({onlySelf:!0})})}zipValidators(n){const t=[];if(n&&Jo.c[n]){const a=Jo.c[n];t.push(r.Validators.pattern(a))}return t}}Oa.\u0275fac=function(n){e.\u0275\u0275invalidFactory()},Oa.\u0275dir=e.\u0275\u0275defineDirective({type:Oa,features:[e.\u0275\u0275InheritDefinitionFeature]});var Qo=c(41034),Au=c(60900);function Nu(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"tenant.title-required")," "))}function Fu(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"tenant.title-max-length")," "))}function Lu(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"section",17)(1,"section",18),e.\u0275\u0275element(2,"tb-dashboard-autocomplete",19),e.\u0275\u0275pipe(3,"translate"),e.\u0275\u0275elementStart(4,"mat-checkbox",20),e.\u0275\u0275text(5),e.\u0275\u0275pipe(6,"translate"),e.\u0275\u0275elementEnd()()()),2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(2),e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(3,5,"dashboard.home-dashboard")),e.\u0275\u0275property("dashboardsScope","tenant")("tenantId",null==t.entity?null:t.entity.id.id)("selectFirstDashboard",!1),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(6,7,"dashboard.home-dashboard-hide-toolbar")," ")}}class $i extends Oa{constructor(n,t,a,o,s,l){super(n,s,a,o,l),this.store=n,this.translate=t,this.entityValue=a,this.entitiesTableConfigValue=o,this.fb=s,this.cd=l}hideDelete(){return!!this.entitiesTableConfig&&!this.entitiesTableConfig.deleteEnabled(this.entity)}buildEntityForm(n){return this.fb.group({title:[n?n.title:"",[r.Validators.required,r.Validators.maxLength(255)]],tenantProfileId:[n?n.tenantProfileId:null,[r.Validators.required]],additionalInfo:this.fb.group({description:[n&&n.additionalInfo?n.additionalInfo.description:""],homeDashboardId:[n&&n.additionalInfo?n.additionalInfo.homeDashboardId:null],homeDashboardHideToolbar:[!(n&&n.additionalInfo&&(0,T.nu)(n.additionalInfo.homeDashboardHideToolbar))||n.additionalInfo.homeDashboardHideToolbar]})})}updateEntityForm(n){this.entityForm.patchValue({title:n.title}),this.entityForm.patchValue({tenantProfileId:n.tenantProfileId}),this.entityForm.patchValue({additionalInfo:{description:n.additionalInfo?n.additionalInfo.description:""}}),this.entityForm.patchValue({additionalInfo:{homeDashboardId:n.additionalInfo?n.additionalInfo.homeDashboardId:null}}),this.entityForm.patchValue({additionalInfo:{homeDashboardHideToolbar:!n.additionalInfo||!(0,T.nu)(n.additionalInfo.homeDashboardHideToolbar)||n.additionalInfo.homeDashboardHideToolbar}})}updateFormState(){this.entityForm&&(this.isEditValue?this.entityForm.enable({emitEvent:!1}):this.entityForm.disable({emitEvent:!1}))}onTenantIdCopied(n){this.store.dispatch(new V.zi({message:this.translate.instant("tenant.idCopiedMessage"),type:"success",duration:750,verticalPosition:"bottom",horizontalPosition:"right"}))}onTenantProfileUpdated(){this.entitiesTableConfig.updateData(!1)}}$i.\u0275fac=function(n){return new(n||$i)(e.\u0275\u0275directiveInject(x.Store),e.\u0275\u0275directiveInject(g.TranslateService),e.\u0275\u0275directiveInject("entity"),e.\u0275\u0275directiveInject("entitiesTableConfig"),e.\u0275\u0275directiveInject(r.UntypedFormBuilder),e.\u0275\u0275directiveInject(e.ChangeDetectorRef))},$i.\u0275cmp=e.\u0275\u0275defineComponent({type:$i,selectors:[["tb-tenant"]],features:[e.\u0275\u0275InheritDefinitionFeature],decls:36,vars:34,consts:[["fxLayout.xs","column",1,"tb-details-buttons"],["mat-raised-button","","color","primary",3,"disabled","fxShow","click"],["fxLayout","row","fxLayout.xs","column"],["mat-raised-button","","ngxClipboard","",3,"cbContent","fxShow","cbOnSuccess"],["svgIcon","mdi:clipboard-arrow-left"],["translate",""],["fxLayout","column",1,"mat-padding"],[3,"formGroup"],[3,"disabled"],[1,"mat-block"],["matInput","","formControlName","title","required",""],[4,"ngIf"],["required","","formControlName","tenantProfileId",3,"selectDefaultProfile","showDetailsPageLink","tenantProfileUpdated"],["formGroupName","additionalInfo","fxLayout","column"],["matInput","","formControlName","description","rows","2"],["class","tb-default-dashboard","fxFlex","","fxLayout","column",4,"ngIf"],[3,"parentForm","isEdit"],["fxFlex","","fxLayout","column",1,"tb-default-dashboard"],["fxFlex","","fxLayout","column","fxLayout.gt-sm","row"],["fxFlex","","formControlName","homeDashboardId",3,"label","dashboardsScope","tenantId","selectFirstDashboard"],["fxFlex","","formControlName","homeDashboardHideToolbar"]],template:function(n,t){1&n&&(e.\u0275\u0275elementStart(0,"div",0)(1,"button",1),e.\u0275\u0275listener("click",function(o){return t.onEntityAction(o,"open")}),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275text(3),e.\u0275\u0275pipe(4,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"button",1),e.\u0275\u0275listener("click",function(o){return t.onEntityAction(o,"manageTenantAdmins")}),e.\u0275\u0275pipe(6,"async"),e.\u0275\u0275text(7),e.\u0275\u0275pipe(8,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(9,"button",1),e.\u0275\u0275listener("click",function(o){return t.onEntityAction(o,"delete")}),e.\u0275\u0275pipe(10,"async"),e.\u0275\u0275text(11),e.\u0275\u0275pipe(12,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(13,"div",2)(14,"button",3),e.\u0275\u0275listener("cbOnSuccess",function(o){return t.onTenantIdCopied(o)}),e.\u0275\u0275element(15,"mat-icon",4),e.\u0275\u0275elementStart(16,"span",5),e.\u0275\u0275text(17,"tenant.copyId"),e.\u0275\u0275elementEnd()()()(),e.\u0275\u0275elementStart(18,"div",6)(19,"form",7)(20,"fieldset",8),e.\u0275\u0275pipe(21,"async"),e.\u0275\u0275elementStart(22,"mat-form-field",9)(23,"mat-label",5),e.\u0275\u0275text(24,"tenant.title"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(25,"input",10),e.\u0275\u0275template(26,Nu,3,3,"mat-error",11),e.\u0275\u0275template(27,Fu,3,3,"mat-error",11),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(28,"tb-tenant-profile-autocomplete",12),e.\u0275\u0275listener("tenantProfileUpdated",function(){return t.onTenantProfileUpdated()}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(29,"div",13)(30,"mat-form-field",9)(31,"mat-label",5),e.\u0275\u0275text(32,"tenant.description"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(33,"textarea",14),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(34,Lu,7,9,"section",15),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(35,"tb-contact",16),e.\u0275\u0275elementEnd()()()),2&n&&(e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(2,20,t.isLoading$))("fxShow",!t.isEdit&&!t.isDetailsPage),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(4,22,"common.open-details-page")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(6,24,t.isLoading$))("fxShow",!t.isEdit),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(8,26,"tenant.manage-tenant-admins")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(10,28,t.isLoading$))("fxShow",!t.hideDelete()&&!t.isEdit),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(12,30,"tenant.delete")," "),e.\u0275\u0275advance(3),e.\u0275\u0275property("cbContent",null==t.entity||null==t.entity.id?null:t.entity.id.id)("fxShow",!t.isEdit),e.\u0275\u0275advance(5),e.\u0275\u0275property("formGroup",t.entityForm),e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(21,32,t.isLoading$)||!t.isEdit),e.\u0275\u0275advance(6),e.\u0275\u0275property("ngIf",t.entityForm.get("title").hasError("required")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.entityForm.get("title").hasError("maxlength")),e.\u0275\u0275advance(1),e.\u0275\u0275property("selectDefaultProfile",t.isAdd)("showDetailsPageLink",!0),e.\u0275\u0275advance(6),e.\u0275\u0275property("ngIf",null==t.entity?null:t.entity.id),e.\u0275\u0275advance(1),e.\u0275\u0275property("parentForm",t.entityForm)("isEdit",t.isEdit))},dependencies:[p.NgIf,vi.DashboardAutocompleteComponent,S.MatButton,fe.MatCheckbox,F.MatIcon,O.MatInput,_.MatFormField,_.MatLabel,_.MatError,he.yb,h.DefaultLayoutDirective,h.DefaultFlexDirective,G.DefaultShowHideDirective,r.\u0275NgNoValidate,r.DefaultValueAccessor,r.NgControlStatus,r.NgControlStatusGroup,r.RequiredValidator,r.FormGroupDirective,r.FormControlName,r.FormGroupName,g.TranslateDirective,Qo.ContactComponent,Au.x,p.AsyncPipe,g.TranslatePipe],styles:['@charset "UTF-8";@media screen and (min-width: 960px){[_nghost-%COMP%]   .tb-default-dashboard[_ngcontent-%COMP%]   tb-dashboard-autocomplete[_ngcontent-%COMP%]{padding-right:12px}}@media screen and (max-width: 959px){[_nghost-%COMP%]   .tb-default-dashboard[_ngcontent-%COMP%]   tb-dashboard-autocomplete[_ngcontent-%COMP%]{padding-bottom:12px}}@media screen and (min-width: 960px){[_nghost-%COMP%]   .tb-default-dashboard[_ngcontent-%COMP%]   .mat-mdc-checkbox[_ngcontent-%COMP%]{margin-top:16px}}']});var wt=c(44446),Et=c(68808),Ke=c(21139),Ye=c(61851);function Pu(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-tab",1,2),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275element(3,"tb-attribute-table",3),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275reference(1),a=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(2,5,"attribute.attributes")),e.\u0275\u0275advance(3),e.\u0275\u0275property("defaultAttributeScope",a.attributeScopes.SERVER_SCOPE)("active",t.isActive)("entityId",a.entity.id)("entityName",a.entity.name)}}function ku(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-tab",1,4),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275element(3,"tb-attribute-table",5),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275reference(1),a=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(2,5,"attribute.latest-telemetry")),e.\u0275\u0275advance(3),e.\u0275\u0275property("defaultAttributeScope",a.latestTelemetryTypes.LATEST_TELEMETRY)("active",t.isActive)("entityId",a.entity.id)("entityName",a.entity.name)}}function Ru(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-tab",1,6),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275element(3,"tb-alarm-table",7),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275reference(1),a=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(2,3,"alarm.alarms")),e.\u0275\u0275advance(3),e.\u0275\u0275property("active",t.isActive)("entityId",a.entity.id)}}function Ou(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-tab",1,8),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275element(3,"tb-event-table",9),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275reference(1),a=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(2,5,"tenant.events")),e.\u0275\u0275advance(3),e.\u0275\u0275property("defaultEventType",a.eventTypes.ERROR)("active",t.isActive)("tenantId",a.nullUid)("entityId",a.entity.id)}}function Bu(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-tab",1,10),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275element(3,"tb-relation-table",7),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275reference(1),a=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(2,3,"relation.relations")),e.\u0275\u0275advance(3),e.\u0275\u0275property("active",t.isActive)("entityId",a.entity.id)}}class Hi extends _e.l{constructor(n){super(n),this.store=n}ngOnInit(){super.ngOnInit()}}Hi.\u0275fac=function(n){return new(n||Hi)(e.\u0275\u0275directiveInject(x.Store))},Hi.\u0275cmp=e.\u0275\u0275defineComponent({type:Hi,selectors:[["tb-tenant-tabs"]],features:[e.\u0275\u0275InheritDefinitionFeature],decls:5,vars:5,consts:[[3,"label",4,"ngIf"],[3,"label"],["attributesTab","matTab"],[3,"defaultAttributeScope","active","entityId","entityName"],["telemetryTab","matTab"],["disableAttributeScopeSelection","",3,"defaultAttributeScope","active","entityId","entityName"],["alarmsTab","matTab"],[3,"active","entityId"],["eventsTab","matTab"],[3,"defaultEventType","active","tenantId","entityId"],["relationsTab","matTab"]],template:function(n,t){1&n&&(e.\u0275\u0275template(0,Pu,4,7,"mat-tab",0),e.\u0275\u0275template(1,ku,4,7,"mat-tab",0),e.\u0275\u0275template(2,Ru,4,5,"mat-tab",0),e.\u0275\u0275template(3,Ou,4,7,"mat-tab",0),e.\u0275\u0275template(4,Bu,4,5,"mat-tab",0)),2&n&&(e.\u0275\u0275property("ngIf",t.entity),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.entity),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.entity),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.entity),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.entity))},dependencies:[p.NgIf,H.MatTab,wt.EventTableComponent,Et.RelationTableComponent,Ke.AlarmTableComponent,Ye.AttributeTableComponent,g.TranslatePipe],encapsulation:2});class Mt{constructor(n,t,a,o){this.tenantService=n,this.translate=t,this.datePipe=a,this.router=o,this.config=new v.ap,this.config.entityType=f.py.TENANT,this.config.entityComponent=$i,this.config.entityTabsComponent=Hi,this.config.entityTranslations=f.Jr.get(f.py.TENANT),this.config.entityResources=f.CZ.get(f.py.TENANT),this.config.columns.push(new v.eq("createdTime","common.created-time",this.datePipe,"150px"),new v.QI("title","tenant.title","20%"),new v.QI("tenantProfileName","tenant-profile.tenant-profile","20%"),new v.QI("email","contact.email","20%"),new v.QI("country","contact.country","20%"),new v.QI("city","contact.city","20%")),this.config.cellActionDescriptors.push({name:this.translate.instant("tenant.manage-tenant-admins"),icon:"account_circle",isEnabled:()=>!0,onAction:(s,l)=>this.manageTenantAdmins(s,l)}),this.config.deleteEntityTitle=s=>this.translate.instant("tenant.delete-tenant-title",{tenantTitle:s.title}),this.config.deleteEntityContent=()=>this.translate.instant("tenant.delete-tenant-text"),this.config.deleteEntitiesTitle=s=>this.translate.instant("tenant.delete-tenants-title",{count:s}),this.config.deleteEntitiesContent=()=>this.translate.instant("tenant.delete-tenants-text"),this.config.entitiesFetchFunction=s=>this.tenantService.getTenantInfos(s),this.config.loadEntity=s=>this.tenantService.getTenantInfo(s.id),this.config.saveEntity=s=>this.tenantService.saveTenant(s).pipe((0,ne.z)(l=>this.tenantService.getTenantInfo(l.id.id))),this.config.deleteEntity=s=>this.tenantService.deleteTenant(s.id),this.config.onEntityAction=s=>this.onTenantAction(s,this.config)}resolve(){return this.config.tableTitle=this.translate.instant("tenant.tenants"),this.config}openTenant(n,t,a){n&&n.stopPropagation();const o=this.router.createUrlTree([t.id.id],{relativeTo:a.getActivatedRoute()});this.router.navigateByUrl(o)}manageTenantAdmins(n,t){n&&n.stopPropagation(),this.router.navigateByUrl(`tenants/${t.id.id}/users`)}onTenantAction(n,t){switch(n.action){case"open":return this.openTenant(n.event,n.entity,t),!0;case"manageTenantAdmins":return this.manageTenantAdmins(n.event,n.entity),!0}return!1}}function Vu(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",1),e.\u0275\u0275listener("click",function(o){e.\u0275\u0275restoreView(t);const s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.onEntityAction(o,"loginAsUser"))}),e.\u0275\u0275pipe(1,"async"),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"translate"),e.\u0275\u0275elementEnd()}if(2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(1,3,t.isLoading$))("fxShow",!t.isEdit),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(3,5,(null==t.entity?null:t.entity.authority)===t.authority.TENANT_ADMIN?"user.login-as-tenant-admin":"user.login-as-customer-user")," ")}}function Uu(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"user.invalid-email-format")," "))}function Gu(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"user.email-required")," "))}function ju(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"section",19)(1,"section",20),e.\u0275\u0275element(2,"tb-dashboard-autocomplete",21),e.\u0275\u0275pipe(3,"translate"),e.\u0275\u0275elementStart(4,"mat-checkbox",22),e.\u0275\u0275text(5),e.\u0275\u0275pipe(6,"translate"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(7,"section",20),e.\u0275\u0275element(8,"tb-dashboard-autocomplete",23),e.\u0275\u0275pipe(9,"translate"),e.\u0275\u0275elementStart(10,"mat-checkbox",24),e.\u0275\u0275text(11),e.\u0275\u0275pipe(12,"translate"),e.\u0275\u0275elementEnd()()()),2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(2),e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(3,12,"user.default-dashboard")),e.\u0275\u0275property("dashboardsScope",(null==t.entity?null:t.entity.authority)===t.authority.TENANT_ADMIN?"tenant":"customer")("tenantId",null==t.entity||null==t.entity.tenantId?null:t.entity.tenantId.id)("customerId",null==t.entity||null==t.entity.customerId?null:t.entity.customerId.id)("selectFirstDashboard",!1),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(6,14,"user.always-fullscreen")," "),e.\u0275\u0275advance(3),e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(9,16,"dashboard.home-dashboard")),e.\u0275\u0275property("dashboardsScope",(null==t.entity?null:t.entity.authority)===t.authority.TENANT_ADMIN?"tenant":"customer")("tenantId",null==t.entity||null==t.entity.tenantId?null:t.entity.tenantId.id)("customerId",null==t.entity||null==t.entity.customerId?null:t.entity.customerId.id)("selectFirstDashboard",!1),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(12,18,"dashboard.home-dashboard-hide-toolbar")," ")}}Mt.\u0275fac=function(n){return new(n||Mt)(e.\u0275\u0275inject(go.a),e.\u0275\u0275inject(g.TranslateService),e.\u0275\u0275inject(p.DatePipe),e.\u0275\u0275inject(b.Router))},Mt.\u0275prov=e.\u0275\u0275defineInjectable({token:Mt,factory:Mt.\u0275fac});class Dt extends Te.r{constructor(n,t,a,o,s,l){super(n,o,t,a,s),this.store=n,this.entityValue=t,this.entitiesTableConfigValue=a,this.fb=o,this.cd=s,this.translate=l,this.authority=u.W,this.loginAsUserEnabled$=this.store.pipe((0,x.select)(q.Hz),(0,re.U)(d=>d.userTokenAccessEnabled))}hideDelete(){return!!this.entitiesTableConfig&&!this.entitiesTableConfig.deleteEnabled(this.entity)}isUserCredentialsEnabled(){return!0===this.entity.additionalInfo.userCredentialsEnabled}isUserCredentialPresent(){return(0,T.nu)(this.entity?.additionalInfo?.userCredentialsEnabled)}buildForm(n){return this.fb.group({email:[n?n.email:"",[r.Validators.required,r.Validators.email]],firstName:[n?n.firstName:""],lastName:[n?n.lastName:""],phone:[n?n.phone:""],additionalInfo:this.fb.group({description:[n&&n.additionalInfo?n.additionalInfo.description:""],defaultDashboardId:[n&&n.additionalInfo?n.additionalInfo.defaultDashboardId:null],defaultDashboardFullscreen:[!(!n||!n.additionalInfo)&&n.additionalInfo.defaultDashboardFullscreen],homeDashboardId:[n&&n.additionalInfo?n.additionalInfo.homeDashboardId:null],homeDashboardHideToolbar:[!(n&&n.additionalInfo&&(0,T.nu)(n.additionalInfo.homeDashboardHideToolbar))||n.additionalInfo.homeDashboardHideToolbar]})})}updateForm(n){this.entityForm.patchValue({email:n.email}),this.entityForm.patchValue({firstName:n.firstName}),this.entityForm.patchValue({lastName:n.lastName}),this.entityForm.patchValue({phone:n.phone}),this.entityForm.patchValue({additionalInfo:{description:n.additionalInfo?n.additionalInfo.description:""}}),this.entityForm.patchValue({additionalInfo:{defaultDashboardId:n.additionalInfo?n.additionalInfo.defaultDashboardId:null}}),this.entityForm.patchValue({additionalInfo:{defaultDashboardFullscreen:!!n.additionalInfo&&n.additionalInfo.defaultDashboardFullscreen}}),this.entityForm.patchValue({additionalInfo:{homeDashboardId:n.additionalInfo?n.additionalInfo.homeDashboardId:null}}),this.entityForm.patchValue({additionalInfo:{homeDashboardHideToolbar:!n.additionalInfo||!(0,T.nu)(n.additionalInfo.homeDashboardHideToolbar)||n.additionalInfo.homeDashboardHideToolbar}})}onUserIdCopied(n){this.store.dispatch(new V.zi({message:this.translate.instant("user.idCopiedMessage"),type:"success",duration:750,verticalPosition:"bottom",horizontalPosition:"right"}))}}Dt.\u0275fac=function(n){return new(n||Dt)(e.\u0275\u0275directiveInject(x.Store),e.\u0275\u0275directiveInject("entity",8),e.\u0275\u0275directiveInject("entitiesTableConfig",8),e.\u0275\u0275directiveInject(r.UntypedFormBuilder),e.\u0275\u0275directiveInject(e.ChangeDetectorRef),e.\u0275\u0275directiveInject(g.TranslateService))},Dt.\u0275cmp=e.\u0275\u0275defineComponent({type:Dt,selectors:[["tb-user"]],features:[e.\u0275\u0275InheritDefinitionFeature],decls:59,vars:62,consts:[["fxLayout.xs","column",1,"tb-details-buttons"],["mat-raised-button","","color","primary",3,"disabled","fxShow","click"],["mat-raised-button","","color","primary",3,"disabled","fxShow","click",4,"ngIf"],["fxLayout","row","fxLayout.xs","column"],["mat-raised-button","","ngxClipboard","",3,"cbContent","disabled","fxShow","cbOnSuccess"],["svgIcon","mdi:clipboard-arrow-left"],["translate",""],["fxLayout","column",1,"mat-padding"],[3,"formGroup"],[3,"disabled"],[1,"mat-block"],["matInput","","type","email","formControlName","email","required",""],[4,"ngIf"],["matInput","","formControlName","firstName"],["matInput","","formControlName","lastName"],["formControlName","phone",3,"required","label","enableFlagsSelect"],["formGroupName","additionalInfo","fxLayout","column"],["matInput","","formControlName","description","rows","2"],["class","tb-default-dashboard","fxFlex","","fxLayout","column",4,"ngIf"],["fxFlex","","fxLayout","column",1,"tb-default-dashboard"],["fxFlex","","fxLayout","column","fxLayout.gt-sm","row"],["fxFlex","","formControlName","defaultDashboardId",3,"label","dashboardsScope","tenantId","customerId","selectFirstDashboard"],["fxFlex","","formControlName","defaultDashboardFullscreen"],["fxFlex","","formControlName","homeDashboardId",3,"label","dashboardsScope","tenantId","customerId","selectFirstDashboard"],["fxFlex","","formControlName","homeDashboardHideToolbar"]],template:function(n,t){1&n&&(e.\u0275\u0275elementStart(0,"div",0)(1,"button",1),e.\u0275\u0275listener("click",function(o){return t.onEntityAction(o,"open")}),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275text(3),e.\u0275\u0275pipe(4,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"button",1),e.\u0275\u0275listener("click",function(o){return t.onEntityAction(o,"disableAccount")}),e.\u0275\u0275pipe(6,"async"),e.\u0275\u0275text(7),e.\u0275\u0275pipe(8,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(9,"button",1),e.\u0275\u0275listener("click",function(o){return t.onEntityAction(o,"enableAccount")}),e.\u0275\u0275pipe(10,"async"),e.\u0275\u0275text(11),e.\u0275\u0275pipe(12,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(13,"button",1),e.\u0275\u0275listener("click",function(o){return t.onEntityAction(o,"displayActivationLink")}),e.\u0275\u0275pipe(14,"async"),e.\u0275\u0275text(15),e.\u0275\u0275pipe(16,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(17,"button",1),e.\u0275\u0275listener("click",function(o){return t.onEntityAction(o,"resendActivation")}),e.\u0275\u0275pipe(18,"async"),e.\u0275\u0275text(19),e.\u0275\u0275pipe(20,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(21,Vu,4,7,"button",2),e.\u0275\u0275pipe(22,"async"),e.\u0275\u0275elementStart(23,"button",1),e.\u0275\u0275listener("click",function(o){return t.onEntityAction(o,"delete")}),e.\u0275\u0275pipe(24,"async"),e.\u0275\u0275text(25),e.\u0275\u0275pipe(26,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(27,"div",3)(28,"button",4),e.\u0275\u0275listener("cbOnSuccess",function(o){return t.onUserIdCopied(o)}),e.\u0275\u0275pipe(29,"async"),e.\u0275\u0275element(30,"mat-icon",5),e.\u0275\u0275elementStart(31,"span",6),e.\u0275\u0275text(32,"user.copyId"),e.\u0275\u0275elementEnd()()()(),e.\u0275\u0275elementStart(33,"div",7)(34,"form",8)(35,"fieldset",9),e.\u0275\u0275pipe(36,"async"),e.\u0275\u0275elementStart(37,"mat-form-field",10)(38,"mat-label",6),e.\u0275\u0275text(39,"user.email"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(40,"input",11),e.\u0275\u0275template(41,Uu,3,3,"mat-error",12),e.\u0275\u0275template(42,Gu,3,3,"mat-error",12),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(43,"mat-form-field",10)(44,"mat-label",6),e.\u0275\u0275text(45,"user.first-name"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(46,"input",13),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(47,"mat-form-field",10)(48,"mat-label",6),e.\u0275\u0275text(49,"user.last-name"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(50,"input",14),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(51,"tb-phone-input",15),e.\u0275\u0275pipe(52,"translate"),e.\u0275\u0275elementStart(53,"div",16)(54,"mat-form-field",10)(55,"mat-label",6),e.\u0275\u0275text(56,"user.description"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(57,"textarea",17),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(58,ju,13,20,"section",18),e.\u0275\u0275elementEnd()()()()),2&n&&(e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(2,30,t.isLoading$))("fxShow",!t.isEdit&&!t.isDetailsPage),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(4,32,"common.open-details-page")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(6,34,t.isLoading$))("fxShow",!t.isEdit&&t.isUserCredentialPresent()&&t.isUserCredentialsEnabled()),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(8,36,"user.disable-account")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(10,38,t.isLoading$))("fxShow",!t.isEdit&&t.isUserCredentialPresent()&&!t.isUserCredentialsEnabled()),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(12,40,"user.enable-account")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(14,42,t.isLoading$))("fxShow",!t.isEdit&&!t.isUserCredentialPresent()),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(16,44,"user.display-activation-link")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(18,46,t.isLoading$))("fxShow",!t.isEdit&&!t.isUserCredentialPresent()),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(20,48,"user.resend-activation")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(22,50,t.loginAsUserEnabled$)),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(24,52,t.isLoading$))("fxShow",!t.hideDelete()&&!t.isEdit),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(26,54,"user.delete")," "),e.\u0275\u0275advance(3),e.\u0275\u0275property("cbContent",null==t.entity||null==t.entity.id?null:t.entity.id.id)("disabled",e.\u0275\u0275pipeBind1(29,56,t.isLoading$))("fxShow",!t.isEdit),e.\u0275\u0275advance(6),e.\u0275\u0275property("formGroup",t.entityForm),e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(36,58,t.isLoading$)||!t.isEdit),e.\u0275\u0275advance(6),e.\u0275\u0275property("ngIf",t.entityForm.get("email").hasError("email")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.entityForm.get("email").hasError("required")),e.\u0275\u0275advance(9),e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(52,60,"contact.phone")),e.\u0275\u0275property("required",!1)("enableFlagsSelect",!0),e.\u0275\u0275advance(7),e.\u0275\u0275property("ngIf",null==t.entity?null:t.entity.id))},dependencies:[p.NgIf,vi.DashboardAutocompleteComponent,S.MatButton,fe.MatCheckbox,F.MatIcon,O.MatInput,_.MatFormField,_.MatLabel,_.MatError,he.yb,h.DefaultLayoutDirective,h.DefaultFlexDirective,G.DefaultShowHideDirective,r.\u0275NgNoValidate,r.DefaultValueAccessor,r.NgControlStatus,r.NgControlStatusGroup,r.RequiredValidator,r.FormGroupDirective,r.FormControlName,r.FormGroupName,g.TranslateDirective,oo.T,p.AsyncPipe,g.TranslatePipe],styles:['@charset "UTF-8";@media screen and (min-width: 960px){[_nghost-%COMP%]   .tb-default-dashboard[_ngcontent-%COMP%]   tb-dashboard-autocomplete[_ngcontent-%COMP%]{padding-right:12px}}@media screen and (max-width: 959px){[_nghost-%COMP%]   .tb-default-dashboard[_ngcontent-%COMP%]   tb-dashboard-autocomplete[_ngcontent-%COMP%]{padding-bottom:12px}}@media screen and (min-width: 960px){[_nghost-%COMP%]   .tb-default-dashboard[_ngcontent-%COMP%]   .mat-mdc-checkbox[_ngcontent-%COMP%]{margin-top:16px}}']});var bo=c(99447),zi=c(60038);function Wu(i,n){1&i&&e.\u0275\u0275element(0,"mat-progress-bar",17)}function qu(i,n){1&i&&e.\u0275\u0275element(0,"div",18)}const $u=function(i){return{activationLink:i}};class Gn extends le.a{constructor(n,t,a,o,s){super(n,t,o),this.store=n,this.router=t,this.data=a,this.dialogRef=o,this.translate=s,this.activationLink=this.data.activationLink}ngOnInit(){}close(){this.dialogRef.close()}onActivationLinkCopied(){this.store.dispatch(new V.zi({message:this.translate.instant("user.activation-link-copied-message"),type:"success",target:"activationLinkDialogContent",duration:1200,verticalPosition:"bottom",horizontalPosition:"left"}))}}Gn.\u0275fac=function(n){return new(n||Gn)(e.\u0275\u0275directiveInject(x.Store),e.\u0275\u0275directiveInject(b.Router),e.\u0275\u0275directiveInject(C.MAT_DIALOG_DATA),e.\u0275\u0275directiveInject(C.MatDialogRef),e.\u0275\u0275directiveInject(g.TranslateService))},Gn.\u0275cmp=e.\u0275\u0275defineComponent({type:Gn,selectors:[["tb-activation-link-dialog"]],features:[e.\u0275\u0275InheritDefinitionFeature],decls:28,vars:23,consts:[[2,"min-width","400px","position","relative"],["color","primary"],["translate",""],["fxFlex",""],["mat-icon-button","","type","button",3,"click"],[1,"material-icons"],["color","warn","mode","indeterminate",4,"ngIf"],["style","height: 4px;",4,"ngIf"],["mat-dialog-content","","tb-toast","","toastTarget","activationLinkDialogContent"],["fxLayout","column",1,"mat-content"],[3,"innerHTML"],["fxLayout","row","fxLayoutAlign","start center"],["fxFlex","",1,"tb-highlight"],["mat-icon-button","","color","primary","ngxClipboard","","matTooltipPosition","above",3,"cbContent","matTooltip","cbOnSuccess"],["svgIcon","mdi:clipboard-arrow-left"],["mat-dialog-actions","","fxLayoutAlign","end center"],["mat-button","","color","primary","type","button","cdkFocusInitial","",3,"disabled","click"],["color","warn","mode","indeterminate"],[2,"height","4px"]],template:function(n,t){1&n&&(e.\u0275\u0275elementStart(0,"form",0)(1,"mat-toolbar",1)(2,"h2",2),e.\u0275\u0275text(3,"user.activation-link"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(4,"span",3),e.\u0275\u0275elementStart(5,"button",4),e.\u0275\u0275listener("click",function(){return t.close()}),e.\u0275\u0275elementStart(6,"mat-icon",5),e.\u0275\u0275text(7,"close"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275template(8,Wu,1,0,"mat-progress-bar",6),e.\u0275\u0275pipe(9,"async"),e.\u0275\u0275template(10,qu,1,0,"div",7),e.\u0275\u0275pipe(11,"async"),e.\u0275\u0275elementStart(12,"div",8)(13,"div",9),e.\u0275\u0275element(14,"span",10),e.\u0275\u0275pipe(15,"translate"),e.\u0275\u0275elementStart(16,"div",11)(17,"pre",12)(18,"code"),e.\u0275\u0275text(19),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(20,"button",13),e.\u0275\u0275listener("cbOnSuccess",function(){return t.onActivationLinkCopied()}),e.\u0275\u0275pipe(21,"translate"),e.\u0275\u0275element(22,"mat-icon",14),e.\u0275\u0275elementEnd()()()(),e.\u0275\u0275elementStart(23,"div",15)(24,"button",16),e.\u0275\u0275listener("click",function(){return t.close()}),e.\u0275\u0275pipe(25,"async"),e.\u0275\u0275text(26),e.\u0275\u0275pipe(27,"translate"),e.\u0275\u0275elementEnd()()()),2&n&&(e.\u0275\u0275advance(8),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(9,8,t.isLoading$)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!e.\u0275\u0275pipeBind1(11,10,t.isLoading$)),e.\u0275\u0275advance(4),e.\u0275\u0275property("innerHTML",e.\u0275\u0275pipeBind2(15,12,"user.activation-link-text",e.\u0275\u0275pureFunction1(21,$u,t.activationLink)),e.\u0275\u0275sanitizeHtml),e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate(t.activationLink),e.\u0275\u0275advance(1),e.\u0275\u0275propertyInterpolate("cbContent",t.activationLink),e.\u0275\u0275propertyInterpolate("matTooltip",e.\u0275\u0275pipeBind1(21,15,"user.copy-activation-link")),e.\u0275\u0275advance(4),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(25,17,t.isLoading$)),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(27,19,"action.ok")," "))},dependencies:[p.NgIf,rt.ToastDirective,S.MatButton,S.MatIconButton,F.MatIcon,z.MatProgressBar,oe.MatToolbar,C.MatDialogContent,C.MatDialogActions,Ln.MatTooltip,he.yb,h.DefaultLayoutDirective,h.DefaultLayoutAlignDirective,h.DefaultFlexDirective,r.\u0275NgNoValidate,r.NgControlStatusGroup,r.NgForm,g.TranslateDirective,p.AsyncPipe,g.TranslatePipe],encapsulation:2});var Xo=c(25891);function Hu(i,n){1&i&&e.\u0275\u0275element(0,"mat-progress-bar",16)}function zu(i,n){1&i&&e.\u0275\u0275element(0,"div",17)}function Ku(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-option",18),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i){const t=n.$implicit,a=e.\u0275\u0275nextContext();e.\u0275\u0275property("value",t),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,2,a.activationMethodTranslations.get(a.activationMethodEnum[t]))," ")}}const Yu=function(){return{standalone:!0}};class Ki extends le.a{constructor(n,t,a,o,s,l){super(n,t,o),this.store=n,this.router=t,this.data=a,this.dialogRef=o,this.userService=s,this.dialog=l,this.activationMethods=Object.keys(zi.l),this.activationMethodEnum=zi.l,this.activationMethodTranslations=zi.t,this.activationMethod=zi.l.DISPLAY_ACTIVATION_LINK}ngOnInit(){this.user={},this.userComponent.isEdit=!0,this.userComponent.entity=this.user,this.detailsForm=this.userComponent.entityForm}cancel(){this.dialogRef.close(null)}add(){if(this.detailsForm.valid){this.user={...this.user,...this.userComponent.entityForm.value},this.user.authority=this.data.authority,this.user.tenantId=new Xo.j(this.data.tenantId),this.user.customerId=new bo.u(this.data.customerId);const n=this.activationMethod===zi.l.SEND_ACTIVATION_MAIL;this.userService.saveUser(this.user,n).subscribe(t=>{this.activationMethod===zi.l.DISPLAY_ACTIVATION_LINK?this.userService.getActivationLink(t.id.id).subscribe(a=>{this.displayActivationLink(a).subscribe(()=>{this.dialogRef.close(t)})}):this.dialogRef.close(t)})}}displayActivationLink(n){return this.dialog.open(Gn,{disableClose:!0,panelClass:["tb-dialog","tb-fullscreen-dialog"],data:{activationLink:n}}).afterClosed()}}function Ju(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-tab",1,2),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275element(3,"tb-attribute-table",3),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275reference(1),a=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(2,5,"attribute.attributes")),e.\u0275\u0275advance(3),e.\u0275\u0275property("defaultAttributeScope",a.attributeScopes.SERVER_SCOPE)("active",t.isActive)("entityId",a.entity.id)("entityName",a.entity.name)}}function Qu(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-tab",1,4),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275element(3,"tb-attribute-table",5),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275reference(1),a=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(2,5,"attribute.latest-telemetry")),e.\u0275\u0275advance(3),e.\u0275\u0275property("defaultAttributeScope",a.latestTelemetryTypes.LATEST_TELEMETRY)("active",t.isActive)("entityId",a.entity.id)("entityName",a.entity.name)}}function Xu(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-tab",1,6),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275element(3,"tb-relation-table",7),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275reference(1),a=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(2,3,"relation.relations")),e.\u0275\u0275advance(3),e.\u0275\u0275property("active",t.isActive)("entityId",a.entity.id)}}function Zu(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-tab",1,8),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275element(3,"tb-audit-log-table",9),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275reference(1),a=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(2,4,"audit-log.audit-logs")),e.\u0275\u0275advance(3),e.\u0275\u0275property("active",t.isActive)("auditLogMode",a.auditLogModes.USER)("userId",a.entity.id)}}Ki.\u0275fac=function(n){return new(n||Ki)(e.\u0275\u0275directiveInject(x.Store),e.\u0275\u0275directiveInject(b.Router),e.\u0275\u0275directiveInject(C.MAT_DIALOG_DATA),e.\u0275\u0275directiveInject(C.MatDialogRef),e.\u0275\u0275directiveInject(Ra.K),e.\u0275\u0275directiveInject(C.MatDialog))},Ki.\u0275cmp=e.\u0275\u0275defineComponent({type:Ki,selectors:[["tb-add-user-dialog"]],viewQuery:function(n,t){if(1&n&&e.\u0275\u0275viewQuery(Dt,7),2&n){let a;e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(t.userComponent=a.first)}},features:[e.\u0275\u0275InheritDefinitionFeature],decls:29,vars:23,consts:[[2,"min-width","450px",3,"ngSubmit"],["color","primary"],["translate",""],["fxFlex",""],[3,"tb-help"],["mat-icon-button","","type","button",3,"click"],[1,"material-icons"],["color","warn","mode","indeterminate",4,"ngIf"],["style","height: 4px;",4,"ngIf"],["mat-dialog-content",""],[1,"mat-block"],[3,"ngModelOptions","ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["mat-dialog-actions","","fxLayoutAlign","end center"],["mat-button","","color","primary","type","button","cdkFocusInitial","",3,"disabled","click"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],["color","warn","mode","indeterminate"],[2,"height","4px"],[3,"value"]],template:function(n,t){1&n&&(e.\u0275\u0275elementStart(0,"form",0),e.\u0275\u0275listener("ngSubmit",function(){return t.add()}),e.\u0275\u0275elementStart(1,"mat-toolbar",1)(2,"h2",2),e.\u0275\u0275text(3,"user.add"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(4,"span",3)(5,"div",4),e.\u0275\u0275elementStart(6,"button",5),e.\u0275\u0275listener("click",function(){return t.cancel()}),e.\u0275\u0275elementStart(7,"mat-icon",6),e.\u0275\u0275text(8,"close"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275template(9,Hu,1,0,"mat-progress-bar",7),e.\u0275\u0275pipe(10,"async"),e.\u0275\u0275template(11,zu,1,0,"div",8),e.\u0275\u0275pipe(12,"async"),e.\u0275\u0275elementStart(13,"div",9),e.\u0275\u0275element(14,"tb-user"),e.\u0275\u0275elementStart(15,"mat-form-field",10)(16,"mat-label",2),e.\u0275\u0275text(17,"user.activation-method"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(18,"mat-select",11),e.\u0275\u0275listener("ngModelChange",function(o){return t.activationMethod=o}),e.\u0275\u0275template(19,Ku,3,4,"mat-option",12),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(20,"div",13)(21,"button",14),e.\u0275\u0275listener("click",function(){return t.cancel()}),e.\u0275\u0275pipe(22,"async"),e.\u0275\u0275text(23),e.\u0275\u0275pipe(24,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(25,"button",15),e.\u0275\u0275pipe(26,"async"),e.\u0275\u0275text(27),e.\u0275\u0275pipe(28,"translate"),e.\u0275\u0275elementEnd()()()),2&n&&(e.\u0275\u0275advance(5),e.\u0275\u0275property("tb-help","users"),e.\u0275\u0275advance(4),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(10,10,t.isLoading$)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!e.\u0275\u0275pipeBind1(12,12,t.isLoading$)),e.\u0275\u0275advance(7),e.\u0275\u0275property("ngModelOptions",e.\u0275\u0275pureFunction0(22,Yu))("ngModel",t.activationMethod),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",t.activationMethods),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(22,14,t.isLoading$)),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(24,16,"action.cancel")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(26,18,t.isLoading$)||t.detailsForm.invalid||!t.detailsForm.dirty),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(28,20,"action.add")," "))},dependencies:[p.NgForOf,p.NgIf,De.HelpComponent,S.MatButton,S.MatIconButton,F.MatIcon,z.MatProgressBar,_.MatFormField,_.MatLabel,oe.MatToolbar,C.MatDialogContent,C.MatDialogActions,ye.MatSelect,X.MatOption,h.DefaultLayoutAlignDirective,h.DefaultFlexDirective,r.\u0275NgNoValidate,r.NgControlStatus,r.NgControlStatusGroup,r.NgModel,r.NgForm,g.TranslateDirective,Dt,p.AsyncPipe,g.TranslatePipe],styles:['@charset "UTF-8";[_nghost-%COMP%]     .mat-padding{padding:0}']});class Yi extends _e.l{constructor(n){super(n),this.store=n}ngOnInit(){super.ngOnInit()}}Yi.\u0275fac=function(n){return new(n||Yi)(e.\u0275\u0275directiveInject(x.Store))},Yi.\u0275cmp=e.\u0275\u0275defineComponent({type:Yi,selectors:[["tb-user-tabs"]],features:[e.\u0275\u0275InheritDefinitionFeature],decls:4,vars:4,consts:[[3,"label",4,"ngIf"],[3,"label"],["attributesTab","matTab"],[3,"defaultAttributeScope","active","entityId","entityName"],["telemetryTab","matTab"],["disableAttributeScopeSelection","",3,"defaultAttributeScope","active","entityId","entityName"],["relationsTab","matTab"],[3,"active","entityId"],["auditLogsTab","matTab"],["detailsMode","true",3,"active","auditLogMode","userId"]],template:function(n,t){1&n&&(e.\u0275\u0275template(0,Ju,4,7,"mat-tab",0),e.\u0275\u0275template(1,Qu,4,7,"mat-tab",0),e.\u0275\u0275template(2,Xu,4,5,"mat-tab",0),e.\u0275\u0275template(3,Zu,4,6,"mat-tab",0)),2&n&&(e.\u0275\u0275property("ngIf",t.entity),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.entity),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.entity),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.entity&&t.authUser.authority===t.authorities.TENANT_ADMIN))},dependencies:[p.NgIf,H.MatTab,Be.AuditLogTableComponent,Et.RelationTableComponent,Ye.AttributeTableComponent,g.TranslatePipe],encapsulation:2});class Ne{constructor(n,t,a,o,s,l,d,m,y){this.store=n,this.userService=t,this.authService=a,this.tenantService=o,this.customerService=s,this.translate=l,this.datePipe=d,this.router=m,this.dialog=y,this.config=new v.ap,this.config.entityType=f.py.USER,this.config.entityComponent=Dt,this.config.entityTabsComponent=Yi,this.config.entityTranslations=f.Jr.get(f.py.USER),this.config.entityResources=f.CZ.get(f.py.USER),this.config.columns.push(new v.eq("createdTime","common.created-time",this.datePipe,"150px"),new v.QI("firstName","user.first-name","33%"),new v.QI("lastName","user.last-name","33%"),new v.QI("email","user.email","33%")),this.config.deleteEnabled=I=>I&&I.id&&I.id.id!==this.authUser.id.id,this.config.deleteEntityTitle=I=>this.translate.instant("user.delete-user-title",{userEmail:I.email}),this.config.deleteEntityContent=()=>this.translate.instant("user.delete-user-text"),this.config.deleteEntitiesTitle=I=>this.translate.instant("user.delete-users-title",{count:I}),this.config.deleteEntitiesContent=()=>this.translate.instant("user.delete-users-text"),this.config.loadEntity=I=>this.userService.getUser(I.id),this.config.saveEntity=I=>this.saveUser(I),this.config.deleteEntity=I=>this.userService.deleteUser(I.id),this.config.onEntityAction=I=>this.onUserAction(I,this.config),this.config.addEntity=()=>this.addUser()}resolve(n){const t=n.params;return this.store.pipe((0,x.select)(q.Hz),(0,Re.q)(1)).pipe((0,Z.b)(a=>{this.authUser=a.userDetails,this.authority=t.tenantId?u.W.TENANT_ADMIN:u.W.CUSTOMER_USER,this.authority===u.W.TENANT_ADMIN?(this.tenantId=t.tenantId,this.customerId=P._,this.config.entitiesFetchFunction=o=>this.userService.getTenantAdmins(this.tenantId,o)):(this.tenantId=this.authUser.tenantId.id,this.customerId=t.customerId,this.config.entitiesFetchFunction=o=>this.userService.getCustomerUsers(this.customerId,o)),this.updateActionCellDescriptors(a)}),(0,ne.z)(()=>this.authority===u.W.TENANT_ADMIN?this.tenantService.getTenant(this.tenantId):(0,T.nu)(this.customerId)?this.customerService.getCustomer(this.customerId):(0,J.of)({title:""})),(0,re.U)(a=>(this.authority===u.W.TENANT_ADMIN?this.config.tableTitle=a.title+": "+this.translate.instant("user.tenant-admins"):this.config.tableTitle=a.title+": "+this.translate.instant("user.customer-users"),this.config)))}updateActionCellDescriptors(n){this.config.cellActionDescriptors.splice(0),n.userTokenAccessEnabled&&this.config.cellActionDescriptors.push({name:this.authority===u.W.TENANT_ADMIN?this.translate.instant("user.login-as-tenant-admin"):this.translate.instant("user.login-as-customer-user"),icon:"mdi:login",isEnabled:()=>!0,onAction:(t,a)=>this.loginAsUser(t,a)})}saveUser(n){return n.tenantId=new Xo.j(this.tenantId),n.customerId=new bo.u(this.customerId),n.authority=this.authority,this.userService.saveUser(n)}addUser(){return this.dialog.open(Ki,{disableClose:!0,panelClass:["tb-dialog","tb-fullscreen-dialog"],data:{tenantId:this.tenantId,customerId:this.customerId,authority:this.authority}}).afterClosed()}openUser(n,t,a){n&&n.stopPropagation();const o=this.router.createUrlTree([t.id.id],{relativeTo:a.getActivatedRoute()});this.router.navigateByUrl(o)}loginAsUser(n,t){n&&n.stopPropagation(),this.authService.loginAsUser(t.id.id).subscribe()}displayActivationLink(n,t){n&&n.stopPropagation(),this.userService.getActivationLink(t.id.id).subscribe(a=>{this.dialog.open(Gn,{disableClose:!0,panelClass:["tb-dialog","tb-fullscreen-dialog"],data:{activationLink:a}})})}resendActivation(n,t){n&&n.stopPropagation(),this.userService.sendActivationEmail(t.email).subscribe(()=>{this.store.dispatch(new V.zi({message:this.translate.instant("user.activation-email-sent-message"),type:"success"}))})}setUserCredentialsEnabled(n,t,a){n&&n.stopPropagation(),this.userService.setUserCredentialsEnabled(t.id.id,a).subscribe(()=>{t.additionalInfo||(t.additionalInfo={}),t.additionalInfo.userCredentialsEnabled=a,this.store.dispatch(new V.zi({message:this.translate.instant(a?"user.enable-account-message":"user.disable-account-message"),type:"success"}))})}onUserAction(n,t){switch(n.action){case"open":return this.openUser(n.event,n.entity,t),!0;case"loginAsUser":return this.loginAsUser(n.event,n.entity),!0;case"displayActivationLink":return this.displayActivationLink(n.event,n.entity),!0;case"resendActivation":return this.resendActivation(n.event,n.entity),!0;case"disableAccount":return this.setUserCredentialsEnabled(n.event,n.entity,!1),!0;case"enableAccount":return this.setUserCredentialsEnabled(n.event,n.entity,!0),!0}return!1}}Ne.\u0275fac=function(n){return new(n||Ne)(e.\u0275\u0275inject(x.Store),e.\u0275\u0275inject(Ra.K),e.\u0275\u0275inject(pi.e),e.\u0275\u0275inject(go.a),e.\u0275\u0275inject($e.v),e.\u0275\u0275inject(g.TranslateService),e.\u0275\u0275inject(p.DatePipe),e.\u0275\u0275inject(b.Router),e.\u0275\u0275inject(C.MatDialog))},Ne.\u0275prov=e.\u0275\u0275defineInjectable({token:Ne,factory:Ne.\u0275fac});const eg=[{path:"tenants",data:{breadcrumb:{label:"tenant.tenants",icon:"supervisor_account"}},children:[{path:"",component:j.EntitiesTableComponent,data:{auth:[u.W.SYS_ADMIN],title:"tenant.tenants"},resolve:{entitiesTableConfig:Mt}},{path:":entityId",component:ee.Y,canDeactivate:[N.P],data:{breadcrumb:{labelFunction:te,icon:"supervisor_account"},auth:[u.W.SYS_ADMIN],title:"tenant.tenants"},resolve:{entitiesTableConfig:Mt}},{path:":tenantId/users",data:{breadcrumb:{label:"user.tenant-admins",icon:"account_circle"}},children:[{path:"",component:j.EntitiesTableComponent,data:{auth:[u.W.SYS_ADMIN],title:"user.tenant-admins"},resolve:{entitiesTableConfig:Ne}},{path:":entityId",component:ee.Y,canDeactivate:[N.P],data:{breadcrumb:{labelFunction:te,icon:"account_circle"},auth:[u.W.SYS_ADMIN],title:"user.tenant-admins"},resolve:{entitiesTableConfig:Ne}}]}]}];class At{}At.\u0275fac=function(n){return new(n||At)},At.\u0275mod=e.\u0275\u0275defineNgModule({type:At}),At.\u0275inj=e.\u0275\u0275defineInjector({providers:[Mt],imports:[b.RouterModule.forChild(eg),b.RouterModule]}),(typeof ngJitMode>"u"||ngJitMode)&&e.\u0275\u0275setNgModuleScope(At,{imports:[b.RouterModule],exports:[b.RouterModule]});class Nt{}function tg(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",1),e.\u0275\u0275listener("click",function(o){e.\u0275\u0275restoreView(t);const s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.onEntityAction(o,"manageEdges"))}),e.\u0275\u0275pipe(1,"async"),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"translate"),e.\u0275\u0275elementEnd()}if(2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(1,3,t.isLoading$))("fxShow",!t.isEdit),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(3,5,"customer.manage-edges")," ")}}function ng(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"customer.title-required")," "))}function ig(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"customer.title-max-length")," "))}function ag(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"section",17)(1,"section",18),e.\u0275\u0275element(2,"tb-dashboard-autocomplete",19),e.\u0275\u0275pipe(3,"translate"),e.\u0275\u0275elementStart(4,"mat-checkbox",20),e.\u0275\u0275text(5),e.\u0275\u0275pipe(6,"translate"),e.\u0275\u0275elementEnd()()()),2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(2),e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(3,5,"dashboard.home-dashboard")),e.\u0275\u0275property("dashboardsScope","customer")("customerId",null==t.entity?null:t.entity.id.id)("selectFirstDashboard",!1),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(6,7,"dashboard.home-dashboard-hide-toolbar")," ")}}Nt.\u0275fac=function(n){return new(n||Nt)},Nt.\u0275mod=e.\u0275\u0275defineNgModule({type:Nt}),Nt.\u0275inj=e.\u0275\u0275defineInjector({imports:[p.CommonModule,M.m,k.W,At]}),(typeof ngJitMode>"u"||ngJitMode)&&e.\u0275\u0275setNgModuleScope(Nt,{declarations:[$i,Hi],imports:[p.CommonModule,M.m,k.W,At]});class Ji extends Oa{constructor(n,t,a,o,s,l){super(n,s,a,o,l),this.store=n,this.translate=t,this.entityValue=a,this.entitiesTableConfigValue=o,this.fb=s,this.cd=l,this.isPublic=!1,this.authState=(0,q.dE)(this.store)}hideDelete(){return!!this.entitiesTableConfig&&!this.entitiesTableConfig.deleteEnabled(this.entity)}buildEntityForm(n){return this.fb.group({title:[n?n.title:"",[r.Validators.required,r.Validators.maxLength(255)]],additionalInfo:this.fb.group({description:[n&&n.additionalInfo?n.additionalInfo.description:""],homeDashboardId:[n&&n.additionalInfo?n.additionalInfo.homeDashboardId:null],homeDashboardHideToolbar:[!(n&&n.additionalInfo&&(0,T.nu)(n.additionalInfo.homeDashboardHideToolbar))||n.additionalInfo.homeDashboardHideToolbar]})})}updateEntityForm(n){this.isPublic=n.additionalInfo&&n.additionalInfo.isPublic,this.entityForm.patchValue({title:n.title}),this.entityForm.patchValue({additionalInfo:{description:n.additionalInfo?n.additionalInfo.description:""}}),this.entityForm.patchValue({additionalInfo:{homeDashboardId:n.additionalInfo?n.additionalInfo.homeDashboardId:null}}),this.entityForm.patchValue({additionalInfo:{homeDashboardHideToolbar:!n.additionalInfo||!(0,T.nu)(n.additionalInfo.homeDashboardHideToolbar)||n.additionalInfo.homeDashboardHideToolbar}})}onCustomerIdCopied(n){this.store.dispatch(new V.zi({message:this.translate.instant("customer.idCopiedMessage"),type:"success",duration:750,verticalPosition:"bottom",horizontalPosition:"right"}))}edgesSupportEnabled(){return this.authState.edgesSupportEnabled}}function og(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-tab",1,2),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275element(3,"tb-attribute-table",3),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275reference(1),a=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(2,5,"attribute.attributes")),e.\u0275\u0275advance(3),e.\u0275\u0275property("defaultAttributeScope",a.attributeScopes.SERVER_SCOPE)("active",t.isActive)("entityId",a.entity.id)("entityName",a.entity.name)}}function rg(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-tab",1,4),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275element(3,"tb-attribute-table",5),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275reference(1),a=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(2,5,"attribute.latest-telemetry")),e.\u0275\u0275advance(3),e.\u0275\u0275property("defaultAttributeScope",a.latestTelemetryTypes.LATEST_TELEMETRY)("active",t.isActive)("entityId",a.entity.id)("entityName",a.entity.name)}}function sg(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-tab",1,6),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275element(3,"tb-alarm-table",7),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275reference(1),a=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(2,3,"alarm.alarms")),e.\u0275\u0275advance(3),e.\u0275\u0275property("active",t.isActive)("entityId",a.entity.id)}}function lg(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-tab",1,8),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275element(3,"tb-event-table",9),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275reference(1),a=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(2,5,"customer.events")),e.\u0275\u0275advance(3),e.\u0275\u0275property("defaultEventType",a.eventTypes.ERROR)("active",t.isActive)("tenantId",a.entity.tenantId.id)("entityId",a.entity.id)}}function dg(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-tab",1,10),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275element(3,"tb-relation-table",7),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275reference(1),a=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(2,3,"relation.relations")),e.\u0275\u0275advance(3),e.\u0275\u0275property("active",t.isActive)("entityId",a.entity.id)}}function cg(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-tab",1,11),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275element(3,"tb-audit-log-table",12),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275reference(1),a=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(2,4,"audit-log.audit-logs")),e.\u0275\u0275advance(3),e.\u0275\u0275property("active",t.isActive)("auditLogMode",a.auditLogModes.CUSTOMER)("customerId",a.entity.id)}}function pg(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"mat-tab",1,13),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementStart(3,"tb-version-control",14),e.\u0275\u0275listener("versionRestored",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.entitiesTableConfig.updateData())}),e.\u0275\u0275elementEnd()()}if(2&i){const t=e.\u0275\u0275reference(1),a=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(2,5,"version-control.version-control")),e.\u0275\u0275advance(3),e.\u0275\u0275property("active",t.isActive)("entityId",a.entity.id)("entityName",a.entity.name)("externalEntityId",a.entity.externalId||a.entity.id)}}Ji.\u0275fac=function(n){return new(n||Ji)(e.\u0275\u0275directiveInject(x.Store),e.\u0275\u0275directiveInject(g.TranslateService),e.\u0275\u0275directiveInject("entity"),e.\u0275\u0275directiveInject("entitiesTableConfig"),e.\u0275\u0275directiveInject(r.UntypedFormBuilder),e.\u0275\u0275directiveInject(e.ChangeDetectorRef))},Ji.\u0275cmp=e.\u0275\u0275defineComponent({type:Ji,selectors:[["tb-customer"]],features:[e.\u0275\u0275InheritDefinitionFeature],decls:48,vars:55,consts:[["fxLayout.xs","column",1,"tb-details-buttons"],["mat-raised-button","","color","primary",3,"disabled","fxShow","click"],["mat-raised-button","","color","primary",3,"disabled","fxShow","click",4,"ngIf"],["fxLayout","row","fxLayout.xs","column"],["mat-raised-button","","ngxClipboard","",3,"cbContent","fxShow","cbOnSuccess"],["svgIcon","mdi:clipboard-arrow-left"],["translate",""],["fxLayout","column",1,"mat-padding"],[3,"formGroup"],[3,"fxShow","disabled"],[1,"mat-block"],["matInput","","formControlName","title","required",""],[4,"ngIf"],["formGroupName","additionalInfo","fxLayout","column"],["matInput","","formControlName","description","rows","2"],["class","tb-default-dashboard","fxFlex","","fxLayout","column",4,"ngIf"],[3,"parentForm","isEdit"],["fxFlex","","fxLayout","column",1,"tb-default-dashboard"],["fxFlex","","fxLayout","column","fxLayout.gt-sm","row"],["fxFlex","","formControlName","homeDashboardId",3,"label","dashboardsScope","customerId","selectFirstDashboard"],["fxFlex","","formControlName","homeDashboardHideToolbar"]],template:function(n,t){1&n&&(e.\u0275\u0275elementStart(0,"div",0)(1,"button",1),e.\u0275\u0275listener("click",function(o){return t.onEntityAction(o,"open")}),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275text(3),e.\u0275\u0275pipe(4,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"button",1),e.\u0275\u0275listener("click",function(o){return t.onEntityAction(o,"manageUsers")}),e.\u0275\u0275pipe(6,"async"),e.\u0275\u0275text(7),e.\u0275\u0275pipe(8,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(9,"button",1),e.\u0275\u0275listener("click",function(o){return t.onEntityAction(o,"manageAssets")}),e.\u0275\u0275pipe(10,"async"),e.\u0275\u0275text(11),e.\u0275\u0275pipe(12,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(13,"button",1),e.\u0275\u0275listener("click",function(o){return t.onEntityAction(o,"manageDevices")}),e.\u0275\u0275pipe(14,"async"),e.\u0275\u0275text(15),e.\u0275\u0275pipe(16,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(17,"button",1),e.\u0275\u0275listener("click",function(o){return t.onEntityAction(o,"manageDashboards")}),e.\u0275\u0275pipe(18,"async"),e.\u0275\u0275text(19),e.\u0275\u0275pipe(20,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(21,tg,4,7,"button",2),e.\u0275\u0275elementStart(22,"button",1),e.\u0275\u0275listener("click",function(o){return t.onEntityAction(o,"delete")}),e.\u0275\u0275pipe(23,"async"),e.\u0275\u0275text(24),e.\u0275\u0275pipe(25,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(26,"div",3)(27,"button",4),e.\u0275\u0275listener("cbOnSuccess",function(o){return t.onCustomerIdCopied(o)}),e.\u0275\u0275element(28,"mat-icon",5),e.\u0275\u0275elementStart(29,"span",6),e.\u0275\u0275text(30,"customer.copyId"),e.\u0275\u0275elementEnd()()()(),e.\u0275\u0275elementStart(31,"div",7)(32,"form",8)(33,"fieldset",9),e.\u0275\u0275pipe(34,"async"),e.\u0275\u0275elementStart(35,"mat-form-field",10)(36,"mat-label",6),e.\u0275\u0275text(37,"customer.title"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(38,"input",11),e.\u0275\u0275template(39,ng,3,3,"mat-error",12),e.\u0275\u0275template(40,ig,3,3,"mat-error",12),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(41,"div",13)(42,"mat-form-field",10)(43,"mat-label",6),e.\u0275\u0275text(44,"customer.description"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(45,"textarea",14),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(46,ag,7,9,"section",15),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(47,"tb-contact",16),e.\u0275\u0275elementEnd()()()),2&n&&(e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(2,29,t.isLoading$))("fxShow",!t.isEdit&&!t.isDetailsPage),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(4,31,"common.open-details-page")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(6,33,t.isLoading$))("fxShow",!t.isEdit&&!t.isPublic),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(8,35,"customer.manage-users")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(10,37,t.isLoading$))("fxShow",!t.isEdit),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(12,39,"customer.manage-assets")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(14,41,t.isLoading$))("fxShow",!t.isEdit),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(16,43,"customer.manage-devices")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(18,45,t.isLoading$))("fxShow",!t.isEdit),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(20,47,"customer.manage-dashboards")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",t.edgesSupportEnabled()),e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(23,49,t.isLoading$))("fxShow",!t.hideDelete()&&!t.isEdit&&!t.isPublic),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(25,51,"customer.delete")," "),e.\u0275\u0275advance(3),e.\u0275\u0275property("cbContent",null==t.entity||null==t.entity.id?null:t.entity.id.id)("fxShow",!t.isEdit),e.\u0275\u0275advance(5),e.\u0275\u0275property("formGroup",t.entityForm),e.\u0275\u0275advance(1),e.\u0275\u0275property("fxShow",!t.isPublic)("disabled",e.\u0275\u0275pipeBind1(34,53,t.isLoading$)||!t.isEdit),e.\u0275\u0275advance(6),e.\u0275\u0275property("ngIf",t.entityForm.get("title").hasError("required")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.entityForm.get("title").hasError("maxlength")),e.\u0275\u0275advance(6),e.\u0275\u0275property("ngIf",null==t.entity?null:t.entity.id),e.\u0275\u0275advance(1),e.\u0275\u0275property("parentForm",t.entityForm)("isEdit",t.isEdit))},dependencies:[p.NgIf,vi.DashboardAutocompleteComponent,S.MatButton,fe.MatCheckbox,F.MatIcon,O.MatInput,_.MatFormField,_.MatLabel,_.MatError,he.yb,h.DefaultLayoutDirective,h.DefaultFlexDirective,G.DefaultShowHideDirective,r.\u0275NgNoValidate,r.DefaultValueAccessor,r.NgControlStatus,r.NgControlStatusGroup,r.RequiredValidator,r.FormGroupDirective,r.FormControlName,r.FormGroupName,g.TranslateDirective,Qo.ContactComponent,p.AsyncPipe,g.TranslatePipe],styles:['@charset "UTF-8";@media screen and (min-width: 960px){[_nghost-%COMP%]   .tb-default-dashboard[_ngcontent-%COMP%]   tb-dashboard-autocomplete[_ngcontent-%COMP%]{padding-right:12px}}@media screen and (max-width: 959px){[_nghost-%COMP%]   .tb-default-dashboard[_ngcontent-%COMP%]   tb-dashboard-autocomplete[_ngcontent-%COMP%]{padding-bottom:12px}}@media screen and (min-width: 960px){[_nghost-%COMP%]   .tb-default-dashboard[_ngcontent-%COMP%]   .mat-mdc-checkbox[_ngcontent-%COMP%]{margin-top:16px}}']});class Qi extends _e.l{constructor(n){super(n),this.store=n}ngOnInit(){super.ngOnInit()}}Qi.\u0275fac=function(n){return new(n||Qi)(e.\u0275\u0275directiveInject(x.Store))},Qi.\u0275cmp=e.\u0275\u0275defineComponent({type:Qi,selectors:[["tb-customer-tabs"]],features:[e.\u0275\u0275InheritDefinitionFeature],decls:7,vars:7,consts:[[3,"label",4,"ngIf"],[3,"label"],["attributesTab","matTab"],[3,"defaultAttributeScope","active","entityId","entityName"],["telemetryTab","matTab"],["disableAttributeScopeSelection","",3,"defaultAttributeScope","active","entityId","entityName"],["alarmsTab","matTab"],[3,"active","entityId"],["eventsTab","matTab"],[3,"defaultEventType","active","tenantId","entityId"],["relationsTab","matTab"],["auditLogsTab","matTab"],["detailsMode","true",3,"active","auditLogMode","customerId"],["versionControlTab","matTab"],["detailsMode","true","singleEntityMode","true",3,"active","entityId","entityName","externalEntityId","versionRestored"]],template:function(n,t){1&n&&(e.\u0275\u0275template(0,og,4,7,"mat-tab",0),e.\u0275\u0275template(1,rg,4,7,"mat-tab",0),e.\u0275\u0275template(2,sg,4,5,"mat-tab",0),e.\u0275\u0275template(3,lg,4,7,"mat-tab",0),e.\u0275\u0275template(4,dg,4,5,"mat-tab",0),e.\u0275\u0275template(5,cg,4,6,"mat-tab",0),e.\u0275\u0275template(6,pg,4,7,"mat-tab",0)),2&n&&(e.\u0275\u0275property("ngIf",t.entity),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.entity),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.entity),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.entity),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.entity),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.entity&&t.authUser.authority===t.authorities.TENANT_ADMIN),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.entity&&t.authUser.authority===t.authorities.TENANT_ADMIN))},dependencies:[p.NgIf,H.MatTab,Be.AuditLogTableComponent,wt.EventTableComponent,Et.RelationTableComponent,Ke.AlarmTableComponent,Ye.AttributeTableComponent,Ae.s,g.TranslatePipe],encapsulation:2});class Ft{constructor(n,t,a,o,s,l){this.customerService=n,this.homeDialogs=t,this.translate=a,this.datePipe=o,this.router=s,this.store=l,this.config=new v.ap,this.config.entityType=f.py.CUSTOMER,this.config.entityComponent=Ji,this.config.entityTabsComponent=Qi,this.config.entityTranslations=f.Jr.get(f.py.CUSTOMER),this.config.entityResources=f.CZ.get(f.py.CUSTOMER);const d=(0,q.dE)(this.store);this.config.columns.push(new v.eq("createdTime","common.created-time",this.datePipe,"150px"),new v.QI("title","customer.title","25%"),new v.QI("email","contact.email","25%"),new v.QI("country","contact.country","25%"),new v.QI("city","contact.city","25%")),this.config.cellActionDescriptors.push({name:this.translate.instant("customer.manage-customer-users"),icon:"account_circle",isEnabled:m=>!m.additionalInfo||!m.additionalInfo.isPublic,onAction:(m,y)=>this.manageCustomerUsers(m,y)},{name:this.translate.instant("customer.manage-customer-assets"),nameFunction:m=>m.additionalInfo&&m.additionalInfo.isPublic?this.translate.instant("customer.manage-public-assets"):this.translate.instant("customer.manage-customer-assets"),icon:"domain",isEnabled:m=>!0,onAction:(m,y)=>this.manageCustomerAssets(m,y)},{name:this.translate.instant("customer.manage-customer-devices"),nameFunction:m=>m.additionalInfo&&m.additionalInfo.isPublic?this.translate.instant("customer.manage-public-devices"):this.translate.instant("customer.manage-customer-devices"),icon:"devices_other",isEnabled:m=>!0,onAction:(m,y)=>this.manageCustomerDevices(m,y)},{name:this.translate.instant("customer.manage-customer-dashboards"),nameFunction:m=>m.additionalInfo&&m.additionalInfo.isPublic?this.translate.instant("customer.manage-public-dashboards"):this.translate.instant("customer.manage-customer-dashboards"),icon:"dashboard",isEnabled:m=>!0,onAction:(m,y)=>this.manageCustomerDashboards(m,y)}),d.edgesSupportEnabled&&this.config.cellActionDescriptors.push({name:this.translate.instant("customer.manage-customer-edges"),nameFunction:m=>m.additionalInfo&&m.additionalInfo.isPublic?this.translate.instant("customer.manage-public-edges"):this.translate.instant("customer.manage-customer-edges"),icon:"router",isEnabled:m=>!0,onAction:(m,y)=>this.manageCustomerEdges(m,y)}),this.config.deleteEntityTitle=m=>this.translate.instant("customer.delete-customer-title",{customerTitle:m.title}),this.config.deleteEntityContent=()=>this.translate.instant("customer.delete-customer-text"),this.config.deleteEntitiesTitle=m=>this.translate.instant("customer.delete-customers-title",{count:m}),this.config.deleteEntitiesContent=()=>this.translate.instant("customer.delete-customers-text"),this.config.entitiesFetchFunction=m=>this.customerService.getCustomers(m),this.config.loadEntity=m=>this.customerService.getCustomer(m.id),this.config.saveEntity=m=>this.customerService.saveCustomer(m),this.config.deleteEntity=m=>this.customerService.deleteCustomer(m.id),this.config.onEntityAction=m=>this.onCustomerAction(m,this.config),this.config.deleteEnabled=m=>m&&(!m.additionalInfo||!m.additionalInfo.isPublic),this.config.entitySelectionEnabled=m=>m&&(!m.additionalInfo||!m.additionalInfo.isPublic),this.config.detailsReadonly=m=>m&&m.additionalInfo&&m.additionalInfo.isPublic}resolve(){return this.config.tableTitle=this.translate.instant("customer.customers"),this.config}openCustomer(n,t,a){n&&n.stopPropagation();const o=this.router.createUrlTree([t.id.id],{relativeTo:a.getActivatedRoute()});this.router.navigateByUrl(o)}manageCustomerUsers(n,t){n&&n.stopPropagation(),this.router.navigateByUrl(`customers/${t.id.id}/users`)}manageCustomerAssets(n,t){n&&n.stopPropagation(),this.router.navigateByUrl(`customers/${t.id.id}/assets`)}manageCustomerDevices(n,t){n&&n.stopPropagation(),this.router.navigateByUrl(`customers/${t.id.id}/devices`)}manageCustomerDashboards(n,t){n&&n.stopPropagation(),this.router.navigateByUrl(`customers/${t.id.id}/dashboards`)}manageCustomerEdges(n,t){n&&n.stopPropagation(),this.router.navigateByUrl(`customers/${t.id.id}/edgeInstances`)}onCustomerAction(n,t){switch(n.action){case"open":return this.openCustomer(n.event,n.entity,t),!0;case"manageUsers":return this.manageCustomerUsers(n.event,n.entity),!0;case"manageAssets":return this.manageCustomerAssets(n.event,n.entity),!0;case"manageDevices":return this.manageCustomerDevices(n.event,n.entity),!0;case"manageDashboards":return this.manageCustomerDashboards(n.event,n.entity),!0;case"manageEdges":return this.manageCustomerEdges(n.event,n.entity),!0}return!1}}Ft.\u0275fac=function(n){return new(n||Ft)(e.\u0275\u0275inject($e.v),e.\u0275\u0275inject(lt.U),e.\u0275\u0275inject(g.TranslateService),e.\u0275\u0275inject(p.DatePipe),e.\u0275\u0275inject(b.Router),e.\u0275\u0275inject(x.Store))},Ft.\u0275prov=e.\u0275\u0275defineInjectable({token:Ft,factory:Ft.\u0275fac});var R=c(82659),Je=c(37975),mg=c(78211),Zo=c(86960),ug=c(79320),ue=c(68590);class jn{get required(){return this.requiredValue}set required(n){this.requiredValue=(0,ue.coerceBooleanProperty)(n)}constructor(n,t){this.store=n,this.fb=t,this.propagateChange=a=>{}}registerOnChange(n){this.propagateChange=n}registerOnTouched(n){}ngOnInit(){this.defaultDeviceConfigurationFormGroup=this.fb.group({configuration:[null,r.Validators.required]}),this.defaultDeviceConfigurationFormGroup.valueChanges.subscribe(()=>{this.updateModel()})}setDisabledState(n){this.disabled=n,this.disabled?this.defaultDeviceConfigurationFormGroup.disable({emitEvent:!1}):this.defaultDeviceConfigurationFormGroup.enable({emitEvent:!1})}writeValue(n){this.defaultDeviceConfigurationFormGroup.patchValue({configuration:n},{emitEvent:!1})}updateModel(){let n=null;this.defaultDeviceConfigurationFormGroup.valid&&(n=this.defaultDeviceConfigurationFormGroup.getRawValue().configuration,n.type=R.z8.DEFAULT),this.propagateChange(n)}}function gg(i,n){if(1&i&&e.\u0275\u0275element(0,"tb-default-device-configuration",3),2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275property("required",t.required)}}jn.\u0275fac=function(n){return new(n||jn)(e.\u0275\u0275directiveInject(x.Store),e.\u0275\u0275directiveInject(r.UntypedFormBuilder))},jn.\u0275cmp=e.\u0275\u0275defineComponent({type:jn,selectors:[["tb-default-device-configuration"]],inputs:{required:"required",disabled:"disabled"},features:[e.\u0275\u0275ProvidersFeature([{provide:r.NG_VALUE_ACCESSOR,useExisting:(0,e.forwardRef)(()=>jn),multi:!0}])],decls:1,vars:1,consts:[[2,"padding-bottom","16px",3,"formGroup"]],template:function(n,t){1&n&&e.\u0275\u0275element(0,"form",0),2&n&&e.\u0275\u0275property("formGroup",t.defaultDeviceConfigurationFormGroup)},dependencies:[r.\u0275NgNoValidate,r.NgControlStatusGroup,r.FormGroupDirective],encapsulation:2});class Wn{get required(){return this.requiredValue}set required(n){this.requiredValue=(0,ue.coerceBooleanProperty)(n)}constructor(n,t){this.store=n,this.fb=t,this.deviceProfileType=R.z8,this.propagateChange=a=>{}}registerOnChange(n){this.propagateChange=n}registerOnTouched(n){}ngOnInit(){this.deviceConfigurationFormGroup=this.fb.group({configuration:[null,r.Validators.required]}),this.deviceConfigurationFormGroup.valueChanges.subscribe(()=>{this.updateModel()})}setDisabledState(n){this.disabled=n,this.disabled?this.deviceConfigurationFormGroup.disable({emitEvent:!1}):this.deviceConfigurationFormGroup.enable({emitEvent:!1})}writeValue(n){this.type=n?.type;const t=(0,T.I8)(n);t&&delete t.type,this.deviceConfigurationFormGroup.patchValue({configuration:t},{emitEvent:!1})}updateModel(){let n=null;this.deviceConfigurationFormGroup.valid&&(n=this.deviceConfigurationFormGroup.getRawValue().configuration,n.type=this.type),this.propagateChange(n)}}Wn.\u0275fac=function(n){return new(n||Wn)(e.\u0275\u0275directiveInject(x.Store),e.\u0275\u0275directiveInject(r.UntypedFormBuilder))},Wn.\u0275cmp=e.\u0275\u0275defineComponent({type:Wn,selectors:[["tb-device-configuration"]],inputs:{required:"required",disabled:"disabled"},features:[e.\u0275\u0275ProvidersFeature([{provide:r.NG_VALUE_ACCESSOR,useExisting:(0,e.forwardRef)(()=>Wn),multi:!0}])],decls:3,vars:3,consts:[[3,"formGroup"],[3,"ngSwitch"],[3,"ngSwitchCase"],["formControlName","configuration",3,"required"]],template:function(n,t){1&n&&(e.\u0275\u0275elementStart(0,"div",0)(1,"div",1),e.\u0275\u0275template(2,gg,1,1,"ng-template",2),e.\u0275\u0275elementEnd()()),2&n&&(e.\u0275\u0275property("formGroup",t.deviceConfigurationFormGroup),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitch",t.type),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase",t.deviceProfileType.DEFAULT))},dependencies:[p.NgSwitch,p.NgSwitchCase,r.NgControlStatus,r.NgControlStatusGroup,r.RequiredValidator,r.FormGroupDirective,r.FormControlName,jn],encapsulation:2});class qn{get required(){return this.requiredValue}set required(n){this.requiredValue=(0,ue.coerceBooleanProperty)(n)}constructor(n,t){this.store=n,this.fb=t,this.propagateChange=a=>{}}registerOnChange(n){this.propagateChange=n}registerOnTouched(n){}ngOnInit(){this.defaultDeviceTransportConfigurationFormGroup=this.fb.group({configuration:[null,r.Validators.required]}),this.defaultDeviceTransportConfigurationFormGroup.valueChanges.subscribe(()=>{this.updateModel()})}setDisabledState(n){this.disabled=n,this.disabled?this.defaultDeviceTransportConfigurationFormGroup.disable({emitEvent:!1}):this.defaultDeviceTransportConfigurationFormGroup.enable({emitEvent:!1})}writeValue(n){this.defaultDeviceTransportConfigurationFormGroup.patchValue({configuration:n},{emitEvent:!1})}updateModel(){let n=null;this.defaultDeviceTransportConfigurationFormGroup.valid&&(n=this.defaultDeviceTransportConfigurationFormGroup.getRawValue().configuration,n.type=R.dH.DEFAULT),this.propagateChange(n)}}qn.\u0275fac=function(n){return new(n||qn)(e.\u0275\u0275directiveInject(x.Store),e.\u0275\u0275directiveInject(r.UntypedFormBuilder))},qn.\u0275cmp=e.\u0275\u0275defineComponent({type:qn,selectors:[["tb-default-device-transport-configuration"]],inputs:{required:"required",disabled:"disabled"},features:[e.\u0275\u0275ProvidersFeature([{provide:r.NG_VALUE_ACCESSOR,useExisting:(0,e.forwardRef)(()=>qn),multi:!0}])],decls:1,vars:1,consts:[[2,"padding-bottom","16px",3,"formGroup"]],template:function(n,t){1&n&&e.\u0275\u0275element(0,"form",0),2&n&&e.\u0275\u0275property("formGroup",t.defaultDeviceTransportConfigurationFormGroup)},dependencies:[r.\u0275NgNoValidate,r.NgControlStatusGroup,r.FormGroupDirective],encapsulation:2});class $n{get required(){return this.requiredValue}set required(n){this.requiredValue=(0,ue.coerceBooleanProperty)(n)}constructor(n,t){this.store=n,this.fb=t,this.propagateChange=a=>{}}registerOnChange(n){this.propagateChange=n}registerOnTouched(n){}ngOnInit(){this.mqttDeviceTransportConfigurationFormGroup=this.fb.group({configuration:[null,r.Validators.required]}),this.mqttDeviceTransportConfigurationFormGroup.valueChanges.subscribe(()=>{this.updateModel()})}setDisabledState(n){this.disabled=n,this.disabled?this.mqttDeviceTransportConfigurationFormGroup.disable({emitEvent:!1}):this.mqttDeviceTransportConfigurationFormGroup.enable({emitEvent:!1})}writeValue(n){this.mqttDeviceTransportConfigurationFormGroup.patchValue({configuration:n},{emitEvent:!1})}updateModel(){let n=null;this.mqttDeviceTransportConfigurationFormGroup.valid&&(n=this.mqttDeviceTransportConfigurationFormGroup.getRawValue().configuration,n.type=R.dH.MQTT),this.propagateChange(n)}}$n.\u0275fac=function(n){return new(n||$n)(e.\u0275\u0275directiveInject(x.Store),e.\u0275\u0275directiveInject(r.UntypedFormBuilder))},$n.\u0275cmp=e.\u0275\u0275defineComponent({type:$n,selectors:[["tb-mqtt-device-transport-configuration"]],inputs:{required:"required",disabled:"disabled"},features:[e.\u0275\u0275ProvidersFeature([{provide:r.NG_VALUE_ACCESSOR,useExisting:(0,e.forwardRef)(()=>$n),multi:!0}])],decls:1,vars:1,consts:[[2,"padding-bottom","16px",3,"formGroup"]],template:function(n,t){1&n&&e.\u0275\u0275element(0,"form",0),2&n&&e.\u0275\u0275property("formGroup",t.mqttDeviceTransportConfigurationFormGroup)},dependencies:[r.\u0275NgNoValidate,r.NgControlStatusGroup,r.FormGroupDirective],encapsulation:2});var er=c(78233);class Hn{get required(){return this.requiredValue}set required(n){this.requiredValue=(0,ue.coerceBooleanProperty)(n)}constructor(n,t){this.store=n,this.fb=t,this.destroy$=new be.x,this.propagateChange=a=>{}}registerOnChange(n){this.propagateChange=n}registerOnTouched(n){}ngOnInit(){this.coapDeviceTransportForm=this.fb.group({powerMode:[null],edrxCycle:[{disabled:!0,value:0},r.Validators.required],psmActivityTimer:[{disabled:!0,value:0},r.Validators.required],pagingTransmissionWindow:[{disabled:!0,value:0},r.Validators.required]}),this.coapDeviceTransportForm.valueChanges.pipe((0,Y.R)(this.destroy$)).subscribe(()=>{this.updateModel()})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}setDisabledState(n){this.disabled=n,this.disabled?this.coapDeviceTransportForm.disable({emitEvent:!1}):(this.coapDeviceTransportForm.enable({emitEvent:!1}),this.coapDeviceTransportForm.get("powerMode").updateValueAndValidity({onlySelf:!0}))}writeValue(n){(0,T.nu)(n)?this.coapDeviceTransportForm.patchValue(n,{emitEvent:!1}):this.coapDeviceTransportForm.get("powerMode").patchValue(null,{emitEvent:!1}),this.disabled||this.coapDeviceTransportForm.get("powerMode").updateValueAndValidity({onlySelf:!0})}updateModel(){let n=null;this.coapDeviceTransportForm.valid&&(n=this.coapDeviceTransportForm.value,n.type=R.dH.COAP),this.propagateChange(n)}}Hn.\u0275fac=function(n){return new(n||Hn)(e.\u0275\u0275directiveInject(x.Store),e.\u0275\u0275directiveInject(r.UntypedFormBuilder))},Hn.\u0275cmp=e.\u0275\u0275defineComponent({type:Hn,selectors:[["tb-coap-device-transport-configuration"]],inputs:{required:"required",disabled:"disabled"},features:[e.\u0275\u0275ProvidersFeature([{provide:r.NG_VALUE_ACCESSOR,useExisting:(0,e.forwardRef)(()=>Hn),multi:!0}])],decls:2,vars:3,consts:[[2,"padding-bottom","16px",3,"formGroup"],[3,"parentForm","isDeviceSetting"]],template:function(n,t){1&n&&(e.\u0275\u0275elementStart(0,"form",0),e.\u0275\u0275element(1,"tb-power-mode-settings",1),e.\u0275\u0275elementEnd()),2&n&&(e.\u0275\u0275property("formGroup",t.coapDeviceTransportForm),e.\u0275\u0275advance(1),e.\u0275\u0275property("parentForm",t.coapDeviceTransportForm)("isDeviceSetting",!0))},dependencies:[r.\u0275NgNoValidate,r.NgControlStatusGroup,r.FormGroupDirective,er.D],encapsulation:2});class zn{get required(){return this.requiredValue}set required(n){this.requiredValue=(0,ue.coerceBooleanProperty)(n)}constructor(n,t){this.store=n,this.fb=t,this.destroy$=new be.x,this.propagateChange=a=>{}}registerOnChange(n){this.propagateChange=n}registerOnTouched(n){}ngOnInit(){this.lwm2mDeviceTransportConfigurationFormGroup=this.fb.group({powerMode:[null],edrxCycle:[{disabled:!0,value:0},r.Validators.required],psmActivityTimer:[{disabled:!0,value:0},r.Validators.required],pagingTransmissionWindow:[{disabled:!0,value:0},r.Validators.required]}),this.lwm2mDeviceTransportConfigurationFormGroup.valueChanges.pipe((0,Y.R)(this.destroy$)).subscribe(()=>{this.updateModel()})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}setDisabledState(n){this.disabled=n,this.disabled?this.lwm2mDeviceTransportConfigurationFormGroup.disable({emitEvent:!1}):(this.lwm2mDeviceTransportConfigurationFormGroup.enable({emitEvent:!1}),this.lwm2mDeviceTransportConfigurationFormGroup.get("powerMode").updateValueAndValidity({onlySelf:!0}))}writeValue(n){(0,T.nu)(n)?this.lwm2mDeviceTransportConfigurationFormGroup.patchValue(n,{emitEvent:!1}):this.lwm2mDeviceTransportConfigurationFormGroup.get("powerMode").patchValue(null,{emitEvent:!1}),this.disabled||this.lwm2mDeviceTransportConfigurationFormGroup.get("powerMode").updateValueAndValidity({onlySelf:!0})}updateModel(){let n=null;this.lwm2mDeviceTransportConfigurationFormGroup.valid&&(n=this.lwm2mDeviceTransportConfigurationFormGroup.value,n.type=R.dH.LWM2M),this.propagateChange(n)}}function fg(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"device-profile.snmp.host-required")," "))}function hg(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"device-profile.snmp.port-required")," "))}function bg(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"device-profile.snmp.port-format")," "))}function yg(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-option",10),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"lowercase"),e.\u0275\u0275elementEnd()),2&i){const t=n.$implicit;e.\u0275\u0275property("value",t),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,2,t)," ")}}function vg(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"device-profile.snmp.protocol-version-required")," "))}function _g(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"device-profile.snmp.community-required")," "))}function xg(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"section")(1,"mat-form-field",11)(2,"mat-label",3),e.\u0275\u0275text(3,"device-profile.snmp.community"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(4,"input",12),e.\u0275\u0275template(5,_g,3,3,"mat-error",5),e.\u0275\u0275elementEnd()()),2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(5),e.\u0275\u0275property("ngIf",t.snmpDeviceTransportConfigurationFormGroup.get("community").hasError("required")||t.snmpDeviceTransportConfigurationFormGroup.get("community").hasError("pattern"))}}function Cg(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"device-profile.snmp.user-name-required")," "))}function Tg(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"device-profile.snmp.security-name-required")," "))}function Sg(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-option",10),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){const t=n.$implicit,a=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("value",t),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",a.snmpAuthenticationProtocolTranslation.get(t)," ")}}function Ig(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"device-profile.snmp.authentication-protocol-required")," "))}function wg(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"device-profile.snmp.authentication-passphrase-required")," "))}function Eg(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-option",10),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){const t=n.$implicit,a=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("value",t),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",a.snmpPrivacyProtocolTranslation.get(t)," ")}}function Mg(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"device-profile.snmp.privacy-protocol-required")," "))}function Dg(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"device-profile.snmp.privacy-passphrase-required")," "))}function Ag(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"section")(1,"div",1)(2,"mat-form-field",2)(3,"mat-label",3),e.\u0275\u0275text(4,"device-profile.snmp.user-name"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(5,"input",13),e.\u0275\u0275template(6,Cg,3,3,"mat-error",5),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(7,"mat-form-field",2)(8,"mat-label",3),e.\u0275\u0275text(9,"device-profile.snmp.security-name"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(10,"input",14),e.\u0275\u0275template(11,Tg,3,3,"mat-error",5),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(12,"div",1)(13,"mat-form-field",15)(14,"mat-label",3),e.\u0275\u0275text(15,"device-profile.snmp.authentication-protocol"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(16,"mat-select",16),e.\u0275\u0275template(17,Sg,2,2,"mat-option",9),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(18,Ig,3,3,"mat-error",5),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(19,"mat-form-field",2)(20,"mat-label",3),e.\u0275\u0275text(21,"device-profile.snmp.authentication-passphrase"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(22,"input",17),e.\u0275\u0275template(23,wg,3,3,"mat-error",5),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(24,"div",1)(25,"mat-form-field",15)(26,"mat-label",3),e.\u0275\u0275text(27,"device-profile.snmp.privacy-protocol"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(28,"mat-select",18),e.\u0275\u0275template(29,Eg,2,2,"mat-option",9),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(30,Mg,3,3,"mat-error",5),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(31,"mat-form-field",2)(32,"mat-label",3),e.\u0275\u0275text(33,"device-profile.snmp.privacy-passphrase"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(34,"input",19),e.\u0275\u0275template(35,Dg,3,3,"mat-error",5),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(36,"div",1)(37,"mat-form-field",2)(38,"mat-label",3),e.\u0275\u0275text(39,"device-profile.snmp.context-name"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(40,"input",20),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(41,"mat-form-field",2)(42,"mat-label",3),e.\u0275\u0275text(43,"device-profile.snmp.engine-id"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(44,"input",21),e.\u0275\u0275elementEnd()()()),2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(6),e.\u0275\u0275property("ngIf",t.snmpDeviceTransportConfigurationFormGroup.get("username").hasError("required")||t.snmpDeviceTransportConfigurationFormGroup.get("username").hasError("pattern")),e.\u0275\u0275advance(5),e.\u0275\u0275property("ngIf",t.snmpDeviceTransportConfigurationFormGroup.get("securityName").hasError("required")||t.snmpDeviceTransportConfigurationFormGroup.get("securityName").hasError("pattern")),e.\u0275\u0275advance(6),e.\u0275\u0275property("ngForOf",t.snmpAuthenticationProtocols),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.snmpDeviceTransportConfigurationFormGroup.get("authenticationProtocol").hasError("required")),e.\u0275\u0275advance(5),e.\u0275\u0275property("ngIf",t.snmpDeviceTransportConfigurationFormGroup.get("authenticationPassphrase").hasError("required")||t.snmpDeviceTransportConfigurationFormGroup.get("authenticationPassphrase").hasError("pattern")),e.\u0275\u0275advance(6),e.\u0275\u0275property("ngForOf",t.snmpPrivacyProtocols),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.snmpDeviceTransportConfigurationFormGroup.get("privacyProtocol").hasError("required")),e.\u0275\u0275advance(5),e.\u0275\u0275property("ngIf",t.snmpDeviceTransportConfigurationFormGroup.get("privacyPassphrase").hasError("required")||t.snmpDeviceTransportConfigurationFormGroup.get("privacyPassphrase").hasError("pattern"))}}zn.\u0275fac=function(n){return new(n||zn)(e.\u0275\u0275directiveInject(x.Store),e.\u0275\u0275directiveInject(r.UntypedFormBuilder))},zn.\u0275cmp=e.\u0275\u0275defineComponent({type:zn,selectors:[["tb-lwm2m-device-transport-configuration"]],inputs:{required:"required",disabled:"disabled"},features:[e.\u0275\u0275ProvidersFeature([{provide:r.NG_VALUE_ACCESSOR,useExisting:(0,e.forwardRef)(()=>zn),multi:!0}])],decls:2,vars:3,consts:[[2,"padding-bottom","16px",3,"formGroup"],[3,"parentForm","isDeviceSetting"]],template:function(n,t){1&n&&(e.\u0275\u0275elementStart(0,"form",0),e.\u0275\u0275element(1,"tb-power-mode-settings",1),e.\u0275\u0275elementEnd()),2&n&&(e.\u0275\u0275property("formGroup",t.lwm2mDeviceTransportConfigurationFormGroup),e.\u0275\u0275advance(1),e.\u0275\u0275property("parentForm",t.lwm2mDeviceTransportConfigurationFormGroup)("isDeviceSetting",!0))},dependencies:[r.\u0275NgNoValidate,r.NgControlStatusGroup,r.FormGroupDirective,er.D],encapsulation:2});class Lt{get required(){return this.requiredValue}set required(n){this.requiredValue=(0,ue.coerceBooleanProperty)(n)}constructor(n,t){this.store=n,this.fb=t,this.snmpDeviceProtocolVersions=Object.values(R.kE),this.snmpAuthenticationProtocols=Object.values(R.II),this.snmpAuthenticationProtocolTranslation=R.qF,this.snmpPrivacyProtocols=Object.values(R.Av),this.snmpPrivacyProtocolTranslation=R.FZ,this.propagateChange=a=>{}}registerOnChange(n){this.propagateChange=n}registerOnTouched(n){}ngOnInit(){this.snmpDeviceTransportConfigurationFormGroup=this.fb.group({host:["",[r.Validators.required,r.Validators.pattern("(.|\\s)*\\S(.|\\s)*")]],port:[null,[r.Validators.required,r.Validators.min(0),r.Validators.pattern("[0-9]*")]],protocolVersion:[R.kE.V2C,r.Validators.required],community:["public",[r.Validators.required,r.Validators.pattern("(.|\\s)*\\S(.|\\s)*")]],username:["",[r.Validators.required,r.Validators.pattern("(.|\\s)*\\S(.|\\s)*")]],securityName:["public",[r.Validators.required,r.Validators.pattern("(.|\\s)*\\S(.|\\s)*")]],contextName:[null],authenticationProtocol:[R.II.SHA_512,r.Validators.required],authenticationPassphrase:["",[r.Validators.required,r.Validators.pattern("(.|\\s)*\\S(.|\\s)*")]],privacyProtocol:[R.Av.DES,r.Validators.required],privacyPassphrase:["",[r.Validators.required,r.Validators.pattern("(.|\\s)*\\S(.|\\s)*")]],engineId:[""]}),this.snmpDeviceTransportConfigurationFormGroup.get("protocolVersion").valueChanges.subscribe(n=>{this.updateDisabledFormValue(n)}),this.snmpDeviceTransportConfigurationFormGroup.valueChanges.subscribe(()=>{this.updateModel()})}validate(){return this.snmpDeviceTransportConfigurationFormGroup.valid?null:{snmpDeviceTransportConfiguration:!1}}setDisabledState(n){this.disabled=n,this.disabled?this.snmpDeviceTransportConfigurationFormGroup.disable({emitEvent:!1}):(this.snmpDeviceTransportConfigurationFormGroup.enable({emitEvent:!1}),this.updateDisabledFormValue(this.snmpDeviceTransportConfigurationFormGroup.get("protocolVersion").value||R.kE.V2C))}writeValue(n){(0,T.nu)(n)&&(this.snmpDeviceTransportConfigurationFormGroup.patchValue(n,{emitEvent:!1}),this.snmpDeviceTransportConfigurationFormGroup.enabled&&this.updateDisabledFormValue(n.protocolVersion||R.kE.V2C))}isV3protocolVersion(){return this.snmpDeviceTransportConfigurationFormGroup.get("protocolVersion").value===R.kE.V3}updateDisabledFormValue(n){n===R.kE.V3?(this.snmpDeviceTransportConfigurationFormGroup.get("community").disable({emitEvent:!1}),this.snmpDeviceTransportConfigurationFormGroup.get("username").enable({emitEvent:!1}),this.snmpDeviceTransportConfigurationFormGroup.get("securityName").enable({emitEvent:!1}),this.snmpDeviceTransportConfigurationFormGroup.get("contextName").enable({emitEvent:!1}),this.snmpDeviceTransportConfigurationFormGroup.get("authenticationProtocol").enable({emitEvent:!1}),this.snmpDeviceTransportConfigurationFormGroup.get("authenticationPassphrase").enable({emitEvent:!1}),this.snmpDeviceTransportConfigurationFormGroup.get("privacyProtocol").enable({emitEvent:!1}),this.snmpDeviceTransportConfigurationFormGroup.get("privacyPassphrase").enable({emitEvent:!1}),this.snmpDeviceTransportConfigurationFormGroup.get("engineId").enable({emitEvent:!1})):(this.snmpDeviceTransportConfigurationFormGroup.get("community").enable({emitEvent:!1}),this.snmpDeviceTransportConfigurationFormGroup.get("username").disable({emitEvent:!1}),this.snmpDeviceTransportConfigurationFormGroup.get("securityName").disable({emitEvent:!1}),this.snmpDeviceTransportConfigurationFormGroup.get("contextName").disable({emitEvent:!1}),this.snmpDeviceTransportConfigurationFormGroup.get("authenticationProtocol").disable({emitEvent:!1}),this.snmpDeviceTransportConfigurationFormGroup.get("authenticationPassphrase").disable({emitEvent:!1}),this.snmpDeviceTransportConfigurationFormGroup.get("privacyProtocol").disable({emitEvent:!1}),this.snmpDeviceTransportConfigurationFormGroup.get("privacyPassphrase").disable({emitEvent:!1}),this.snmpDeviceTransportConfigurationFormGroup.get("engineId").disable({emitEvent:!1}))}updateModel(){let n=null;this.snmpDeviceTransportConfigurationFormGroup.valid&&(n=this.snmpDeviceTransportConfigurationFormGroup.value,n.type=R.dH.SNMP),this.propagateChange(n)}}function Ng(i,n){if(1&i&&e.\u0275\u0275element(0,"tb-default-device-transport-configuration",3),2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275property("required",t.required)}}function Fg(i,n){if(1&i&&e.\u0275\u0275element(0,"tb-mqtt-device-transport-configuration",3),2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275property("required",t.required)}}function Lg(i,n){if(1&i&&e.\u0275\u0275element(0,"tb-lwm2m-device-transport-configuration",3),2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275property("required",t.required)}}function Pg(i,n){if(1&i&&e.\u0275\u0275element(0,"tb-coap-device-transport-configuration",3),2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275property("required",t.required)}}function kg(i,n){if(1&i&&e.\u0275\u0275element(0,"tb-snmp-device-transport-configuration",3),2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275property("required",t.required)}}Lt.\u0275fac=function(n){return new(n||Lt)(e.\u0275\u0275directiveInject(x.Store),e.\u0275\u0275directiveInject(r.UntypedFormBuilder))},Lt.\u0275cmp=e.\u0275\u0275defineComponent({type:Lt,selectors:[["tb-snmp-device-transport-configuration"]],inputs:{required:"required",disabled:"disabled"},features:[e.\u0275\u0275ProvidersFeature([{provide:r.NG_VALUE_ACCESSOR,useExisting:(0,e.forwardRef)(()=>Lt),multi:!0},{provide:r.NG_VALIDATORS,useExisting:(0,e.forwardRef)(()=>Lt),multi:!0}])],decls:21,vars:8,consts:[["fxLayoutGap","8px","fxLayout","column",2,"padding-bottom","16px",3,"formGroup"],["fxLayout","row","fxLayoutGap","8px","fxLayout.xs","column"],["fxFlex",""],["translate",""],["matInput","","formControlName","host","required",""],[4,"ngIf"],["matInput","","formControlName","port","type","number","min","0","required",""],["floatLabel","always","hideRequiredMarker","",1,"mat-block"],["formControlName","protocolVersion","required",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"mat-block"],["matInput","","formControlName","community","required",""],["matInput","","formControlName","username","required",""],["matInput","","formControlName","securityName","required",""],["fxFlex","","floatLabel","always","hideRequiredMarker",""],["formControlName","authenticationProtocol","required",""],["matInput","","formControlName","authenticationPassphrase","required",""],["formControlName","privacyProtocol","required",""],["matInput","","formControlName","privacyPassphrase","required",""],["matInput","","formControlName","contextName"],["matInput","","formControlName","engineId"]],template:function(n,t){1&n&&(e.\u0275\u0275elementStart(0,"form",0)(1,"div",1)(2,"mat-form-field",2)(3,"mat-label",3),e.\u0275\u0275text(4,"device-profile.snmp.host"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(5,"input",4),e.\u0275\u0275template(6,fg,3,3,"mat-error",5),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(7,"mat-form-field",2)(8,"mat-label",3),e.\u0275\u0275text(9,"device-profile.snmp.port"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(10,"input",6),e.\u0275\u0275template(11,hg,3,3,"mat-error",5),e.\u0275\u0275template(12,bg,3,3,"mat-error",5),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(13,"mat-form-field",7)(14,"mat-label",3),e.\u0275\u0275text(15,"device-profile.snmp.protocol-version"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(16,"mat-select",8),e.\u0275\u0275template(17,yg,3,4,"mat-option",9),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(18,vg,3,3,"mat-error",5),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(19,xg,6,1,"section",5),e.\u0275\u0275template(20,Ag,45,8,"section",5),e.\u0275\u0275elementEnd()),2&n&&(e.\u0275\u0275property("formGroup",t.snmpDeviceTransportConfigurationFormGroup),e.\u0275\u0275advance(6),e.\u0275\u0275property("ngIf",t.snmpDeviceTransportConfigurationFormGroup.get("host").hasError("required")||t.snmpDeviceTransportConfigurationFormGroup.get("host").hasError("pattern")),e.\u0275\u0275advance(5),e.\u0275\u0275property("ngIf",t.snmpDeviceTransportConfigurationFormGroup.get("port").hasError("required")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.snmpDeviceTransportConfigurationFormGroup.get("port").hasError("pattern")||t.snmpDeviceTransportConfigurationFormGroup.get("port").hasError("min")),e.\u0275\u0275advance(5),e.\u0275\u0275property("ngForOf",t.snmpDeviceProtocolVersions),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.snmpDeviceTransportConfigurationFormGroup.get("protocolVersion").hasError("required")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!t.isV3protocolVersion()),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.isV3protocolVersion()))},dependencies:[p.NgForOf,p.NgIf,O.MatInput,_.MatFormField,_.MatLabel,_.MatError,ye.MatSelect,X.MatOption,h.DefaultLayoutDirective,h.DefaultLayoutGapDirective,h.DefaultFlexDirective,r.\u0275NgNoValidate,r.DefaultValueAccessor,r.NumberValueAccessor,r.NgControlStatus,r.NgControlStatusGroup,r.RequiredValidator,r.MinValidator,r.FormGroupDirective,r.FormControlName,g.TranslateDirective,p.LowerCasePipe,g.TranslatePipe],encapsulation:2});class Pt{get required(){return this.requiredValue}set required(n){this.requiredValue=(0,ue.coerceBooleanProperty)(n)}constructor(n,t){this.store=n,this.fb=t,this.deviceTransportType=R.dH,this.propagateChange=a=>{}}registerOnChange(n){this.propagateChange=n}registerOnTouched(n){}ngOnInit(){this.deviceTransportConfigurationFormGroup=this.fb.group({configuration:[null,r.Validators.required]}),this.deviceTransportConfigurationFormGroup.valueChanges.subscribe(()=>{this.updateModel()})}setDisabledState(n){this.disabled=n,this.disabled?this.deviceTransportConfigurationFormGroup.disable({emitEvent:!1}):this.deviceTransportConfigurationFormGroup.enable({emitEvent:!1})}writeValue(n){this.transportType=n?.type;const t=(0,T.I8)(n);t&&delete t.type,this.deviceTransportConfigurationFormGroup.patchValue({configuration:t},{emitEvent:!1})}validate(){return this.deviceTransportConfigurationFormGroup.valid?null:{deviceTransportConfiguration:!1}}updateModel(){let n=null;this.deviceTransportConfigurationFormGroup.valid&&(n=this.deviceTransportConfigurationFormGroup.getRawValue().configuration,n.type=this.transportType),this.propagateChange(n)}}function Rg(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-expansion-panel",3)(1,"mat-expansion-panel-header")(2,"mat-panel-title")(3,"div",4),e.\u0275\u0275text(4,"device.device-configuration"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275element(5,"tb-device-configuration",5),e.\u0275\u0275elementEnd()),2&i&&e.\u0275\u0275property("expanded",!0)}function Og(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-expansion-panel",3)(1,"mat-expansion-panel-header")(2,"mat-panel-title")(3,"div",4),e.\u0275\u0275text(4,"device.transport-configuration"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275element(5,"tb-device-transport-configuration",6),e.\u0275\u0275elementEnd()),2&i&&e.\u0275\u0275property("expanded",!0)}Pt.\u0275fac=function(n){return new(n||Pt)(e.\u0275\u0275directiveInject(x.Store),e.\u0275\u0275directiveInject(r.UntypedFormBuilder))},Pt.\u0275cmp=e.\u0275\u0275defineComponent({type:Pt,selectors:[["tb-device-transport-configuration"]],inputs:{required:"required",disabled:"disabled"},features:[e.\u0275\u0275ProvidersFeature([{provide:r.NG_VALUE_ACCESSOR,useExisting:(0,e.forwardRef)(()=>Pt),multi:!0},{provide:r.NG_VALIDATORS,useExisting:(0,e.forwardRef)(()=>Pt),multi:!0}])],decls:7,vars:7,consts:[[3,"formGroup"],[3,"ngSwitch"],[3,"ngSwitchCase"],["formControlName","configuration",3,"required"]],template:function(n,t){1&n&&(e.\u0275\u0275elementStart(0,"div",0)(1,"div",1),e.\u0275\u0275template(2,Ng,1,1,"ng-template",2),e.\u0275\u0275template(3,Fg,1,1,"ng-template",2),e.\u0275\u0275template(4,Lg,1,1,"ng-template",2),e.\u0275\u0275template(5,Pg,1,1,"ng-template",2),e.\u0275\u0275template(6,kg,1,1,"ng-template",2),e.\u0275\u0275elementEnd()()),2&n&&(e.\u0275\u0275property("formGroup",t.deviceTransportConfigurationFormGroup),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitch",t.transportType),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase",t.deviceTransportType.DEFAULT),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase",t.deviceTransportType.MQTT),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase",t.deviceTransportType.LWM2M),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase",t.deviceTransportType.COAP),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase",t.deviceTransportType.SNMP))},dependencies:[p.NgSwitch,p.NgSwitchCase,r.NgControlStatus,r.NgControlStatusGroup,r.RequiredValidator,r.FormGroupDirective,r.FormControlName,qn,$n,Hn,zn,Lt],encapsulation:2});class kt{get required(){return this.requiredValue}set required(n){this.requiredValue=(0,ue.coerceBooleanProperty)(n)}constructor(n,t){this.store=n,this.fb=t,this.propagateChange=a=>{}}registerOnChange(n){this.propagateChange=n}registerOnTouched(n){}ngOnInit(){this.deviceDataFormGroup=this.fb.group({configuration:[null,r.Validators.required],transportConfiguration:[null,r.Validators.required]}),this.deviceDataFormGroup.valueChanges.subscribe(()=>{this.updateModel()})}setDisabledState(n){this.disabled=n,this.disabled?this.deviceDataFormGroup.disable({emitEvent:!1}):this.deviceDataFormGroup.enable({emitEvent:!1})}writeValue(n){const t=n?.configuration?.type;this.displayDeviceConfiguration=t&&R.Lh.get(t).hasDeviceConfiguration;const a=n?.transportConfiguration?.type;this.displayTransportConfiguration=a&&R.RW.get(a).hasDeviceConfiguration,this.deviceDataFormGroup.patchValue({configuration:n?.configuration},{emitEvent:!1}),this.deviceDataFormGroup.patchValue({transportConfiguration:n?.transportConfiguration},{emitEvent:!1})}validate(){return this.deviceDataFormGroup.valid?null:{deviceDataForm:!1}}updateModel(){let n=null;this.deviceDataFormGroup.valid&&(n=this.deviceDataFormGroup.getRawValue()),this.propagateChange(n)}}function Bg(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"device.name-required")," "))}function Vg(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"device.name-max-length")," "))}function Ug(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"device.label-max-length")," "))}function Gg(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-slide-toggle",27),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"device.overwrite-activity-time")," "))}kt.\u0275fac=function(n){return new(n||kt)(e.\u0275\u0275directiveInject(x.Store),e.\u0275\u0275directiveInject(r.UntypedFormBuilder))},kt.\u0275cmp=e.\u0275\u0275defineComponent({type:kt,selectors:[["tb-device-data"]],inputs:{required:"required",disabled:"disabled"},features:[e.\u0275\u0275ProvidersFeature([{provide:r.NG_VALUE_ACCESSOR,useExisting:(0,e.forwardRef)(()=>kt),multi:!0},{provide:r.NG_VALIDATORS,useExisting:(0,e.forwardRef)(()=>kt),multi:!0}])],decls:4,vars:3,consts:[[2,"padding-bottom","16px",3,"formGroup"],["multi","true"],[3,"expanded",4,"ngIf"],[3,"expanded"],["translate",""],["formControlName","configuration","required",""],["formControlName","transportConfiguration","required",""]],template:function(n,t){1&n&&(e.\u0275\u0275elementStart(0,"div",0)(1,"mat-accordion",1),e.\u0275\u0275template(2,Rg,6,1,"mat-expansion-panel",2),e.\u0275\u0275template(3,Og,6,1,"mat-expansion-panel",2),e.\u0275\u0275elementEnd()()),2&n&&(e.\u0275\u0275property("formGroup",t.deviceDataFormGroup),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",t.displayDeviceConfiguration),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.displayTransportConfiguration))},dependencies:[p.NgIf,U.MatAccordion,U.MatExpansionPanel,U.MatExpansionPanelHeader,U.MatExpansionPanelTitle,r.NgControlStatus,r.NgControlStatusGroup,r.RequiredValidator,r.FormGroupDirective,r.FormControlName,g.TranslateDirective,Wn,Pt],encapsulation:2});class Xi extends Te.r{constructor(n,t,a,o,s,l){super(n,s,a,o,l),this.store=n,this.translate=t,this.entityValue=a,this.entitiesTableConfigValue=o,this.fb=s,this.cd=l,this.entityType=f.py,this.otaUpdateType=Je.Jj}ngOnInit(){this.deviceScope=this.entitiesTableConfig.componentsData.deviceScope,this.deviceCredentials$=this.entitiesTableConfigValue.componentsData.deviceCredentials$,super.ngOnInit()}hideDelete(){return!!this.entitiesTableConfig&&!this.entitiesTableConfig.deleteEnabled(this.entity)}isAssignedToCustomer(n){return n&&n.customerId&&n.customerId.id!==P._}buildForm(n){const t=this.fb.group({name:[n?n.name:"",[r.Validators.required,r.Validators.maxLength(255)]],deviceProfileId:[n?n.deviceProfileId:null,[r.Validators.required]],firmwareId:[n?n.firmwareId:null],softwareId:[n?n.softwareId:null],label:[n?n.label:"",[r.Validators.maxLength(255)]],deviceData:[n?n.deviceData:null,[r.Validators.required]],additionalInfo:this.fb.group({gateway:[!(!n||!n.additionalInfo)&&n.additionalInfo.gateway],overwriteActivityTime:[!(!n||!n.additionalInfo)&&n.additionalInfo.overwriteActivityTime],description:[n&&n.additionalInfo?n.additionalInfo.description:""]})});return t.get("deviceProfileId").valueChanges.pipe((0,uo.x)((a,o)=>a?.id===o?.id)).subscribe(a=>{a&&this.isEdit&&this.entityForm.patchValue({firmwareId:null,softwareId:null},{emitEvent:!1})}),t}updateForm(n){this.entityForm.patchValue({name:n.name,deviceProfileId:n.deviceProfileId,firmwareId:n.firmwareId,softwareId:n.softwareId,label:n.label,deviceData:n.deviceData,additionalInfo:{gateway:!!n.additionalInfo&&n.additionalInfo.gateway,overwriteActivityTime:!!n.additionalInfo&&n.additionalInfo.overwriteActivityTime,description:n.additionalInfo?n.additionalInfo.description:""}})}onDeviceIdCopied(n){this.store.dispatch(new V.zi({message:this.translate.instant("device.idCopiedMessage"),type:"success",duration:750,verticalPosition:"bottom",horizontalPosition:"right"}))}onDeviceProfileUpdated(){this.entitiesTableConfig.updateData(!1)}onDeviceProfileChanged(n){if(n&&this.isEdit){const t=n.type,a=n.transportType;let o=this.entityForm.getRawValue().deviceData;if(o){let s=!1;o.configuration.type!==t&&(o.configuration=(0,R.Jf)(t),s=!0),o.transportConfiguration.type!==a&&(o.transportConfiguration=(0,R.Nm)(a),s=!0),s&&(this.entityForm.patchValue({deviceData:o}),this.entityForm.markAsDirty())}else o={configuration:(0,R.Jf)(t),transportConfiguration:(0,R.Nm)(a)},this.entityForm.patchValue({deviceData:o}),this.entityForm.markAsDirty()}}}Xi.\u0275fac=function(n){return new(n||Xi)(e.\u0275\u0275directiveInject(x.Store),e.\u0275\u0275directiveInject(g.TranslateService),e.\u0275\u0275directiveInject("entity"),e.\u0275\u0275directiveInject("entitiesTableConfig"),e.\u0275\u0275directiveInject(r.UntypedFormBuilder),e.\u0275\u0275directiveInject(e.ChangeDetectorRef))},Xi.\u0275cmp=e.\u0275\u0275defineComponent({type:Xi,selectors:[["tb-device"]],features:[e.\u0275\u0275InheritDefinitionFeature],decls:77,vars:94,consts:[["fxLayout.xs","column",1,"tb-details-buttons"],["mat-raised-button","","color","primary",3,"disabled","fxShow","click"],["mat-raised-button","","color","primary","fxFlex.xs","",3,"disabled","fxShow","click"],["fxLayout","row","fxLayout.xs","column"],["mat-raised-button","","ngxClipboard","",3,"cbContent","disabled","fxShow","cbOnSuccess"],["svgIcon","mdi:clipboard-arrow-left"],["translate",""],[3,"fxShow","disabled","credentials$","deviceId"],["fxLayout","column",1,"mat-padding"],[1,"mat-block",3,"fxShow"],["matInput","","disabled","",3,"ngModel"],[1,"tb-small",2,"padding-bottom","10px","padding-left","2px",3,"fxShow"],[3,"formGroup"],[3,"disabled"],[1,"mat-block"],["matInput","","formControlName","name","required",""],[4,"ngIf"],["required","","formControlName","deviceProfileId",3,"selectDefaultProfile","showDetailsPageLink","deviceProfileUpdated","deviceProfileChanged"],["matInput","","formControlName","label"],["formControlName","firmwareId",3,"useFullEntityId","showDetailsPageLink","type","deviceProfileId"],["formControlName","softwareId",3,"useFullEntityId","showDetailsPageLink","type","deviceProfileId"],["formControlName","deviceData","required",""],["formGroupName","additionalInfo","fxLayout","column"],[1,"toggle-group"],["formControlName","gateway",2,"min-width","165px"],["formControlName","overwriteActivityTime",4,"ngIf"],["matInput","","formControlName","description","rows","2"],["formControlName","overwriteActivityTime"]],template:function(n,t){1&n&&(e.\u0275\u0275elementStart(0,"div",0)(1,"button",1),e.\u0275\u0275listener("click",function(o){return t.onEntityAction(o,"open")}),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275text(3),e.\u0275\u0275pipe(4,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"button",1),e.\u0275\u0275listener("click",function(o){return t.onEntityAction(o,"makePublic")}),e.\u0275\u0275pipe(6,"async"),e.\u0275\u0275text(7),e.\u0275\u0275pipe(8,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(9,"button",1),e.\u0275\u0275listener("click",function(o){return t.onEntityAction(o,"assignToCustomer")}),e.\u0275\u0275pipe(10,"async"),e.\u0275\u0275text(11),e.\u0275\u0275pipe(12,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(13,"button",1),e.\u0275\u0275listener("click",function(o){return t.onEntityAction(o,"unassignFromCustomer")}),e.\u0275\u0275pipe(14,"async"),e.\u0275\u0275text(15),e.\u0275\u0275pipe(16,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(17,"button",1),e.\u0275\u0275listener("click",function(o){return t.onEntityAction(o,"manageCredentials")}),e.\u0275\u0275pipe(18,"async"),e.\u0275\u0275text(19),e.\u0275\u0275pipe(20,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(21,"button",1),e.\u0275\u0275listener("click",function(o){return t.onEntityAction(o,"checkConnectivity")}),e.\u0275\u0275pipe(22,"async"),e.\u0275\u0275text(23),e.\u0275\u0275pipe(24,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(25,"button",1),e.\u0275\u0275listener("click",function(o){return t.onEntityAction(o,"unassignFromEdge")}),e.\u0275\u0275pipe(26,"async"),e.\u0275\u0275text(27),e.\u0275\u0275pipe(28,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(29,"button",2),e.\u0275\u0275listener("click",function(o){return t.onEntityAction(o,"delete")}),e.\u0275\u0275pipe(30,"async"),e.\u0275\u0275text(31),e.\u0275\u0275pipe(32,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(33,"div",3)(34,"button",4),e.\u0275\u0275listener("cbOnSuccess",function(o){return t.onDeviceIdCopied(o)}),e.\u0275\u0275pipe(35,"async"),e.\u0275\u0275element(36,"mat-icon",5),e.\u0275\u0275elementStart(37,"span",6),e.\u0275\u0275text(38,"device.copyId"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275element(39,"tb-copy-device-credentials",7),e.\u0275\u0275pipe(40,"async"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(41,"div",8)(42,"mat-form-field",9)(43,"mat-label",6),e.\u0275\u0275text(44,"device.assignedToCustomer"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(45,"input",10),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(46,"div",11),e.\u0275\u0275text(47),e.\u0275\u0275pipe(48,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(49,"form",12)(50,"fieldset",13),e.\u0275\u0275pipe(51,"async"),e.\u0275\u0275elementStart(52,"mat-form-field",14)(53,"mat-label",6),e.\u0275\u0275text(54,"device.name"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(55,"input",15),e.\u0275\u0275template(56,Bg,3,3,"mat-error",16),e.\u0275\u0275template(57,Vg,3,3,"mat-error",16),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(58,"tb-device-profile-autocomplete",17),e.\u0275\u0275listener("deviceProfileUpdated",function(){return t.onDeviceProfileUpdated()})("deviceProfileChanged",function(o){return t.onDeviceProfileChanged(o)}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(59,"mat-form-field",14)(60,"mat-label",6),e.\u0275\u0275text(61,"device.label"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(62,"input",18),e.\u0275\u0275template(63,Ug,3,3,"mat-error",16),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(64,"tb-ota-package-autocomplete",19)(65,"tb-ota-package-autocomplete",20)(66,"tb-device-data",21),e.\u0275\u0275elementStart(67,"div",22)(68,"div",23)(69,"mat-slide-toggle",24),e.\u0275\u0275text(70),e.\u0275\u0275pipe(71,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(72,Gg,3,3,"mat-slide-toggle",25),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(73,"mat-form-field",14)(74,"mat-label",6),e.\u0275\u0275text(75,"device.description"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(76,"textarea",26),e.\u0275\u0275elementEnd()()()()()),2&n&&(e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(2,52,t.isLoading$))("fxShow",!t.isEdit&&!t.isDetailsPage),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(4,54,"common.open-details-page")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(6,56,t.isLoading$))("fxShow",!(t.isEdit||"tenant"!==t.deviceScope||t.isAssignedToCustomer(t.entity)||null!=t.entity&&t.entity.customerIsPublic)),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(8,58,"device.make-public")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(10,60,t.isLoading$))("fxShow",!t.isEdit&&"tenant"===t.deviceScope&&!t.isAssignedToCustomer(t.entity)),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(12,62,"device.assign-to-customer")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(14,64,t.isLoading$))("fxShow",!t.isEdit&&("customer"===t.deviceScope||"tenant"===t.deviceScope)&&t.isAssignedToCustomer(t.entity)),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(16,66,null!=t.entity&&t.entity.customerIsPublic?"device.make-private":"device.unassign-from-customer")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(18,68,t.isLoading$))("fxShow",!t.isEdit),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(20,70,"customer_user"===t.deviceScope||"edge_customer_user"===t.deviceScope?"device.view-credentials":"device.manage-credentials")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(22,72,t.isLoading$))("fxShow",!t.isEdit),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(24,74,"device.connectivity.check-connectivity")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(26,76,t.isLoading$))("fxShow",!t.isEdit&&"edge"===t.deviceScope),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(28,78,"edge.unassign-from-edge")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(30,80,t.isLoading$))("fxShow",!t.hideDelete()&&!t.isEdit),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(32,82,"device.delete")," "),e.\u0275\u0275advance(3),e.\u0275\u0275property("cbContent",null==t.entity||null==t.entity.id?null:t.entity.id.id)("disabled",e.\u0275\u0275pipeBind1(35,84,t.isLoading$))("fxShow",!t.isEdit),e.\u0275\u0275advance(5),e.\u0275\u0275property("fxShow",!t.isEdit)("disabled",e.\u0275\u0275pipeBind1(40,86,t.isLoading$))("credentials$",t.deviceCredentials$)("deviceId",null==t.entity?null:t.entity.id),e.\u0275\u0275advance(3),e.\u0275\u0275property("fxShow",!t.isEdit&&t.isAssignedToCustomer(t.entity)&&!(null!=t.entity&&t.entity.customerIsPublic)&&"tenant"===t.deviceScope),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngModel",null==t.entity?null:t.entity.customerTitle),e.\u0275\u0275advance(1),e.\u0275\u0275property("fxShow",!t.isEdit&&(null==t.entity?null:t.entity.customerIsPublic)&&("customer"===t.deviceScope||"tenant"===t.deviceScope)),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(48,88,"device.device-public")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("formGroup",t.entityForm),e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(51,90,t.isLoading$)||!t.isEdit),e.\u0275\u0275advance(6),e.\u0275\u0275property("ngIf",t.entityForm.get("name").hasError("required")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.entityForm.get("name").hasError("maxlength")),e.\u0275\u0275advance(1),e.\u0275\u0275property("selectDefaultProfile",t.isAdd)("showDetailsPageLink",!0),e.\u0275\u0275advance(5),e.\u0275\u0275property("ngIf",t.entityForm.get("label").hasError("maxlength")),e.\u0275\u0275advance(1),e.\u0275\u0275property("useFullEntityId",!0)("showDetailsPageLink",!0)("type",t.otaUpdateType.FIRMWARE)("deviceProfileId",null==t.entityForm.get("deviceProfileId").value?null:t.entityForm.get("deviceProfileId").value.id),e.\u0275\u0275advance(1),e.\u0275\u0275property("useFullEntityId",!0)("showDetailsPageLink",!0)("type",t.otaUpdateType.SOFTWARE)("deviceProfileId",null==t.entityForm.get("deviceProfileId").value?null:t.entityForm.get("deviceProfileId").value.id),e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(71,92,"device.is-gateway")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",t.entityForm.get("additionalInfo.gateway").value))},dependencies:[p.NgIf,S.MatButton,F.MatIcon,O.MatInput,_.MatFormField,_.MatLabel,_.MatError,Ce.MatSlideToggle,he.yb,h.DefaultLayoutDirective,h.DefaultFlexDirective,G.DefaultShowHideDirective,r.\u0275NgNoValidate,r.DefaultValueAccessor,r.NgControlStatus,r.NgControlStatusGroup,r.RequiredValidator,r.NgModel,r.FormGroupDirective,r.FormControlName,r.FormGroupName,g.TranslateDirective,mg.OtaPackageAutocompleteComponent,Zo.DeviceProfileAutocompleteComponent,ug._,kt,p.AsyncPipe,g.TranslatePipe],styles:['@charset "UTF-8";[_nghost-%COMP%]   .toggle-group[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:wrap;gap:16px;margin-bottom:16px}']});var yo=c(1976),jg=c(44454);class Zi extends He.n{constructor(n){super(n),this.store=n,this.entityType=f.py}deviceInfoFilterChanged(n){this.entitiesTableConfig.componentsData.deviceInfoFilter=n,this.entitiesTableConfig.getTable().resetSortAndFilter(!0)}}Zi.\u0275fac=function(n){return new(n||Zi)(e.\u0275\u0275directiveInject(x.Store))},Zi.\u0275cmp=e.\u0275\u0275defineComponent({type:Zi,selectors:[["tb-device-table-header"]],features:[e.\u0275\u0275InheritDefinitionFeature],decls:1,vars:1,consts:[[3,"ngModel","ngModelChange"]],template:function(n,t){1&n&&(e.\u0275\u0275elementStart(0,"tb-device-info-filter",0),e.\u0275\u0275listener("ngModelChange",function(o){return t.deviceInfoFilterChanged(o)}),e.\u0275\u0275elementEnd()),2&n&&e.\u0275\u0275property("ngModel",t.entitiesTableConfig.componentsData.deviceInfoFilter)},dependencies:[r.NgControlStatus,r.NgModel,jg.F],encapsulation:2});var tr=c(77093),Wg=c(76703);function qg(i,n){1&i&&e.\u0275\u0275element(0,"mat-progress-bar",11)}function $g(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"section")(1,"form",12),e.\u0275\u0275element(2,"tb-device-credentials",13),e.\u0275\u0275elementEnd()()),2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("formGroup",t.deviceCredentialsFormGroup),e.\u0275\u0275advance(1),e.\u0275\u0275property("deviceTransportType",t.deviceTransportType)}}function Hg(i,n){1&i&&(e.\u0275\u0275elementStart(0,"div",14),e.\u0275\u0275element(1,"mat-spinner",15),e.\u0275\u0275elementStart(2,"span",16),e.\u0275\u0275text(3),e.\u0275\u0275pipe(4,"translate"),e.\u0275\u0275elementEnd()()),2&i&&(e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(4,1,"device.loading-device-credentials")," "))}function zg(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",17),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.save())}),e.\u0275\u0275pipe(1,"async"),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"translate"),e.\u0275\u0275elementEnd()}if(2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(1,2,t.isLoading$)||t.deviceCredentialsFormGroup.invalid||!t.deviceCredentialsFormGroup.dirty),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(3,4,"action.save")," ")}}class Kn extends le.a{constructor(n,t,a,o,s,l,d,m){super(n,t,d),this.store=n,this.router=t,this.data=a,this.deviceService=o,this.deviceProfileService=s,this.errorStateMatcher=l,this.dialogRef=d,this.fb=m,this.loadingCredentials=!0,this.submitted=!1,this.isReadOnly=a.isReadOnly}ngOnInit(){this.deviceCredentialsFormGroup=this.fb.group({credential:[null]}),this.isReadOnly&&this.deviceCredentialsFormGroup.disable({emitEvent:!1}),this.loadDeviceCredentials()}isErrorState(n,t){const a=this.errorStateMatcher.isErrorState(n,t),o=!!(n&&n.invalid&&this.submitted);return a||o}loadDeviceCredentials(){const n=[this.deviceService.getDeviceCredentials(this.data.deviceId),this.deviceProfileService.getDeviceProfileInfo(this.data.deviceProfileId)];(0,xe.D)(n).subscribe(([t,a])=>{this.deviceTransportType=a.transportType,this.deviceCredentials=t,this.deviceCredentialsFormGroup.patchValue({credential:t},{emitEvent:!1}),this.loadingCredentials=!1})}cancel(){this.dialogRef.close(null)}save(){this.submitted=!0;const n=this.deviceCredentialsFormGroup.value.credential;this.deviceCredentials={...this.deviceCredentials,...n},this.deviceService.saveDeviceCredentials(this.deviceCredentials).subscribe(t=>{this.dialogRef.close(t)})}}Kn.\u0275fac=function(n){return new(n||Kn)(e.\u0275\u0275directiveInject(x.Store),e.\u0275\u0275directiveInject(b.Router),e.\u0275\u0275directiveInject(C.MAT_DIALOG_DATA),e.\u0275\u0275directiveInject(yo.U),e.\u0275\u0275directiveInject(tr.A),e.\u0275\u0275directiveInject(X.ErrorStateMatcher,4),e.\u0275\u0275directiveInject(C.MatDialogRef),e.\u0275\u0275directiveInject(r.UntypedFormBuilder))},Kn.\u0275cmp=e.\u0275\u0275defineComponent({type:Kn,selectors:[["tb-device-credentials-dialog"]],features:[e.\u0275\u0275ProvidersFeature([{provide:X.ErrorStateMatcher,useExisting:Kn}]),e.\u0275\u0275InheritDefinitionFeature],decls:20,vars:15,consts:[["color","primary"],["fxFlex",""],["mat-icon-button","","type","button",3,"click"],[1,"material-icons"],["color","warn","mode","indeterminate",4,"ngIf"],["mat-dialog-content",""],[4,"ngIf","ngIfElse"],["loadCredentials",""],["mat-dialog-actions","",1,"tb-dialog-actions"],["mat-button","","color","primary","type","button","cdkFocusInitial","",3,"disabled","click"],["mat-raised-button","","color","primary","type","button",3,"disabled","click",4,"ngIf"],["color","warn","mode","indeterminate"],[3,"formGroup"],["formControlName","credential",3,"deviceTransportType"],["fxLayout","column","fxLayoutAlign","center center"],["color","accent","diameter","65","strokeWidth","4",2,"margin-bottom","18px"],[1,"mat-subtitle-1",2,"margin-bottom","0"],["mat-raised-button","","color","primary","type","button",3,"disabled","click"]],template:function(n,t){if(1&n&&(e.\u0275\u0275elementStart(0,"mat-toolbar",0)(1,"h2"),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(4,"span",1),e.\u0275\u0275elementStart(5,"button",2),e.\u0275\u0275listener("click",function(){return t.cancel()}),e.\u0275\u0275elementStart(6,"mat-icon",3),e.\u0275\u0275text(7,"close"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275template(8,qg,1,0,"mat-progress-bar",4),e.\u0275\u0275pipe(9,"async"),e.\u0275\u0275elementStart(10,"div",5),e.\u0275\u0275template(11,$g,3,2,"section",6),e.\u0275\u0275template(12,Hg,5,3,"ng-template",null,7,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(14,"div",8)(15,"button",9),e.\u0275\u0275listener("click",function(){return t.cancel()}),e.\u0275\u0275pipe(16,"async"),e.\u0275\u0275text(17),e.\u0275\u0275pipe(18,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(19,zg,4,6,"button",10),e.\u0275\u0275elementEnd()),2&n){const a=e.\u0275\u0275reference(13);e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(3,7,"device.device-credentials")),e.\u0275\u0275advance(6),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(9,9,t.isLoading$)),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",!t.loadingCredentials)("ngIfElse",a),e.\u0275\u0275advance(4),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(16,11,t.isLoading$)),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(18,13,t.isReadOnly?"action.close":"action.cancel")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!t.isReadOnly)}},dependencies:[p.NgIf,S.MatButton,S.MatIconButton,F.MatIcon,z.MatProgressBar,oe.MatToolbar,C.MatDialogContent,C.MatDialogActions,Ga.MatProgressSpinner,h.DefaultLayoutDirective,h.DefaultLayoutAlignDirective,h.DefaultFlexDirective,r.\u0275NgNoValidate,r.NgControlStatus,r.NgControlStatusGroup,r.FormGroupDirective,r.FormControlName,Wg.s,p.AsyncPipe,g.TranslatePipe],styles:['@charset "UTF-8";[_nghost-%COMP%]{height:100%;display:grid;grid-template-rows:min-content 4px auto min-content}@media screen and (min-width: 600px){[_nghost-%COMP%]{min-width:420px}}.mat-mdc-dialog-container[_nghost-%COMP%]   .tb-dialog-actions[_ngcontent-%COMP%], .mat-mdc-dialog-container   [_nghost-%COMP%]   .tb-dialog-actions[_ngcontent-%COMP%]{grid-row:4;display:flex;gap:8px;justify-content:flex-end;flex:1}.mat-mdc-dialog-container[_nghost-%COMP%]   .mat-mdc-dialog-content[_ngcontent-%COMP%], .mat-mdc-dialog-container   [_nghost-%COMP%]   .mat-mdc-dialog-content[_ngcontent-%COMP%]{grid-row:3;padding:24px 24px 4px}']});var za=c(19202),Ka=c(1989);function Kg(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-tab",1,2),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275element(3,"tb-attribute-table",3),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275reference(1),a=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(2,5,"attribute.attributes")),e.\u0275\u0275advance(3),e.\u0275\u0275property("defaultAttributeScope",a.attributeScopes.CLIENT_SCOPE)("active",t.isActive)("entityId",a.entity.id)("entityName",a.entity.name)}}function Yg(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-tab",1,4),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275element(3,"tb-attribute-table",5),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275reference(1),a=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(2,5,"attribute.latest-telemetry")),e.\u0275\u0275advance(3),e.\u0275\u0275property("defaultAttributeScope",a.latestTelemetryTypes.LATEST_TELEMETRY)("active",t.isActive)("entityId",a.entity.id)("entityName",a.entity.name)}}function Jg(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-tab",1,6),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275element(3,"tb-alarm-table",7),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275reference(1),a=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(2,3,"alarm.alarms")),e.\u0275\u0275advance(3),e.\u0275\u0275property("active",t.isActive)("entityId",a.entity.id)}}function Qg(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-tab",1,8),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275element(3,"tb-event-table",9),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275reference(1),a=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(2,5,"device.events")),e.\u0275\u0275advance(3),e.\u0275\u0275property("defaultEventType",a.eventTypes.ERROR)("active",t.isActive)("tenantId",a.entity.tenantId.id)("entityId",a.entity.id)}}function Xg(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-tab",1,10),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275element(3,"tb-relation-table",7),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275reference(1),a=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(2,3,"relation.relations")),e.\u0275\u0275advance(3),e.\u0275\u0275property("active",t.isActive)("entityId",a.entity.id)}}function Zg(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-tab",1,11),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275element(3,"tb-audit-log-table",12),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275reference(1),a=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(2,4,"audit-log.audit-logs")),e.\u0275\u0275advance(3),e.\u0275\u0275property("active",t.isActive)("auditLogMode",a.auditLogModes.ENTITY)("entityId",a.entity.id)}}function ef(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"mat-tab",1,13),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementStart(3,"tb-version-control",14),e.\u0275\u0275listener("versionRestored",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.entitiesTableConfig.updateData())}),e.\u0275\u0275elementEnd()()}if(2&i){const t=e.\u0275\u0275reference(1),a=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(2,5,"version-control.version-control")),e.\u0275\u0275advance(3),e.\u0275\u0275property("active",t.isActive)("entityId",a.entity.id)("entityName",a.entity.name)("externalEntityId",a.entity.externalId||a.entity.id)}}class ea extends _e.l{constructor(n){super(n),this.store=n}ngOnInit(){super.ngOnInit()}}ea.\u0275fac=function(n){return new(n||ea)(e.\u0275\u0275directiveInject(x.Store))},ea.\u0275cmp=e.\u0275\u0275defineComponent({type:ea,selectors:[["tb-device-tabs"]],features:[e.\u0275\u0275InheritDefinitionFeature],decls:7,vars:7,consts:[[3,"label",4,"ngIf"],[3,"label"],["attributesTab","matTab"],[3,"defaultAttributeScope","active","entityId","entityName"],["telemetryTab","matTab"],["disableAttributeScopeSelection","",3,"defaultAttributeScope","active","entityId","entityName"],["alarmsTab","matTab"],[3,"active","entityId"],["eventsTab","matTab"],[3,"defaultEventType","active","tenantId","entityId"],["relationsTab","matTab"],["auditLogsTab","matTab"],["detailsMode","true",3,"active","auditLogMode","entityId"],["versionControlTab","matTab"],["detailsMode","true","singleEntityMode","true",3,"active","entityId","entityName","externalEntityId","versionRestored"]],template:function(n,t){1&n&&(e.\u0275\u0275template(0,Kg,4,7,"mat-tab",0),e.\u0275\u0275template(1,Yg,4,7,"mat-tab",0),e.\u0275\u0275template(2,Jg,4,5,"mat-tab",0),e.\u0275\u0275template(3,Qg,4,7,"mat-tab",0),e.\u0275\u0275template(4,Xg,4,5,"mat-tab",0),e.\u0275\u0275template(5,Zg,4,6,"mat-tab",0),e.\u0275\u0275template(6,ef,4,7,"mat-tab",0)),2&n&&(e.\u0275\u0275property("ngIf",t.entity),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.entity),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.entity),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.entity),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.entity),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.entity&&t.authUser.authority===t.authorities.TENANT_ADMIN),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.entity&&t.authUser.authority===t.authorities.TENANT_ADMIN))},dependencies:[p.NgIf,H.MatTab,Be.AuditLogTableComponent,wt.EventTableComponent,Et.RelationTableComponent,Ke.AlarmTableComponent,Ye.AttributeTableComponent,Ae.s,g.TranslatePipe],encapsulation:2});var tf=c(48857),Yn=c(52594),Ya=c(26021),nf=c(82884),af=c(13260),ta=c(71337),of=c(19429),nr=c(68457);function rf(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"tb-toggle-option",30),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("value",t.BasicTransportType.HTTP),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,2,t.deviceTransportTypeTranslationMap.get(t.BasicTransportType.HTTP))," ")}}function sf(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"tb-toggle-option",30),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("value",t.DeviceTransportType.MQTT),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,2,t.deviceTransportTypeTranslationMap.get(t.DeviceTransportType.MQTT))," ")}}function lf(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"tb-toggle-option",30),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("value",t.DeviceTransportType.COAP),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,2,t.deviceTransportTypeTranslationMap.get(t.DeviceTransportType.COAP))," ")}}function df(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"tb-toggle-option",30),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("value",t.DeviceTransportType.SNMP),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,2,t.deviceTransportTypeTranslationMap.get(t.DeviceTransportType.SNMP))," ")}}function cf(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"tb-toggle-option",30),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("value",t.DeviceTransportType.LWM2M),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,2,t.deviceTransportTypeTranslationMap.get(t.DeviceTransportType.LWM2M))," ")}}function pf(i,n){1&i&&(e.\u0275\u0275element(0,"mat-icon",35),e.\u0275\u0275text(1," Windows "))}function mf(i,n){1&i&&e.\u0275\u0275elementContainer(0)}const vo=function(){return{text:"",href:""}},_o=function(i,n,t){return{noSecLabel:"HTTP",noSec:i,secLabel:"HTTPs",sec:n,doc:t}},Qe=function(i){return{cmd:i}};function uf(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",36)(1,"div",21)(2,"div",23),e.\u0275\u0275text(3,"device.connectivity.install-necessary-client-tools"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"div",37),e.\u0275\u0275text(5,"device.connectivity.install-curl-windows"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(6,mf,1,0,"ng-container",38),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275nextContext(3),a=e.\u0275\u0275reference(23);e.\u0275\u0275advance(6),e.\u0275\u0275property("ngTemplateOutlet",a)("ngTemplateOutletContext",e.\u0275\u0275pureFunction1(7,Qe,e.\u0275\u0275pureFunction3(3,_o,t.commands.http.http,t.commands.http.https,e.\u0275\u0275pureFunction0(2,vo))))}}function gf(i,n){1&i&&(e.\u0275\u0275element(0,"mat-icon",39),e.\u0275\u0275text(1," MacOS "))}function ff(i,n){1&i&&e.\u0275\u0275elementContainer(0)}function hf(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",36)(1,"div",21)(2,"div",23),e.\u0275\u0275text(3,"device.connectivity.install-necessary-client-tools"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"div",37),e.\u0275\u0275text(5,"device.connectivity.install-curl-macos"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(6,ff,1,0,"ng-container",38),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275nextContext(3),a=e.\u0275\u0275reference(23);e.\u0275\u0275advance(6),e.\u0275\u0275property("ngTemplateOutlet",a)("ngTemplateOutletContext",e.\u0275\u0275pureFunction1(7,Qe,e.\u0275\u0275pureFunction3(3,_o,t.commands.http.http,t.commands.http.https,e.\u0275\u0275pureFunction0(2,vo))))}}function bf(i,n){1&i&&(e.\u0275\u0275element(0,"mat-icon",40),e.\u0275\u0275text(1," Linux "))}function yf(i,n){1&i&&e.\u0275\u0275elementContainer(0)}function vf(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",36)(1,"div",21)(2,"div",23),e.\u0275\u0275text(3,"device.connectivity.install-necessary-client-tools"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(4,"tb-markdown",41),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(5,yf,1,0,"ng-container",38),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275nextContext(3),a=e.\u0275\u0275reference(23);e.\u0275\u0275advance(4),e.\u0275\u0275property("data",t.createMarkDownCommand("sudo apt-get install curl")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngTemplateOutlet",a)("ngTemplateOutletContext",e.\u0275\u0275pureFunction1(8,Qe,e.\u0275\u0275pureFunction3(4,_o,t.commands.http.http,t.commands.http.https,e.\u0275\u0275pureFunction0(3,vo))))}}function _f(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",31),e.\u0275\u0275text(1,"device.connectivity.use-following-instructions"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(2,"mat-tab-group",32),e.\u0275\u0275listener("selectedIndexChange",function(o){e.\u0275\u0275restoreView(t);const s=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(s.httpTabIndex=o)}),e.\u0275\u0275elementStart(3,"mat-tab"),e.\u0275\u0275template(4,pf,2,0,"ng-template",33),e.\u0275\u0275template(5,uf,7,9,"ng-template",34),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(6,"mat-tab"),e.\u0275\u0275template(7,gf,2,0,"ng-template",33),e.\u0275\u0275template(8,hf,7,9,"ng-template",34),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(9,"mat-tab"),e.\u0275\u0275template(10,bf,2,0,"ng-template",33),e.\u0275\u0275template(11,vf,6,10,"ng-template",34),e.\u0275\u0275elementEnd()()}if(2&i){const t=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(2),e.\u0275\u0275property("selectedIndex",t.httpTabIndex)}}function xf(i,n){1&i&&e.\u0275\u0275elementContainer(0)}const Tf=function(){return{text:"device.connectivity.sparkplug-command",href:"https://thingsboard.io/docs/reference/mqtt-sparkplug-api/"}},na=function(i){return{doc:i}};function Sf(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",21),e.\u0275\u0275template(1,xf,1,0,"ng-container",38),e.\u0275\u0275elementEnd()),2&i){e.\u0275\u0275nextContext(3);const t=e.\u0275\u0275reference(25);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngTemplateOutlet",t)("ngTemplateOutletContext",e.\u0275\u0275pureFunction1(3,na,e.\u0275\u0275pureFunction0(2,Tf)))}}function If(i,n){1&i&&(e.\u0275\u0275element(0,"mat-icon",35),e.\u0275\u0275text(1," Windows "))}function wf(i,n){1&i&&e.\u0275\u0275elementContainer(0)}function Ef(i,n){1&i&&e.\u0275\u0275elementContainer(0)}const Df=function(){return{text:"device.connectivity.install-mqtt-windows",href:"https://thingsboard.io/docs/reference/mqtt-api/?connectdevice=mqtt-windows#mqtt-connect"}},Ja=function(){return{text:"device.connectivity.mqtts-x509-command",href:"https://thingsboard.io/docs/user-guide/mqtt-over-ssl/"}},Qa=function(i,n,t){return{noSecLabel:"MQTT",noSec:i,secLabel:"MQTTs",sec:n,doc:t}};function Nf(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",36)(1,"div",21)(2,"div",23),e.\u0275\u0275text(3,"device.connectivity.install-necessary-client-tools"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"div",45),e.\u0275\u0275template(5,wf,1,0,"ng-container",38),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(6,Ef,1,0,"ng-container",38),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275nextContext(4),a=e.\u0275\u0275reference(25),o=e.\u0275\u0275reference(23);e.\u0275\u0275advance(5),e.\u0275\u0275property("ngTemplateOutlet",a)("ngTemplateOutletContext",e.\u0275\u0275pureFunction1(5,na,e.\u0275\u0275pureFunction0(4,Df))),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngTemplateOutlet",o)("ngTemplateOutletContext",e.\u0275\u0275pureFunction1(12,Qe,e.\u0275\u0275pureFunction3(8,Qa,t.commands.mqtt.mqtt,t.commands.mqtt.mqtts,e.\u0275\u0275pureFunction0(7,Ja))))}}function Ff(i,n){1&i&&(e.\u0275\u0275element(0,"mat-icon",39),e.\u0275\u0275text(1," MacOS "))}function Lf(i,n){1&i&&e.\u0275\u0275elementContainer(0)}function Pf(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",36)(1,"div",21)(2,"div",23),e.\u0275\u0275text(3,"device.connectivity.install-necessary-client-tools"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(4,"tb-markdown",41),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(5,Lf,1,0,"ng-container",38),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275nextContext(4),a=e.\u0275\u0275reference(23);e.\u0275\u0275advance(4),e.\u0275\u0275property("data",t.createMarkDownCommand("brew install mosquitto")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngTemplateOutlet",a)("ngTemplateOutletContext",e.\u0275\u0275pureFunction1(8,Qe,e.\u0275\u0275pureFunction3(4,Qa,t.commands.mqtt.mqtt,t.commands.mqtt.mqtts,e.\u0275\u0275pureFunction0(3,Ja))))}}function kf(i,n){1&i&&(e.\u0275\u0275element(0,"mat-icon",40),e.\u0275\u0275text(1," Linux "))}function Rf(i,n){1&i&&e.\u0275\u0275elementContainer(0)}function Of(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",36)(1,"div",21)(2,"div",23),e.\u0275\u0275text(3,"device.connectivity.install-necessary-client-tools"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(4,"tb-markdown",41),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(5,Rf,1,0,"ng-container",38),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275nextContext(4),a=e.\u0275\u0275reference(23);e.\u0275\u0275advance(4),e.\u0275\u0275property("data",t.createMarkDownCommand("sudo apt-get install curl mosquitto-clients")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngTemplateOutlet",a)("ngTemplateOutletContext",e.\u0275\u0275pureFunction1(8,Qe,e.\u0275\u0275pureFunction3(4,Qa,t.commands.mqtt.mqtt,t.commands.mqtt.mqtts,e.\u0275\u0275pureFunction0(3,Ja))))}}function Bf(i,n){1&i&&(e.\u0275\u0275element(0,"mat-icon",46),e.\u0275\u0275text(1," Docker "))}function Vf(i,n){1&i&&e.\u0275\u0275elementContainer(0)}function Uf(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",36),e.\u0275\u0275template(1,Vf,1,0,"ng-container",38),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275nextContext(5),a=e.\u0275\u0275reference(23);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngTemplateOutlet",a)("ngTemplateOutletContext",e.\u0275\u0275pureFunction1(7,Qe,e.\u0275\u0275pureFunction3(3,Qa,t.commands.mqtt.docker.mqtt,t.commands.mqtt.docker.mqtts,e.\u0275\u0275pureFunction0(2,Ja))))}}function Gf(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-tab"),e.\u0275\u0275template(1,Bf,2,0,"ng-template",33),e.\u0275\u0275template(2,Uf,2,9,"ng-template",34),e.\u0275\u0275elementEnd())}function jf(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",31),e.\u0275\u0275text(1,"device.connectivity.use-following-instructions"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(2,"mat-tab-group",32),e.\u0275\u0275listener("selectedIndexChange",function(o){e.\u0275\u0275restoreView(t);const s=e.\u0275\u0275nextContext(3);return e.\u0275\u0275resetView(s.mqttTabIndex=o)}),e.\u0275\u0275elementStart(3,"mat-tab"),e.\u0275\u0275template(4,If,2,0,"ng-template",33),e.\u0275\u0275template(5,Nf,7,14,"ng-template",34),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(6,"mat-tab"),e.\u0275\u0275template(7,Ff,2,0,"ng-template",33),e.\u0275\u0275template(8,Pf,6,10,"ng-template",34),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(9,"mat-tab"),e.\u0275\u0275template(10,kf,2,0,"ng-template",33),e.\u0275\u0275template(11,Of,6,10,"ng-template",34),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(12,Gf,3,0,"mat-tab",44),e.\u0275\u0275elementEnd()}if(2&i){const t=e.\u0275\u0275nextContext(3);e.\u0275\u0275advance(2),e.\u0275\u0275property("selectedIndex",t.mqttTabIndex),e.\u0275\u0275advance(10),e.\u0275\u0275property("ngIf",!!t.commands.mqtt.docker)}}function Wf(i,n){if(1&i&&(e.\u0275\u0275template(0,Sf,2,5,"div",42),e.\u0275\u0275template(1,jf,13,2,"ng-template",null,43,e.\u0275\u0275templateRefExtractor)),2&i){const t=e.\u0275\u0275reference(2),a=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("ngIf",a.commands.mqtt.sparkplug)("ngIfElse",t)}}function qf(i,n){1&i&&(e.\u0275\u0275element(0,"mat-icon",40),e.\u0275\u0275text(1," Linux "))}function $f(i,n){1&i&&e.\u0275\u0275elementContainer(0)}const zf=function(){return{text:"device.connectivity.install-coap-client",href:"https://thingsboard.io/docs/user-guide/ssl/coap-access-token/"}};function Kf(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",21)(1,"div",23),e.\u0275\u0275text(2,"device.connectivity.install-necessary-client-tools"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"div",45),e.\u0275\u0275template(4,$f,1,0,"ng-container",38),e.\u0275\u0275elementEnd()()),2&i){e.\u0275\u0275nextContext(4);const t=e.\u0275\u0275reference(25);e.\u0275\u0275advance(4),e.\u0275\u0275property("ngTemplateOutlet",t)("ngTemplateOutletContext",e.\u0275\u0275pureFunction1(3,na,e.\u0275\u0275pureFunction0(2,zf)))}}function Yf(i,n){1&i&&e.\u0275\u0275elementContainer(0)}const ir=function(){return{text:"device.connectivity.coaps-x509-command",href:"https://thingsboard.io/docs/user-guide/ssl/coap-x509-certificates/"}},ar=function(i,n,t){return{noSecLabel:"CoAP",noSec:i,secLabel:"CoAPs",sec:n,doc:t}};function Qf(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",36),e.\u0275\u0275template(1,Kf,5,5,"div",47),e.\u0275\u0275template(2,Yf,1,0,"ng-container",38),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275nextContext(3),a=e.\u0275\u0275reference(23);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf","Check documentation"!==t.commands.coap.coaps),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngTemplateOutlet",a)("ngTemplateOutletContext",e.\u0275\u0275pureFunction1(8,Qe,e.\u0275\u0275pureFunction3(4,ar,t.commands.coap.coap,t.commands.coap.coaps,e.\u0275\u0275pureFunction0(3,ir))))}}function Xf(i,n){1&i&&(e.\u0275\u0275element(0,"mat-icon",46),e.\u0275\u0275text(1," Docker "))}function Zf(i,n){1&i&&e.\u0275\u0275elementContainer(0)}function eh(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",36),e.\u0275\u0275template(1,Zf,1,0,"ng-container",38),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275nextContext(4),a=e.\u0275\u0275reference(23);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngTemplateOutlet",a)("ngTemplateOutletContext",e.\u0275\u0275pureFunction1(7,Qe,e.\u0275\u0275pureFunction3(3,ar,t.commands.coap.docker.coap,t.commands.coap.docker.coaps,e.\u0275\u0275pureFunction0(2,ir))))}}function th(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-tab"),e.\u0275\u0275template(1,Xf,2,0,"ng-template",33),e.\u0275\u0275template(2,eh,2,9,"ng-template",34),e.\u0275\u0275elementEnd())}function nh(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",31),e.\u0275\u0275text(1,"device.connectivity.use-following-instructions"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(2,"mat-tab-group",32),e.\u0275\u0275listener("selectedIndexChange",function(o){e.\u0275\u0275restoreView(t);const s=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(s.coapTabIndex=o)}),e.\u0275\u0275elementStart(3,"mat-tab"),e.\u0275\u0275template(4,qf,2,0,"ng-template",33),e.\u0275\u0275template(5,Qf,3,10,"ng-template",34),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(6,th,3,0,"mat-tab",44),e.\u0275\u0275elementEnd()}if(2&i){const t=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(2),e.\u0275\u0275property("selectedIndex",t.coapTabIndex),e.\u0275\u0275advance(4),e.\u0275\u0275property("ngIf",!!t.commands.coap.docker)}}function ih(i,n){1&i&&e.\u0275\u0275elementContainer(0)}const ah=function(){return{text:"device.connectivity.snmp-command",href:"https://thingsboard.io/docs/reference/snmp-api/"}};function oh(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",21),e.\u0275\u0275template(1,ih,1,0,"ng-container",38),e.\u0275\u0275elementEnd()),2&i){e.\u0275\u0275nextContext(2);const t=e.\u0275\u0275reference(25);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngTemplateOutlet",t)("ngTemplateOutletContext",e.\u0275\u0275pureFunction1(3,na,e.\u0275\u0275pureFunction0(2,ah)))}}function rh(i,n){1&i&&e.\u0275\u0275elementContainer(0)}const sh=function(){return{text:"device.connectivity.lwm2m-command",href:"https://thingsboard.io/docs/reference/lwm2m-api/"}};function lh(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",21),e.\u0275\u0275template(1,rh,1,0,"ng-container",38),e.\u0275\u0275elementEnd()),2&i){e.\u0275\u0275nextContext(2);const t=e.\u0275\u0275reference(25);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngTemplateOutlet",t)("ngTemplateOutletContext",e.\u0275\u0275pureFunction1(3,na,e.\u0275\u0275pureFunction0(2,sh)))}}function dh(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",50)(1,"div",51),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"date"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"div",51),e.\u0275\u0275text(5),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(6,"div",51),e.\u0275\u0275text(7),e.\u0275\u0275elementEnd()()),2&i){const t=n.$implicit;e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind2(3,3,t.lastUpdateTs,"yyyy-MM-dd HH:mm:ss")),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(t.key),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(t.value)}}function ch(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",48),e.\u0275\u0275template(1,dh,8,6,"div",49),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",t.latestTelemetry)}}const ph=function(i,n){return{inactive:i,hide:n}};function mh(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"section",14)(1,"tb-toggle-header",15,16),e.\u0275\u0275template(3,rf,3,4,"tb-toggle-option",17),e.\u0275\u0275template(4,sf,3,4,"tb-toggle-option",17),e.\u0275\u0275template(5,lf,3,4,"tb-toggle-option",17),e.\u0275\u0275template(6,df,3,4,"tb-toggle-option",17),e.\u0275\u0275template(7,cf,3,4,"tb-toggle-option",17),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(8,"div",18),e.\u0275\u0275elementContainerStart(9,19),e.\u0275\u0275template(10,_f,12,1,"ng-template",20),e.\u0275\u0275template(11,Wf,3,2,"ng-template",20),e.\u0275\u0275template(12,nh,7,2,"ng-template",20),e.\u0275\u0275template(13,oh,2,5,"ng-template",20),e.\u0275\u0275template(14,lh,2,5,"ng-template",20),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(15,"div",21)(16,"div",22)(17,"div",23),e.\u0275\u0275text(18,"device.state"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(19,"div",24),e.\u0275\u0275text(20),e.\u0275\u0275pipe(21,"translate"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(22,"div",25),e.\u0275\u0275text(23,"attribute.latest-telemetry"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(24,"div",26)(25,"div",27)(26,"div",28),e.\u0275\u0275text(27,"device.time"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(28,"div",28),e.\u0275\u0275text(29,"attribute.key"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(30,"div",28),e.\u0275\u0275text(31,"attribute.value"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(32,ch,2,1,"div",29),e.\u0275\u0275elementEnd()()()),2&i){const t=e.\u0275\u0275reference(2),a=e.\u0275\u0275nextContext(),o=e.\u0275\u0275reference(21);e.\u0275\u0275advance(1),e.\u0275\u0275propertyInterpolate("value",a.selectTransportType),e.\u0275\u0275property("fxHide",a.allowTransportType.size<2),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",a.allowTransportType.has(a.BasicTransportType.HTTP)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",a.allowTransportType.has(a.DeviceTransportType.MQTT)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",a.allowTransportType.has(a.DeviceTransportType.COAP)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",a.allowTransportType.has(a.DeviceTransportType.SNMP)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",a.allowTransportType.has(a.DeviceTransportType.LWM2M)),e.\u0275\u0275advance(1),e.\u0275\u0275property("fxHide",!a.allowTransportType.size),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitch",t.value),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase",a.BasicTransportType.HTTP),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase",a.DeviceTransportType.MQTT),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase",a.DeviceTransportType.COAP),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase",a.DeviceTransportType.SNMP),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase",a.DeviceTransportType.LWM2M),e.\u0275\u0275advance(5),e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction2(20,ph,!a.status,void 0===a.status)),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(21,18,a.status?"device.active":"device.inactive")," "),e.\u0275\u0275advance(12),e.\u0275\u0275property("ngIf",a.latestTelemetry.length)("ngIfElse",o)}}function uh(i,n){1&i&&(e.\u0275\u0275elementStart(0,"div",52),e.\u0275\u0275element(1,"mat-spinner",53),e.\u0275\u0275elementStart(2,"span",54),e.\u0275\u0275text(3),e.\u0275\u0275pipe(4,"translate"),e.\u0275\u0275elementEnd()()),2&i&&(e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(4,1,"device.connectivity.loading-check-connectivity-command")," "))}function gh(i,n){1&i&&(e.\u0275\u0275elementStart(0,"div",55),e.\u0275\u0275element(1,"div",56),e.\u0275\u0275elementStart(2,"div",31),e.\u0275\u0275text(3,"attribute.no-latest-telemetry"),e.\u0275\u0275elementEnd()())}function fh(i,n){if(1&i&&e.\u0275\u0275element(0,"tb-markdown",41),2&i){const t=e.\u0275\u0275nextContext().cmd,a=e.\u0275\u0275nextContext();e.\u0275\u0275property("data",a.createMarkDownCommand(t.noSec))}}function hh(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div"),e.\u0275\u0275element(1,"tb-markdown",41),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275nextContext(2).cmd,a=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("data",a.createMarkDownCommand(t.sec))}}function bh(i,n){1&i&&e.\u0275\u0275elementContainer(0)}function yh(i,n){if(1&i&&e.\u0275\u0275template(0,bh,1,0,"ng-container",38),2&i){const t=e.\u0275\u0275nextContext(2).cmd;e.\u0275\u0275nextContext();const a=e.\u0275\u0275reference(25);e.\u0275\u0275property("ngTemplateOutlet",a)("ngTemplateOutletContext",e.\u0275\u0275pureFunction1(2,na,t.doc))}}function vh(i,n){if(1&i&&(e.\u0275\u0275template(0,hh,2,1,"div",62),e.\u0275\u0275template(1,yh,1,4,"ng-template",null,63,e.\u0275\u0275templateRefExtractor)),2&i){const t=e.\u0275\u0275reference(2),a=e.\u0275\u0275nextContext().cmd;e.\u0275\u0275property("ngIf","Check documentation"!==a.sec)("ngIfElse",t)}}function _h(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",21)(1,"div",57)(2,"div",23),e.\u0275\u0275text(3,"device.connectivity.execute-following-command"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"tb-toggle-header",58,59)(6,"tb-toggle-option",60),e.\u0275\u0275text(7),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(8,"tb-toggle-option",61),e.\u0275\u0275text(9),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementContainerStart(10,19),e.\u0275\u0275template(11,fh,1,1,"ng-template",20),e.\u0275\u0275template(12,vh,3,2,"ng-template",20),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275elementEnd()),2&i){const t=n.cmd,a=e.\u0275\u0275reference(5);e.\u0275\u0275advance(1),e.\u0275\u0275property("fxHide",!(t.noSec||"Check documentation"!==t.sec)),e.\u0275\u0275advance(3),e.\u0275\u0275propertyInterpolate("value",t.noSec?"noSec":"sec"),e.\u0275\u0275property("fxShow",t.noSec&&t.sec),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(t.noSecLabel),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(t.secLabel),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitch",a.value),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase","noSec"),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase","sec")}}function xh(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",64)(1,"div",65),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"a",66)(5,"mat-icon"),e.\u0275\u0275text(6,"description"),e.\u0275\u0275elementEnd(),e.\u0275\u0275text(7),e.\u0275\u0275pipe(8,"translate"),e.\u0275\u0275elementEnd()()),2&i){const t=n.doc;e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(3,3,t.text)),e.\u0275\u0275advance(2),e.\u0275\u0275propertyInterpolate("href",t.href,e.\u0275\u0275sanitizeUrl),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(8,5,"common.documentation")," ")}}class ia extends le.a{constructor(n,t,a,o,s,l,d){super(n,t,o),this.store=n,this.router=t,this.data=a,this.dialogRef=o,this.deviceService=s,this.telemetryWsService=l,this.zone=d,this.loadedCommand=!1,this.latestTelemetry=[],this.allowTransportType=new Set,this.BasicTransportType=R.KH,this.DeviceTransportType=R.dH,this.deviceTransportTypeTranslationMap=R.GX,this.notShowAgain=!1,this.httpTabIndex=0,this.mqttTabIndex=0,this.coapTabIndex=0,this.currentTime=Date.now(),this.transportTypes=[...Object.keys(R.KH),...Object.keys(R.dH)],this.data.afterAdd?(this.dialogTitle="device.connectivity.device-created-check-connectivity",this.showDontShowAgain=!0):(this.dialogTitle="device.connectivity.check-connectivity",this.showDontShowAgain=!1)}ngOnInit(){this.loadCommands(),this.subscribeToLatestTelemetry()}ngOnDestroy(){super.ngOnDestroy(),this.telemetrySubscriber?.complete(),this.telemetrySubscriber?.unsubscribe()}close(){this.notShowAgain&&this.showDontShowAgain?(this.store.dispatch(new ho.BG({notDisplayConnectivityAfterAddDevice:!0})),this.dialogRef.close(null)):this.dialogRef.close(null)}createMarkDownCommand(n){if(Array.isArray(n)){const t=[];return n.forEach(a=>t.push(this.createMarkDownSingleCommand(a))),t.join("\n<br />\n\n")}return this.createMarkDownSingleCommand(n)}createMarkDownSingleCommand(n){return"```bash\n"+n+"{:copy-code}\n```"}loadCommands(){this.deviceService.getDevicePublishTelemetryCommands(this.data.deviceId.id).subscribe(n=>{this.commands=n;const t=Object.keys(n);this.transportTypes.forEach(a=>{t.find(s=>s.toUpperCase().startsWith(a))&&this.allowTransportType.add(a)}),this.selectTransportType=this.allowTransportType.values().next().value,this.selectTabIndexForUserOS(),this.loadedCommand=!0})}subscribeToLatestTelemetry(){this.store.pipe((0,x.select)(q.un)).pipe((0,Re.q)(1)).subscribe(n=>{if(this.telemetrySubscriber=ta.xb.createEntityAttributesSubscription(this.telemetryWsService,this.data.deviceId,ta.B5.LATEST_TELEMETRY,this.zone),!n){const t=new ta.Md;t.entityType=this.data.deviceId.entityType,t.entityId=this.data.deviceId.id,t.scope=ta.My.SERVER_SCOPE,t.keys="active",this.telemetrySubscriber.subscriptionCommands.push(t)}this.telemetrySubscriber.subscribe(),this.telemetrySubscriber.attributeData$().subscribe(t=>{const a=t.reduce((o,s)=>("active"===s.key?this.status=(0,ue.coerceBooleanProperty)(s.value):s.lastUpdateTs>this.currentTime&&o.push(s),o),[]);this.latestTelemetry=a.sort((o,s)=>s.lastUpdateTs-o.lastUpdateTs)})})}selectTabIndexForUserOS(){switch((0,T.Ij)()){case"linux":case"android":this.httpTabIndex=2,this.mqttTabIndex=2;break;case"macos":case"ios":this.httpTabIndex=1,this.mqttTabIndex=1,this.coapTabIndex=1;break;case"windows":this.httpTabIndex=0,this.mqttTabIndex=0,this.coapTabIndex=1;break;default:this.mqttTabIndex=this.commands.mqtt?.docker?3:0,this.coapTabIndex=this.commands.coap?.docker?1:0}}}ia.\u0275fac=function(n){return new(n||ia)(e.\u0275\u0275directiveInject(x.Store),e.\u0275\u0275directiveInject(b.Router),e.\u0275\u0275directiveInject(C.MAT_DIALOG_DATA),e.\u0275\u0275directiveInject(C.MatDialogRef),e.\u0275\u0275directiveInject(yo.U),e.\u0275\u0275directiveInject(of.h),e.\u0275\u0275directiveInject(e.NgZone))},ia.\u0275cmp=e.\u0275\u0275defineComponent({type:ia,selectors:[["tb-device-check-connectivity-dialog"]],features:[e.\u0275\u0275InheritDefinitionFeature],decls:26,vars:14,consts:[["color","primary"],["translate",""],["fxFlex",""],["mat-icon-button","","type","button",3,"click"],[1,"material-icons"],["mat-dialog-content",""],["class","tb-form-panel no-padding no-border",4,"ngIf","ngIfElse"],["mat-dialog-actions","",1,"tb-dialog-actions"],[3,"fxShow","ngModel","ngModelChange"],["mat-button","",3,"disabled","click"],["loadingCommand",""],["noData",""],["executeCommand",""],["seeDocumentation",""],[1,"tb-form-panel","no-padding","no-border"],["name","TransportProtocol","useSelectOnMdLg","false","appearance","fill",3,"value","fxHide"],["transportProtocol",""],[3,"value",4,"ngIf"],[1,"tb-form-panel","no-padding","no-border",3,"fxHide"],[3,"ngSwitch"],[3,"ngSwitchCase"],[1,"tb-form-panel","stroked"],["fxFlex","","fxLayout","row"],["translate","",1,"tb-form-panel-title"],[1,"status",3,"ngClass"],["translate","",1,"tb-form-panel-hint","tb-font-14"],[1,"tb-form-table"],[1,"tb-form-table-header"],["fxFlex","","translate","",1,"tb-form-table-header-cell"],["class","tb-form-table-body",4,"ngIf","ngIfElse"],[3,"value"],["translate","",1,"tb-no-data-text"],[3,"selectedIndex","selectedIndexChange"],["mat-tab-label",""],["matTabContent",""],["svgIcon","windows",1,"tabs-icon"],[1,"tb-form-panel","no-padding","no-border","tb-tab-body"],["translate","",1,"tb-install-instruction-text"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["svgIcon","macos",1,"tabs-icon"],["svgIcon","linux",1,"tabs-icon"],["usePlainMarkdown","","containerClass","tb-command-code",3,"data"],["class","tb-form-panel stroked",4,"ngIf","ngIfElse"],["mqttCommands",""],[4,"ngIf"],[1,"tb-install-instruction-text"],["svgIcon","docker",1,"tabs-icon"],["class","tb-form-panel stroked",4,"ngIf"],[1,"tb-form-table-body"],["class","tb-form-table-row",4,"ngFor","ngForOf"],[1,"tb-form-table-row"],["fxFlex","",1,"tb-form-table-row-cell"],[1,"tb-loader"],["color","accent","diameter","65","strokeWidth","4"],[1,"mat-subtitle-1","label"],[1,"tb-no-data-available"],[1,"tb-no-data-bg"],["fxLayout","row","fxLayoutAlign","space-between center",3,"fxHide"],["name","protocolType","useSelectOnMdLg","false",3,"value","fxShow"],["protocolType",""],["value","noSec"],["value","sec"],[4,"ngIf","ngIfElse"],["checkDocumentation",""],[1,"tb-form-row","no-border","no-padding","space-between"],[1,"tb-font-14","tb-flex-1"],["mat-stroked-button","","color","primary","target","_blank",3,"href"]],template:function(n,t){if(1&n&&(e.\u0275\u0275elementStart(0,"mat-toolbar",0)(1,"h2",1),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(3,"span",2),e.\u0275\u0275elementStart(4,"button",3),e.\u0275\u0275listener("click",function(){return t.close()}),e.\u0275\u0275elementStart(5,"mat-icon",4),e.\u0275\u0275text(6,"close"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(7,"div",5),e.\u0275\u0275template(8,mh,33,23,"section",6),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(9,"div",7)(10,"mat-slide-toggle",8),e.\u0275\u0275listener("ngModelChange",function(o){return t.notShowAgain=o}),e.\u0275\u0275text(11),e.\u0275\u0275pipe(12,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(13,"span",2),e.\u0275\u0275elementStart(14,"button",9),e.\u0275\u0275listener("click",function(){return t.close()}),e.\u0275\u0275pipe(15,"async"),e.\u0275\u0275text(16),e.\u0275\u0275pipe(17,"translate"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(18,uh,5,3,"ng-template",null,10,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(20,gh,4,0,"ng-template",null,11,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(22,_h,13,8,"ng-template",null,12,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(24,xh,9,7,"ng-template",null,13,e.\u0275\u0275templateRefExtractor)),2&n){const a=e.\u0275\u0275reference(19);e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(t.dialogTitle),e.\u0275\u0275advance(6),e.\u0275\u0275property("ngIf",t.loadedCommand)("ngIfElse",a),e.\u0275\u0275advance(2),e.\u0275\u0275propertyInterpolate("fxShow",t.showDontShowAgain),e.\u0275\u0275property("ngModel",t.notShowAgain),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(12,8,"action.dont-show-again")),e.\u0275\u0275advance(3),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(15,10,t.isLoading$)),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(17,12,"action.close"))}},dependencies:[p.NgClass,p.NgForOf,p.NgIf,p.NgTemplateOutlet,p.NgSwitch,p.NgSwitchCase,nr.TbMarkdownComponent,S.MatAnchor,S.MatButton,S.MatIconButton,F.MatIcon,oe.MatToolbar,C.MatDialogContent,C.MatDialogActions,Ga.MatProgressSpinner,H.MatTabContent,H.MatTabLabel,H.MatTab,H.MatTabGroup,Ce.MatSlideToggle,h.DefaultLayoutDirective,h.DefaultLayoutAlignDirective,h.DefaultFlexDirective,G.DefaultShowHideDirective,G.DefaultClassDirective,r.NgControlStatus,r.NgModel,g.TranslateDirective,io.ToggleHeaderComponent,io.ToggleOption,p.AsyncPipe,p.DatePipe,g.TranslatePipe],styles:['@charset "UTF-8";[_nghost-%COMP%]{height:100%;max-height:100vh;display:grid;grid-template-rows:min-content minmax(auto,1fr) min-content}[_nghost-%COMP%]   .tb-loader[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;gap:16px;height:300px;max-height:100%}[_nghost-%COMP%]   .tb-loader[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{margin-bottom:0;text-align:center}[_nghost-%COMP%]   .status[_ngcontent-%COMP%]{margin-left:12px;border-radius:12px;height:24px;line-height:24px;padding:0 8px;width:-moz-fit-content;width:fit-content;color:#198038;background-color:#19803814;font-size:14px}[_nghost-%COMP%]   .status.inactive[_ngcontent-%COMP%]{color:#d12730;background-color:#d1273014}[_nghost-%COMP%]   .tb-hint-instruction[_ngcontent-%COMP%]{border-radius:6px;background-color:#3056800a;padding:6px 16px}[_nghost-%COMP%]   .tb-hint-instruction[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{vertical-align:middle}[_nghost-%COMP%]   .tb-font-14[_ngcontent-%COMP%]{font-size:14px}[_nghost-%COMP%]   .tb-flex-1[_ngcontent-%COMP%]{flex:1}[_nghost-%COMP%]   .tb-form-table-body[_ngcontent-%COMP%]{max-height:108px;min-height:108px;overflow-y:auto;scrollbar-gutter:stable}[_nghost-%COMP%]   .tb-form-table-body[_ngcontent-%COMP%]   .tb-form-table-row[_ngcontent-%COMP%]{min-height:38px}[_nghost-%COMP%]   .tb-no-data-available[_ngcontent-%COMP%]   .tb-no-data-bg[_ngcontent-%COMP%]{min-height:68px}[_nghost-%COMP%]   .tb-install-instruction-text[_ngcontent-%COMP%]{min-height:42px}@media screen and (min-width: 600px) and (max-width: 959px){[_nghost-%COMP%]{width:470px}}@media screen and (min-width: 960px){[_nghost-%COMP%]{width:720px}}.mat-mdc-dialog-container[_nghost-%COMP%]   .tb-dialog-actions[_ngcontent-%COMP%], .mat-mdc-dialog-container   [_nghost-%COMP%]   .tb-dialog-actions[_ngcontent-%COMP%]{display:flex;gap:8px;padding:8px 16px}.mat-mdc-dialog-container[_nghost-%COMP%]   .mat-mdc-dialog-content[_ngcontent-%COMP%], .mat-mdc-dialog-container   [_nghost-%COMP%]   .mat-mdc-dialog-content[_ngcontent-%COMP%]{max-height:80vh;padding:16px}[_nghost-%COMP%]     .tb-markdown-view .tb-command-code .code-wrapper{padding:0}[_nghost-%COMP%]     .tb-markdown-view .tb-command-code .code-wrapper pre[class*=language-]{margin:0;background:#F3F6FA;border-color:#305680;padding-right:38px;overflow:scroll;padding-bottom:4px}[_nghost-%COMP%]     .tb-markdown-view .tb-command-code .code-wrapper pre[class*=language-]::-webkit-scrollbar{width:4px;height:4px}[_nghost-%COMP%]     .tb-markdown-view .tb-command-code button.clipboard-btn{right:-2px}[_nghost-%COMP%]     .tb-markdown-view .tb-command-code button.clipboard-btn p{color:#305680}[_nghost-%COMP%]     .tb-markdown-view .tb-command-code button.clipboard-btn p, [_nghost-%COMP%]     .tb-markdown-view .tb-command-code button.clipboard-btn div{background-color:#f3f6fa}[_nghost-%COMP%]     .tb-markdown-view .tb-command-code button.clipboard-btn div img{display:none}[_nghost-%COMP%]     .tb-markdown-view .tb-command-code button.clipboard-btn div:after{content:"";position:initial;display:block;width:18px;height:18px;background:#305680;-webkit-mask-image:url(/assets/copy-code-icon.svg);mask-image:url(/assets/copy-code-icon.svg);-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat}[_nghost-%COMP%]     .mdc-button__label>span .mat-icon{vertical-align:text-bottom;box-sizing:initial}[_nghost-%COMP%]     .tabs-icon{margin-right:8px}[_nghost-%COMP%]     .tb-form-panel.tb-tab-body{padding:16px 0 0}']});class Ie{constructor(n,t,a,o,s,l,d,m,y,I,E){this.store=n,this.broadcast=t,this.deviceService=a,this.customerService=o,this.dialogService=s,this.edgeService=l,this.homeDialogs=d,this.translate=m,this.datePipe=y,this.router=I,this.dialog=E,this.config=new v.ap,this.config.entityType=f.py.DEVICE,this.config.entityComponent=Xi,this.config.entityTabsComponent=ea,this.config.entityTranslations=f.Jr.get(f.py.DEVICE),this.config.entityResources=f.CZ.get(f.py.DEVICE),this.config.addDialogStyle={width:"600px"},this.config.deleteEntityTitle=L=>this.translate.instant("device.delete-device-title",{deviceName:L.name}),this.config.deleteEntityContent=()=>this.translate.instant("device.delete-device-text"),this.config.deleteEntitiesTitle=L=>this.translate.instant("device.delete-devices-title",{count:L}),this.config.deleteEntitiesContent=()=>this.translate.instant("device.delete-devices-text"),this.config.loadEntity=L=>this.deviceService.getDeviceInfo(L.id),this.config.saveEntity=L=>this.deviceService.saveDevice(L).pipe((0,Z.b)(()=>{this.broadcast.broadcast("deviceSaved")}),(0,ne.z)(ae=>this.deviceService.getDeviceInfo(ae.id.id))),this.config.onEntityAction=L=>this.onDeviceAction(L,this.config),this.config.detailsReadonly=()=>"customer_user"===this.config.componentsData.deviceScope||"edge_customer_user"===this.config.componentsData.deviceScope,this.config.onLoadAction=L=>this.onLoadAction(L),this.config.headerComponent=Zi}resolve(n){const t=n.params;return this.config.componentsData={deviceScope:n.data.devicesType,deviceInfoFilter:{},deviceCredentials$:new be.x,edgeId:t.edgeId},this.customerId=t.customerId,this.config.componentsData.edgeId=t.edgeId,this.store.pipe((0,x.select)(q.rk),(0,Re.q)(1)).pipe((0,Z.b)(a=>{a.authority===u.W.CUSTOMER_USER&&("edge"===n.data.devicesType?this.config.componentsData.deviceScope="edge_customer_user":this.config.componentsData.deviceScope="customer_user",this.customerId=a.customerId)}),(0,ne.z)(()=>this.customerId?this.customerService.getCustomer(this.customerId):(0,J.of)(null)),(0,re.U)(a=>(a?a.additionalInfo&&a.additionalInfo.isPublic?this.config.tableTitle=this.translate.instant("customer.public-devices"):this.config.tableTitle=a.title+": "+this.translate.instant("device.devices"):"edge"===this.config.componentsData.deviceScope?this.edgeService.getEdge(this.config.componentsData.edgeId).subscribe(o=>this.config.tableTitle=o.name+": "+this.translate.instant("device.devices")):this.config.tableTitle=this.translate.instant("device.devices"),this.config.columns=this.configureColumns(this.config.componentsData.deviceScope),this.configureEntityFunctions(this.config.componentsData.deviceScope),this.config.cellActionDescriptors=this.configureCellActions(this.config.componentsData.deviceScope),this.config.groupActionDescriptors=this.configureGroupActions(this.config.componentsData.deviceScope),this.config.addActionDescriptors=this.configureAddActions(this.config.componentsData.deviceScope),this.config.addEnabled=!("customer_user"===this.config.componentsData.deviceScope||"edge_customer_user"===this.config.componentsData.deviceScope),this.config.entitiesDeleteEnabled="tenant"===this.config.componentsData.deviceScope,this.config.deleteEnabled=()=>"tenant"===this.config.componentsData.deviceScope,this.config)))}onLoadAction(n){const t=n.snapshot.queryParams;if(t){const a=(0,T.I8)(t);let o=!1;t?.deviceProfileId&&(this.config.componentsData.deviceInfoFilter.deviceProfileId=new af.h(t?.deviceProfileId),delete a.deviceProfileId,o=!0),(0,T.$K)(t?.active)&&(this.config.componentsData.deviceInfoFilter.active=!0===t?.active||"true"===t?.active,delete a.active,o=!0),o&&this.router.navigate([],{relativeTo:n,queryParams:a,queryParamsHandling:"",replaceUrl:!0})}}configureColumns(n){const t=[new v.eq("createdTime","common.created-time",this.datePipe,"150px"),new v.QI("name","device.name","25%"),new v.QI("deviceProfileName","device-profile.device-profile","25%"),new v.QI("label","device.label","25%"),new v.QI("active","device.state","80px",a=>this.deviceState(a),a=>this.deviceStateStyle(a))];return"tenant"===n&&t.push(new v.QI("customerTitle","customer.customer","25%"),new v.QI("customerIsPublic","device.public","60px",a=>(0,v.Gj)(a.customerIsPublic),()=>({}))),t.push(new v.QI("gateway","device.is-gateway","60px",a=>(0,v.Gj)(a.additionalInfo&&a.additionalInfo.gateway),()=>({}),!1)),t}deviceState(n){let t="device.active",a="rgba(25, 128, 56, 0.08)";return n.active||(t="device.inactive",a="rgba(209, 39, 48, 0.08)"),`<div class="status" style="border-radius: 16px; height: 32px;\n                line-height: 32px; padding: 0 12px; width: fit-content; background-color: ${a}">\n                ${this.translate.instant(t)}\n            </div>`}deviceStateStyle(n){const t={fontSize:"14px",color:"#198038",cursor:"pointer"};return n.active||(t.color="#d12730"),t}configureEntityFunctions(n){this.config.entitiesFetchFunction=t=>this.deviceService.getDeviceInfosByQuery(this.prepareDeviceInfoQuery(t)),this.config.deleteEntity="tenant"===n?t=>this.deviceService.deleteDevice(t.id):()=>(0,J.of)()}prepareDeviceInfoQuery(n){const t=(0,T.I8)(this.config.componentsData.deviceInfoFilter);return"edge"===this.config.componentsData.deviceScope||"edge_customer_user"===this.config.componentsData.deviceScope?t.edgeId=new nf.U(this.config.componentsData.edgeId):"tenant"!==this.config.componentsData.deviceScope&&(t.customerId=new bo.u(this.customerId)),new R.Ts(n,t)}configureCellActions(n){const t=[];return"tenant"===n&&t.push({name:this.translate.instant("device.make-public"),icon:"share",isEnabled:a=>!a.customerId||a.customerId.id===P._,onAction:(a,o)=>this.makePublic(a,o)},{name:this.translate.instant("device.assign-to-customer"),icon:"assignment_ind",isEnabled:a=>!a.customerId||a.customerId.id===P._,onAction:(a,o)=>this.assignToCustomer(a,[o.id])},{name:this.translate.instant("device.unassign-from-customer"),icon:"assignment_return",isEnabled:a=>a.customerId&&a.customerId.id!==P._&&!a.customerIsPublic,onAction:(a,o)=>this.unassignFromCustomer(a,o)},{name:this.translate.instant("device.make-private"),icon:"reply",isEnabled:a=>a.customerId&&a.customerId.id!==P._&&a.customerIsPublic,onAction:(a,o)=>this.unassignFromCustomer(a,o)},{name:this.translate.instant("device.manage-credentials"),icon:"security",isEnabled:()=>!0,onAction:(a,o)=>this.manageCredentials(a,o)}),"customer"===n&&t.push({name:this.translate.instant("device.unassign-from-customer"),icon:"assignment_return",isEnabled:a=>a.customerId&&a.customerId.id!==P._&&!a.customerIsPublic,onAction:(a,o)=>this.unassignFromCustomer(a,o)},{name:this.translate.instant("device.make-private"),icon:"reply",isEnabled:a=>a.customerId&&a.customerId.id!==P._&&a.customerIsPublic,onAction:(a,o)=>this.unassignFromCustomer(a,o)},{name:this.translate.instant("device.manage-credentials"),icon:"security",isEnabled:()=>!0,onAction:(a,o)=>this.manageCredentials(a,o)}),("customer_user"===n||"edge_customer_user"===n)&&t.push({name:this.translate.instant("device.view-credentials"),icon:"security",isEnabled:()=>!0,onAction:(a,o)=>this.manageCredentials(a,o)}),"edge"===n&&t.push({name:this.translate.instant("edge.unassign-from-edge"),icon:"assignment_return",isEnabled:a=>!0,onAction:(a,o)=>this.unassignFromEdge(a,o)}),t}configureGroupActions(n){const t=[];return"tenant"===n&&t.push({name:this.translate.instant("device.assign-devices"),icon:"assignment_ind",isEnabled:!0,onAction:(a,o)=>this.assignToCustomer(a,o.map(s=>s.id))}),"customer"===n&&t.push({name:this.translate.instant("device.unassign-devices"),icon:"assignment_return",isEnabled:!0,onAction:(a,o)=>this.unassignDevicesFromCustomer(a,o)}),"edge"===n&&t.push({name:this.translate.instant("device.unassign-devices-from-edge"),icon:"assignment_return",isEnabled:!0,onAction:(a,o)=>this.unassignDevicesFromEdge(a,o)}),t}configureAddActions(n){this.config.addEntity=null;const t=[];return"tenant"===n&&(t.push({name:this.translate.instant("device.add-device-text"),icon:"insert_drive_file",isEnabled:()=>!0,onAction:a=>this.deviceWizard(a)},{name:this.translate.instant("device.import"),icon:"file_upload",isEnabled:()=>!0,onAction:a=>this.importDevices(a)}),this.config.addEntity=()=>(this.deviceWizard(null),(0,J.of)(null))),"customer"===n&&t.push({name:this.translate.instant("device.assign-new-device"),icon:"add",isEnabled:()=>!0,onAction:a=>this.addDevicesToCustomer(a)}),"edge"===n&&t.push({name:this.translate.instant("device.assign-new-device"),icon:"add",isEnabled:()=>!0,onAction:a=>this.addDevicesToEdge(a)}),t}openDevice(n,t,a){n&&n.stopPropagation();const o=this.router.createUrlTree([t.id.id],{relativeTo:a.getActivatedRoute()});this.router.navigateByUrl(o)}importDevices(n){this.homeDialogs.importEntities(f.py.DEVICE).subscribe(t=>{t&&(this.broadcast.broadcast("deviceSaved"),this.config.updateData())})}deviceWizard(n){this.dialog.open(tf.DeviceWizardDialogComponent,{disableClose:!0,panelClass:["tb-dialog","tb-fullscreen-dialog"]}).afterClosed().subscribe(t=>{t&&this.store.pipe((0,x.select)((0,q.f6)("notDisplayConnectivityAfterAddDevice"))).pipe((0,Re.q)(1)).subscribe(a=>{a?this.config.updateData():this.checkConnectivity(null,t.id,!0)})})}addDevicesToCustomer(n){n&&n.stopPropagation(),this.dialog.open(Ka.J,{disableClose:!0,panelClass:["tb-dialog","tb-fullscreen-dialog"],data:{customerId:this.customerId,entityType:f.py.DEVICE}}).afterClosed().subscribe(t=>{t&&this.config.updateData()})}makePublic(n,t){n&&n.stopPropagation(),this.dialogService.confirm(this.translate.instant("device.make-public-device-title",{deviceName:t.name}),this.translate.instant("device.make-public-device-text"),this.translate.instant("action.no"),this.translate.instant("action.yes"),!0).subscribe(a=>{a&&this.deviceService.makeDevicePublic(t.id.id).subscribe(()=>{this.config.updateData()})})}assignToCustomer(n,t){n&&n.stopPropagation(),this.dialog.open(za.S,{disableClose:!0,panelClass:["tb-dialog","tb-fullscreen-dialog"],data:{entityIds:t,entityType:f.py.DEVICE}}).afterClosed().subscribe(a=>{a&&this.config.updateData()})}unassignFromCustomer(n,t){n&&n.stopPropagation();let o,s;t.customerIsPublic?(o=this.translate.instant("device.make-private-device-title",{deviceName:t.name}),s=this.translate.instant("device.make-private-device-text")):(o=this.translate.instant("device.unassign-device-title",{deviceName:t.name}),s=this.translate.instant("device.unassign-device-text")),this.dialogService.confirm(o,s,this.translate.instant("action.no"),this.translate.instant("action.yes"),!0).subscribe(l=>{l&&this.deviceService.unassignDeviceFromCustomer(t.id.id).subscribe(()=>{this.config.updateData("tenant"!==this.config.componentsData.deviceScope)})})}unassignDevicesFromCustomer(n,t){n&&n.stopPropagation(),this.dialogService.confirm(this.translate.instant("device.unassign-devices-title",{count:t.length}),this.translate.instant("device.unassign-devices-text"),this.translate.instant("action.no"),this.translate.instant("action.yes"),!0).subscribe(a=>{if(a){const o=[];t.forEach(s=>{o.push(this.deviceService.unassignDeviceFromCustomer(s.id.id))}),(0,xe.D)(o).subscribe(()=>{this.config.updateData()})}})}manageCredentials(n,t){n&&n.stopPropagation(),this.dialog.open(Kn,{disableClose:!0,panelClass:["tb-dialog","tb-fullscreen-dialog"],data:{deviceId:t.id.id,deviceProfileId:t.deviceProfileId.id,isReadOnly:"customer_user"===this.config.componentsData.deviceScope||"edge_customer_user"===this.config.componentsData.deviceScope}}).afterClosed().subscribe(a=>{(0,T.nu)(a)&&this.config.componentsData.deviceCredentials$.next(a)})}onDeviceAction(n,t){switch(n.action){case"open":return this.openDevice(n.event,n.entity,t),!0;case"makePublic":return this.makePublic(n.event,n.entity),!0;case"assignToCustomer":return this.assignToCustomer(n.event,[n.entity.id]),!0;case"unassignFromCustomer":return this.unassignFromCustomer(n.event,n.entity),!0;case"unassignFromEdge":return this.unassignFromEdge(n.event,n.entity),!0;case"manageCredentials":return this.manageCredentials(n.event,n.entity),!0;case"checkConnectivity":return this.checkConnectivity(n.event,n.entity.id),!0}return!1}addDevicesToEdge(n){n&&n.stopPropagation(),this.dialog.open(Ya.J,{disableClose:!0,panelClass:["tb-dialog","tb-fullscreen-dialog"],data:{edgeId:this.config.componentsData.edgeId,entityType:f.py.DEVICE}}).afterClosed().subscribe(t=>{t&&this.config.updateData()})}unassignFromEdge(n,t){n&&n.stopPropagation(),this.dialogService.confirm(this.translate.instant("device.unassign-device-from-edge-title",{deviceName:t.name}),this.translate.instant("device.unassign-device-from-edge-text"),this.translate.instant("action.no"),this.translate.instant("action.yes"),!0).subscribe(a=>{a&&this.deviceService.unassignDeviceFromEdge(this.config.componentsData.edgeId,t.id.id).subscribe(()=>{this.config.updateData("tenant"!==this.config.componentsData.deviceScope)})})}unassignDevicesFromEdge(n,t){n&&n.stopPropagation(),this.dialogService.confirm(this.translate.instant("device.unassign-devices-from-edge-title",{count:t.length}),this.translate.instant("device.unassign-devices-from-edge-text"),this.translate.instant("action.no"),this.translate.instant("action.yes"),!0).subscribe(a=>{if(a){const o=[];t.forEach(s=>{o.push(this.deviceService.unassignDeviceFromEdge(this.config.componentsData.edgeId,s.id.id))}),(0,xe.D)(o).subscribe(()=>{this.config.updateData()})}})}checkConnectivity(n,t,a=!1){n&&n.stopPropagation(),this.dialog.open(ia,{disableClose:!0,panelClass:["tb-dialog","tb-fullscreen-dialog"],data:{deviceId:t,afterAdd:a}}).afterClosed().subscribe(()=>{a&&this.config.updateData()})}}Ie.\u0275fac=function(n){return new(n||Ie)(e.\u0275\u0275inject(x.Store),e.\u0275\u0275inject(Pa.M),e.\u0275\u0275inject(yo.U),e.\u0275\u0275inject($e.v),e.\u0275\u0275inject(pe.x),e.\u0275\u0275inject(Yn.A),e.\u0275\u0275inject(lt.U),e.\u0275\u0275inject(g.TranslateService),e.\u0275\u0275inject(p.DatePipe),e.\u0275\u0275inject(b.Router),e.\u0275\u0275inject(C.MatDialog))},Ie.\u0275prov=e.\u0275\u0275defineInjectable({token:Ie,factory:Ie.\u0275fac});var Ch=c(19393),Th=c(77753),or=c(76340);function Sh(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"asset.name-required")," "))}function Ih(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"asset.name-max-length")," "))}function wh(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"asset.label-max-length")," "))}function Eh(i,n){if(1&i&&e.\u0275\u0275element(0,"tb-entity-autocomplete",20),2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275property("entityType",t.entityType.CUSTOMER)}}class aa extends Te.r{constructor(n,t,a,o,s,l){super(n,s,a,o,l),this.store=n,this.translate=t,this.entityValue=a,this.entitiesTableConfigValue=o,this.fb=s,this.cd=l,this.entityType=f.py}ngOnInit(){this.assetScope=this.entitiesTableConfig.componentsData.assetScope,super.ngOnInit()}hideDelete(){return!!this.entitiesTableConfig&&!this.entitiesTableConfig.deleteEnabled(this.entity)}isAssignedToCustomer(n){return n&&n.customerId&&n.customerId.id!==P._}buildForm(n){return this.fb.group({name:[n?n.name:"",[r.Validators.required,r.Validators.maxLength(255)]],assetProfileId:[n?n.assetProfileId:null,[r.Validators.required]],label:[n?n.label:"",r.Validators.maxLength(255)],customerId:[n?n.customerId:""],additionalInfo:this.fb.group({description:[n&&n.additionalInfo?n.additionalInfo.description:""]})})}updateForm(n){this.entityForm.patchValue({name:n.name}),this.entityForm.patchValue({assetProfileId:n.assetProfileId}),this.entityForm.patchValue({label:n.label}),this.entityForm.patchValue({customerId:n.customerId}),this.entityForm.patchValue({additionalInfo:{description:n.additionalInfo?n.additionalInfo.description:""}})}onAssetIdCopied(n){this.store.dispatch(new V.zi({message:this.translate.instant("asset.idCopiedMessage"),type:"success",duration:750,verticalPosition:"bottom",horizontalPosition:"right"}))}onAssetProfileUpdated(){this.entitiesTableConfig.updateData(!1)}}aa.\u0275fac=function(n){return new(n||aa)(e.\u0275\u0275directiveInject(x.Store),e.\u0275\u0275directiveInject(g.TranslateService),e.\u0275\u0275directiveInject("entity"),e.\u0275\u0275directiveInject("entitiesTableConfig"),e.\u0275\u0275directiveInject(r.UntypedFormBuilder),e.\u0275\u0275directiveInject(e.ChangeDetectorRef))},aa.\u0275cmp=e.\u0275\u0275defineComponent({type:aa,selectors:[["tb-asset"]],features:[e.\u0275\u0275InheritDefinitionFeature],decls:59,vars:60,consts:[["fxLayout.xs","column",1,"tb-details-buttons"],["mat-raised-button","","color","primary",3,"disabled","fxShow","click"],["fxLayout","row","fxLayout.xs","column"],["mat-raised-button","","ngxClipboard","",3,"cbContent","fxShow","cbOnSuccess"],["svgIcon","mdi:clipboard-arrow-left"],["translate",""],["fxLayout","column",1,"mat-padding"],[1,"mat-block",3,"fxShow"],["matInput","","disabled","",3,"ngModel"],[1,"tb-small",2,"padding-bottom","10px","padding-left","2px",3,"fxShow"],[3,"formGroup"],[3,"disabled"],[1,"mat-block"],["matInput","","formControlName","name","required",""],[4,"ngIf"],["matInput","","formControlName","label"],["required","","formControlName","assetProfileId",3,"selectDefaultProfile","showDetailsPageLink","assetProfileUpdated"],["useFullEntityId","","formControlName","customerId","labelText","asset.assign-to-customer",3,"entityType",4,"ngIf"],["formGroupName","additionalInfo"],["matInput","","formControlName","description","rows","2"],["useFullEntityId","","formControlName","customerId","labelText","asset.assign-to-customer",3,"entityType"]],template:function(n,t){1&n&&(e.\u0275\u0275elementStart(0,"div",0)(1,"button",1),e.\u0275\u0275listener("click",function(o){return t.onEntityAction(o,"open")}),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275text(3),e.\u0275\u0275pipe(4,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"button",1),e.\u0275\u0275listener("click",function(o){return t.onEntityAction(o,"makePublic")}),e.\u0275\u0275pipe(6,"async"),e.\u0275\u0275text(7),e.\u0275\u0275pipe(8,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(9,"button",1),e.\u0275\u0275listener("click",function(o){return t.onEntityAction(o,"assignToCustomer")}),e.\u0275\u0275pipe(10,"async"),e.\u0275\u0275text(11),e.\u0275\u0275pipe(12,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(13,"button",1),e.\u0275\u0275listener("click",function(o){return t.onEntityAction(o,"unassignFromCustomer")}),e.\u0275\u0275pipe(14,"async"),e.\u0275\u0275text(15),e.\u0275\u0275pipe(16,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(17,"button",1),e.\u0275\u0275listener("click",function(o){return t.onEntityAction(o,"unassignFromEdge")}),e.\u0275\u0275pipe(18,"async"),e.\u0275\u0275text(19),e.\u0275\u0275pipe(20,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(21,"button",1),e.\u0275\u0275listener("click",function(o){return t.onEntityAction(o,"delete")}),e.\u0275\u0275pipe(22,"async"),e.\u0275\u0275text(23),e.\u0275\u0275pipe(24,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(25,"div",2)(26,"button",3),e.\u0275\u0275listener("cbOnSuccess",function(o){return t.onAssetIdCopied(o)}),e.\u0275\u0275element(27,"mat-icon",4),e.\u0275\u0275elementStart(28,"span",5),e.\u0275\u0275text(29,"asset.copyId"),e.\u0275\u0275elementEnd()()()(),e.\u0275\u0275elementStart(30,"div",6)(31,"mat-form-field",7)(32,"mat-label",5),e.\u0275\u0275text(33,"asset.assignedToCustomer"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(34,"input",8),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(35,"div",9),e.\u0275\u0275text(36),e.\u0275\u0275pipe(37,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(38,"form",10)(39,"fieldset",11),e.\u0275\u0275pipe(40,"async"),e.\u0275\u0275elementStart(41,"mat-form-field",12)(42,"mat-label",5),e.\u0275\u0275text(43,"asset.name"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(44,"input",13),e.\u0275\u0275template(45,Sh,3,3,"mat-error",14),e.\u0275\u0275template(46,Ih,3,3,"mat-error",14),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(47,"mat-form-field",12)(48,"mat-label",5),e.\u0275\u0275text(49,"asset.label"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(50,"input",15),e.\u0275\u0275template(51,wh,3,3,"mat-error",14),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(52,"tb-asset-profile-autocomplete",16),e.\u0275\u0275listener("assetProfileUpdated",function(){return t.onAssetProfileUpdated()}),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(53,Eh,1,1,"tb-entity-autocomplete",17),e.\u0275\u0275elementStart(54,"div",18)(55,"mat-form-field",12)(56,"mat-label",5),e.\u0275\u0275text(57,"asset.description"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(58,"textarea",19),e.\u0275\u0275elementEnd()()()()()),2&n&&(e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(2,32,t.isLoading$))("fxShow",!t.isEdit&&!t.isDetailsPage),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(4,34,"common.open-details-page")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(6,36,t.isLoading$))("fxShow",!(t.isEdit||"tenant"!==t.assetScope||t.isAssignedToCustomer(t.entity)||null!=t.entity&&t.entity.customerIsPublic)),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(8,38,"asset.make-public")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(10,40,t.isLoading$))("fxShow",!t.isEdit&&"tenant"===t.assetScope&&!t.isAssignedToCustomer(t.entity)),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(12,42,"asset.assign-to-customer")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(14,44,t.isLoading$))("fxShow",!t.isEdit&&("customer"===t.assetScope||"tenant"===t.assetScope)&&t.isAssignedToCustomer(t.entity)),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(16,46,null!=t.entity&&t.entity.customerIsPublic?"asset.make-private":"asset.unassign-from-customer")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(18,48,t.isLoading$))("fxShow",!t.isEdit&&"edge"===t.assetScope),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(20,50,"edge.unassign-from-edge")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(22,52,t.isLoading$))("fxShow",!t.hideDelete()&&!t.isEdit),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(24,54,"asset.delete")," "),e.\u0275\u0275advance(3),e.\u0275\u0275property("cbContent",null==t.entity||null==t.entity.id?null:t.entity.id.id)("fxShow",!t.isEdit),e.\u0275\u0275advance(5),e.\u0275\u0275property("fxShow",!t.isEdit&&t.isAssignedToCustomer(t.entity)&&!(null!=t.entity&&t.entity.customerIsPublic)&&"tenant"===t.assetScope),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngModel",null==t.entity?null:t.entity.customerTitle),e.\u0275\u0275advance(1),e.\u0275\u0275property("fxShow",!t.isEdit&&(null==t.entity?null:t.entity.customerIsPublic)&&("customer"===t.assetScope||"tenant"===t.assetScope)),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(37,56,"asset.asset-public")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("formGroup",t.entityForm),e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(40,58,t.isLoading$)||!t.isEdit),e.\u0275\u0275advance(6),e.\u0275\u0275property("ngIf",t.entityForm.get("name").hasError("required")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.entityForm.get("name").hasError("maxlength")),e.\u0275\u0275advance(5),e.\u0275\u0275property("ngIf",t.entityForm.get("label").hasError("maxlength")),e.\u0275\u0275advance(1),e.\u0275\u0275property("selectDefaultProfile",t.isAdd)("showDetailsPageLink",!0),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.isAdd))},dependencies:[p.NgIf,Th.EntityAutocompleteComponent,S.MatButton,F.MatIcon,O.MatInput,_.MatFormField,_.MatLabel,_.MatError,he.yb,h.DefaultLayoutDirective,G.DefaultShowHideDirective,r.\u0275NgNoValidate,r.DefaultValueAccessor,r.NgControlStatus,r.NgControlStatusGroup,r.RequiredValidator,r.NgModel,r.FormGroupDirective,r.FormControlName,r.FormGroupName,g.TranslateDirective,or.AssetProfileAutocompleteComponent,p.AsyncPipe,g.TranslatePipe],styles:['@charset "UTF-8";']});class oa extends He.n{constructor(n){super(n),this.store=n,this.entityType=f.py}assetProfileChanged(n){this.entitiesTableConfig.componentsData.assetProfileId=n,this.entitiesTableConfig.getTable().resetSortAndFilter(!0)}}function Mh(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-tab",1,2),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275element(3,"tb-attribute-table",3),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275reference(1),a=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(2,5,"attribute.attributes")),e.\u0275\u0275advance(3),e.\u0275\u0275property("defaultAttributeScope",a.attributeScopes.SERVER_SCOPE)("active",t.isActive)("entityId",a.entity.id)("entityName",a.entity.name)}}function Dh(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-tab",1,4),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275element(3,"tb-attribute-table",5),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275reference(1),a=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(2,5,"attribute.latest-telemetry")),e.\u0275\u0275advance(3),e.\u0275\u0275property("defaultAttributeScope",a.latestTelemetryTypes.LATEST_TELEMETRY)("active",t.isActive)("entityId",a.entity.id)("entityName",a.entity.name)}}function Ah(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-tab",1,6),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275element(3,"tb-alarm-table",7),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275reference(1),a=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(2,3,"alarm.alarms")),e.\u0275\u0275advance(3),e.\u0275\u0275property("active",t.isActive)("entityId",a.entity.id)}}function Nh(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-tab",1,8),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275element(3,"tb-event-table",9),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275reference(1),a=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(2,5,"asset.events")),e.\u0275\u0275advance(3),e.\u0275\u0275property("defaultEventType",a.eventTypes.ERROR)("active",t.isActive)("tenantId",a.entity.tenantId.id)("entityId",a.entity.id)}}function Fh(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-tab",1,10),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275element(3,"tb-relation-table",7),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275reference(1),a=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(2,3,"relation.relations")),e.\u0275\u0275advance(3),e.\u0275\u0275property("active",t.isActive)("entityId",a.entity.id)}}function Lh(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-tab",1,11),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275element(3,"tb-audit-log-table",12),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275reference(1),a=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(2,4,"audit-log.audit-logs")),e.\u0275\u0275advance(3),e.\u0275\u0275property("active",t.isActive)("auditLogMode",a.auditLogModes.ENTITY)("entityId",a.entity.id)}}function Ph(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"mat-tab",1,13),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementStart(3,"tb-version-control",14),e.\u0275\u0275listener("versionRestored",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.entitiesTableConfig.updateData())}),e.\u0275\u0275elementEnd()()}if(2&i){const t=e.\u0275\u0275reference(1),a=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(2,5,"version-control.version-control")),e.\u0275\u0275advance(3),e.\u0275\u0275property("active",t.isActive)("entityId",a.entity.id)("entityName",a.entity.name)("externalEntityId",a.entity.externalId||a.entity.id)}}oa.\u0275fac=function(n){return new(n||oa)(e.\u0275\u0275directiveInject(x.Store))},oa.\u0275cmp=e.\u0275\u0275defineComponent({type:oa,selectors:[["tb-asset-table-header"]],features:[e.\u0275\u0275InheritDefinitionFeature],decls:1,vars:3,consts:[["subscriptSizing","dynamic",3,"ngModel","displayAllOnEmpty","editProfileEnabled","ngModelChange"]],template:function(n,t){1&n&&(e.\u0275\u0275elementStart(0,"tb-asset-profile-autocomplete",0),e.\u0275\u0275listener("ngModelChange",function(o){return t.assetProfileChanged(o)}),e.\u0275\u0275elementEnd()),2&n&&e.\u0275\u0275property("ngModel",t.entitiesTableConfig.componentsData.assetProfileId)("displayAllOnEmpty",!0)("editProfileEnabled",!1)},dependencies:[r.NgControlStatus,r.NgModel,or.AssetProfileAutocompleteComponent],encapsulation:2});class ra extends _e.l{constructor(n){super(n),this.store=n}ngOnInit(){super.ngOnInit()}}ra.\u0275fac=function(n){return new(n||ra)(e.\u0275\u0275directiveInject(x.Store))},ra.\u0275cmp=e.\u0275\u0275defineComponent({type:ra,selectors:[["tb-asset-tabs"]],features:[e.\u0275\u0275InheritDefinitionFeature],decls:7,vars:7,consts:[[3,"label",4,"ngIf"],[3,"label"],["attributesTab","matTab"],[3,"defaultAttributeScope","active","entityId","entityName"],["telemetryTab","matTab"],["disableAttributeScopeSelection","",3,"defaultAttributeScope","active","entityId","entityName"],["alarmsTab","matTab"],[3,"active","entityId"],["eventsTab","matTab"],[3,"defaultEventType","active","tenantId","entityId"],["relationsTab","matTab"],["auditLogsTab","matTab"],["detailsMode","true",3,"active","auditLogMode","entityId"],["versionControlTab","matTab"],["detailsMode","true","singleEntityMode","true",3,"active","entityId","entityName","externalEntityId","versionRestored"]],template:function(n,t){1&n&&(e.\u0275\u0275template(0,Mh,4,7,"mat-tab",0),e.\u0275\u0275template(1,Dh,4,7,"mat-tab",0),e.\u0275\u0275template(2,Ah,4,5,"mat-tab",0),e.\u0275\u0275template(3,Nh,4,7,"mat-tab",0),e.\u0275\u0275template(4,Fh,4,5,"mat-tab",0),e.\u0275\u0275template(5,Lh,4,6,"mat-tab",0),e.\u0275\u0275template(6,Ph,4,7,"mat-tab",0)),2&n&&(e.\u0275\u0275property("ngIf",t.entity),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.entity),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.entity),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.entity),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.entity),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.entity&&t.authUser.authority===t.authorities.TENANT_ADMIN),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.entity&&t.authUser.authority===t.authorities.TENANT_ADMIN))},dependencies:[p.NgIf,H.MatTab,Be.AuditLogTableComponent,wt.EventTableComponent,Et.RelationTableComponent,Ke.AlarmTableComponent,Ye.AttributeTableComponent,Ae.s,g.TranslatePipe],encapsulation:2});class we{constructor(n,t,a,o,s,l,d,m,y,I,E){this.store=n,this.broadcast=t,this.assetService=a,this.customerService=o,this.edgeService=s,this.dialogService=l,this.homeDialogs=d,this.translate=m,this.datePipe=y,this.router=I,this.dialog=E,this.config=new v.ap,this.config.entityType=f.py.ASSET,this.config.entityComponent=aa,this.config.entityTabsComponent=ra,this.config.entityTranslations=f.Jr.get(f.py.ASSET),this.config.entityResources=f.CZ.get(f.py.ASSET),this.config.deleteEntityTitle=L=>this.translate.instant("asset.delete-asset-title",{assetName:L.name}),this.config.deleteEntityContent=()=>this.translate.instant("asset.delete-asset-text"),this.config.deleteEntitiesTitle=L=>this.translate.instant("asset.delete-assets-title",{count:L}),this.config.deleteEntitiesContent=()=>this.translate.instant("asset.delete-assets-text"),this.config.loadEntity=L=>this.assetService.getAssetInfo(L.id),this.config.saveEntity=L=>this.assetService.saveAsset(L).pipe((0,Z.b)(()=>{this.broadcast.broadcast("assetSaved")}),(0,ne.z)(ae=>this.assetService.getAssetInfo(ae.id.id))),this.config.onEntityAction=L=>this.onAssetAction(L,this.config),this.config.detailsReadonly=()=>"customer_user"===this.config.componentsData.assetScope||"edge_customer_user"===this.config.componentsData.assetScope,this.config.headerComponent=oa}resolve(n){const t=n.params;return this.config.componentsData={assetScope:n.data.assetsType,assetProfileId:null,assetType:"",edgeId:t.edgeId},this.customerId=t.customerId,this.store.pipe((0,x.select)(q.rk),(0,Re.q)(1)).pipe((0,Z.b)(a=>{a.authority===u.W.CUSTOMER_USER&&("edge"===n.data.assetsType?this.config.componentsData.assetScope="edge_customer_user":this.config.componentsData.assetScope="customer_user",this.customerId=a.customerId)}),(0,ne.z)(()=>this.customerId?this.customerService.getCustomer(this.customerId):(0,J.of)(null)),(0,re.U)(a=>(a?a.additionalInfo&&a.additionalInfo.isPublic?this.config.tableTitle=this.translate.instant("customer.public-assets"):this.config.tableTitle=a.title+": "+this.translate.instant("asset.assets"):"edge"===this.config.componentsData.assetScope?this.edgeService.getEdge(this.config.componentsData.edgeId).subscribe(o=>this.config.tableTitle=o.name+": "+this.translate.instant("asset.assets")):this.config.tableTitle=this.translate.instant("asset.assets"),this.config.columns=this.configureColumns(this.config.componentsData.assetScope),this.configureEntityFunctions(this.config.componentsData.assetScope),this.config.cellActionDescriptors=this.configureCellActions(this.config.componentsData.assetScope),this.config.groupActionDescriptors=this.configureGroupActions(this.config.componentsData.assetScope),this.config.addActionDescriptors=this.configureAddActions(this.config.componentsData.assetScope),this.config.addEnabled=!("customer_user"===this.config.componentsData.assetScope||"edge_customer_user"===this.config.componentsData.assetScope),this.config.entitiesDeleteEnabled="tenant"===this.config.componentsData.assetScope,this.config.deleteEnabled=()=>"tenant"===this.config.componentsData.assetScope,this.config)))}configureColumns(n){const t=[new v.eq("createdTime","common.created-time",this.datePipe,"150px"),new v.QI("name","asset.name","25%"),new v.QI("assetProfileName","asset-profile.asset-profile","25%"),new v.QI("label","asset.label","25%")];return"tenant"===n&&t.push(new v.QI("customerTitle","customer.customer","25%"),new v.QI("customerIsPublic","asset.public","60px",a=>(0,v.Gj)(a.customerIsPublic),()=>({}),!1)),t}configureEntityFunctions(n){"tenant"===n?(this.config.entitiesFetchFunction=t=>this.assetService.getTenantAssetInfosByAssetProfileId(t,null!==this.config.componentsData.assetProfileId?this.config.componentsData.assetProfileId.id:""),this.config.deleteEntity=t=>this.assetService.deleteAsset(t.id)):"edge"===n||"edge_customer_user"===n?this.config.entitiesFetchFunction=t=>this.assetService.getEdgeAssets(this.config.componentsData.edgeId,t,this.config.componentsData.assetType):(this.config.entitiesFetchFunction=t=>this.assetService.getCustomerAssetInfosByAssetProfileId(this.customerId,t,null!==this.config.componentsData.assetProfileId?this.config.componentsData.assetProfileId.id:""),this.config.deleteEntity=t=>this.assetService.unassignAssetFromCustomer(t.id))}configureCellActions(n){const t=[];return"tenant"===n&&t.push({name:this.translate.instant("asset.make-public"),icon:"share",isEnabled:a=>!a.customerId||a.customerId.id===P._,onAction:(a,o)=>this.makePublic(a,o)},{name:this.translate.instant("asset.assign-to-customer"),icon:"assignment_ind",isEnabled:a=>!a.customerId||a.customerId.id===P._,onAction:(a,o)=>this.assignToCustomer(a,[o.id])},{name:this.translate.instant("asset.unassign-from-customer"),icon:"assignment_return",isEnabled:a=>a.customerId&&a.customerId.id!==P._&&!a.customerIsPublic,onAction:(a,o)=>this.unassignFromCustomer(a,o)},{name:this.translate.instant("asset.make-private"),icon:"reply",isEnabled:a=>a.customerId&&a.customerId.id!==P._&&a.customerIsPublic,onAction:(a,o)=>this.unassignFromCustomer(a,o)}),"customer"===n&&t.push({name:this.translate.instant("asset.unassign-from-customer"),icon:"assignment_return",isEnabled:a=>a.customerId&&a.customerId.id!==P._&&!a.customerIsPublic,onAction:(a,o)=>this.unassignFromCustomer(a,o)},{name:this.translate.instant("asset.make-private"),icon:"reply",isEnabled:a=>a.customerId&&a.customerId.id!==P._&&a.customerIsPublic,onAction:(a,o)=>this.unassignFromCustomer(a,o)}),"edge"===n&&t.push({name:this.translate.instant("edge.unassign-from-edge"),icon:"assignment_return",isEnabled:a=>!0,onAction:(a,o)=>this.unassignFromEdge(a,o)}),t}configureGroupActions(n){const t=[];return"tenant"===n&&t.push({name:this.translate.instant("asset.assign-assets"),icon:"assignment_ind",isEnabled:!0,onAction:(a,o)=>this.assignToCustomer(a,o.map(s=>s.id))}),"customer"===n&&t.push({name:this.translate.instant("asset.unassign-assets"),icon:"assignment_return",isEnabled:!0,onAction:(a,o)=>this.unassignAssetsFromCustomer(a,o)}),"edge"===n&&t.push({name:this.translate.instant("asset.unassign-assets-from-edge"),icon:"assignment_return",isEnabled:!0,onAction:(a,o)=>this.unassignAssetsFromEdge(a,o)}),t}configureAddActions(n){const t=[];return"tenant"===n&&t.push({name:this.translate.instant("asset.add-asset-text"),icon:"insert_drive_file",isEnabled:()=>!0,onAction:a=>this.config.getTable().addEntity(a)},{name:this.translate.instant("asset.import"),icon:"file_upload",isEnabled:()=>!0,onAction:a=>this.importAssets(a)}),"customer"===n&&t.push({name:this.translate.instant("asset.assign-new-asset"),icon:"add",isEnabled:()=>!0,onAction:a=>this.addAssetsToCustomer(a)}),"edge"===n&&t.push({name:this.translate.instant("asset.assign-new-asset"),icon:"add",isEnabled:()=>!0,onAction:a=>this.addAssetsToEdge(a)}),t}importAssets(n){this.homeDialogs.importEntities(f.py.ASSET).subscribe(t=>{t&&(this.broadcast.broadcast("assetSaved"),this.config.updateData())})}openAsset(n,t,a){n&&n.stopPropagation();const o=this.router.createUrlTree([t.id.id],{relativeTo:a.getActivatedRoute()});this.router.navigateByUrl(o)}addAssetsToCustomer(n){n&&n.stopPropagation(),this.dialog.open(Ka.J,{disableClose:!0,panelClass:["tb-dialog","tb-fullscreen-dialog"],data:{customerId:this.customerId,entityType:f.py.ASSET}}).afterClosed().subscribe(t=>{t&&this.config.updateData()})}makePublic(n,t){n&&n.stopPropagation(),this.dialogService.confirm(this.translate.instant("asset.make-public-asset-title",{assetName:t.name}),this.translate.instant("asset.make-public-asset-text"),this.translate.instant("action.no"),this.translate.instant("action.yes"),!0).subscribe(a=>{a&&this.assetService.makeAssetPublic(t.id.id).subscribe(()=>{this.config.updateData()})})}assignToCustomer(n,t){n&&n.stopPropagation(),this.dialog.open(za.S,{disableClose:!0,panelClass:["tb-dialog","tb-fullscreen-dialog"],data:{entityIds:t,entityType:f.py.ASSET}}).afterClosed().subscribe(a=>{a&&this.config.updateData()})}unassignFromCustomer(n,t){n&&n.stopPropagation();let o,s;t.customerIsPublic?(o=this.translate.instant("asset.make-private-asset-title",{assetName:t.name}),s=this.translate.instant("asset.make-private-asset-text")):(o=this.translate.instant("asset.unassign-asset-title",{assetName:t.name}),s=this.translate.instant("asset.unassign-asset-text")),this.dialogService.confirm(o,s,this.translate.instant("action.no"),this.translate.instant("action.yes"),!0).subscribe(l=>{l&&this.assetService.unassignAssetFromCustomer(t.id.id).subscribe(()=>{this.config.updateData("tenant"!==this.config.componentsData.assetScope)})})}unassignAssetsFromCustomer(n,t){n&&n.stopPropagation(),this.dialogService.confirm(this.translate.instant("asset.unassign-assets-title",{count:t.length}),this.translate.instant("asset.unassign-assets-text"),this.translate.instant("action.no"),this.translate.instant("action.yes"),!0).subscribe(a=>{if(a){const o=[];t.forEach(s=>{o.push(this.assetService.unassignAssetFromCustomer(s.id.id))}),(0,xe.D)(o).subscribe(()=>{this.config.updateData()})}})}onAssetAction(n,t){switch(n.action){case"open":return this.openAsset(n.event,n.entity,t),!0;case"makePublic":return this.makePublic(n.event,n.entity),!0;case"assignToCustomer":return this.assignToCustomer(n.event,[n.entity.id]),!0;case"unassignFromCustomer":return this.unassignFromCustomer(n.event,n.entity),!0;case"unassignFromEdge":return this.unassignFromEdge(n.event,n.entity),!0}return!1}addAssetsToEdge(n){n&&n.stopPropagation(),this.dialog.open(Ya.J,{disableClose:!0,panelClass:["tb-dialog","tb-fullscreen-dialog"],data:{edgeId:this.config.componentsData.edgeId,entityType:f.py.ASSET}}).afterClosed().subscribe(t=>{t&&this.config.updateData()})}unassignFromEdge(n,t){n&&n.stopPropagation(),this.dialogService.confirm(this.translate.instant("asset.unassign-asset-from-edge-title",{assetName:t.name}),this.translate.instant("asset.unassign-asset-from-edge-text"),this.translate.instant("action.no"),this.translate.instant("action.yes"),!0).subscribe(a=>{a&&this.assetService.unassignAssetFromEdge(this.config.componentsData.edgeId,t.id.id).subscribe(()=>{this.config.updateData("tenant"!==this.config.componentsData.assetScope)})})}unassignAssetsFromEdge(n,t){n&&n.stopPropagation(),this.dialogService.confirm(this.translate.instant("asset.unassign-assets-from-edge-title",{count:t.length}),this.translate.instant("asset.unassign-assets-from-edge-text"),this.translate.instant("action.no"),this.translate.instant("action.yes"),!0).subscribe(a=>{if(a){const o=[];t.forEach(s=>{o.push(this.assetService.unassignAssetFromEdge(this.config.componentsData.edgeId,s.id.id))}),(0,xe.D)(o).subscribe(()=>{this.config.updateData()})}})}}we.\u0275fac=function(n){return new(n||we)(e.\u0275\u0275inject(x.Store),e.\u0275\u0275inject(Pa.M),e.\u0275\u0275inject(Ch.d),e.\u0275\u0275inject($e.v),e.\u0275\u0275inject(Yn.A),e.\u0275\u0275inject(pe.x),e.\u0275\u0275inject(lt.U),e.\u0275\u0275inject(g.TranslateService),e.\u0275\u0275inject(p.DatePipe),e.\u0275\u0275inject(b.Router),e.\u0275\u0275inject(C.MatDialog))},we.\u0275prov=e.\u0275\u0275defineInjectable({token:we,factory:we.\u0275fac});var rr=c(63219),sa=c(12288),sr=c(80131);function kh(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"button",1),e.\u0275\u0275listener("click",function(o){e.\u0275\u0275restoreView(t);const s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.onEntityAction(o,"openInstallInstructions"))}),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275elementStart(3,"mat-icon"),e.\u0275\u0275text(4,"info_outline"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"span"),e.\u0275\u0275text(6),e.\u0275\u0275pipe(7,"translate"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementContainerEnd()}if(2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(2,3,t.isLoading$))("fxShow",!t.isEdit&&"customer_user"!==t.edgeScope),e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(7,5,"edge.install-connect-instructions"))}}function Rh(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"button",1),e.\u0275\u0275listener("click",function(o){e.\u0275\u0275restoreView(t);const s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.onEntityAction(o,"openUpgradeInstructions"))}),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275elementStart(3,"mat-icon"),e.\u0275\u0275text(4,"info_outline"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"span"),e.\u0275\u0275text(6),e.\u0275\u0275pipe(7,"translate"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementContainerEnd()}if(2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(2,3,t.isLoading$))("fxShow",!t.isEdit&&"customer_user"!==t.edgeScope),e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(7,5,"edge.upgrade-instructions"))}}function Oh(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"edge.name-required")," "))}function Bh(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"edge.name-max-length")," "))}function Vh(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"edge.label-max-length")," "))}class la extends Te.r{constructor(n,t,a,o,s,l,d){super(n,l,o,s,d),this.store=n,this.translate=t,this.edgeService=a,this.entityValue=o,this.entitiesTableConfigValue=s,this.fb=l,this.cd=d,this.entityType=f.py,this.upgradeAvailable=!1}ngOnInit(){this.edgeScope=this.entitiesTableConfig.componentsData.edgeScope,super.ngOnInit()}hideDelete(){return!!this.entitiesTableConfig&&!this.entitiesTableConfig.deleteEnabled(this.entity)}isAssignedToCustomer(n){return n&&n.customerId&&n.customerId.id!==P._}buildForm(n){const t=this.fb.group({name:[n?n.name:"",[r.Validators.required,r.Validators.maxLength(255)]],type:[n?.type?n.type:"default",[r.Validators.required,r.Validators.maxLength(255)]],label:[n?n.label:"",r.Validators.maxLength(255)],routingKey:this.fb.control({value:n?n.routingKey:null,disabled:!0}),secret:this.fb.control({value:n?n.secret:null,disabled:!0}),additionalInfo:this.fb.group({description:[n&&n.additionalInfo?n.additionalInfo.description:""]})});return this.generateRoutingKeyAndSecret(n,t),t}updateForm(n){this.entityForm.patchValue({name:n.name,type:n.type,label:n.label,routingKey:n.routingKey,secret:n.secret,additionalInfo:{description:n.additionalInfo?n.additionalInfo.description:""}}),this.generateRoutingKeyAndSecret(n,this.entityForm),this.edgeService.isEdgeUpgradeAvailable(this.entity.id.id).subscribe(t=>{this.upgradeAvailable=t})}updateFormState(){super.updateFormState(),this.entityForm.get("routingKey").disable({emitEvent:!1}),this.entityForm.get("secret").disable({emitEvent:!1})}onEdgeIdCopied(n){this.store.dispatch(new V.zi({message:this.translate.instant("edge.id-copied-message"),type:"success",duration:750,verticalPosition:"bottom",horizontalPosition:"right"}))}onEdgeInfoCopied(n){const t="key"===n?"edge.edge-key-copied-message":"edge.edge-secret-copied-message";this.store.dispatch(new V.zi({message:this.translate.instant(t),type:"success",duration:750,verticalPosition:"bottom",horizontalPosition:"right"}))}generateRoutingKeyAndSecret(n,t){n&&!n.id&&(t.get("routingKey").patchValue((0,T.M8)(),{emitEvent:!1}),t.get("secret").patchValue((0,T.KK)(20),{emitEvent:!1}))}}la.\u0275fac=function(n){return new(n||la)(e.\u0275\u0275directiveInject(x.Store),e.\u0275\u0275directiveInject(g.TranslateService),e.\u0275\u0275directiveInject(Yn.A),e.\u0275\u0275directiveInject("entity"),e.\u0275\u0275directiveInject("entitiesTableConfig"),e.\u0275\u0275directiveInject(r.UntypedFormBuilder),e.\u0275\u0275directiveInject(e.ChangeDetectorRef))},la.\u0275cmp=e.\u0275\u0275defineComponent({type:la,selectors:[["tb-edge"]],features:[e.\u0275\u0275InheritDefinitionFeature],decls:112,vars:120,consts:[["fxLayout.xs","column",1,"tb-details-buttons"],["mat-raised-button","","color","primary",3,"disabled","fxShow","click"],["mat-raised-button","","color","primary","fxFlex.xs","",3,"disabled","fxShow","click"],["fxLayout","row wrap","fxLayout.xs","column"],["mat-raised-button","","ngxClipboard","",3,"cbContent","disabled","fxShow","cbOnSuccess"],["svgIcon","mdi:clipboard-arrow-left"],["translate",""],["mat-raised-button","","ngxClipboard","",3,"disabled","fxShow","click"],["svgIcon","mdi:sync"],["fxLayout","row","fxLayout.xs","column"],[3,"ngSwitch"],[4,"ngSwitchCase"],["fxLayout","column",1,"mat-padding"],[1,"mat-block",3,"fxShow"],["matInput","","disabled","",3,"ngModel"],[1,"tb-small",2,"padding-bottom","10px","padding-left","2px",3,"fxShow"],[3,"formGroup"],[3,"disabled"],[1,"mat-block"],["matInput","","formControlName","name","required",""],[4,"ngIf"],["formControlName","type",3,"required","entityType"],["fxLayout","row",3,"fxShow"],["fxFlex","",1,"mat-block"],["matInput","","formControlName","routingKey"],["mat-icon-button","","type","button","ngxClipboard","",3,"cbContent","matTooltip","cbOnSuccess"],["matInput","","formControlName","secret"],["matInput","","formControlName","label"],["formGroupName","additionalInfo","fxLayout","column"],["matInput","","formControlName","description","rows","2"]],template:function(n,t){1&n&&(e.\u0275\u0275elementStart(0,"div",0)(1,"button",1),e.\u0275\u0275listener("click",function(o){return t.onEntityAction(o,"open")}),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275text(3),e.\u0275\u0275pipe(4,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"button",1),e.\u0275\u0275listener("click",function(o){return t.onEntityAction(o,"makePublic")}),e.\u0275\u0275pipe(6,"async"),e.\u0275\u0275text(7),e.\u0275\u0275pipe(8,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(9,"button",1),e.\u0275\u0275listener("click",function(o){return t.onEntityAction(o,"assignToCustomer")}),e.\u0275\u0275pipe(10,"async"),e.\u0275\u0275text(11),e.\u0275\u0275pipe(12,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(13,"button",1),e.\u0275\u0275listener("click",function(o){return t.onEntityAction(o,"unassignFromCustomer")}),e.\u0275\u0275pipe(14,"async"),e.\u0275\u0275text(15),e.\u0275\u0275pipe(16,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(17,"button",1),e.\u0275\u0275listener("click",function(o){return t.onEntityAction(o,"openEdgeAssets")}),e.\u0275\u0275pipe(18,"async"),e.\u0275\u0275text(19),e.\u0275\u0275pipe(20,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(21,"button",1),e.\u0275\u0275listener("click",function(o){return t.onEntityAction(o,"openEdgeDevices")}),e.\u0275\u0275pipe(22,"async"),e.\u0275\u0275text(23),e.\u0275\u0275pipe(24,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(25,"button",1),e.\u0275\u0275listener("click",function(o){return t.onEntityAction(o,"openEdgeEntityViews")}),e.\u0275\u0275pipe(26,"async"),e.\u0275\u0275text(27),e.\u0275\u0275pipe(28,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(29,"button",1),e.\u0275\u0275listener("click",function(o){return t.onEntityAction(o,"openEdgeDashboards")}),e.\u0275\u0275pipe(30,"async"),e.\u0275\u0275text(31),e.\u0275\u0275pipe(32,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(33,"button",1),e.\u0275\u0275listener("click",function(o){return t.onEntityAction(o,"openEdgeRuleChains")}),e.\u0275\u0275pipe(34,"async"),e.\u0275\u0275text(35),e.\u0275\u0275pipe(36,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(37,"button",2),e.\u0275\u0275listener("click",function(o){return t.onEntityAction(o,"delete")}),e.\u0275\u0275pipe(38,"async"),e.\u0275\u0275text(39),e.\u0275\u0275pipe(40,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(41,"div",3)(42,"button",4),e.\u0275\u0275listener("cbOnSuccess",function(o){return t.onEdgeIdCopied(o)}),e.\u0275\u0275pipe(43,"async"),e.\u0275\u0275element(44,"mat-icon",5),e.\u0275\u0275elementStart(45,"span",6),e.\u0275\u0275text(46,"edge.copy-id"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(47,"button",4),e.\u0275\u0275listener("cbOnSuccess",function(){return t.onEdgeInfoCopied("key")}),e.\u0275\u0275pipe(48,"async"),e.\u0275\u0275element(49,"mat-icon",5),e.\u0275\u0275elementStart(50,"span",6),e.\u0275\u0275text(51,"edge.copy-edge-key"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(52,"button",4),e.\u0275\u0275listener("cbOnSuccess",function(){return t.onEdgeInfoCopied("secret")}),e.\u0275\u0275pipe(53,"async"),e.\u0275\u0275element(54,"mat-icon",5),e.\u0275\u0275elementStart(55,"span",6),e.\u0275\u0275text(56,"edge.copy-edge-secret"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(57,"button",7),e.\u0275\u0275listener("click",function(o){return t.onEntityAction(o,"syncEdge")}),e.\u0275\u0275pipe(58,"async"),e.\u0275\u0275element(59,"mat-icon",8),e.\u0275\u0275elementStart(60,"span",6),e.\u0275\u0275text(61,"edge.sync"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(62,"div",9)(63,"div",10),e.\u0275\u0275template(64,kh,8,7,"ng-container",11),e.\u0275\u0275template(65,Rh,8,7,"ng-container",11),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(66,"div",12)(67,"mat-form-field",13)(68,"mat-label",6),e.\u0275\u0275text(69,"edge.assignedToCustomer"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(70,"input",14),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(71,"div",15),e.\u0275\u0275text(72),e.\u0275\u0275pipe(73,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(74,"form",16)(75,"fieldset",17),e.\u0275\u0275pipe(76,"async"),e.\u0275\u0275elementStart(77,"mat-form-field",18)(78,"mat-label",6),e.\u0275\u0275text(79,"edge.name"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(80,"input",19),e.\u0275\u0275template(81,Oh,3,3,"mat-error",20),e.\u0275\u0275template(82,Bh,3,3,"mat-error",20),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(83,"tb-entity-subtype-autocomplete",21),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(84,"div",22)(85,"mat-form-field",23)(86,"mat-label",6),e.\u0275\u0275text(87,"edge.edge-key"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(88,"input",24),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(89,"button",25),e.\u0275\u0275listener("cbOnSuccess",function(){return t.onEdgeInfoCopied("key")}),e.\u0275\u0275pipe(90,"translate"),e.\u0275\u0275element(91,"mat-icon",5),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(92,"div",22)(93,"mat-form-field",23)(94,"mat-label",6),e.\u0275\u0275text(95,"edge.edge-secret"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(96,"input",26),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(97,"button",25),e.\u0275\u0275listener("cbOnSuccess",function(){return t.onEdgeInfoCopied("secret")}),e.\u0275\u0275pipe(98,"translate"),e.\u0275\u0275element(99,"mat-icon",5),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(100,"fieldset",17),e.\u0275\u0275pipe(101,"async"),e.\u0275\u0275elementStart(102,"mat-form-field",18)(103,"mat-label",6),e.\u0275\u0275text(104,"edge.label"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(105,"input",27),e.\u0275\u0275template(106,Vh,3,3,"mat-error",20),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(107,"div",28)(108,"mat-form-field",18)(109,"mat-label",6),e.\u0275\u0275text(110,"edge.description"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(111,"textarea",29),e.\u0275\u0275elementEnd()()()()()),2&n&&(e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(2,62,t.isLoading$))("fxShow",!t.isEdit&&!t.isDetailsPage),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(4,64,"common.open-details-page")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(6,66,t.isLoading$))("fxShow",!(t.isEdit||"tenant"!==t.edgeScope||t.isAssignedToCustomer(t.entity)||null!=t.entity&&t.entity.customerIsPublic)),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(8,68,"edge.make-public")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(10,70,t.isLoading$))("fxShow",!t.isEdit&&"tenant"===t.edgeScope&&!t.isAssignedToCustomer(t.entity)),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(12,72,"edge.assign-to-customer")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(14,74,t.isLoading$))("fxShow",!t.isEdit&&("customer"===t.edgeScope||"tenant"===t.edgeScope)&&t.isAssignedToCustomer(t.entity)),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(16,76,null!=t.entity&&t.entity.customerIsPublic?"edge.make-private":"edge.unassign-from-customer")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(18,78,t.isLoading$))("fxShow",!t.isEdit&&"customer"!==t.edgeScope),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(20,80,"edge.manage-assets")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(22,82,t.isLoading$))("fxShow",!t.isEdit&&"customer"!==t.edgeScope),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(24,84,"edge.manage-devices")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(26,86,t.isLoading$))("fxShow",!t.isEdit&&"customer"!==t.edgeScope),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(28,88,"edge.manage-entity-views")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(30,90,t.isLoading$))("fxShow",!t.isEdit&&"customer"!==t.edgeScope),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(32,92,"edge.manage-dashboards")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(34,94,t.isLoading$))("fxShow",!t.isEdit&&"tenant"===t.edgeScope),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(36,96,"edge.manage-rulechains")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(38,98,t.isLoading$))("fxShow",!t.hideDelete()&&!t.isEdit),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(40,100,"edge.delete")," "),e.\u0275\u0275advance(3),e.\u0275\u0275property("cbContent",null==t.entity||null==t.entity.id?null:t.entity.id.id)("disabled",e.\u0275\u0275pipeBind1(43,102,t.isLoading$))("fxShow",!t.isEdit),e.\u0275\u0275advance(5),e.\u0275\u0275property("cbContent",null==t.entity?null:t.entity.routingKey)("disabled",e.\u0275\u0275pipeBind1(48,104,t.isLoading$))("fxShow",!t.isEdit&&"customer_user"!==t.edgeScope),e.\u0275\u0275advance(5),e.\u0275\u0275property("cbContent",null==t.entity?null:t.entity.secret)("disabled",e.\u0275\u0275pipeBind1(53,106,t.isLoading$))("fxShow",!t.isEdit&&"customer_user"!==t.edgeScope),e.\u0275\u0275advance(5),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(58,108,t.isLoading$))("fxShow",!t.isEdit&&"customer_user"!==t.edgeScope),e.\u0275\u0275advance(6),e.\u0275\u0275property("ngSwitch",t.upgradeAvailable),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase",!1),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngSwitchCase",!0),e.\u0275\u0275advance(2),e.\u0275\u0275property("fxShow",!t.isEdit&&t.isAssignedToCustomer(t.entity)&&!(null!=t.entity&&t.entity.customerIsPublic)&&"tenant"===t.edgeScope),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngModel",null==t.entity?null:t.entity.customerTitle),e.\u0275\u0275advance(1),e.\u0275\u0275property("fxShow",!t.isEdit&&(null==t.entity?null:t.entity.customerIsPublic)&&"tenant"===t.edgeScope),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(73,110,"edge.edge-public")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("formGroup",t.entityForm),e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(76,112,t.isLoading$)||!t.isEdit),e.\u0275\u0275advance(6),e.\u0275\u0275property("ngIf",t.entityForm.get("name").hasError("required")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.entityForm.get("name").hasError("maxlength")),e.\u0275\u0275advance(1),e.\u0275\u0275property("required",!0)("entityType",t.entityType.EDGE),e.\u0275\u0275advance(1),e.\u0275\u0275property("fxShow","customer_user"!==t.edgeScope),e.\u0275\u0275advance(5),e.\u0275\u0275propertyInterpolate("matTooltip",e.\u0275\u0275pipeBind1(90,114,"edge.copy-edge-key")),e.\u0275\u0275property("cbContent",null==t.entityForm?null:t.entityForm.get("routingKey").value),e.\u0275\u0275advance(3),e.\u0275\u0275property("fxShow","customer_user"!==t.edgeScope),e.\u0275\u0275advance(5),e.\u0275\u0275propertyInterpolate("matTooltip",e.\u0275\u0275pipeBind1(98,116,"edge.copy-edge-secret")),e.\u0275\u0275property("cbContent",null==t.entityForm?null:t.entityForm.get("secret").value),e.\u0275\u0275advance(3),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(101,118,t.isLoading$)||!t.isEdit),e.\u0275\u0275advance(6),e.\u0275\u0275property("ngIf",t.entityForm.get("label").hasError("maxlength")))},dependencies:[p.NgIf,p.NgSwitch,p.NgSwitchCase,sr.EntitySubTypeAutocompleteComponent,S.MatButton,S.MatIconButton,F.MatIcon,O.MatInput,_.MatFormField,_.MatLabel,_.MatError,Ln.MatTooltip,he.yb,h.DefaultLayoutDirective,h.DefaultFlexDirective,G.DefaultShowHideDirective,r.\u0275NgNoValidate,r.DefaultValueAccessor,r.NgControlStatus,r.NgControlStatusGroup,r.RequiredValidator,r.NgModel,r.FormGroupDirective,r.FormControlName,r.FormGroupName,g.TranslateDirective,p.AsyncPipe,g.TranslatePipe],styles:['@charset "UTF-8";']});var lr=c(39776);class da extends He.n{constructor(n){super(n),this.store=n,this.entityType=f.py}edgeTypeChanged(n){this.entitiesTableConfig.componentsData.edgeType=n,this.entitiesTableConfig.getTable().resetSortAndFilter(!0)}}da.\u0275fac=function(n){return new(n||da)(e.\u0275\u0275directiveInject(x.Store))},da.\u0275cmp=e.\u0275\u0275defineComponent({type:da,selectors:[["tb-edge-table-header"]],features:[e.\u0275\u0275InheritDefinitionFeature],decls:1,vars:3,consts:[["subscriptSizing","dynamic",3,"showLabel","entityType","ngModel","ngModelChange"]],template:function(n,t){1&n&&(e.\u0275\u0275elementStart(0,"tb-entity-subtype-select",0),e.\u0275\u0275listener("ngModelChange",function(o){return t.edgeTypeChanged(o)}),e.\u0275\u0275elementEnd()),2&n&&e.\u0275\u0275property("showLabel",!0)("entityType",t.entityType.EDGE)("ngModel",t.entitiesTableConfig.componentsData.edgeType)},dependencies:[lr.EntitySubTypeSelectComponent,r.NgControlStatus,r.NgModel],encapsulation:2});var Uh=c(58494);function Gh(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-tab",1,2),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275element(3,"tb-attribute-table",3),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275reference(1),a=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(2,5,"attribute.attributes")),e.\u0275\u0275advance(3),e.\u0275\u0275property("defaultAttributeScope",a.attributeScopes.SERVER_SCOPE)("active",t.isActive)("entityId",a.entity.id)("entityName",a.entity.name)}}function jh(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-tab",1,4),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275element(3,"tb-attribute-table",5),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275reference(1),a=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(2,5,"attribute.latest-telemetry")),e.\u0275\u0275advance(3),e.\u0275\u0275property("defaultAttributeScope",a.latestTelemetryTypes.LATEST_TELEMETRY)("active",t.isActive)("entityId",a.entity.id)("entityName",a.entity.name)}}function Wh(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-tab",1,6),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275element(3,"tb-alarm-table",7),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275reference(1),a=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(2,3,"alarm.alarms")),e.\u0275\u0275advance(3),e.\u0275\u0275property("active",t.isActive)("entityId",a.entity.id)}}function qh(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-tab",1,8),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275element(3,"tb-event-table",9),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275reference(1),a=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(2,5,"edge.events")),e.\u0275\u0275advance(3),e.\u0275\u0275property("defaultEventType",a.eventTypes.ERROR)("active",t.isActive)("tenantId",a.entity.tenantId.id)("entityId",a.entity.id)}}function $h(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-tab",1,10),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275element(3,"tb-edge-downlink-table",7),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275reference(1),a=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(2,3,"edge.downlinks")),e.\u0275\u0275advance(3),e.\u0275\u0275property("active",t.isActive)("entityId",a.entity.id)}}function Hh(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-tab",1,11),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275element(3,"tb-relation-table",7),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275reference(1),a=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(2,3,"relation.relations")),e.\u0275\u0275advance(3),e.\u0275\u0275property("active",t.isActive)("entityId",a.entity.id)}}function zh(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-tab",1,12),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275element(3,"tb-audit-log-table",13),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275reference(1),a=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(2,4,"audit-log.audit-logs")),e.\u0275\u0275advance(3),e.\u0275\u0275property("active",t.isActive)("auditLogMode",a.auditLogModes.ENTITY)("entityId",a.entity.id)}}class ca extends _e.l{constructor(n){super(n),this.store=n}ngOnInit(){super.ngOnInit()}}ca.\u0275fac=function(n){return new(n||ca)(e.\u0275\u0275directiveInject(x.Store))},ca.\u0275cmp=e.\u0275\u0275defineComponent({type:ca,selectors:[["tb-edge-tabs"]],features:[e.\u0275\u0275InheritDefinitionFeature],decls:7,vars:7,consts:[[3,"label",4,"ngIf"],[3,"label"],["attributesTab","matTab"],[3,"defaultAttributeScope","active","entityId","entityName"],["telemetryTab","matTab"],["disableAttributeScopeSelection","",3,"defaultAttributeScope","active","entityId","entityName"],["alarmsTab","matTab"],[3,"active","entityId"],["eventsTab","matTab"],[3,"defaultEventType","active","tenantId","entityId"],["downLinksTab","matTab"],["relationsTab","matTab"],["auditLogsTab","matTab"],["detailsMode","true",3,"active","auditLogMode","entityId"]],template:function(n,t){1&n&&(e.\u0275\u0275template(0,Gh,4,7,"mat-tab",0),e.\u0275\u0275template(1,jh,4,7,"mat-tab",0),e.\u0275\u0275template(2,Wh,4,5,"mat-tab",0),e.\u0275\u0275template(3,qh,4,7,"mat-tab",0),e.\u0275\u0275template(4,$h,4,5,"mat-tab",0),e.\u0275\u0275template(5,Hh,4,5,"mat-tab",0),e.\u0275\u0275template(6,zh,4,6,"mat-tab",0)),2&n&&(e.\u0275\u0275property("ngIf",t.entity),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.entity),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.entity),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.entity),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.entity&&t.authUser.authority===t.authorities.TENANT_ADMIN),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.entity),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.entity&&t.authUser.authority===t.authorities.TENANT_ADMIN))},dependencies:[p.NgIf,H.MatTab,Be.AuditLogTableComponent,wt.EventTableComponent,Uh.EdgeDownlinkTableComponent,Et.RelationTableComponent,Ke.AlarmTableComponent,Ye.AttributeTableComponent,g.TranslatePipe],encapsulation:2});var dr=c(68107),Kh=c(63661),Yh=c(70970);function Jh(i,n){1&i&&(e.\u0275\u0275element(0,"mat-icon",15),e.\u0275\u0275text(1," Ubuntu "))}function Qh(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",11)(1,"div",16),e.\u0275\u0275element(2,"tb-markdown",17),e.\u0275\u0275elementEnd()()),2&i){const t=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(2),e.\u0275\u0275property("data",t.contentData.ubuntu)}}function Xh(i,n){1&i&&(e.\u0275\u0275element(0,"mat-icon",18),e.\u0275\u0275text(1," CentOS/RHEL "))}function Zh(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",11)(1,"div",16),e.\u0275\u0275element(2,"tb-markdown",17),e.\u0275\u0275elementEnd()()),2&i){const t=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(2),e.\u0275\u0275property("data",t.contentData.centos)}}function eb(i,n){1&i&&(e.\u0275\u0275element(0,"mat-icon",19),e.\u0275\u0275text(1," Docker "))}function tb(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",11)(1,"div",16),e.\u0275\u0275element(2,"tb-markdown",17),e.\u0275\u0275elementEnd()()),2&i){const t=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(2),e.\u0275\u0275property("data",t.contentData.docker)}}function nb(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"section",11)(1,"div",11)(2,"mat-tab-group",12),e.\u0275\u0275listener("selectedIndexChange",function(o){e.\u0275\u0275restoreView(t);const s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.tabIndex=o)})("selectedTabChange",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.selectedTabChange(o.tabIndex))}),e.\u0275\u0275elementStart(3,"mat-tab"),e.\u0275\u0275template(4,Jh,2,0,"ng-template",13),e.\u0275\u0275template(5,Qh,3,1,"ng-template",14),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(6,"mat-tab"),e.\u0275\u0275template(7,Xh,2,0,"ng-template",13),e.\u0275\u0275template(8,Zh,3,1,"ng-template",14),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(9,"mat-tab"),e.\u0275\u0275template(10,eb,2,0,"ng-template",13),e.\u0275\u0275template(11,tb,3,1,"ng-template",14),e.\u0275\u0275elementEnd()()()()}if(2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(2),e.\u0275\u0275property("selectedIndex",t.tabIndex)}}function ib(i,n){1&i&&(e.\u0275\u0275elementStart(0,"div",20),e.\u0275\u0275element(1,"mat-spinner",21),e.\u0275\u0275elementStart(2,"span",22),e.\u0275\u0275text(3),e.\u0275\u0275pipe(4,"translate"),e.\u0275\u0275elementEnd()()),2&i&&(e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(4,1,"edge.loading-edge-instructions")," "))}class pa extends le.a{constructor(n,t,a,o,s,l){super(n,t,o),this.store=n,this.router=t,this.data=a,this.dialogRef=o,this.attributeService=s,this.edgeService=l,this.loadedInstructions=!1,this.notShowAgain=!1,this.tabIndex=0,this.instructionsMethod=dr.E,this.contentData={},this.data.afterAdd?(this.dialogTitle="edge.install-connect-instructions-edge-created",this.showDontShowAgain=!0):this.data.upgradeAvailable?(this.dialogTitle="edge.upgrade-instructions",this.showDontShowAgain=!1):(this.dialogTitle="edge.install-connect-instructions",this.showDontShowAgain=!1)}ngOnInit(){Yh("tb-edge-installation-dialog").css("background-color","dark"==localStorage.getItem("satlTheme")?"#333333":"#FFFFFF"),this.getInstructions(this.instructionsMethod[this.tabIndex])}ngOnDestroy(){super.ngOnDestroy()}close(){this.notShowAgain&&this.showDontShowAgain?(this.store.dispatch(new ho.BG({notDisplayInstructionsAfterAddEdge:!0})),this.dialogRef.close(null)):this.dialogRef.close(null)}selectedTabChange(n){this.getInstructions(this.instructionsMethod[n])}getInstructions(n){if(!this.contentData[n]){let t;this.loadedInstructions=!1,t=this.data.upgradeAvailable?this.attributeService.getEntityAttributes(this.data.edge.id,ta.My.SERVER_SCOPE,[dr.fR]).pipe((0,ne.z)(a=>{if(a.length){const o=a[0].value;return this.edgeService.getEdgeUpgradeInstructions(o,n)}})):this.edgeService.getEdgeInstallInstructions(this.data.edge.id.id,n),t.subscribe(a=>{this.contentData[n]=a.instructions,this.loadedInstructions=!0})}}}pa.\u0275fac=function(n){return new(n||pa)(e.\u0275\u0275directiveInject(x.Store),e.\u0275\u0275directiveInject(b.Router),e.\u0275\u0275directiveInject(C.MAT_DIALOG_DATA),e.\u0275\u0275directiveInject(C.MatDialogRef),e.\u0275\u0275directiveInject(Kh.c),e.\u0275\u0275directiveInject(Yn.A))},pa.\u0275cmp=e.\u0275\u0275defineComponent({type:pa,selectors:[["tb-edge-installation-dialog"]],features:[e.\u0275\u0275InheritDefinitionFeature],decls:20,vars:14,consts:[["color","primary"],["translate",""],["fxFlex",""],["mat-icon-button","","type","button",3,"click"],[1,"material-icons"],["mat-dialog-content",""],["class","tb-form-panel no-padding no-border",4,"ngIf","ngIfElse"],["mat-dialog-actions","",1,"tb-dialog-actions"],[3,"fxShow","ngModel","ngModelChange"],["mat-button","",3,"disabled","click"],["loadingInstructions",""],[1,"tb-form-panel","no-padding","no-border"],[3,"selectedIndex","selectedIndexChange","selectedTabChange"],["mat-tab-label",""],["matTabContent",""],["svgIcon","mdi:ubuntu",1,"tabs-icon"],[1,"tb-form-panel","no-padding","stroked"],[3,"data"],["svgIcon","mdi:centos",1,"tabs-icon"],["svgIcon","docker",1,"tabs-icon"],[1,"tb-loader"],["color","accent","diameter","65","strokeWidth","4"],[1,"mat-subtitle-1","label"]],template:function(n,t){if(1&n&&(e.\u0275\u0275elementStart(0,"mat-toolbar",0)(1,"h2",1),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(3,"span",2),e.\u0275\u0275elementStart(4,"button",3),e.\u0275\u0275listener("click",function(){return t.close()}),e.\u0275\u0275elementStart(5,"mat-icon",4),e.\u0275\u0275text(6,"close"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(7,"div",5),e.\u0275\u0275template(8,nb,12,1,"section",6),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(9,"div",7)(10,"mat-slide-toggle",8),e.\u0275\u0275listener("ngModelChange",function(o){return t.notShowAgain=o}),e.\u0275\u0275text(11),e.\u0275\u0275pipe(12,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(13,"span",2),e.\u0275\u0275elementStart(14,"button",9),e.\u0275\u0275listener("click",function(){return t.close()}),e.\u0275\u0275pipe(15,"async"),e.\u0275\u0275text(16),e.\u0275\u0275pipe(17,"translate"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(18,ib,5,3,"ng-template",null,10,e.\u0275\u0275templateRefExtractor)),2&n){const a=e.\u0275\u0275reference(19);e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(t.dialogTitle),e.\u0275\u0275advance(6),e.\u0275\u0275property("ngIf",t.loadedInstructions)("ngIfElse",a),e.\u0275\u0275advance(2),e.\u0275\u0275propertyInterpolate("fxShow",t.showDontShowAgain),e.\u0275\u0275property("ngModel",t.notShowAgain),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(12,8,"action.dont-show-again")),e.\u0275\u0275advance(3),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(15,10,t.isLoading$)),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(17,12,"action.close"))}},dependencies:[p.NgIf,nr.TbMarkdownComponent,S.MatButton,S.MatIconButton,F.MatIcon,oe.MatToolbar,C.MatDialogContent,C.MatDialogActions,Ga.MatProgressSpinner,H.MatTabContent,H.MatTabLabel,H.MatTab,H.MatTabGroup,Ce.MatSlideToggle,h.DefaultFlexDirective,G.DefaultShowHideDirective,r.NgControlStatus,r.NgModel,g.TranslateDirective,p.AsyncPipe,g.TranslatePipe],styles:['@charset "UTF-8";[_nghost-%COMP%]{height:100%;max-height:100vh;display:grid;grid-template-rows:min-content minmax(auto,1fr) min-content}[_nghost-%COMP%]   .tb-loader[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;gap:16px;height:300px;max-height:100%}[_nghost-%COMP%]   .tb-loader[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{margin-bottom:0;text-align:center}[_nghost-%COMP%]   .tb-font-14[_ngcontent-%COMP%]{font-size:14px}[_nghost-%COMP%]   .tb-flex-1[_ngcontent-%COMP%]{flex:1}@media screen and (min-width: 600px) and (max-width: 959px){[_nghost-%COMP%]{width:705px}}@media screen and (min-width: 960px){[_nghost-%COMP%]{width:1080px}}.mat-mdc-dialog-container[_nghost-%COMP%]   .tb-dialog-actions[_ngcontent-%COMP%], .mat-mdc-dialog-container   [_nghost-%COMP%]   .tb-dialog-actions[_ngcontent-%COMP%]{display:flex;gap:8px;padding:8px 16px}.mat-mdc-dialog-container[_nghost-%COMP%]   .mat-mdc-dialog-content[_ngcontent-%COMP%], .mat-mdc-dialog-container   [_nghost-%COMP%]   .mat-mdc-dialog-content[_ngcontent-%COMP%]{max-height:80vh;padding:0 16px 16px}[_nghost-%COMP%]     .tb-markdown-view{padding:16px 16px 32px}[_nghost-%COMP%]     .tb-markdown-view div.code-wrapper button.clipboard-btn{right:-2px!important}[_nghost-%COMP%]     .tb-markdown-view div.code-wrapper button.clipboard-btn div img{display:none}[_nghost-%COMP%]     .tb-markdown-view div.code-wrapper button.clipboard-btn div:after{content:"";position:initial;display:block;width:18px;height:18px;-webkit-mask-image:url(/assets/copy-code-icon.svg);mask-image:url(/assets/copy-code-icon.svg);-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat}[_nghost-%COMP%]     .tb-markdown-view div.code-wrapper button.clipboard-btn.multiline{right:-2px!important}[_nghost-%COMP%]     .tb-markdown-view>*:not(ul){padding-right:unset!important;padding-left:unset!important}[_nghost-%COMP%]     .tb-markdown-view pre[class*=language-]{border:1px solid #424242!important}[_nghost-%COMP%]     .mdc-button__label>span .mat-icon{vertical-align:text-bottom;box-sizing:initial}[_nghost-%COMP%]     .mat-mdc-tab-header{position:sticky;top:0;z-index:10}[_nghost-%COMP%]     .tabs-icon{margin-right:8px}[_nghost-%COMP%]     .tb-form-panel.tb-tab-body{padding:16px 0 0}[_nghost-%COMP%]     .mat-mdc-tab-body{padding:16px 0}']});var ab=c(4443);class Ve{constructor(n,t,a,o,s,l,d,m,y,I){this.store=n,this.broadcast=t,this.edgeService=a,this.customerService=o,this.dialogService=s,this.homeDialogs=l,this.translate=d,this.datePipe=m,this.router=y,this.dialog=I,this.config=new v.ap,this.config.entityType=f.py.EDGE,this.config.entityComponent=la,this.config.entityTabsComponent=ca,this.config.entityTranslations=f.Jr.get(f.py.EDGE),this.config.entityResources=f.CZ.get(f.py.EDGE),this.config.deleteEntityTitle=E=>this.translate.instant("edge.delete-edge-title",{edgeName:E.name}),this.config.deleteEntityContent=()=>this.translate.instant("edge.delete-edge-text"),this.config.deleteEntitiesTitle=E=>this.translate.instant("edge.delete-edges-title",{count:E}),this.config.deleteEntitiesContent=()=>this.translate.instant("edge.delete-edges-text"),this.config.loadEntity=E=>this.edgeService.getEdgeInfo(E.id),this.config.saveEntity=E=>this.edgeService.saveEdge(E).pipe((0,Z.b)(()=>{this.broadcast.broadcast("edgeSaved")}),(0,ne.z)(L=>this.edgeService.getEdgeInfo(L.id.id))),this.config.onEntityAction=E=>this.onEdgeAction(E,this.config),this.config.detailsReadonly=()=>"customer_user"===this.config.componentsData.edgeScope,this.config.headerComponent=da}resolve(n){const t=n.params;return this.config.componentsData={edgeScope:n.data.edgesType,edgeType:""},this.customerId=t.customerId,this.store.pipe((0,x.select)(q.rk),(0,Re.q)(1)).pipe((0,Z.b)(a=>{a.authority===u.W.CUSTOMER_USER&&(this.config.componentsData.edgeScope="customer_user",this.customerId=a.customerId)}),(0,ne.z)(()=>this.customerId?this.customerService.getCustomer(this.customerId):(0,J.of)(null)),(0,re.U)(a=>(a?a.additionalInfo&&a.additionalInfo.isPublic?this.config.tableTitle=this.translate.instant("customer.public-edges"):this.config.tableTitle=a.title+": "+this.translate.instant("edge.edge-instances"):this.config.tableTitle=this.translate.instant("edge.edge-instances"),this.config.columns=this.configureColumns(this.config.componentsData.edgeScope),this.configureEntityFunctions(this.config.componentsData.edgeScope),this.config.cellActionDescriptors=this.configureCellActions(this.config.componentsData.edgeScope),this.config.groupActionDescriptors=this.configureGroupActions(this.config.componentsData.edgeScope),this.config.addActionDescriptors=this.configureAddActions(this.config.componentsData.edgeScope),this.config.addEnabled="customer_user"!==this.config.componentsData.edgeScope,this.config.entitiesDeleteEnabled="tenant"===this.config.componentsData.edgeScope,this.config.deleteEnabled=()=>"tenant"===this.config.componentsData.edgeScope,this.config.addEntity=()=>(this.addEdge(),(0,J.of)(null)),this.config)))}configureColumns(n){const t=[new v.eq("createdTime","common.created-time",this.datePipe,"150px"),new v.QI("name","edge.name","25%"),new v.QI("type","edge.edge-type","25%"),new v.QI("label","edge.label","25%")];return"tenant"===n&&t.push(new v.QI("customerTitle","customer.customer","25%"),new v.QI("customerIsPublic","edge.public","60px",a=>(0,v.Gj)(a.customerIsPublic),()=>({}),!1)),t}configureEntityFunctions(n){"tenant"===n&&(this.config.entitiesFetchFunction=t=>this.edgeService.getTenantEdgeInfos(t,this.config.componentsData.edgeType),this.config.deleteEntity=t=>this.edgeService.deleteEdge(t.id)),"customer"===n&&(this.config.entitiesFetchFunction=t=>this.edgeService.getCustomerEdgeInfos(this.customerId,t,this.config.componentsData.edgeType),this.config.deleteEntity=t=>this.edgeService.unassignEdgeFromCustomer(t.id)),"customer_user"===n&&(this.config.entitiesFetchFunction=t=>this.edgeService.getCustomerEdgeInfos(this.customerId,t,this.config.componentsData.edgeType),this.config.deleteEntity=t=>this.edgeService.unassignEdgeFromCustomer(t.id))}configureCellActions(n){const t=[];return"tenant"===n&&t.push({name:this.translate.instant("edge.make-public"),icon:"share",isEnabled:a=>!a.customerId||a.customerId.id===P._,onAction:(a,o)=>this.makePublic(a,o)},{name:this.translate.instant("edge.assign-to-customer"),icon:"assignment_ind",isEnabled:a=>!a.customerId||a.customerId.id===P._,onAction:(a,o)=>this.assignToCustomer(a,[o.id])},{name:this.translate.instant("edge.unassign-from-customer"),icon:"assignment_return",isEnabled:a=>a.customerId&&a.customerId.id!==P._&&!a.customerIsPublic,onAction:(a,o)=>this.unassignFromCustomer(a,o)},{name:this.translate.instant("edge.make-private"),icon:"reply",isEnabled:a=>a.customerId&&a.customerId.id!==P._&&a.customerIsPublic,onAction:(a,o)=>this.unassignFromCustomer(a,o)},{name:this.translate.instant("edge.manage-assets"),icon:"domain",isEnabled:a=>!0,onAction:(a,o)=>this.openEdgeEntitiesByType(a,o,f.py.ASSET)},{name:this.translate.instant("edge.manage-devices"),icon:"devices_other",isEnabled:a=>!0,onAction:(a,o)=>this.openEdgeEntitiesByType(a,o,f.py.DEVICE)},{name:this.translate.instant("edge.manage-entity-views"),icon:"view_quilt",isEnabled:a=>!0,onAction:(a,o)=>this.openEdgeEntitiesByType(a,o,f.py.ENTITY_VIEW)},{name:this.translate.instant("edge.manage-dashboards"),icon:"dashboard",isEnabled:a=>!0,onAction:(a,o)=>this.openEdgeEntitiesByType(a,o,f.py.DASHBOARD)},{name:this.translate.instant("edge.manage-rulechains"),icon:"settings_ethernet",isEnabled:a=>!0,onAction:(a,o)=>this.openEdgeEntitiesByType(a,o,f.py.RULE_CHAIN)}),"customer"===n&&t.push({name:this.translate.instant("edge.unassign-from-customer"),icon:"assignment_return",isEnabled:a=>a.customerId&&a.customerId.id!==P._&&!a.customerIsPublic,onAction:(a,o)=>this.unassignFromCustomer(a,o)},{name:this.translate.instant("edge.make-private"),icon:"reply",isEnabled:a=>a.customerId&&a.customerId.id!==P._&&a.customerIsPublic,onAction:(a,o)=>this.unassignFromCustomer(a,o)}),"customer_user"===n&&t.push({name:this.translate.instant("edge.manage-assets"),icon:"domain",isEnabled:a=>!0,onAction:(a,o)=>this.openEdgeEntitiesByType(a,o,f.py.ASSET)},{name:this.translate.instant("edge.manage-devices"),icon:"devices_other",isEnabled:a=>!0,onAction:(a,o)=>this.openEdgeEntitiesByType(a,o,f.py.DEVICE)},{name:this.translate.instant("edge.manage-entity-views"),icon:"view_quilt",isEnabled:a=>!0,onAction:(a,o)=>this.openEdgeEntitiesByType(a,o,f.py.ENTITY_VIEW)},{name:this.translate.instant("edge.manage-dashboards"),icon:"dashboard",isEnabled:a=>!0,onAction:(a,o)=>this.openEdgeEntitiesByType(a,o,f.py.DASHBOARD)}),t}configureGroupActions(n){const t=[];return"tenant"===n&&t.push({name:this.translate.instant("edge.assign-edge-to-customer-text"),icon:"assignment_ind",isEnabled:!0,onAction:(a,o)=>this.assignToCustomer(a,o.map(s=>s.id))}),"customer"===n&&t.push({name:this.translate.instant("edge.unassign-from-customer"),icon:"assignment_return",isEnabled:!0,onAction:(a,o)=>this.unassignEdgesFromCustomer(a,o)}),t}configureAddActions(n){const t=[];return"tenant"===n&&t.push({name:this.translate.instant("edge.add-edge-text"),icon:"insert_drive_file",isEnabled:()=>!0,onAction:a=>this.config.getTable().addEntity(a)},{name:this.translate.instant("edge.import"),icon:"file_upload",isEnabled:()=>!0,onAction:a=>this.importEdges(a)}),"customer"===n&&t.push({name:this.translate.instant("edge.assign-new-edge"),icon:"add",isEnabled:()=>!0,onAction:a=>this.addEdgesToCustomer(a)}),t}importEdges(n){this.homeDialogs.importEntities(f.py.EDGE).subscribe(t=>{t&&(this.broadcast.broadcast("edgeSaved"),this.config.updateData())})}addEdgesToCustomer(n){n&&n.stopPropagation(),this.dialog.open(Ka.J,{disableClose:!0,panelClass:["tb-dialog","tb-fullscreen-dialog"],data:{customerId:this.customerId,entityType:f.py.EDGE}}).afterClosed().subscribe(t=>{t&&this.config.updateData()})}openEdge(n,t,a){n&&n.stopPropagation();const o=this.router.createUrlTree([t.id.id],{relativeTo:a.getActivatedRoute()});this.router.navigateByUrl(o)}makePublic(n,t){n&&n.stopPropagation(),this.dialogService.confirm(this.translate.instant("edge.make-public-edge-title",{edgeName:t.name}),this.translate.instant("edge.make-public-edge-text"),this.translate.instant("action.no"),this.translate.instant("action.yes"),!0).subscribe(a=>{a&&this.edgeService.makeEdgePublic(t.id.id).subscribe(()=>{this.config.updateData()})})}openEdgeEntitiesByType(n,t,a){let o;switch(n&&n.stopPropagation(),a){case f.py.DEVICE:o="devices";break;case f.py.ASSET:case f.py.EDGE:o="assets";break;case f.py.ENTITY_VIEW:o="entityViews";break;case f.py.DASHBOARD:o="dashboards";break;case f.py.RULE_CHAIN:o="ruleChains"}this.router.navigateByUrl(`edgeManagement/instances/${t.id.id}/${o}`)}assignToCustomer(n,t){n&&n.stopPropagation(),this.dialog.open(za.S,{disableClose:!0,panelClass:["tb-dialog","tb-fullscreen-dialog"],data:{entityIds:t,entityType:f.py.EDGE}}).afterClosed().subscribe(a=>{a&&this.config.updateData()})}unassignFromCustomer(n,t){n&&n.stopPropagation();let o,s;t.customerIsPublic?(o=this.translate.instant("edge.make-private-edge-title",{edgeName:t.name}),s=this.translate.instant("edge.make-private-edge-text")):(o=this.translate.instant("edge.unassign-edge-title",{edgeName:t.name}),s=this.translate.instant("edge.unassign-edge-text")),this.dialogService.confirm(o,s,this.translate.instant("action.no"),this.translate.instant("action.yes"),!0).subscribe(l=>{l&&this.edgeService.unassignEdgeFromCustomer(t.id.id).subscribe(()=>{this.config.updateData("tenant"!==this.config.componentsData.edgeScope)})})}unassignEdgesFromCustomer(n,t){n&&n.stopPropagation(),this.dialogService.confirm(this.translate.instant("edge.unassign-edges-title",{count:t.length}),this.translate.instant("edge.unassign-edges-text"),this.translate.instant("action.no"),this.translate.instant("action.yes"),!0).subscribe(a=>{if(a){const o=[];t.forEach(s=>{o.push(this.edgeService.unassignEdgeFromCustomer(s.id.id))}),(0,xe.D)(o).subscribe(()=>{this.config.updateData()})}})}syncEdge(n,t){n&&n.stopPropagation(),this.edgeService.syncEdge(t.id.id).subscribe(()=>{this.store.dispatch(new V.zi({message:this.translate.instant("edge.sync-process-started-successfully"),type:"success",duration:750,verticalPosition:"bottom",horizontalPosition:"right"}))})}addEdge(){this.dialog.open(ab.AddEntityDialogComponent,{disableClose:!0,panelClass:["tb-dialog","tb-fullscreen-dialog"],data:{entitiesTableConfig:this.config}}).afterClosed().subscribe(n=>{n&&this.store.pipe((0,x.select)((0,q.f6)("notDisplayInstructionsAfterAddEdge"))).pipe((0,Re.q)(1)).subscribe(t=>{t?(this.config.updateData(),this.config.entityAdded(n)):this.openInstructions(null,n,!0)})})}openInstructions(n,t,a=!1,o=!1){n&&n.stopPropagation(),this.dialog.open(pa,{disableClose:!0,panelClass:["tb-dialog","tb-fullscreen-dialog"],data:{edge:t,afterAdd:a,upgradeAvailable:o}}).afterClosed().subscribe(()=>{a&&this.config.updateData()})}onEdgeAction(n,t){switch(n.action){case"open":return this.openEdge(n.event,n.entity,t),!0;case"makePublic":return this.makePublic(n.event,n.entity),!0;case"assignToCustomer":return this.assignToCustomer(n.event,[n.entity.id]),!0;case"unassignFromCustomer":return this.unassignFromCustomer(n.event,n.entity),!0;case"openEdgeAssets":return this.openEdgeEntitiesByType(n.event,n.entity,f.py.ASSET),!0;case"openEdgeDevices":return this.openEdgeEntitiesByType(n.event,n.entity,f.py.DEVICE),!0;case"openEdgeEntityViews":return this.openEdgeEntitiesByType(n.event,n.entity,f.py.ENTITY_VIEW),!0;case"openEdgeDashboards":return this.openEdgeEntitiesByType(n.event,n.entity,f.py.DASHBOARD),!0;case"openEdgeRuleChains":return this.openEdgeEntitiesByType(n.event,n.entity,f.py.RULE_CHAIN),!0;case"syncEdge":return this.syncEdge(n.event,n.entity),!0;case"openInstallInstructions":return this.openInstructions(n.event,n.entity),!0;case"openUpgradeInstructions":return this.openInstructions(n.event,n.entity,!1,!0),!0}}}Ve.\u0275fac=function(n){return new(n||Ve)(e.\u0275\u0275inject(x.Store),e.\u0275\u0275inject(Pa.M),e.\u0275\u0275inject(Yn.A),e.\u0275\u0275inject($e.v),e.\u0275\u0275inject(pe.x),e.\u0275\u0275inject(lt.U),e.\u0275\u0275inject(g.TranslateService),e.\u0275\u0275inject(p.DatePipe),e.\u0275\u0275inject(b.Router),e.\u0275\u0275inject(C.MatDialog))},Ve.\u0275prov=e.\u0275\u0275defineInjectable({token:Ve,factory:Ve.\u0275fac});const ob=[{path:"customers",data:{breadcrumb:{label:"customer.customers",icon:"supervisor_account"}},children:[{path:"",component:j.EntitiesTableComponent,data:{auth:[u.W.TENANT_ADMIN],title:"customer.customers"},resolve:{entitiesTableConfig:Ft}},{path:":entityId",component:ee.Y,canDeactivate:[N.P],data:{breadcrumb:{labelFunction:te,icon:"supervisor_account"},auth:[u.W.TENANT_ADMIN],title:"customer.customers"},resolve:{entitiesTableConfig:Ft}},{path:":customerId/users",data:{breadcrumb:{label:"user.customer-users",icon:"account_circle"}},children:[{path:"",component:j.EntitiesTableComponent,data:{auth:[u.W.TENANT_ADMIN],title:"user.customer-users"},resolve:{entitiesTableConfig:Ne}},{path:":entityId",component:ee.Y,canDeactivate:[N.P],data:{breadcrumb:{labelFunction:te,icon:"account_circle"},auth:[u.W.TENANT_ADMIN],title:"user.customer-users"},resolve:{entitiesTableConfig:Ne}}]},{path:":customerId/devices",data:{breadcrumb:{label:"customer.devices",icon:"devices_other"}},children:[{path:"",component:j.EntitiesTableComponent,data:{auth:[u.W.TENANT_ADMIN],title:"customer.devices",devicesType:"customer"},resolve:{entitiesTableConfig:Ie}},{path:":entityId",component:ee.Y,canDeactivate:[N.P],data:{breadcrumb:{labelFunction:te,icon:"devices_other"},auth:[u.W.TENANT_ADMIN],title:"customer.devices",devicesType:"customer"},resolve:{entitiesTableConfig:Ie}}]},{path:":customerId/assets",data:{breadcrumb:{label:"customer.assets",icon:"domain"}},children:[{path:"",component:j.EntitiesTableComponent,data:{auth:[u.W.TENANT_ADMIN],title:"customer.assets",assetsType:"customer"},resolve:{entitiesTableConfig:we}},{path:":entityId",component:ee.Y,canDeactivate:[N.P],data:{breadcrumb:{labelFunction:te,icon:"domain"},auth:[u.W.TENANT_ADMIN],title:"customer.assets",assetsType:"customer"},resolve:{entitiesTableConfig:we}}]},{path:":customerId/edgeInstances",data:{breadcrumb:{label:"customer.edges",icon:"router"}},children:[{path:"",component:j.EntitiesTableComponent,data:{auth:[u.W.TENANT_ADMIN],title:"customer.edges",edgesType:"customer"},resolve:{entitiesTableConfig:Ve}},{path:":entityId",component:ee.Y,canDeactivate:[N.P],data:{breadcrumb:{labelFunction:te,icon:"router"},auth:[u.W.TENANT_ADMIN],title:"customer.edges",edgesType:"customer"},resolve:{entitiesTableConfig:Ve}}]},{path:":customerId/dashboards",data:{breadcrumb:{label:"customer.dashboards",icon:"dashboard"}},children:[{path:"",component:j.EntitiesTableComponent,data:{auth:[u.W.TENANT_ADMIN],title:"customer.dashboards",dashboardsType:"customer"},resolve:{entitiesTableConfig:rr.C}},{path:":dashboardId",component:Ha.DashboardPageComponent,canDeactivate:[N.P],data:{breadcrumb:{labelFunction:sa.it,icon:"dashboard"},auth:[u.W.TENANT_ADMIN,u.W.CUSTOMER_USER],title:"customer.dashboard",widgetEditMode:!1},resolve:{dashboard:sa.tA}}]}]}];class Rt{}Rt.\u0275fac=function(n){return new(n||Rt)},Rt.\u0275mod=e.\u0275\u0275defineNgModule({type:Rt}),Rt.\u0275inj=e.\u0275\u0275defineInjector({providers:[Ft],imports:[b.RouterModule.forChild(ob),b.RouterModule]}),(typeof ngJitMode>"u"||ngJitMode)&&e.\u0275\u0275setNgModuleScope(Rt,{imports:[b.RouterModule],exports:[b.RouterModule]});class Ot{}Ot.\u0275fac=function(n){return new(n||Ot)},Ot.\u0275mod=e.\u0275\u0275defineNgModule({type:Ot}),Ot.\u0275inj=e.\u0275\u0275defineInjector({imports:[p.CommonModule,M.m,k.W,Rt]}),(typeof ngJitMode>"u"||ngJitMode)&&e.\u0275\u0275setNgModuleScope(Ot,{declarations:[Ji,Qi],imports:[p.CommonModule,M.m,k.W,Rt]});class Bt{}Bt.\u0275fac=function(n){return new(n||Bt)},Bt.\u0275mod=e.\u0275\u0275defineNgModule({type:Bt}),Bt.\u0275inj=e.\u0275\u0275defineInjector({imports:[p.CommonModule,M.m,bt]}),(typeof ngJitMode>"u"||ngJitMode)&&e.\u0275\u0275setNgModuleScope(Bt,{imports:[p.CommonModule,M.m,bt]});const rb=[{path:"users",data:{breadcrumb:{skip:!0}},children:[{path:"",redirectTo:"/",pathMatch:"full"},{path:":entityId",component:ee.Y,canDeactivate:[N.P],data:{breadcrumb:{labelFunction:te,icon:"account_circle"},auth:[u.W.SYS_ADMIN,u.W.TENANT_ADMIN],title:"user.user"},resolve:{entitiesTableConfig:Ne}}]}];class Vt{}Vt.\u0275fac=function(n){return new(n||Vt)},Vt.\u0275mod=e.\u0275\u0275defineNgModule({type:Vt}),Vt.\u0275inj=e.\u0275\u0275defineInjector({providers:[Ne],imports:[b.RouterModule.forChild(rb),b.RouterModule]}),(typeof ngJitMode>"u"||ngJitMode)&&e.\u0275\u0275setNgModuleScope(Vt,{imports:[b.RouterModule],exports:[b.RouterModule]});class Ut{}Ut.\u0275fac=function(n){return new(n||Ut)},Ut.\u0275mod=e.\u0275\u0275defineNgModule({type:Ut}),Ut.\u0275inj=e.\u0275\u0275defineInjector({imports:[p.CommonModule,M.m,k.W,Vt]}),(typeof ngJitMode>"u"||ngJitMode)&&e.\u0275\u0275setNgModuleScope(Ut,{declarations:[Dt,Yi,Ki,Gn],imports:[p.CommonModule,M.m,k.W,Vt]});const sb=[{path:"devices",data:{breadcrumb:{label:"device.devices",icon:"devices_other"}},children:[{path:"",component:j.EntitiesTableComponent,data:{auth:[u.W.TENANT_ADMIN,u.W.CUSTOMER_USER],title:"device.devices",devicesType:"tenant"},resolve:{entitiesTableConfig:Ie}},{path:":entityId",component:ee.Y,canDeactivate:[N.P],data:{breadcrumb:{labelFunction:te,icon:"devices_other"},auth:[u.W.TENANT_ADMIN,u.W.CUSTOMER_USER],title:"device.devices",devicesType:"tenant"},resolve:{entitiesTableConfig:Ie}}]}];class Gt{}Gt.\u0275fac=function(n){return new(n||Gt)},Gt.\u0275mod=e.\u0275\u0275defineNgModule({type:Gt}),Gt.\u0275inj=e.\u0275\u0275defineInjector({providers:[Ie],imports:[b.RouterModule.forChild([{path:"devices",pathMatch:"full",redirectTo:"/entities/devices"},{path:"devices/:entityId",redirectTo:"/entities/devices/:entityId"}]),b.RouterModule]}),(typeof ngJitMode>"u"||ngJitMode)&&e.\u0275\u0275setNgModuleScope(Gt,{imports:[b.RouterModule],exports:[b.RouterModule]});var Ee=c(19097),cr=c(24481),pr=c(11432);class jt{}jt.\u0275fac=function(n){return new(n||jt)},jt.\u0275mod=e.\u0275\u0275defineNgModule({type:jt}),jt.\u0275inj=e.\u0275\u0275defineInjector({imports:[p.CommonModule,M.m,k.W,Ee.J,cr.X,pr.C,Gt]}),(typeof ngJitMode>"u"||ngJitMode)&&e.\u0275\u0275setNgModuleScope(jt,{declarations:[jn,Wn,qn,$n,Hn,zn,Lt,Pt,kt,Xi,ea,Zi,Kn,ia],imports:[p.CommonModule,M.m,k.W,Ee.J,cr.X,pr.C,Gt]});const db=[{path:"assets",data:{breadcrumb:{label:"asset.assets",icon:"domain"}},children:[{path:"",component:j.EntitiesTableComponent,data:{auth:[u.W.TENANT_ADMIN,u.W.CUSTOMER_USER],title:"asset.assets",assetsType:"tenant"},resolve:{entitiesTableConfig:we}},{path:":entityId",component:ee.Y,canDeactivate:[N.P],data:{breadcrumb:{labelFunction:te,icon:"domain"},auth:[u.W.TENANT_ADMIN,u.W.CUSTOMER_USER],title:"asset.assets",assetsType:"tenant"},resolve:{entitiesTableConfig:we}}]}];class Wt{}Wt.\u0275fac=function(n){return new(n||Wt)},Wt.\u0275mod=e.\u0275\u0275defineNgModule({type:Wt}),Wt.\u0275inj=e.\u0275\u0275defineInjector({providers:[we],imports:[b.RouterModule.forChild([{path:"assets",pathMatch:"full",redirectTo:"/entities/assets"},{path:"assets/:entityId",redirectTo:"/entities/assets/:entityId"}]),b.RouterModule]}),(typeof ngJitMode>"u"||ngJitMode)&&e.\u0275\u0275setNgModuleScope(Wt,{imports:[b.RouterModule],exports:[b.RouterModule]});class qt{}qt.\u0275fac=function(n){return new(n||qt)},qt.\u0275mod=e.\u0275\u0275defineNgModule({type:qt}),qt.\u0275inj=e.\u0275\u0275defineInjector({imports:[p.CommonModule,M.m,k.W,Ee.J,Wt]}),(typeof ngJitMode>"u"||ngJitMode)&&e.\u0275\u0275setNgModuleScope(qt,{declarations:[aa,ra,oa],imports:[p.CommonModule,M.m,k.W,Ee.J,Wt]});var pb=c(77404),mb=c(82433),ub=c(27355);function gb(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"entity-view.name-required")," "))}function fb(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"entity-view.name-max-length")," "))}class ma extends Te.r{constructor(n,t,a,o,s,l){super(n,s,a,o,l),this.store=n,this.translate=t,this.entityValue=a,this.entitiesTableConfigValue=o,this.fb=s,this.cd=l,this.entityType=f.py,this.dataKeyType=ta.dG,this.allowedEntityTypes=[f.py.DEVICE,f.py.ASSET]}ngOnInit(){this.entityViewScope=this.entitiesTableConfig.componentsData.entityViewScope,super.ngOnInit(),this.maxStartTimeMs=this.entityForm.get("endTimeMs").valueChanges,this.minEndTimeMs=this.entityForm.get("startTimeMs").valueChanges,this.selectedEntityId=this.entityForm.get("entityId").valueChanges}hideDelete(){return!!this.entitiesTableConfig&&!this.entitiesTableConfig.deleteEnabled(this.entity)}isAssignedToCustomer(n){return n&&n.customerId&&n.customerId.id!==P._}buildForm(n){return this.fb.group({name:[n?n.name:"",[r.Validators.required,r.Validators.maxLength(255)]],type:[n?n.type:null,r.Validators.required],entityId:[n?n.entityId:null,[r.Validators.required]],startTimeMs:[n?n.startTimeMs:null],endTimeMs:[n?n.endTimeMs:null],keys:this.fb.group({attributes:this.fb.group({cs:[n&&n.keys&&n.keys.attributes?n.keys.attributes.cs:null],sh:[n&&n.keys&&n.keys.attributes?n.keys.attributes.sh:null],ss:[n&&n.keys&&n.keys.attributes?n.keys.attributes.ss:null]}),timeseries:[n&&n.keys&&n.keys.timeseries?n.keys.timeseries:null]}),additionalInfo:this.fb.group({description:[n&&n.additionalInfo?n.additionalInfo.description:""]})})}updateForm(n){this.entityForm.patchValue({name:n.name}),this.entityForm.patchValue({type:n.type}),this.entityForm.patchValue({entityId:n.entityId}),this.entityForm.patchValue({startTimeMs:n.startTimeMs}),this.entityForm.patchValue({endTimeMs:n.endTimeMs}),this.entityForm.patchValue({keys:{attributes:{cs:n.keys&&n.keys.attributes?n.keys.attributes.cs:null,sh:n.keys&&n.keys.attributes?n.keys.attributes.sh:null,ss:n.keys&&n.keys.attributes?n.keys.attributes.ss:null},timeseries:n.keys&&n.keys.timeseries?n.keys.timeseries:null}}),this.entityForm.patchValue({additionalInfo:{description:n.additionalInfo?n.additionalInfo.description:""}})}onEntityViewIdCopied(n){this.store.dispatch(new V.zi({message:this.translate.instant("entity-view.idCopiedMessage"),type:"success",duration:750,verticalPosition:"bottom",horizontalPosition:"right"}))}}ma.\u0275fac=function(n){return new(n||ma)(e.\u0275\u0275directiveInject(x.Store),e.\u0275\u0275directiveInject(g.TranslateService),e.\u0275\u0275directiveInject("entity"),e.\u0275\u0275directiveInject("entitiesTableConfig"),e.\u0275\u0275directiveInject(r.UntypedFormBuilder),e.\u0275\u0275directiveInject(e.ChangeDetectorRef))},ma.\u0275cmp=e.\u0275\u0275defineComponent({type:ma,selectors:[["tb-entity-view"]],features:[e.\u0275\u0275InheritDefinitionFeature],decls:93,vars:85,consts:[["fxLayout.xs","column",1,"tb-details-buttons"],["mat-raised-button","","color","primary",3,"disabled","fxShow","click"],["fxLayout","row","fxLayout.xs","column"],["mat-raised-button","","ngxClipboard","",3,"cbContent","fxShow","cbOnSuccess"],["svgIcon","mdi:clipboard-arrow-left"],["translate",""],["fxLayout","column",1,"mat-padding"],[1,"mat-block",3,"fxShow"],["matInput","","disabled","",3,"ngModel"],[1,"tb-small",2,"padding-bottom","10px","padding-left","2px",3,"fxShow"],[3,"formGroup"],[3,"disabled"],[1,"mat-block"],["matInput","","formControlName","name","required",""],[4,"ngIf"],["formControlName","type",3,"required","entityType"],["fxLayout","column"],["translate","",1,"tb-title","no-padding"],["fxFlex","","formControlName","entityId",3,"required","allowedEntityTypes"],["formGroupName","keys",1,"mat-accordion-container"],[3,"multi"],["formGroupName","attributes",3,"expanded"],["translate","",1,"tb-panel-title"],["translate","",1,"tb-hint"],["formControlName","cs","keysText","entity-view.client-attributes-placeholder",3,"entityId","dataKeyType"],["formControlName","sh","keysText","entity-view.shared-attributes-placeholder",3,"entityId","dataKeyType"],["formControlName","ss","keysText","entity-view.server-attributes-placeholder",3,"entityId","dataKeyType"],[3,"expanded"],["formControlName","timeseries","keysText","entity-view.timeseries-placeholder",3,"entityId","dataKeyType"],["dateText","entity-view.start-date","timeText","entity-view.start-ts","formControlName","startTimeMs",3,"maxDate"],["dateText","entity-view.end-date","timeText","entity-view.end-ts","formControlName","endTimeMs",3,"minDate"],["formGroupName","additionalInfo"],["matInput","","formControlName","description","rows","2"]],template:function(n,t){1&n&&(e.\u0275\u0275elementStart(0,"div",0)(1,"button",1),e.\u0275\u0275listener("click",function(o){return t.onEntityAction(o,"open")}),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275text(3),e.\u0275\u0275pipe(4,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"button",1),e.\u0275\u0275listener("click",function(o){return t.onEntityAction(o,"makePublic")}),e.\u0275\u0275pipe(6,"async"),e.\u0275\u0275text(7),e.\u0275\u0275pipe(8,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(9,"button",1),e.\u0275\u0275listener("click",function(o){return t.onEntityAction(o,"assignToCustomer")}),e.\u0275\u0275pipe(10,"async"),e.\u0275\u0275text(11),e.\u0275\u0275pipe(12,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(13,"button",1),e.\u0275\u0275listener("click",function(o){return t.onEntityAction(o,"unassignFromCustomer")}),e.\u0275\u0275pipe(14,"async"),e.\u0275\u0275text(15),e.\u0275\u0275pipe(16,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(17,"button",1),e.\u0275\u0275listener("click",function(o){return t.onEntityAction(o,"unassignFromEdge")}),e.\u0275\u0275pipe(18,"async"),e.\u0275\u0275text(19),e.\u0275\u0275pipe(20,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(21,"button",1),e.\u0275\u0275listener("click",function(o){return t.onEntityAction(o,"delete")}),e.\u0275\u0275pipe(22,"async"),e.\u0275\u0275text(23),e.\u0275\u0275pipe(24,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(25,"div",2)(26,"button",3),e.\u0275\u0275listener("cbOnSuccess",function(o){return t.onEntityViewIdCopied(o)}),e.\u0275\u0275element(27,"mat-icon",4),e.\u0275\u0275elementStart(28,"span",5),e.\u0275\u0275text(29,"entity-view.copyId"),e.\u0275\u0275elementEnd()()()(),e.\u0275\u0275elementStart(30,"div",6)(31,"mat-form-field",7)(32,"mat-label",5),e.\u0275\u0275text(33,"entity-view.assignedToCustomer"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(34,"input",8),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(35,"div",9),e.\u0275\u0275text(36),e.\u0275\u0275pipe(37,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(38,"form",10)(39,"fieldset",11),e.\u0275\u0275pipe(40,"async"),e.\u0275\u0275elementStart(41,"mat-form-field",12)(42,"mat-label",5),e.\u0275\u0275text(43,"entity-view.name"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(44,"input",13),e.\u0275\u0275template(45,gb,3,3,"mat-error",14),e.\u0275\u0275template(46,fb,3,3,"mat-error",14),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(47,"tb-entity-subtype-autocomplete",15),e.\u0275\u0275elementStart(48,"section",16)(49,"label",17),e.\u0275\u0275text(50,"entity-view.target-entity"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(51,"tb-entity-select",18),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(52,"div",19)(53,"mat-accordion",20)(54,"mat-expansion-panel",21)(55,"mat-expansion-panel-header")(56,"mat-panel-title")(57,"div",22),e.\u0275\u0275text(58,"entity-view.attributes-propagation"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(59,"div",23),e.\u0275\u0275text(60,"entity-view.attributes-propagation-hint"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(61,"label",17),e.\u0275\u0275text(62,"entity-view.client-attributes"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(63,"tb-entity-keys-list",24),e.\u0275\u0275pipe(64,"async"),e.\u0275\u0275elementStart(65,"label",17),e.\u0275\u0275text(66,"entity-view.shared-attributes"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(67,"tb-entity-keys-list",25),e.\u0275\u0275pipe(68,"async"),e.\u0275\u0275elementStart(69,"label",17),e.\u0275\u0275text(70,"entity-view.server-attributes"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(71,"tb-entity-keys-list",26),e.\u0275\u0275pipe(72,"async"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(73,"mat-expansion-panel",27)(74,"mat-expansion-panel-header")(75,"mat-panel-title")(76,"div",22),e.\u0275\u0275text(77,"entity-view.timeseries-data"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(78,"div",23),e.\u0275\u0275text(79,"entity-view.timeseries-data-hint"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(80,"label",17),e.\u0275\u0275text(81,"entity-view.timeseries"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(82,"tb-entity-keys-list",28),e.\u0275\u0275pipe(83,"async"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275element(84,"tb-datetime",29),e.\u0275\u0275pipe(85,"async"),e.\u0275\u0275element(86,"tb-datetime",30),e.\u0275\u0275pipe(87,"async"),e.\u0275\u0275elementStart(88,"div",31)(89,"mat-form-field",12)(90,"mat-label",5),e.\u0275\u0275text(91,"entity-view.description"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(92,"textarea",32),e.\u0275\u0275elementEnd()()()()()),2&n&&(e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(2,45,t.isLoading$))("fxShow",!t.isEdit&&!t.isDetailsPage),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(4,47,"common.open-details-page")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(6,49,t.isLoading$))("fxShow",!(t.isEdit||"tenant"!==t.entityViewScope||t.isAssignedToCustomer(t.entity)||null!=t.entity&&t.entity.customerIsPublic)),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(8,51,"entity-view.make-public")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(10,53,t.isLoading$))("fxShow",!t.isEdit&&"tenant"===t.entityViewScope&&!t.isAssignedToCustomer(t.entity)),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(12,55,"entity-view.assign-to-customer")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(14,57,t.isLoading$))("fxShow",!t.isEdit&&("customer"===t.entityViewScope||"tenant"===t.entityViewScope)&&t.isAssignedToCustomer(t.entity)),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(16,59,null!=t.entity&&t.entity.customerIsPublic?"entity-view.make-private":"entity-view.unassign-from-customer")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(18,61,t.isLoading$))("fxShow",!t.isEdit&&"edge"===t.entityViewScope),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(20,63,"edge.unassign-from-edge")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(22,65,t.isLoading$))("fxShow",!t.hideDelete()&&!t.isEdit),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(24,67,"entity-view.delete")," "),e.\u0275\u0275advance(3),e.\u0275\u0275property("cbContent",null==t.entity||null==t.entity.id?null:t.entity.id.id)("fxShow",!t.isEdit),e.\u0275\u0275advance(5),e.\u0275\u0275property("fxShow",!t.isEdit&&t.isAssignedToCustomer(t.entity)&&!(null!=t.entity&&t.entity.customerIsPublic)&&"tenant"===t.entityViewScope),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngModel",null==t.entity?null:t.entity.customerTitle),e.\u0275\u0275advance(1),e.\u0275\u0275property("fxShow",!t.isEdit&&(null==t.entity?null:t.entity.customerIsPublic)&&("customer"===t.entityViewScope||"tenant"===t.entityViewScope)),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(37,69,"entity-view.entity-view-public")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("formGroup",t.entityForm),e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(40,71,t.isLoading$)||!t.isEdit),e.\u0275\u0275advance(6),e.\u0275\u0275property("ngIf",t.entityForm.get("name").hasError("required")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.entityForm.get("name").hasError("maxlength")),e.\u0275\u0275advance(1),e.\u0275\u0275property("required",!0)("entityType",t.entityType.ENTITY_VIEW),e.\u0275\u0275advance(4),e.\u0275\u0275property("required",!0)("allowedEntityTypes",t.allowedEntityTypes),e.\u0275\u0275advance(2),e.\u0275\u0275property("multi",!0),e.\u0275\u0275advance(1),e.\u0275\u0275property("expanded",!0),e.\u0275\u0275advance(9),e.\u0275\u0275property("entityId",e.\u0275\u0275pipeBind1(64,73,t.selectedEntityId))("dataKeyType",t.dataKeyType.attribute),e.\u0275\u0275advance(4),e.\u0275\u0275property("entityId",e.\u0275\u0275pipeBind1(68,75,t.selectedEntityId))("dataKeyType",t.dataKeyType.attribute),e.\u0275\u0275advance(4),e.\u0275\u0275property("entityId",e.\u0275\u0275pipeBind1(72,77,t.selectedEntityId))("dataKeyType",t.dataKeyType.attribute),e.\u0275\u0275advance(2),e.\u0275\u0275property("expanded",!0),e.\u0275\u0275advance(9),e.\u0275\u0275property("entityId",e.\u0275\u0275pipeBind1(83,79,t.selectedEntityId))("dataKeyType",t.dataKeyType.timeseries),e.\u0275\u0275advance(2),e.\u0275\u0275property("maxDate",e.\u0275\u0275pipeBind1(85,81,t.maxStartTimeMs)),e.\u0275\u0275advance(2),e.\u0275\u0275property("minDate",e.\u0275\u0275pipeBind1(87,83,t.minEndTimeMs)))},dependencies:[p.NgIf,pb.DatetimeComponent,sr.EntitySubTypeAutocompleteComponent,mb.EntitySelectComponent,ub.EntityKeysListComponent,S.MatButton,F.MatIcon,O.MatInput,_.MatFormField,_.MatLabel,_.MatError,U.MatAccordion,U.MatExpansionPanel,U.MatExpansionPanelHeader,U.MatExpansionPanelTitle,he.yb,h.DefaultLayoutDirective,h.DefaultFlexDirective,G.DefaultShowHideDirective,r.\u0275NgNoValidate,r.DefaultValueAccessor,r.NgControlStatus,r.NgControlStatusGroup,r.RequiredValidator,r.NgModel,r.FormGroupDirective,r.FormControlName,r.FormGroupName,g.TranslateDirective,p.AsyncPipe,g.TranslatePipe],styles:['@charset "UTF-8";[_nghost-%COMP%]   .mat-accordion-container[_ngcontent-%COMP%]{margin-bottom:16px}']});class ua extends He.n{constructor(n){super(n),this.store=n,this.entityType=f.py}entityViewTypeChanged(n){this.entitiesTableConfig.componentsData.entityViewType=n,this.entitiesTableConfig.getTable().resetSortAndFilter(!0)}}ua.\u0275fac=function(n){return new(n||ua)(e.\u0275\u0275directiveInject(x.Store))},ua.\u0275cmp=e.\u0275\u0275defineComponent({type:ua,selectors:[["tb-entity-view-table-header"]],features:[e.\u0275\u0275InheritDefinitionFeature],decls:1,vars:3,consts:[["subscriptSizing","dynamic",3,"showLabel","entityType","ngModel","ngModelChange"]],template:function(n,t){1&n&&(e.\u0275\u0275elementStart(0,"tb-entity-subtype-select",0),e.\u0275\u0275listener("ngModelChange",function(o){return t.entityViewTypeChanged(o)}),e.\u0275\u0275elementEnd()),2&n&&e.\u0275\u0275property("showLabel",!0)("entityType",t.entityType.ENTITY_VIEW)("ngModel",t.entitiesTableConfig.componentsData.entityViewType)},dependencies:[lr.EntitySubTypeSelectComponent,r.NgControlStatus,r.NgModel],encapsulation:2});var hb=c(34108);function bb(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-tab",1,2),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275element(3,"tb-attribute-table",3),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275reference(1),a=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(2,5,"attribute.attributes")),e.\u0275\u0275advance(3),e.\u0275\u0275property("defaultAttributeScope",a.attributeScopes.CLIENT_SCOPE)("active",t.isActive)("entityId",a.entity.id)("entityName",a.entity.name)}}function yb(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-tab",1,4),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275element(3,"tb-attribute-table",5),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275reference(1),a=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(2,5,"attribute.latest-telemetry")),e.\u0275\u0275advance(3),e.\u0275\u0275property("defaultAttributeScope",a.latestTelemetryTypes.LATEST_TELEMETRY)("active",t.isActive)("entityId",a.entity.id)("entityName",a.entity.name)}}function vb(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-tab",1,6),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275element(3,"tb-alarm-table",7),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275reference(1),a=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(2,3,"alarm.alarms")),e.\u0275\u0275advance(3),e.\u0275\u0275property("active",t.isActive)("entityId",a.entity.id)}}function _b(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-tab",1,8),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275element(3,"tb-event-table",9),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275reference(1),a=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(2,5,"entity-view.events")),e.\u0275\u0275advance(3),e.\u0275\u0275property("defaultEventType",a.eventTypes.ERROR)("active",t.isActive)("tenantId",a.entity.tenantId.id)("entityId",a.entity.id)}}function xb(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-tab",1,10),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275element(3,"tb-relation-table",7),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275reference(1),a=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(2,3,"relation.relations")),e.\u0275\u0275advance(3),e.\u0275\u0275property("active",t.isActive)("entityId",a.entity.id)}}function Cb(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-tab",1,11),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275element(3,"tb-audit-log-table",12),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275reference(1),a=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(2,4,"audit-log.audit-logs")),e.\u0275\u0275advance(3),e.\u0275\u0275property("active",t.isActive)("auditLogMode",a.auditLogModes.ENTITY)("entityId",a.entity.id)}}function Tb(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"mat-tab",1,13),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementStart(3,"tb-version-control",14),e.\u0275\u0275listener("versionRestored",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.entitiesTableConfig.updateData())}),e.\u0275\u0275elementEnd()()}if(2&i){const t=e.\u0275\u0275reference(1),a=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(2,5,"version-control.version-control")),e.\u0275\u0275advance(3),e.\u0275\u0275property("active",t.isActive)("entityId",a.entity.id)("entityName",a.entity.name)("externalEntityId",a.entity.externalId||a.entity.id)}}class ga extends _e.l{constructor(n){super(n),this.store=n}ngOnInit(){super.ngOnInit()}}ga.\u0275fac=function(n){return new(n||ga)(e.\u0275\u0275directiveInject(x.Store))},ga.\u0275cmp=e.\u0275\u0275defineComponent({type:ga,selectors:[["tb-entity-view-tabs"]],features:[e.\u0275\u0275InheritDefinitionFeature],decls:7,vars:7,consts:[[3,"label",4,"ngIf"],[3,"label"],["attributesTab","matTab"],[3,"defaultAttributeScope","active","entityId","entityName"],["telemetryTab","matTab"],["disableAttributeScopeSelection","",3,"defaultAttributeScope","active","entityId","entityName"],["alarmsTab","matTab"],[3,"active","entityId"],["eventsTab","matTab"],[3,"defaultEventType","active","tenantId","entityId"],["relationsTab","matTab"],["auditLogsTab","matTab"],["detailsMode","true",3,"active","auditLogMode","entityId"],["versionControlTab","matTab"],["detailsMode","true","singleEntityMode","true",3,"active","entityId","entityName","externalEntityId","versionRestored"]],template:function(n,t){1&n&&(e.\u0275\u0275template(0,bb,4,7,"mat-tab",0),e.\u0275\u0275template(1,yb,4,7,"mat-tab",0),e.\u0275\u0275template(2,vb,4,5,"mat-tab",0),e.\u0275\u0275template(3,_b,4,7,"mat-tab",0),e.\u0275\u0275template(4,xb,4,5,"mat-tab",0),e.\u0275\u0275template(5,Cb,4,6,"mat-tab",0),e.\u0275\u0275template(6,Tb,4,7,"mat-tab",0)),2&n&&(e.\u0275\u0275property("ngIf",t.entity),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.entity),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.entity),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.entity),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.entity),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.entity&&t.authUser.authority===t.authorities.TENANT_ADMIN),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.entity&&t.authUser.authority===t.authorities.TENANT_ADMIN))},dependencies:[p.NgIf,H.MatTab,Be.AuditLogTableComponent,wt.EventTableComponent,Et.RelationTableComponent,Ke.AlarmTableComponent,Ye.AttributeTableComponent,Ae.s,g.TranslatePipe],encapsulation:2});class Ue{constructor(n,t,a,o,s,l,d,m,y,I){this.store=n,this.broadcast=t,this.entityViewService=a,this.customerService=o,this.edgeService=s,this.dialogService=l,this.translate=d,this.datePipe=m,this.router=y,this.dialog=I,this.config=new v.ap,this.config.entityType=f.py.ENTITY_VIEW,this.config.entityComponent=ma,this.config.entityTabsComponent=ga,this.config.entityTranslations=f.Jr.get(f.py.ENTITY_VIEW),this.config.entityResources=f.CZ.get(f.py.ENTITY_VIEW),this.config.addDialogStyle={maxWidth:"800px"},this.config.deleteEntityTitle=E=>this.translate.instant("entity-view.delete-entity-view-title",{entityViewName:E.name}),this.config.deleteEntityContent=()=>this.translate.instant("entity-view.delete-entity-view-text"),this.config.deleteEntitiesTitle=E=>this.translate.instant("entity-view.delete-entity-views-title",{count:E}),this.config.deleteEntitiesContent=()=>this.translate.instant("entity-view.delete-entity-views-text"),this.config.loadEntity=E=>this.entityViewService.getEntityViewInfo(E.id),this.config.saveEntity=E=>this.entityViewService.saveEntityView(E).pipe((0,Z.b)(()=>{this.broadcast.broadcast("entityViewSaved")}),(0,ne.z)(L=>this.entityViewService.getEntityViewInfo(L.id.id))),this.config.onEntityAction=E=>this.onEntityViewAction(E,this.config),this.config.detailsReadonly=()=>"customer_user"===this.config.componentsData.entityViewScope||"edge_customer_user"===this.config.componentsData.entityViewScope,this.config.headerComponent=ua}resolve(n){const t=n.params;return this.config.componentsData={entityViewScope:n.data.entityViewsType,entityViewType:"",edgeId:t.edgeId},this.customerId=t.customerId,this.store.pipe((0,x.select)(q.rk),(0,Re.q)(1)).pipe((0,Z.b)(a=>{a.authority===u.W.CUSTOMER_USER&&("edge"===n.data.entityViewsType?this.config.componentsData.entityViewScope="edge_customer_user":this.config.componentsData.entityViewScope="customer_user",this.customerId=a.customerId)}),(0,ne.z)(()=>this.customerId?this.customerService.getCustomer(this.customerId):(0,J.of)(null)),(0,re.U)(a=>(a?a.additionalInfo&&a.additionalInfo.isPublic?this.config.tableTitle=this.translate.instant("customer.public-entity-views"):this.config.tableTitle=a.title+": "+this.translate.instant("entity-view.entity-views"):"edge"===this.config.componentsData.entityViewScope?this.edgeService.getEdge(this.config.componentsData.edgeId).subscribe(o=>this.config.tableTitle=o.name+": "+this.translate.instant("entity-view.entity-views")):this.config.tableTitle=this.translate.instant("entity-view.entity-views"),this.config.columns=this.configureColumns(this.config.componentsData.entityViewScope),this.configureEntityFunctions(this.config.componentsData.entityViewScope),this.config.cellActionDescriptors=this.configureCellActions(this.config.componentsData.entityViewScope),this.config.groupActionDescriptors=this.configureGroupActions(this.config.componentsData.entityViewScope),this.config.addActionDescriptors=this.configureAddActions(this.config.componentsData.entityViewScope),this.config.addEnabled=!("customer_user"===this.config.componentsData.entityViewScope||"edge_customer_user"===this.config.componentsData.entityViewScope),this.config.entitiesDeleteEnabled="tenant"===this.config.componentsData.entityViewScope,this.config.deleteEnabled=()=>"tenant"===this.config.componentsData.entityViewScope,this.config)))}configureColumns(n){const t=[new v.eq("createdTime","common.created-time",this.datePipe,"150px"),new v.QI("name","entity-view.name","33%"),new v.QI("type","entity-view.entity-view-type","33%")];return"tenant"===n&&t.push(new v.QI("customerTitle","customer.customer","33%"),new v.QI("customerIsPublic","entity-view.public","60px",a=>(0,v.Gj)(a.customerIsPublic),()=>({}),!1)),t}configureEntityFunctions(n){"tenant"===n?(this.config.entitiesFetchFunction=t=>this.entityViewService.getTenantEntityViewInfos(t,this.config.componentsData.entityViewType),this.config.deleteEntity=t=>this.entityViewService.deleteEntityView(t.id)):"edge"===n||"edge_customer_user"===n?this.config.entitiesFetchFunction=t=>this.entityViewService.getEdgeEntityViews(this.config.componentsData.edgeId,t,this.config.componentsData.entityViewType):(this.config.entitiesFetchFunction=t=>this.entityViewService.getCustomerEntityViewInfos(this.customerId,t,this.config.componentsData.entityViewType),this.config.deleteEntity=t=>this.entityViewService.unassignEntityViewFromCustomer(t.id))}configureCellActions(n){const t=[];return"tenant"===n&&t.push({name:this.translate.instant("entity-view.make-public"),icon:"share",isEnabled:a=>!a.customerId||a.customerId.id===P._,onAction:(a,o)=>this.makePublic(a,o)},{name:this.translate.instant("entity-view.assign-to-customer"),icon:"assignment_ind",isEnabled:a=>!a.customerId||a.customerId.id===P._,onAction:(a,o)=>this.assignToCustomer(a,[o.id])},{name:this.translate.instant("entity-view.unassign-from-customer"),icon:"assignment_return",isEnabled:a=>a.customerId&&a.customerId.id!==P._&&!a.customerIsPublic,onAction:(a,o)=>this.unassignFromCustomer(a,o)},{name:this.translate.instant("entity-view.make-private"),icon:"reply",isEnabled:a=>a.customerId&&a.customerId.id!==P._&&a.customerIsPublic,onAction:(a,o)=>this.unassignFromCustomer(a,o)}),"customer"===n&&t.push({name:this.translate.instant("entity-view.unassign-from-customer"),icon:"assignment_return",isEnabled:a=>a.customerId&&a.customerId.id!==P._&&!a.customerIsPublic,onAction:(a,o)=>this.unassignFromCustomer(a,o)},{name:this.translate.instant("entity-view.make-private"),icon:"reply",isEnabled:a=>a.customerId&&a.customerId.id!==P._&&a.customerIsPublic,onAction:(a,o)=>this.unassignFromCustomer(a,o)}),"edge"===n&&t.push({name:this.translate.instant("edge.unassign-from-edge"),icon:"assignment_return",isEnabled:()=>!0,onAction:(a,o)=>this.unassignFromEdge(a,o)}),t}configureGroupActions(n){const t=[];return"tenant"===n&&t.push({name:this.translate.instant("entity-view.assign-entity-views"),icon:"assignment_ind",isEnabled:!0,onAction:(a,o)=>this.assignToCustomer(a,o.map(s=>s.id))}),"customer"===n&&t.push({name:this.translate.instant("entity-view.unassign-entity-views"),icon:"assignment_return",isEnabled:!0,onAction:(a,o)=>this.unassignEntityViewsFromCustomer(a,o)}),"edge"===n&&t.push({name:this.translate.instant("entity-view.unassign-entity-views-from-edge"),icon:"assignment_return",isEnabled:!0,onAction:(a,o)=>this.unassignEntityViewsFromEdge(a,o)}),t}configureAddActions(n){const t=[];return"customer"===n&&t.push({name:this.translate.instant("entity-view.assign-new-entity-view"),icon:"add",isEnabled:()=>!0,onAction:a=>this.addEntityViewsToCustomer(a)}),"edge"===n&&t.push({name:this.translate.instant("entity-view.assign-new-entity-view"),icon:"add",isEnabled:()=>!0,onAction:a=>this.addEntityViewsToEdge(a)}),t}addEntityViewsToCustomer(n){n&&n.stopPropagation(),this.dialog.open(Ka.J,{disableClose:!0,panelClass:["tb-dialog","tb-fullscreen-dialog"],data:{customerId:this.customerId,entityType:f.py.ENTITY_VIEW}}).afterClosed().subscribe(t=>{t&&this.config.updateData()})}openEntityView(n,t,a){n&&n.stopPropagation();const o=this.router.createUrlTree([t.id.id],{relativeTo:a.getActivatedRoute()});this.router.navigateByUrl(o)}makePublic(n,t){n&&n.stopPropagation(),this.dialogService.confirm(this.translate.instant("entity-view.make-public-entity-view-title",{entityViewName:t.name}),this.translate.instant("entity-view.make-public-entity-view-text"),this.translate.instant("action.no"),this.translate.instant("action.yes"),!0).subscribe(a=>{a&&this.entityViewService.makeEntityViewPublic(t.id.id).subscribe(()=>{this.config.updateData()})})}assignToCustomer(n,t){n&&n.stopPropagation(),this.dialog.open(za.S,{disableClose:!0,panelClass:["tb-dialog","tb-fullscreen-dialog"],data:{entityIds:t,entityType:f.py.ENTITY_VIEW}}).afterClosed().subscribe(a=>{a&&this.config.updateData()})}unassignFromCustomer(n,t){n&&n.stopPropagation();let o,s;t.customerIsPublic?(o=this.translate.instant("entity-view.make-private-entity-view-title",{entityViewName:t.name}),s=this.translate.instant("entity-view.make-private-entity-view-text")):(o=this.translate.instant("entity-view.unassign-entity-view-title",{entityViewName:t.name}),s=this.translate.instant("entity-view.unassign-entity-view-text")),this.dialogService.confirm(o,s,this.translate.instant("action.no"),this.translate.instant("action.yes"),!0).subscribe(l=>{l&&this.entityViewService.unassignEntityViewFromCustomer(t.id.id).subscribe(()=>{this.config.updateData("tenant"!==this.config.componentsData.entityViewScope)})})}unassignEntityViewsFromCustomer(n,t){n&&n.stopPropagation(),this.dialogService.confirm(this.translate.instant("entity-view.unassign-entity-views-title",{count:t.length}),this.translate.instant("entity-view.unassign-entity-views-text"),this.translate.instant("action.no"),this.translate.instant("action.yes"),!0).subscribe(a=>{if(a){const o=[];t.forEach(s=>{o.push(this.entityViewService.unassignEntityViewFromCustomer(s.id.id))}),(0,xe.D)(o).subscribe(()=>{this.config.updateData()})}})}onEntityViewAction(n,t){switch(n.action){case"open":return this.openEntityView(n.event,n.entity,t),!0;case"makePublic":return this.makePublic(n.event,n.entity),!0;case"assignToCustomer":return this.assignToCustomer(n.event,[n.entity.id]),!0;case"unassignFromCustomer":return this.unassignFromCustomer(n.event,n.entity),!0;case"unassignFromEdge":return this.unassignFromEdge(n.event,n.entity),!0}return!1}addEntityViewsToEdge(n){n&&n.stopPropagation(),this.dialog.open(Ya.J,{disableClose:!0,panelClass:["tb-dialog","tb-fullscreen-dialog"],data:{edgeId:this.config.componentsData.edgeId,entityType:f.py.ENTITY_VIEW}}).afterClosed().subscribe(t=>{t&&this.config.updateData()})}unassignFromEdge(n,t){n&&n.stopPropagation(),this.dialogService.confirm(this.translate.instant("entity-view.unassign-entity-view-from-edge-title",{entityViewName:t.name}),this.translate.instant("entity-view.unassign-entity-view-from-edge-text"),this.translate.instant("action.no"),this.translate.instant("action.yes"),!0).subscribe(a=>{a&&this.entityViewService.unassignEntityViewFromEdge(this.config.componentsData.edgeId,t.id.id).subscribe(()=>{this.config.updateData("tenant"!==this.config.componentsData.entityViewScope)})})}unassignEntityViewsFromEdge(n,t){n&&n.stopPropagation(),this.dialogService.confirm(this.translate.instant("entity-view.unassign-entity-views-from-edge-title",{count:t.length}),this.translate.instant("entity-view.unassign-entity-views-from-edge-text"),this.translate.instant("action.no"),this.translate.instant("action.yes"),!0).subscribe(a=>{if(a){const o=[];t.forEach(s=>{o.push(this.entityViewService.unassignEntityViewFromEdge(this.config.componentsData.edgeId,s.id.id))}),(0,xe.D)(o).subscribe(()=>{this.config.updateData()})}})}}Ue.\u0275fac=function(n){return new(n||Ue)(e.\u0275\u0275inject(x.Store),e.\u0275\u0275inject(Pa.M),e.\u0275\u0275inject(hb.l),e.\u0275\u0275inject($e.v),e.\u0275\u0275inject(Yn.A),e.\u0275\u0275inject(pe.x),e.\u0275\u0275inject(g.TranslateService),e.\u0275\u0275inject(p.DatePipe),e.\u0275\u0275inject(b.Router),e.\u0275\u0275inject(C.MatDialog))},Ue.\u0275prov=e.\u0275\u0275defineInjectable({token:Ue,factory:Ue.\u0275fac});const Sb=[{path:"entityViews",data:{breadcrumb:{label:"entity-view.entity-views",icon:"view_quilt"}},children:[{path:"",component:j.EntitiesTableComponent,data:{auth:[u.W.TENANT_ADMIN,u.W.CUSTOMER_USER],title:"entity-view.entity-views",entityViewsType:"tenant"},resolve:{entitiesTableConfig:Ue}},{path:":entityId",component:ee.Y,canDeactivate:[N.P],data:{breadcrumb:{labelFunction:te,icon:"view_quilt"},auth:[u.W.TENANT_ADMIN,u.W.CUSTOMER_USER],title:"entity-view.entity-views",entityViewsType:"tenant"},resolve:{entitiesTableConfig:Ue}}]}];class $t{}$t.\u0275fac=function(n){return new(n||$t)},$t.\u0275mod=e.\u0275\u0275defineNgModule({type:$t}),$t.\u0275inj=e.\u0275\u0275defineInjector({providers:[Ue],imports:[b.RouterModule.forChild([{path:"entityViews",pathMatch:"full",redirectTo:"/entities/entityViews"},{path:"entityViews/:entityId",redirectTo:"/entities/entityViews/:entityId"}]),b.RouterModule]}),(typeof ngJitMode>"u"||ngJitMode)&&e.\u0275\u0275setNgModuleScope($t,{imports:[b.RouterModule],exports:[b.RouterModule]});class Ht{}function wb(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"rulechain.name-required")," "))}function Eb(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"rulechain.name-max-length")," "))}Ht.\u0275fac=function(n){return new(n||Ht)},Ht.\u0275mod=e.\u0275\u0275defineNgModule({type:Ht}),Ht.\u0275inj=e.\u0275\u0275defineInjector({imports:[p.CommonModule,M.m,k.W,Ee.J,$t]}),(typeof ngJitMode>"u"||ngJitMode)&&e.\u0275\u0275setNgModuleScope(Ht,{declarations:[ma,ga,ua],imports:[p.CommonModule,M.m,k.W,Ee.J,$t]});class fa extends Te.r{constructor(n,t,a,o,s,l){super(n,s,a,o,l),this.store=n,this.translate=t,this.entityValue=a,this.entitiesTableConfigValue=o,this.fb=s,this.cd=l}ngOnInit(){this.ruleChainScope=this.entitiesTableConfig.componentsData.ruleChainScope,super.ngOnInit()}hideDelete(){return!!this.entitiesTableConfig&&!this.entitiesTableConfig.deleteEnabled(this.entity)}buildForm(n){return this.fb.group({name:[n?n.name:"",[r.Validators.required,r.Validators.maxLength(255)]],debugMode:[!!n&&n.debugMode],additionalInfo:this.fb.group({description:[n&&n.additionalInfo?n.additionalInfo.description:""]})})}updateForm(n){this.entityForm.patchValue({name:n.name}),this.entityForm.patchValue({debugMode:n.debugMode}),this.entityForm.patchValue({additionalInfo:{description:n.additionalInfo?n.additionalInfo.description:""}})}onRuleChainIdCopied(n){this.store.dispatch(new V.zi({message:this.translate.instant("rulechain.idCopiedMessage"),type:"success",duration:750,verticalPosition:"bottom",horizontalPosition:"right"}))}isEdgeRootRuleChain(){return!(!this.entitiesTableConfig||!this.entityValue)&&this.entitiesTableConfig.componentsData.edge?.rootRuleChainId?.id==this.entityValue.id.id}isAutoAssignToEdgeRuleChain(){return!(!this.entitiesTableConfig||!this.entityValue)&&(!this.entityValue.root&&this.entitiesTableConfig.componentsData?.autoAssignToEdgeRuleChainIds?.includes(this.entityValue.id.id))}isNotAutoAssignToEdgeRuleChain(){return!(!this.entitiesTableConfig||!this.entityValue)&&(!this.entityValue.root&&!this.entitiesTableConfig.componentsData?.autoAssignToEdgeRuleChainIds?.includes(this.entityValue.id.id))}}fa.\u0275fac=function(n){return new(n||fa)(e.\u0275\u0275directiveInject(x.Store),e.\u0275\u0275directiveInject(g.TranslateService),e.\u0275\u0275directiveInject("entity"),e.\u0275\u0275directiveInject("entitiesTableConfig"),e.\u0275\u0275directiveInject(r.UntypedFormBuilder),e.\u0275\u0275directiveInject(e.ChangeDetectorRef))},fa.\u0275cmp=e.\u0275\u0275defineComponent({type:fa,selectors:[["tb-rulechain"]],features:[e.\u0275\u0275InheritDefinitionFeature],decls:56,vars:67,consts:[[1,"tb-details-buttons"],["mat-raised-button","","color","primary",3,"disabled","fxShow","click"],["fxLayout","row"],["mat-raised-button","","ngxClipboard","",3,"cbContent","fxShow","cbOnSuccess"],["svgIcon","mdi:clipboard-arrow-left"],["translate",""],["fxLayout","column",1,"mat-padding"],[3,"formGroup"],[3,"disabled"],[1,"mat-block"],["matInput","","formControlName","name","required",""],[4,"ngIf"],["fxFlex","","formControlName","debugMode",2,"padding-bottom","16px"],["formGroupName","additionalInfo"],["matInput","","formControlName","description","rows","2"]],template:function(n,t){1&n&&(e.\u0275\u0275elementStart(0,"div",0)(1,"button",1),e.\u0275\u0275listener("click",function(o){return t.onEntityAction(o,"open")}),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275text(3),e.\u0275\u0275pipe(4,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"button",1),e.\u0275\u0275listener("click",function(o){return t.onEntityAction(o,"export")}),e.\u0275\u0275pipe(6,"async"),e.\u0275\u0275text(7),e.\u0275\u0275pipe(8,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(9,"button",1),e.\u0275\u0275listener("click",function(o){return t.onEntityAction(o,"setRoot")}),e.\u0275\u0275pipe(10,"async"),e.\u0275\u0275text(11),e.\u0275\u0275pipe(12,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(13,"button",1),e.\u0275\u0275listener("click",function(o){return t.onEntityAction(o,"setEdgeTemplateRoot")}),e.\u0275\u0275pipe(14,"async"),e.\u0275\u0275text(15),e.\u0275\u0275pipe(16,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(17,"button",1),e.\u0275\u0275listener("click",function(o){return t.onEntityAction(o,"setAutoAssignToEdge")}),e.\u0275\u0275pipe(18,"async"),e.\u0275\u0275text(19),e.\u0275\u0275pipe(20,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(21,"button",1),e.\u0275\u0275listener("click",function(o){return t.onEntityAction(o,"unsetAutoAssignToEdge")}),e.\u0275\u0275pipe(22,"async"),e.\u0275\u0275text(23),e.\u0275\u0275pipe(24,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(25,"button",1),e.\u0275\u0275listener("click",function(o){return t.onEntityAction(o,"unassignFromEdge")}),e.\u0275\u0275pipe(26,"async"),e.\u0275\u0275text(27),e.\u0275\u0275pipe(28,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(29,"button",1),e.\u0275\u0275listener("click",function(o){return t.onEntityAction(o,"delete")}),e.\u0275\u0275pipe(30,"async"),e.\u0275\u0275text(31),e.\u0275\u0275pipe(32,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(33,"div",2)(34,"button",3),e.\u0275\u0275listener("cbOnSuccess",function(o){return t.onRuleChainIdCopied(o)}),e.\u0275\u0275element(35,"mat-icon",4),e.\u0275\u0275elementStart(36,"span",5),e.\u0275\u0275text(37,"rulechain.copyId"),e.\u0275\u0275elementEnd()()()(),e.\u0275\u0275elementStart(38,"div",6)(39,"form",7)(40,"fieldset",8),e.\u0275\u0275pipe(41,"async"),e.\u0275\u0275elementStart(42,"mat-form-field",9)(43,"mat-label",5),e.\u0275\u0275text(44,"rulechain.name"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(45,"input",10),e.\u0275\u0275template(46,wb,3,3,"mat-error",11),e.\u0275\u0275template(47,Eb,3,3,"mat-error",11),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(48,"mat-checkbox",12),e.\u0275\u0275text(49),e.\u0275\u0275pipe(50,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(51,"div",13)(52,"mat-form-field",9)(53,"mat-label",5),e.\u0275\u0275text(54,"rulechain.description"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(55,"textarea",14),e.\u0275\u0275elementEnd()()()()()),2&n&&(e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(2,31,t.isLoading$))("fxShow",!t.isEdit),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(4,33,"rulechain.open-rulechain")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(6,35,t.isLoading$))("fxShow",!t.isEdit),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(8,37,"rulechain.export")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(10,39,t.isLoading$))("fxShow",!t.isEdit&&(!(null!=t.entity&&t.entity.root)&&"tenant"===t.ruleChainScope||!t.isEdgeRootRuleChain()&&"edge"===t.ruleChainScope)),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(12,41,"rulechain.set-root")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(14,43,t.isLoading$))("fxShow",!(t.isEdit||null!=t.entity&&t.entity.root||"edges"!==t.ruleChainScope)),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(16,45,"rulechain.set-edge-template-root-rulechain")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(18,47,t.isLoading$))("fxShow",!t.isEdit&&t.isNotAutoAssignToEdgeRuleChain()&&"edges"===t.ruleChainScope),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(20,49,"rulechain.set-auto-assign-to-edge")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(22,51,t.isLoading$))("fxShow",!t.isEdit&&t.isAutoAssignToEdgeRuleChain()&&"edges"===t.ruleChainScope),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(24,53,"rulechain.unset-auto-assign-to-edge")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(26,55,t.isLoading$))("fxShow",!t.isEdit&&!t.isEdgeRootRuleChain()&&"edge"===t.ruleChainScope),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(28,57,"edge.unassign-from-edge")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(30,59,t.isLoading$))("fxShow",!t.hideDelete()&&!t.isEdit&&"edge"!==t.ruleChainScope),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(32,61,"rulechain.delete")," "),e.\u0275\u0275advance(3),e.\u0275\u0275property("cbContent",null==t.entity||null==t.entity.id?null:t.entity.id.id)("fxShow",!t.isEdit),e.\u0275\u0275advance(5),e.\u0275\u0275property("formGroup",t.entityForm),e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(41,63,t.isLoading$)||!t.isEdit),e.\u0275\u0275advance(6),e.\u0275\u0275property("ngIf",t.entityForm.get("name").hasError("required")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.entityForm.get("name").hasError("maxlength")),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(50,65,"rulechain.debug-mode")," "))},dependencies:[p.NgIf,S.MatButton,fe.MatCheckbox,F.MatIcon,O.MatInput,_.MatFormField,_.MatLabel,_.MatError,he.yb,h.DefaultLayoutDirective,h.DefaultFlexDirective,G.DefaultShowHideDirective,r.\u0275NgNoValidate,r.DefaultValueAccessor,r.NgControlStatus,r.NgControlStatusGroup,r.RequiredValidator,r.FormGroupDirective,r.FormControlName,r.FormGroupName,g.TranslateDirective,p.AsyncPipe,g.TranslatePipe],styles:['@charset "UTF-8";']});var de=c(71618),zt=c(54552);function Mb(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-tab",1,2),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275element(3,"tb-attribute-table",3),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275reference(1),a=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(2,5,"attribute.attributes")),e.\u0275\u0275advance(3),e.\u0275\u0275property("defaultAttributeScope",a.attributeScopes.SERVER_SCOPE)("active",t.isActive)("entityId",a.entity.id)("entityName",a.entity.name)}}function Db(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-tab",1,4),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275element(3,"tb-attribute-table",5),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275reference(1),a=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(2,5,"attribute.latest-telemetry")),e.\u0275\u0275advance(3),e.\u0275\u0275property("defaultAttributeScope",a.latestTelemetryTypes.LATEST_TELEMETRY)("active",t.isActive)("entityId",a.entity.id)("entityName",a.entity.name)}}function Ab(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-tab",1,6),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275element(3,"tb-alarm-table",7),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275reference(1),a=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(2,3,"alarm.alarms")),e.\u0275\u0275advance(3),e.\u0275\u0275property("active",t.isActive)("entityId",a.entity.id)}}const Nb=function(i){return[i]};function Fb(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-tab",1,8),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275element(3,"tb-event-table",9),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275reference(1),a=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(2,6,"rulechain.events")),e.\u0275\u0275advance(3),e.\u0275\u0275property("debugEventTypes",e.\u0275\u0275pureFunction1(8,Nb,a.debugEventTypes.DEBUG_RULE_CHAIN))("defaultEventType",a.debugEventTypes.DEBUG_RULE_CHAIN)("active",t.isActive)("tenantId",a.entity.tenantId.id)("entityId",a.entity.id)}}function Lb(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-tab",1,10),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275element(3,"tb-relation-table",7),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275reference(1),a=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(2,3,"relation.relations")),e.\u0275\u0275advance(3),e.\u0275\u0275property("active",t.isActive)("entityId",a.entity.id)}}function Pb(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-tab",1,11),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275element(3,"tb-audit-log-table",12),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275reference(1),a=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(2,4,"audit-log.audit-logs")),e.\u0275\u0275advance(3),e.\u0275\u0275property("active",t.isActive)("auditLogMode",a.auditLogModes.ENTITY)("entityId",a.entity.id)}}function kb(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"mat-tab",1,13),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementStart(3,"tb-version-control",14),e.\u0275\u0275listener("versionRestored",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.entitiesTableConfig.updateData())}),e.\u0275\u0275elementEnd()()}if(2&i){const t=e.\u0275\u0275reference(1),a=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(2,5,"version-control.version-control")),e.\u0275\u0275advance(3),e.\u0275\u0275property("active",t.isActive)("entityId",a.entity.id)("entityName",a.entity.name)("externalEntityId",a.entity.externalId||a.entity.id)}}class ha extends _e.l{constructor(n){super(n),this.store=n}ngOnInit(){super.ngOnInit()}}ha.\u0275fac=function(n){return new(n||ha)(e.\u0275\u0275directiveInject(x.Store))},ha.\u0275cmp=e.\u0275\u0275defineComponent({type:ha,selectors:[["tb-rulechain-tabs"]],features:[e.\u0275\u0275InheritDefinitionFeature],decls:7,vars:7,consts:[[3,"label",4,"ngIf"],[3,"label"],["attributesTab","matTab"],[3,"defaultAttributeScope","active","entityId","entityName"],["telemetryTab","matTab"],["disableAttributeScopeSelection","",3,"defaultAttributeScope","active","entityId","entityName"],["alarmsTab","matTab"],[3,"active","entityId"],["eventsTab","matTab"],[3,"debugEventTypes","defaultEventType","active","tenantId","entityId"],["relationsTab","matTab"],["auditLogsTab","matTab"],["detailsMode","true",3,"active","auditLogMode","entityId"],["versionControlTab","matTab"],["detailsMode","true","singleEntityMode","true",3,"active","entityId","entityName","externalEntityId","versionRestored"]],template:function(n,t){1&n&&(e.\u0275\u0275template(0,Mb,4,7,"mat-tab",0),e.\u0275\u0275template(1,Db,4,7,"mat-tab",0),e.\u0275\u0275template(2,Ab,4,5,"mat-tab",0),e.\u0275\u0275template(3,Fb,4,10,"mat-tab",0),e.\u0275\u0275template(4,Lb,4,5,"mat-tab",0),e.\u0275\u0275template(5,Pb,4,6,"mat-tab",0),e.\u0275\u0275template(6,kb,4,7,"mat-tab",0)),2&n&&(e.\u0275\u0275property("ngIf",t.entity),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.entity),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.entity),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.entity),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.entity),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.entity&&t.authUser.authority===t.authorities.TENANT_ADMIN),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.entity&&t.authUser.authority===t.authorities.TENANT_ADMIN))},dependencies:[p.NgIf,H.MatTab,Be.AuditLogTableComponent,wt.EventTableComponent,Et.RelationTableComponent,Ke.AlarmTableComponent,Ye.AttributeTableComponent,Ae.s,g.TranslatePipe],encapsulation:2});var mr=c(9442);class Xe{constructor(n,t,a,o,s,l,d,m,y,I){this.ruleChainService=n,this.dialogService=t,this.dialog=a,this.importExport=o,this.itembuffer=s,this.edgeService=l,this.homeDialogs=d,this.translate=m,this.datePipe=y,this.router=I,this.config=new v.ap,this.config.entityType=f.py.RULE_CHAIN,this.config.entityComponent=fa,this.config.entityTabsComponent=ha,this.config.entityTranslations=f.Jr.get(f.py.RULE_CHAIN),this.config.entityResources=f.CZ.get(f.py.RULE_CHAIN),this.config.rowPointer=!0,this.config.deleteEntityTitle=E=>this.translate.instant("rulechain.delete-rulechain-title",{ruleChainName:E.name}),this.config.deleteEntityContent=()=>this.translate.instant("rulechain.delete-rulechain-text"),this.config.deleteEntitiesTitle=E=>this.translate.instant("rulechain.delete-rulechains-title",{count:E}),this.config.deleteEntitiesContent=()=>this.translate.instant("rulechain.delete-rulechains-text"),this.config.loadEntity=E=>this.ruleChainService.getRuleChain(E.id),this.config.saveEntity=E=>this.saveRuleChain(E),this.config.deleteEntity=E=>this.ruleChainService.deleteRuleChain(E.id),this.config.onEntityAction=E=>this.onRuleChainAction(E),this.config.handleRowClick=(E,L)=>(this.config.isDetailsOpen()?this.config.toggleEntityDetails(E,L):this.openRuleChain(E,L),!0)}resolve(n){const t=n.params?.edgeId,a=n.data?.ruleChainsType?n.data?.ruleChainsType:"tenant";return this.config.componentsData={ruleChainScope:a,edgeId:t},this.config.columns=this.configureEntityTableColumns(a),this.config.entitiesFetchFunction=this.configureEntityFunctions(a,t),this.config.groupActionDescriptors=this.configureGroupActions(a),this.config.addActionDescriptors=this.configureAddActions(a),this.config.cellActionDescriptors=this.configureCellActions(a),"tenant"===a||"edges"===a?(this.config.entitySelectionEnabled=o=>o&&!o.root,this.config.deleteEnabled=o=>o&&!o.root,this.config.entitiesDeleteEnabled=!0,this.config.tableTitle=this.configureTableTitle(a,null)):"edge"===a&&(this.config.entitySelectionEnabled=o=>this.config.componentsData.edge.rootRuleChainId.id!==o.id.id,this.edgeService.getEdge(t).subscribe(o=>{this.config.componentsData.edge=o,this.config.tableTitle=this.configureTableTitle(a,o)}),this.config.entitiesDeleteEnabled=!1),this.config}configureEntityTableColumns(n){const t=[];return t.push(new v.eq("createdTime","common.created-time",this.datePipe,"150px"),new v.QI("name","rulechain.name","100%")),"tenant"===n||"edge"===n?t.push(new v.QI("root","rulechain.root","60px",a=>"edge"===n?(0,v.Gj)(this.config.componentsData.edge.rootRuleChainId.id===a.id.id):(0,v.Gj)(a.root))):"edges"===n&&t.push(new v.QI("root","rulechain.edge-template-root","100px",a=>(0,v.Gj)(a.root)),new v.QI("assignToEdge","rulechain.assign-to-edge","100px",a=>(0,v.Gj)(this.isAutoAssignToEdgeRuleChain(a)),()=>({}),!1)),t}configureAddActions(n){const t=[];return("tenant"===n||"edges"===n)&&t.push({name:this.translate.instant("rulechain.create-new-rulechain"),icon:"insert_drive_file",isEnabled:()=>!0,onAction:a=>this.config.getTable().addEntity(a)},{name:this.translate.instant("rulechain.import"),icon:"file_upload",isEnabled:()=>!0,onAction:a=>this.importRuleChain(a)}),"edge"===n&&t.push({name:this.translate.instant("rulechain.assign-to-edge"),icon:"add",isEnabled:()=>!0,onAction:a=>this.assignRuleChainsToEdge(a)}),t}configureEntityFunctions(n,t){return"tenant"===n?a=>this.fetchRuleChains(a):"edges"===n?a=>this.fetchEdgeRuleChains(a):"edge"===n?a=>this.ruleChainService.getEdgeRuleChains(t,a):void 0}configureTableTitle(n,t){return"tenant"===n?this.translate.instant("rulechain.rulechains"):"edges"===n?this.translate.instant("edge.rulechain-templates"):"edge"===n?this.config.tableTitle=t.name+": "+this.translate.instant("rulechain.rulechains"):void 0}configureGroupActions(n){const t=[];return"edge"===n&&t.push({name:this.translate.instant("rulechain.unassign-rulechains"),icon:"assignment_return",isEnabled:!0,onAction:(a,o)=>this.unassignRuleChainsFromEdge(a,o)}),t}configureCellActions(n){const t=[];return t.push({name:this.translate.instant("rulechain.export"),icon:"file_download",isEnabled:()=>!0,onAction:(a,o)=>this.exportRuleChain(a,o)}),"tenant"===n&&t.push({name:this.translate.instant("rulechain.set-root"),icon:"flag",isEnabled:a=>this.isNonRootRuleChain(a),onAction:(a,o)=>this.setRootRuleChain(a,o)}),"edges"===n&&t.push({name:this.translate.instant("rulechain.set-edge-template-root-rulechain"),icon:"flag",isEnabled:a=>this.isNonRootRuleChain(a),onAction:(a,o)=>this.setEdgeTemplateRootRuleChain(a,o)},{name:this.translate.instant("rulechain.set-auto-assign-to-edge"),icon:"bookmark_outline",isEnabled:a=>this.isNotAutoAssignToEdgeRuleChain(a),onAction:(a,o)=>this.setAutoAssignToEdgeRuleChain(a,o)},{name:this.translate.instant("rulechain.unset-auto-assign-to-edge"),icon:"bookmark",isEnabled:a=>this.isAutoAssignToEdgeRuleChain(a),onAction:(a,o)=>this.unsetAutoAssignToEdgeRuleChain(a,o)}),"edge"===n&&t.push({name:this.translate.instant("rulechain.set-root"),icon:"flag",isEnabled:a=>this.isNonRootRuleChain(a),onAction:(a,o)=>this.setRootRuleChain(a,o)},{name:this.translate.instant("edge.unassign-from-edge"),icon:"assignment_return",isEnabled:a=>a.id.id!==this.config.componentsData.edge.rootRuleChainId.id,onAction:(a,o)=>this.unassignFromEdge(a,o)}),t.push({name:this.translate.instant("rulechain.rulechain-details"),icon:"edit",isEnabled:()=>!0,onAction:(a,o)=>this.config.toggleEntityDetails(a,o)}),t}importRuleChain(n){n&&n.stopPropagation();const t="tenant"===this.config.componentsData.ruleChainScope?de.CI.CORE:de.CI.EDGE;this.importExport.importRuleChain(t).subscribe(a=>{a&&(this.itembuffer.storeRuleChainImport(a),"edges"===this.config.componentsData.ruleChainScope?this.router.navigateByUrl("edgeManagement/ruleChains/ruleChain/import"):this.router.navigateByUrl("ruleChains/ruleChain/import"))})}openRuleChain(n,t){n&&n.stopPropagation(),"edges"===this.config.componentsData.ruleChainScope?this.router.navigateByUrl(`edgeManagement/ruleChains/${t.id.id}`):"edge"===this.config.componentsData.ruleChainScope?this.router.navigateByUrl(`edgeInstances/${this.config.componentsData.edgeId}/ruleChains/${t.id.id}`):this.router.navigateByUrl(`ruleChains/${t.id.id}`)}saveRuleChain(n){return(0,T.o8)(n.type)&&("tenant"===this.config.componentsData.ruleChainScope?n.type=de.CI.CORE:"edges"===this.config.componentsData.ruleChainScope?n.type=de.CI.EDGE:n.type=de.CI.CORE),this.ruleChainService.saveRuleChain(n)}exportRuleChain(n,t){n&&n.stopPropagation(),this.importExport.exportRuleChain(t.id.id)}setRootRuleChain(n,t){n&&n.stopPropagation(),this.dialogService.confirm(this.translate.instant("rulechain.set-root-rulechain-title",{ruleChainName:t.name}),this.translate.instant("rulechain.set-root-rulechain-text"),this.translate.instant("action.no"),this.translate.instant("action.yes"),!0).subscribe(a=>{a&&("edge"===this.config.componentsData.ruleChainScope?this.ruleChainService.setEdgeRootRuleChain(this.config.componentsData.edgeId,t.id.id).subscribe(o=>{this.config.componentsData.edge=o,this.config.updateData()}):this.ruleChainService.setRootRuleChain(t.id.id).subscribe(()=>{this.config.updateData()}))})}onRuleChainAction(n){switch(n.action){case"open":return this.openRuleChain(n.event,n.entity),!0;case"export":return this.exportRuleChain(n.event,n.entity),!0;case"setRoot":return this.setRootRuleChain(n.event,n.entity),!0;case"setEdgeTemplateRoot":return this.setEdgeTemplateRootRuleChain(n.event,n.entity),!0;case"unassignFromEdge":return this.unassignFromEdge(n.event,n.entity),!0;case"setAutoAssignToEdge":return this.setAutoAssignToEdgeRuleChain(n.event,n.entity),!0;case"unsetAutoAssignToEdge":return this.unsetAutoAssignToEdgeRuleChain(n.event,n.entity),!0}return!1}setEdgeTemplateRootRuleChain(n,t){n&&n.stopPropagation(),this.dialogService.confirm(this.translate.instant("rulechain.set-edge-template-root-rulechain-title",{ruleChainName:t.name}),this.translate.instant("rulechain.set-edge-template-root-rulechain-text"),this.translate.instant("action.no"),this.translate.instant("action.yes"),!0).subscribe(a=>{a&&this.ruleChainService.setEdgeTemplateRootRuleChain(t.id.id).subscribe(()=>{this.config.updateData()})})}checkMissingToRelatedRuleChains(){this.edgeService.findMissingToRelatedRuleChains(this.config.componentsData.edgeId).subscribe(n=>{if(n&&Object.keys(n).length>0){const t=new Array;for(const o of Object.keys(n)){const l="- '"+o+"': '"+n[o].join("', ")+"'";t.push(l)}const a=this.translate.instant("edge.missing-related-rule-chains-text",{missingRuleChains:t.join("<br>")});this.dialogService.alert(this.translate.instant("edge.missing-related-rule-chains-title"),a,this.translate.instant("action.close"),!0).subscribe(()=>{this.config.updateData()})}else this.config.updateData()})}assignRuleChainsToEdge(n){n&&n.stopPropagation(),this.dialog.open(Ya.J,{disableClose:!0,panelClass:["tb-dialog","tb-fullscreen-dialog"],data:{edgeId:this.config.componentsData.edgeId,entityType:f.py.RULE_CHAIN}}).afterClosed().subscribe(t=>{t&&this.checkMissingToRelatedRuleChains()})}unassignFromEdge(n,t){n&&n.stopPropagation(),this.dialogService.confirm(this.translate.instant("rulechain.unassign-rulechain-title",{ruleChainName:t.name}),this.translate.instant("rulechain.unassign-rulechain-from-edge-text"),this.translate.instant("action.no"),this.translate.instant("action.yes"),!0).subscribe(a=>{a&&this.ruleChainService.unassignRuleChainFromEdge(this.config.componentsData.edgeId,t.id.id).subscribe(()=>{this.checkMissingToRelatedRuleChains()})})}unassignRuleChainsFromEdge(n,t){n&&n.stopPropagation(),this.dialogService.confirm(this.translate.instant("rulechain.unassign-rulechains-from-edge-title",{count:t.length}),this.translate.instant("rulechain.unassign-rulechains-from-edge-text"),this.translate.instant("action.no"),this.translate.instant("action.yes"),!0).subscribe(a=>{if(a){const o=[];t.forEach(s=>{o.push(this.ruleChainService.unassignRuleChainFromEdge(this.config.componentsData.edgeId,s.id.id))}),(0,xe.D)(o).subscribe(()=>{this.checkMissingToRelatedRuleChains()})}})}setAutoAssignToEdgeRuleChain(n,t){n&&n.stopPropagation(),this.dialogService.confirm(this.translate.instant("rulechain.set-auto-assign-to-edge-title",{ruleChainName:t.name}),this.translate.instant("rulechain.set-auto-assign-to-edge-text"),this.translate.instant("action.no"),this.translate.instant("action.yes"),!0).subscribe(a=>{a&&this.ruleChainService.setAutoAssignToEdgeRuleChain(t.id.id).subscribe(()=>{this.config.updateData()})})}unsetAutoAssignToEdgeRuleChain(n,t){n&&n.stopPropagation(),this.dialogService.confirm(this.translate.instant("rulechain.unset-auto-assign-to-edge-title",{ruleChainName:t.name}),this.translate.instant("rulechain.unset-auto-assign-to-edge-text"),this.translate.instant("action.no"),this.translate.instant("action.yes"),!0).subscribe(a=>{a&&this.ruleChainService.unsetAutoAssignToEdgeRuleChain(t.id.id).subscribe(()=>{this.config.updateData()})})}isNonRootRuleChain(n){return"edge"===this.config.componentsData.ruleChainScope?this.config.componentsData.edge.rootRuleChainId&&this.config.componentsData.edge.rootRuleChainId.id!==n.id.id:!n.root}isAutoAssignToEdgeRuleChain(n){return!n.root&&this.config.componentsData.autoAssignToEdgeRuleChainIds.includes(n.id.id)}isNotAutoAssignToEdgeRuleChain(n){return!n.root&&!this.config.componentsData.autoAssignToEdgeRuleChainIds.includes(n.id.id)}fetchRuleChains(n){return this.ruleChainService.getRuleChains(n,de.CI.CORE)}fetchEdgeRuleChains(n){return this.ruleChainService.getAutoAssignToEdgeRuleChains().pipe((0,ne.z)(t=>(this.config.componentsData.autoAssignToEdgeRuleChainIds=[],t.map(a=>this.config.componentsData.autoAssignToEdgeRuleChainIds.push(a.id.id)),this.ruleChainService.getRuleChains(n,de.CI.EDGE))))}}Xe.\u0275fac=function(n){return new(n||Xe)(e.\u0275\u0275inject(zt.U),e.\u0275\u0275inject(pe.x),e.\u0275\u0275inject(C.MatDialog),e.\u0275\u0275inject(ct.s),e.\u0275\u0275inject(mr.$),e.\u0275\u0275inject(Yn.A),e.\u0275\u0275inject(lt.U),e.\u0275\u0275inject(g.TranslateService),e.\u0275\u0275inject(p.DatePipe),e.\u0275\u0275inject(b.Router))},Xe.\u0275prov=e.\u0275\u0275defineInjectable({token:Xe,factory:Xe.\u0275fac});var Rb=c(16173),K=c(91485),B=c(73904),Ob=c(46638),Bb=c(43535),Vb=c(92527),Ub=c(586);const Gb=["definedConfigContent"],jb=["jsonObjectEditComponent"];function Wb(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",4),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(t.definedDirectiveError)}}function qb(i,n){if(1&i&&(e.\u0275\u0275element(0,"tb-json-object-edit",5,6),e.\u0275\u0275pipe(2,"translate")),2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275property("label",e.\u0275\u0275pipeBind1(2,3,"rulenode.configuration"))("jsonRequired",t.required)("fillHeight",!0)}}class Jn{get required(){return this.requiredValue}set required(n){this.requiredValue=(0,ue.coerceBooleanProperty)(n)}set nodeDefinition(n){this.nodeDefinitionValue!==n&&(this.nodeDefinitionValue=n,this.nodeDefinitionValue&&this.validateDefinedDirective(),setTimeout(()=>this.initRuleNode.emit()))}get nodeDefinition(){return this.nodeDefinitionValue}constructor(n,t,a){this.translate=n,this.ruleChainService=t,this.fb=a,this.initRuleNode=new e.EventEmitter,this.changeScript=new e.EventEmitter,this.propagateChange=o=>{},this.ruleNodeConfigFormGroup=this.fb.group({configuration:[null,r.Validators.required]})}registerOnChange(n){this.propagateChange=n}registerOnTouched(n){}ngOnInit(){}ngOnDestroy(){this.definedConfigComponentRef&&this.definedConfigComponentRef.destroy(),this.changeSubscription&&(this.changeSubscription.unsubscribe(),this.changeSubscription=null),this.changeScriptSubscription&&(this.changeScriptSubscription.unsubscribe(),this.changeScriptSubscription=null)}ngAfterViewInit(){}setDisabledState(n){this.disabled=n,this.disabled?this.ruleNodeConfigFormGroup.disable({emitEvent:!1}):this.ruleNodeConfigFormGroup.enable({emitEvent:!1}),this.definedConfigComponent&&(this.definedConfigComponent.disabled=this.disabled)}writeValue(n){this.configuration=(0,T.I8)(n),this.changeSubscription&&(this.changeSubscription.unsubscribe(),this.changeSubscription=null),this.definedConfigComponent?(this.definedConfigComponent.configuration=this.configuration,this.changeSubscription=this.definedConfigComponent.configurationChanged.subscribe(t=>{this.updateModel(t)})):(this.ruleNodeConfigFormGroup.get("configuration").patchValue(this.configuration,{emitEvent:!1}),this.changeSubscription=this.ruleNodeConfigFormGroup.get("configuration").valueChanges.subscribe(t=>{this.updateModel(t)}))}useDefinedDirective(){return this.nodeDefinition&&this.nodeDefinition.configDirective&&this.nodeDefinition.configDirective.length&&!this.definedDirectiveError}updateModel(n){this.definedConfigComponent||this.ruleNodeConfigFormGroup.valid?this.propagateChange(n):this.propagateChange(this.required?null:n)}validateDefinedDirective(){if(this.definedConfigComponentRef&&(this.definedConfigComponentRef.destroy(),this.definedConfigComponentRef=null),this.nodeDefinition.uiResourceLoadError&&this.nodeDefinition.uiResourceLoadError.length)this.definedDirectiveError=this.nodeDefinition.uiResourceLoadError;else if(this.nodeDefinition.configDirective&&this.nodeDefinition.configDirective.length){this.changeSubscription&&(this.changeSubscription.unsubscribe(),this.changeSubscription=null),this.definedConfigContainer.clear();const n=this.ruleChainService.getRuleNodeConfigFactory(this.nodeDefinition.configDirective);this.definedConfigComponentRef=this.definedConfigContainer.createComponent(n),this.definedConfigComponent=this.definedConfigComponentRef.instance,this.definedConfigComponent.ruleNodeId=this.ruleNodeId,this.definedConfigComponent.ruleChainId=this.ruleChainId,this.definedConfigComponent.ruleChainType=this.ruleChainType,this.definedConfigComponent.configuration=this.configuration,this.changeSubscription=this.definedConfigComponent.configurationChanged.subscribe(t=>{this.updateModel(t)}),this.definedConfigComponent?.changeScript&&(this.changeScriptSubscription=this.definedConfigComponent.changeScript.subscribe(()=>this.changeScript.emit()))}}validate(){this.useDefinedDirective()&&this.definedConfigComponent.validate()}}Jn.\u0275fac=function(n){return new(n||Jn)(e.\u0275\u0275directiveInject(g.TranslateService),e.\u0275\u0275directiveInject(zt.U),e.\u0275\u0275directiveInject(r.UntypedFormBuilder))},Jn.\u0275cmp=e.\u0275\u0275defineComponent({type:Jn,selectors:[["tb-rule-node-config"]],viewQuery:function(n,t){if(1&n&&(e.\u0275\u0275viewQuery(Gb,7,e.ViewContainerRef),e.\u0275\u0275viewQuery(jb,5)),2&n){let a;e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(t.definedConfigContainer=a.first),e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(t.jsonObjectEditComponent=a.first)}},inputs:{required:"required",disabled:"disabled",ruleNodeId:"ruleNodeId",ruleChainId:"ruleChainId",ruleChainType:"ruleChainType",nodeDefinition:"nodeDefinition"},outputs:{initRuleNode:"initRuleNode",changeScript:"changeScript"},features:[e.\u0275\u0275ProvidersFeature([{provide:r.NG_VALUE_ACCESSOR,useExisting:(0,e.forwardRef)(()=>Jn),multi:!0}])],decls:5,vars:3,consts:[[3,"formGroup"],["definedConfigContent",""],["class","tb-rulenode-directive-error",4,"ngIf"],["class","tb-rule-node-configuration-json","formControlName","configuration",3,"label","jsonRequired","fillHeight",4,"ngIf"],[1,"tb-rulenode-directive-error"],["formControlName","configuration",1,"tb-rule-node-configuration-json",3,"label","jsonRequired","fillHeight"],["jsonObjectEditComponent",""]],template:function(n,t){1&n&&(e.\u0275\u0275elementStart(0,"div",0),e.\u0275\u0275elementContainer(1,null,1),e.\u0275\u0275template(3,Wb,2,1,"div",2),e.\u0275\u0275template(4,qb,3,5,"tb-json-object-edit",3),e.\u0275\u0275elementEnd()),2&n&&(e.\u0275\u0275property("formGroup",t.ruleNodeConfigFormGroup),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",t.definedDirectiveError),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!t.useDefinedDirective()))},dependencies:[p.NgIf,Ub.JsonObjectEditComponent,r.NgControlStatus,r.NgControlStatusGroup,r.FormGroupDirective,r.FormControlName,g.TranslatePipe],styles:['@charset "UTF-8";[_nghost-%COMP%]{display:block}[_nghost-%COMP%]   tb-json-object-edit.tb-rule-node-configuration-json[_ngcontent-%COMP%]{display:block;height:300px}[_nghost-%COMP%]   .tb-rulenode-directive-error[_ngcontent-%COMP%]{font-size:13px;font-weight:400;color:#dd2c00}']});var ur=c(78991);const $b=["ruleNodeConfigComponent"];function Hb(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",15)(1,"button",16),e.\u0275\u0275listener("click",function(o){e.\u0275\u0275restoreView(t);const s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.openRuleChain(o))}),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"translate"),e.\u0275\u0275elementEnd()()}2&i&&(e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(3,1,"rulechain.open-rulechain")," "))}function zb(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"rulenode.name-required")," "))}function Kb(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"rulenode.name-max-length")," "))}function Yb(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-slide-toggle",17),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"rulenode.singleton-mode")," "))}class Ze extends se.I{constructor(n,t,a){super(n),this.store=n,this.fb=t,this.router=a,this.disabled=!1,this.isAdd=!1,this.initRuleNode=new e.EventEmitter,this.changeScript=new e.EventEmitter,this.ruleNodeType=B.ij,this.entityType=f.py,this.ruleNodeFormGroup=this.fb.group({})}buildForm(){this.ruleNodeFormSubscription&&(this.ruleNodeFormSubscription.unsubscribe(),this.ruleNodeFormSubscription=null),this.ruleNode?(this.ruleNodeFormGroup=this.fb.group({name:[this.ruleNode.name,[r.Validators.required,r.Validators.pattern("(.|\\s)*\\S(.|\\s)*"),r.Validators.maxLength(255)]],debugMode:[this.ruleNode.debugMode,[]],singletonMode:[this.ruleNode.singletonMode,[]],configuration:[this.ruleNode.configuration,[r.Validators.required]],additionalInfo:this.fb.group({description:[this.ruleNode.additionalInfo?this.ruleNode.additionalInfo.description:""]})}),this.ruleNodeFormSubscription=this.ruleNodeFormGroup.valueChanges.subscribe(()=>{this.updateRuleNode()})):this.ruleNodeFormGroup=this.fb.group({}),this.disabled&&this.ruleNodeFormGroup.disable({emitEvent:!1})}updateRuleNode(){const n=this.ruleNodeFormGroup.value||{};n.name=n.name.trim(),Object.assign(this.ruleNode,n)}ngOnInit(){this.disabled&&this.ruleNodeFormGroup.disable({emitEvent:!1})}ngOnChanges(n){for(const t of Object.keys(n)){const a=n[t];a.currentValue!==a.previousValue&&"ruleNode"===t&&this.buildForm()}}validate(){this.ruleNodeConfigComponent.validate()}openRuleChain(n){n&&n.stopPropagation();const t=this.ruleNodeFormGroup.get("configuration")?.value?.ruleChainId;t&&(this.ruleChainType===de.CI.EDGE?this.router.navigateByUrl(`/edgeManagement/ruleChains/${t}`):this.router.navigateByUrl(`/ruleChains/${t}`))}isSingletonEditAllowed(){return this.ruleNode.component.clusteringMode===ur.m.USER_PREFERENCE}}Ze.\u0275fac=function(n){return new(n||Ze)(e.\u0275\u0275directiveInject(x.Store),e.\u0275\u0275directiveInject(r.UntypedFormBuilder),e.\u0275\u0275directiveInject(b.Router))},Ze.\u0275cmp=e.\u0275\u0275defineComponent({type:Ze,selectors:[["tb-rule-node"]],viewQuery:function(n,t){if(1&n&&e.\u0275\u0275viewQuery($b,5),2&n){let a;e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(t.ruleNodeConfigComponent=a.first)}},inputs:{ruleNode:"ruleNode",ruleChainId:"ruleChainId",ruleChainType:"ruleChainType",disabled:"disabled",isAdd:"isAdd"},outputs:{initRuleNode:"initRuleNode",changeScript:"changeScript"},features:[e.\u0275\u0275InheritDefinitionFeature,e.\u0275\u0275NgOnChangesFeature],decls:21,vars:12,consts:[["class","tb-details-buttons",4,"ngIf"],[1,"mat-padding",3,"formGroup"],[1,"title-row"],["fxFlex","",1,"mat-block"],["translate",""],["matInput","","formControlName","name","required",""],[4,"ngIf"],[1,"node-setting"],["formControlName","debugMode"],["formControlName","singletonMode",4,"ngIf"],["formControlName","configuration",3,"ruleNodeId","ruleChainId","ruleChainType","nodeDefinition","initRuleNode","changeScript"],["ruleNodeConfigComponent",""],["formGroupName","additionalInfo","fxLayout","column",1,"description-block"],[1,"mat-block"],["matInput","","formControlName","description","rows","1"],[1,"tb-details-buttons"],["mat-raised-button","","color","primary",3,"click"],["formControlName","singletonMode"]],template:function(n,t){1&n&&(e.\u0275\u0275template(0,Hb,4,3,"div",0),e.\u0275\u0275elementStart(1,"form",1)(2,"section",2)(3,"mat-form-field",3)(4,"mat-label",4),e.\u0275\u0275text(5,"rulenode.name"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(6,"input",5),e.\u0275\u0275template(7,zb,3,3,"mat-error",6),e.\u0275\u0275template(8,Kb,3,3,"mat-error",6),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(9,"section",7)(10,"mat-slide-toggle",8),e.\u0275\u0275text(11),e.\u0275\u0275pipe(12,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(13,Yb,3,3,"mat-slide-toggle",9),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(14,"tb-rule-node-config",10,11),e.\u0275\u0275listener("initRuleNode",function(o){return t.initRuleNode.emit(o)})("changeScript",function(o){return t.changeScript.emit(o)}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(16,"div",12)(17,"mat-form-field",13)(18,"mat-label",4),e.\u0275\u0275text(19,"rulenode.rule-node-description"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(20,"textarea",14),e.\u0275\u0275elementEnd()()()),2&n&&(e.\u0275\u0275property("ngIf",!t.isAdd&&(null==t.ruleNode.component||null==t.ruleNode.component.configurationDescriptor||null==t.ruleNode.component.configurationDescriptor.nodeDefinition?null:t.ruleNode.component.configurationDescriptor.nodeDefinition.ruleChainNode)),e.\u0275\u0275advance(1),e.\u0275\u0275property("formGroup",t.ruleNodeFormGroup),e.\u0275\u0275advance(6),e.\u0275\u0275property("ngIf",t.ruleNodeFormGroup.get("name").hasError("required")||t.ruleNodeFormGroup.get("name").hasError("pattern")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.ruleNodeFormGroup.get("name").hasError("maxlength")),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(12,10,"rulenode.debug-mode")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",t.isSingletonEditAllowed()),e.\u0275\u0275advance(1),e.\u0275\u0275property("ruleNodeId",null==t.ruleNode.ruleNodeId?null:t.ruleNode.ruleNodeId.id)("ruleChainId",t.ruleChainId)("ruleChainType",t.ruleChainType)("nodeDefinition",t.ruleNode.component.configurationDescriptor.nodeDefinition))},dependencies:[p.NgIf,S.MatButton,O.MatInput,_.MatFormField,_.MatLabel,_.MatError,Ce.MatSlideToggle,h.DefaultLayoutDirective,h.DefaultFlexDirective,r.\u0275NgNoValidate,r.DefaultValueAccessor,r.NgControlStatus,r.NgControlStatusGroup,r.RequiredValidator,r.FormGroupDirective,r.FormControlName,r.FormGroupName,g.TranslateDirective,Jn,g.TranslatePipe],styles:['@charset "UTF-8";[_nghost-%COMP%]   form[_ngcontent-%COMP%]{overflow-x:hidden!important}[_nghost-%COMP%]   .title-row[_ngcontent-%COMP%]{display:flex;flex-direction:column}[_nghost-%COMP%]   .title-row[_ngcontent-%COMP%]   .node-setting[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px;margin-bottom:22px}@media screen and (min-width: 960px){[_nghost-%COMP%]   .title-row[_ngcontent-%COMP%]{flex-direction:row;gap:8px;align-items:center}[_nghost-%COMP%]   .title-row[_ngcontent-%COMP%]   .node-setting[_ngcontent-%COMP%]{margin-top:5px}}[_nghost-%COMP%]   .description-block[_ngcontent-%COMP%]{margin-top:22px}']}),(0,gt.__decorate)([(0,qa.coerceBoolean)(),(0,gt.__metadata)("design:type",Object)],Ze.prototype,"disabled",void 0),(0,gt.__decorate)([(0,qa.coerceBoolean)(),(0,gt.__metadata)("design:type",Object)],Ze.prototype,"isAdd",void 0);var gr=c(30925);const Jb=["chipList"],Qb=["labelAutocomplete"],Xb=["labelInput"];function Zb(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-icon",12),e.\u0275\u0275text(1,"close"),e.\u0275\u0275elementEnd())}function ey(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"mat-chip-row",10),e.\u0275\u0275listener("removed",function(){const s=e.\u0275\u0275restoreView(t).$implicit,l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.remove(s))}),e.\u0275\u0275text(1),e.\u0275\u0275template(2,Zb,2,0,"mat-icon",11),e.\u0275\u0275elementEnd()}if(2&i){const t=n.$implicit,a=e.\u0275\u0275nextContext();e.\u0275\u0275property("removable",!a.disabled),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",t.name," "),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!a.disabled)}}function ty(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-option",13),e.\u0275\u0275element(1,"span",14),e.\u0275\u0275pipe(2,"highlight"),e.\u0275\u0275elementEnd()),2&i){const t=n.$implicit,a=e.\u0275\u0275nextContext();e.\u0275\u0275property("value",t),e.\u0275\u0275advance(1),e.\u0275\u0275property("innerHTML",e.\u0275\u0275pipeBind2(2,2,t.name,a.searchText),e.\u0275\u0275sanitizeHtml)}}function ny(i,n){1&i&&(e.\u0275\u0275elementStart(0,"div")(1,"span",1),e.\u0275\u0275text(2,"rulenode.no-link-labels-found"),e.\u0275\u0275elementEnd()())}const iy=function(i){return{label:i}};function ay(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"span"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,t.translate.get("rulenode.no-link-label-matching",e.\u0275\u0275pureFunction1(3,iy,t.truncate.transform(t.searchText,!0,6,"..."))))," ")}}function oy(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"span")(1,"a",20),e.\u0275\u0275listener("click",function(o){e.\u0275\u0275restoreView(t);const s=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(s.createLinkLabel(o,s.searchText))}),e.\u0275\u0275text(2,"rulenode.create-new-link-label"),e.\u0275\u0275elementEnd()()}}function ry(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-option",15)(1,"div",16),e.\u0275\u0275listener("click",function(a){return a.stopPropagation()}),e.\u0275\u0275template(2,ny,3,0,"div",17),e.\u0275\u0275template(3,ay,3,5,"ng-template",null,18,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(5,oy,3,0,"span",19),e.\u0275\u0275elementEnd()()),2&i){const t=e.\u0275\u0275reference(4),a=e.\u0275\u0275nextContext();e.\u0275\u0275property("value",null),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!a.textIsNotEmpty(a.searchText))("ngIfElse",t),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",a.allowCustom)}}class Qn{get required(){return this.requiredValue}set required(n){this.requiredValue=(0,ue.coerceBooleanProperty)(n)}get allowCustom(){return this.allowCustomValue}set allowCustom(n){this.allowCustomValue=(0,ue.coerceBooleanProperty)(n),this.separatorKeysCodes=this.allowCustomValue?[Fn.ENTER,Fn.COMMA,Fn.SEMICOLON]:[]}constructor(n,t,a,o){this.fb=n,this.truncate=t,this.translate=a,this.ruleChainService=o,this.labelsList=[],this.separatorKeysCodes=[],this.labels=[],this.searchText="",this.propagateChange=s=>{},this.linksFormGroup=this.fb.group({label:[null]})}registerOnChange(n){this.propagateChange=n}registerOnTouched(n){}ngOnInit(){this.filteredLabels=this.linksFormGroup.get("label").valueChanges.pipe((0,La.O)(""),(0,re.U)(n=>n||""),(0,ne.z)(n=>this.fetchLabels(n)),(0,Uo.B)())}ngOnChanges(n){let t=!1;for(const a of Object.keys(n)){const o=n[a];o.currentValue!==o.previousValue&&["allowCustom","allowedLabels","sourceRuleChainId"].includes(a)&&(t=!0)}t&&this.linksFormGroup.get("label").patchValue("",{emitEvent:!0})}setDisabledState(n){this.disabled=n,this.disabled?this.linksFormGroup.disable({emitEvent:!1}):this.linksFormGroup.enable({emitEvent:!1})}writeValue(n){this.searchText="",this.labelsList.length=0,this.labels.length=0,this.modelValue=n,this.prepareLabelsList().subscribe(t=>{this.labelsList=t,n&&n.forEach(a=>{this.allowedLabels[a]?this.labels.push((0,T.I8)(this.allowedLabels[a])):this.labels.push({name:a,value:a})}),this.chipList&&this.required&&(this.chipList.errorState=!this.labels.length),this.linksFormGroup.get("label").patchValue("",{emitEvent:!0})})}prepareLabelsList(){const n=[];if(this.sourceRuleChainId)return this.ruleChainService.getRuleChainOutputLabels(this.sourceRuleChainId,{ignoreErrors:!0}).pipe((0,re.U)(t=>{for(const a of t)n.push({name:a,value:a});return n}),(0,Go.K)(()=>(0,J.of)(n)));for(const t of Object.keys(this.allowedLabels))n.push({name:this.allowedLabels[t].name,value:this.allowedLabels[t].value});return(0,J.of)(n)}displayLabelFn(n){return n?n.name:void 0}textIsNotEmpty(n){return n&&n.length>0}createLinkLabel(n,t){n.preventDefault(),this.transformLinkLabel(t)}add(n){(!this.matAutocomplete.isOpen||this.allowCustom)&&this.transformLinkLabel(n.value)}fetchLabels(n){if(this.searchText=n,this.searchText&&this.searchText.length){const t=this.searchText.toUpperCase();return(0,J.of)(this.labelsList.filter(a=>a.name.toUpperCase().includes(t)))}return(0,J.of)(this.labelsList)}transformLinkLabel(n){if((n||"").trim()){let t=null;const a=n.trim(),o=this.labelsList.find(s=>s.name===a);o?t=(0,T.I8)(o):this.allowCustom&&(t={name:a,value:a}),t&&this.addLabel(t)}this.clear("")}remove(n){const t=this.labels.indexOf(n);t>=0&&(this.labels.splice(t,1),this.labels.length||this.required&&(this.chipList.errorState=!0),this.updateModel())}selected(n){this.addLabel(n.option.value),this.clear("")}addLabel(n){-1===this.labels.findIndex(a=>a.value===n.value)&&(this.labels.push(n),this.required&&(this.chipList.errorState=!1),this.updateModel())}onFocus(){this.linksFormGroup.get("label").updateValueAndValidity({onlySelf:!0,emitEvent:!0})}clear(n=""){this.labelInput.nativeElement.value=n,this.linksFormGroup.get("label").patchValue(null,{emitEvent:!0}),setTimeout(()=>{this.labelInput.nativeElement.blur(),this.labelInput.nativeElement.focus()},0)}updateModel(){const n=this.labels.map(t=>t.value);this.propagateChange(n)}}Qn.\u0275fac=function(n){return new(n||Qn)(e.\u0275\u0275directiveInject(r.UntypedFormBuilder),e.\u0275\u0275directiveInject(gr.TruncatePipe),e.\u0275\u0275directiveInject(g.TranslateService),e.\u0275\u0275directiveInject(zt.U))},Qn.\u0275cmp=e.\u0275\u0275defineComponent({type:Qn,selectors:[["tb-link-labels"]],viewQuery:function(n,t){if(1&n&&(e.\u0275\u0275viewQuery(Jb,5),e.\u0275\u0275viewQuery(Qb,5),e.\u0275\u0275viewQuery(Xb,5)),2&n){let a;e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(t.chipList=a.first),e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(t.matAutocomplete=a.first),e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(t.labelInput=a.first)}},inputs:{required:"required",disabled:"disabled",allowCustom:"allowCustom",allowedLabels:"allowedLabels",sourceRuleChainId:"sourceRuleChainId"},features:[e.\u0275\u0275ProvidersFeature([{provide:r.NG_VALUE_ACCESSOR,useExisting:(0,e.forwardRef)(()=>Qn),multi:!0}]),e.\u0275\u0275NgOnChangesFeature],decls:16,vars:16,consts:[[2,"width","100%",3,"formGroup"],["translate",""],["chipList",""],[3,"removable","removed",4,"ngFor","ngForOf"],["matInput","","type","text","formControlName","label","matAutocompleteOrigin","",2,"max-width","200px",3,"placeholder","matAutocompleteConnectedTo","matAutocomplete","matChipInputFor","matChipInputSeparatorKeyCodes","focusin","matChipInputTokenEnd"],["labelInput","","origin","matAutocompleteOrigin"],[1,"tb-autocomplete",3,"displayWith","optionSelected"],["labelAutocomplete","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["class","tb-not-found",3,"value",4,"ngIf"],[3,"removable","removed"],["matChipRemove","",4,"ngIf"],["matChipRemove",""],[3,"value"],[3,"innerHTML"],[1,"tb-not-found",3,"value"],[1,"tb-not-found-content",3,"click"],[4,"ngIf","ngIfElse"],["searchNotEmpty",""],[4,"ngIf"],["translate","",3,"click"]],template:function(n,t){if(1&n&&(e.\u0275\u0275elementStart(0,"mat-form-field",0)(1,"mat-label",1),e.\u0275\u0275text(2,"rulenode.link-labels"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"mat-chip-grid",null,2),e.\u0275\u0275template(5,ey,3,3,"mat-chip-row",3),e.\u0275\u0275elementStart(6,"input",4,5),e.\u0275\u0275listener("focusin",function(){return t.onFocus()})("matChipInputTokenEnd",function(o){return t.add(o)}),e.\u0275\u0275pipe(9,"translate"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(10,"mat-autocomplete",6,7),e.\u0275\u0275listener("optionSelected",function(o){return t.selected(o)}),e.\u0275\u0275template(12,ty,3,5,"mat-option",8),e.\u0275\u0275pipe(13,"async"),e.\u0275\u0275template(14,ry,6,4,"mat-option",9),e.\u0275\u0275pipe(15,"async"),e.\u0275\u0275elementEnd()()),2&n){const a=e.\u0275\u0275reference(4),o=e.\u0275\u0275reference(8),s=e.\u0275\u0275reference(11);let l;e.\u0275\u0275property("formGroup",t.linksFormGroup),e.\u0275\u0275advance(5),e.\u0275\u0275property("ngForOf",t.labels),e.\u0275\u0275advance(1),e.\u0275\u0275propertyInterpolate("placeholder",t.disabled?"":e.\u0275\u0275pipeBind1(9,10,"rulenode.link-label")),e.\u0275\u0275property("matAutocompleteConnectedTo",o)("matAutocomplete",s)("matChipInputFor",a)("matChipInputSeparatorKeyCodes",t.separatorKeysCodes),e.\u0275\u0275advance(4),e.\u0275\u0275property("displayWith",t.displayLabelFn),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",e.\u0275\u0275pipeBind1(13,12,t.filteredLabels)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",0===(null==(l=e.\u0275\u0275pipeBind1(15,14,t.filteredLabels))?null:l.length))}},dependencies:[p.NgForOf,p.NgIf,F.MatIcon,O.MatInput,_.MatFormField,_.MatLabel,X.MatOption,ka.MatAutocomplete,ka.MatAutocompleteTrigger,ka.MatAutocompleteOrigin,ve.MatChipGrid,ve.MatChipInput,ve.MatChipRemove,ve.MatChipRow,r.DefaultValueAccessor,r.NgControlStatus,r.NgControlStatusGroup,r.FormGroupDirective,r.FormControlName,g.TranslateDirective,p.AsyncPipe,Wo.HighlightPipe,g.TranslatePipe],encapsulation:2});class Kt{get required(){return this.requiredValue}set required(n){this.requiredValue=(0,ue.coerceBooleanProperty)(n)}get allowCustom(){return this.allowCustomValue}set allowCustom(n){this.allowCustomValue=(0,ue.coerceBooleanProperty)(n)}constructor(n,t,a){this.fb=n,this.truncate=t,this.translate=a,this.propagateChange=o=>{},this.ruleNodeLinkFormGroup=this.fb.group({labels:[[],r.Validators.required]}),this.ruleNodeLinkFormGroup.get("labels").valueChanges.subscribe(o=>this.updateModel(o))}registerOnChange(n){this.propagateChange=n}registerOnTouched(n){}ngOnInit(){}setDisabledState(n){this.disabled=n,this.disabled?this.ruleNodeLinkFormGroup.disable({emitEvent:!1}):this.ruleNodeLinkFormGroup.enable({emitEvent:!1})}writeValue(n){this.modelValue=n;const t=this.modelValue&&this.modelValue.labels?this.modelValue.labels:[];this.ruleNodeLinkFormGroup.get("labels").patchValue(t,{emitEvent:!1})}updateModel(n){n&&n.length?(this.modelValue.labels=n,this.modelValue.label=n.join(" / "),this.propagateChange(this.modelValue)):this.propagateChange(this.required?null:this.modelValue)}}Kt.\u0275fac=function(n){return new(n||Kt)(e.\u0275\u0275directiveInject(r.UntypedFormBuilder),e.\u0275\u0275directiveInject(gr.TruncatePipe),e.\u0275\u0275directiveInject(g.TranslateService))},Kt.\u0275cmp=e.\u0275\u0275defineComponent({type:Kt,selectors:[["tb-rule-node-link"]],inputs:{required:"required",disabled:"disabled",allowCustom:"allowCustom",allowedLabels:"allowedLabels",sourceRuleChainId:"sourceRuleChainId"},features:[e.\u0275\u0275ProvidersFeature([{provide:r.NG_VALUE_ACCESSOR,useExisting:(0,e.forwardRef)(()=>Kt),multi:!0}])],decls:3,vars:4,consts:[["fxLayout","column",1,"mat-padding"],[3,"formGroup"],["required","","formControlName","labels",3,"allowedLabels","allowCustom","sourceRuleChainId"]],template:function(n,t){1&n&&(e.\u0275\u0275elementStart(0,"div",0)(1,"form",1),e.\u0275\u0275element(2,"tb-link-labels",2),e.\u0275\u0275elementEnd()()),2&n&&(e.\u0275\u0275advance(1),e.\u0275\u0275property("formGroup",t.ruleNodeLinkFormGroup),e.\u0275\u0275advance(1),e.\u0275\u0275property("allowedLabels",t.allowedLabels)("allowCustom",t.allowCustom)("sourceRuleChainId",t.sourceRuleChainId))},dependencies:[h.DefaultLayoutDirective,r.\u0275NgNoValidate,r.NgControlStatus,r.NgControlStatusGroup,r.RequiredValidator,r.FormGroupDirective,r.FormControlName,Qn],encapsulation:2});var fr=c(11613),sy=c(36678),xo=c(9085),ly=c(75792),dy=c(80332),cy=c(24513),ba=c(70970);const py=["ruleChainCanvas"],my=["ruleChainMenuTrigger"],uy=["drawer"],hr=["tbRuleNode"],gy=["tbRuleNodeLink"],fy=["ruleNodeTypeExpansionPanels"];function hy(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"tb-rule-chain-select",34),e.\u0275\u0275listener("ngModelChange",function(o){e.\u0275\u0275restoreView(t);const s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.ruleChain.id.id=o)})("ngModelChange",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.currentRuleChainIdChanged(null==o.ruleChain.id?null:o.ruleChain.id.id))}),e.\u0275\u0275elementEnd()}if(2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275property("ruleChainType",t.ruleChainType)("disabled",t.isDirtyValue)("ngModel",t.ruleChain.id.id)}}function by(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"mat-expansion-panel",35,36)(2,"mat-expansion-panel-header",37),e.\u0275\u0275listener("mouseenter",function(o){const l=e.\u0275\u0275restoreView(t).$implicit,d=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(d.typeHeaderMouseEnter(o,l))})("mouseleave",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.destroyTooltips())}),e.\u0275\u0275elementStart(3,"mat-panel-title")(4,"mat-icon"),e.\u0275\u0275text(5),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(6,"div",38),e.\u0275\u0275text(7),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275element(8,"fc-canvas",39),e.\u0275\u0275elementEnd()}if(2&i){const t=n.$implicit,a=e.\u0275\u0275nextContext();e.\u0275\u0275property("expanded",!0),e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate(a.ruleNodeTypeDescriptorsMap.get(t).icon),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(a.ruleNodeTypeDescriptorsMap.get(t).name),e.\u0275\u0275advance(1),e.\u0275\u0275propertyInterpolate1("id","tb-rulchain-",t,""),e.\u0275\u0275property("model",a.ruleNodeTypesModel[t].model)("selectedObjects",a.ruleNodeTypesModel[t].selectedObjects)("automaticResize",!1)("userCallbacks",a.nodeLibCallbacks)("nodeWidth",170)("nodeHeight",50)("dropTargetId","tb-rulchain-canvas")}}const yy=function(i){return[i]};function vy(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"mat-tab",44,53),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementStart(3,"tb-event-table",54),e.\u0275\u0275listener("debugEventSelected",function(o){e.\u0275\u0275restoreView(t);const s=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(s.onDebugEventSelected(o))}),e.\u0275\u0275elementEnd()()}if(2&i){const t=e.\u0275\u0275reference(1),a=e.\u0275\u0275nextContext(2);e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(2,7,"rulenode.events")),e.\u0275\u0275advance(3),e.\u0275\u0275property("debugEventTypes",e.\u0275\u0275pureFunction1(9,yy,a.debugEventTypes.DEBUG_RULE_NODE))("defaultEventType",a.debugEventTypes.DEBUG_RULE_NODE)("active",t.isActive)("tenantId",a.ruleChain.tenantId.id)("entityId",a.editingRuleNode.ruleNodeId)("functionTestButtonLabel",a.ruleNodeTestButtonLabel)}}function _y(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"tb-details-panel",40),e.\u0275\u0275listener("closeDetails",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.onEditRuleNodeClosed())})("toggleDetailsEditMode",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.onRevertRuleNodeEdit())})("applyDetails",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.saveRuleNode())}),e.\u0275\u0275pipe(1,"translate"),e.\u0275\u0275elementStart(2,"div",41),e.\u0275\u0275element(3,"div",42),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"mat-tab-group",43),e.\u0275\u0275listener("selectedIndexChange",function(o){e.\u0275\u0275restoreView(t);const s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.selectedRuleNodeTabIndex=o)}),e.\u0275\u0275elementStart(5,"mat-tab",44),e.\u0275\u0275pipe(6,"translate"),e.\u0275\u0275elementStart(7,"tb-rule-node",45,46),e.\u0275\u0275listener("initRuleNode",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.onRuleNodeInit())})("changeScript",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.switchToFirstTab())}),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(9,vy,4,11,"mat-tab",47),e.\u0275\u0275elementStart(10,"mat-tab",44),e.\u0275\u0275pipe(11,"translate"),e.\u0275\u0275elementStart(12,"div",48)(13,"div",49)(14,"div",50),e.\u0275\u0275text(15),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(16,"div"),e.\u0275\u0275text(17,"\xa0"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(18,"div",51),e.\u0275\u0275text(19),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(20,"div"),e.\u0275\u0275text(21,"\xa0"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(22,"div",52),e.\u0275\u0275elementEnd()()()()()}if(2&i){const t=e.\u0275\u0275reference(8),a=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("headerTitle",a.editingRuleNode.name),e.\u0275\u0275propertyInterpolate("headerSubtitle",e.\u0275\u0275pipeBind1(1,16,a.ruleNodeTypeDescriptorsMap.get(a.editingRuleNode.component.type).name)+" - "+a.editingRuleNode.component.name),e.\u0275\u0275property("isReadOnly",a.selectedRuleNodeTabIndex>0)("isAlwaysEdit",!0)("theForm",t.ruleNodeFormGroup),e.\u0275\u0275advance(3),e.\u0275\u0275property("tb-help",a.helpLinkIdForRuleNodeType()),e.\u0275\u0275advance(1),e.\u0275\u0275property("selectedIndex",a.selectedRuleNodeTabIndex),e.\u0275\u0275advance(1),e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(6,18,"rulenode.details")),e.\u0275\u0275advance(2),e.\u0275\u0275property("ruleNode",a.editingRuleNode)("ruleChainId",null==a.ruleChain.id?null:a.ruleChain.id.id)("ruleChainType",a.ruleChainType),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",a.editingRuleNode.ruleNodeId),e.\u0275\u0275advance(1),e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(11,20,"rulenode.help")),e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate(a.editingRuleNode.component.name),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate(a.editingRuleNode.component.configurationDescriptor.nodeDefinition.description),e.\u0275\u0275advance(3),e.\u0275\u0275property("innerHtml",a.editingRuleNode.component.configurationDescriptor.nodeDefinition.details,e.\u0275\u0275sanitizeHtml)}}function xy(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"tb-details-panel",40),e.\u0275\u0275listener("closeDetails",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.onEditRuleNodeLinkClosed())})("toggleDetailsEditMode",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.onRevertRuleNodeLinkEdit())})("applyDetails",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.saveRuleNodeLink())}),e.\u0275\u0275pipe(1,"translate"),e.\u0275\u0275elementStart(2,"div",41),e.\u0275\u0275element(3,"div",42),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"tb-rule-node-link",55,56),e.\u0275\u0275listener("ngModelChange",function(o){e.\u0275\u0275restoreView(t);const s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.editingRuleNodeLink=o)}),e.\u0275\u0275elementEnd()()}if(2&i){const t=e.\u0275\u0275reference(5),a=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("headerTitle",a.editingRuleNodeLink.label),e.\u0275\u0275propertyInterpolate("headerSubtitle",e.\u0275\u0275pipeBind1(1,10,"rulenode.link-details")),e.\u0275\u0275property("isReadOnly",!1)("isAlwaysEdit",!0)("theForm",t.ruleNodeLinkFormGroup),e.\u0275\u0275advance(3),e.\u0275\u0275property("tb-help","ruleEngine"),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngModel",a.editingRuleNodeLink)("allowedLabels",a.editingRuleNodeLinkLabels)("allowCustom",a.editingRuleNodeAllowCustomLabels)("sourceRuleChainId",a.editingRuleNodeSourceRuleChainId)}}function Cy(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",57,58),e.\u0275\u0275listener("click",function(o){e.\u0275\u0275restoreView(t);const s=e.\u0275\u0275reference(1),l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.toggleVersionControl(o,s))}),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementStart(3,"mat-icon"),e.\u0275\u0275text(4,"history"),e.\u0275\u0275elementEnd()()}2&i&&e.\u0275\u0275propertyInterpolate("matTooltip",e.\u0275\u0275pipeBind1(2,1,"version-control.version-control"))}function Ty(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-icon"),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275nextContext().contextInfo;e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(t.icon)}}function Sy(i,n){if(1&i&&e.\u0275\u0275element(0,"img",66),2&i){const t=e.\u0275\u0275nextContext().contextInfo;e.\u0275\u0275property("src",t.iconUrl,e.\u0275\u0275sanitizeUrl)}}function Iy(i,n){1&i&&e.\u0275\u0275element(0,"mat-divider")}function wy(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"span",71),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"keyboardShortcut"),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275nextContext(2).$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,t.shortcut),"")}}function Ey(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-icon"),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275nextContext(2).$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(t.icon)}}function My(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",68),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext().$implicit,s=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(o.action(s.contextMenuEvent))}),e.\u0275\u0275template(1,wy,3,3,"span",69),e.\u0275\u0275template(2,Ey,2,1,"mat-icon",60),e.\u0275\u0275elementStart(3,"span",70),e.\u0275\u0275text(4),e.\u0275\u0275elementEnd()()}if(2&i){const t=e.\u0275\u0275nextContext().$implicit;e.\u0275\u0275property("disabled",!t.enabled),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.shortcut),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.icon),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(t.value)}}function Dy(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div"),e.\u0275\u0275template(1,Iy,1,0,"mat-divider",60),e.\u0275\u0275template(2,My,5,4,"button",67),e.\u0275\u0275elementEnd()),2&i){const t=n.$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.divider),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!t.divider)}}function Ay(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",59),e.\u0275\u0275listener("mouseleave",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.onRuleChainContextMenuMouseLeave())}),e.\u0275\u0275elementStart(1,"div"),e.\u0275\u0275template(2,Ty,2,1,"mat-icon",60),e.\u0275\u0275template(3,Sy,1,1,"img",61),e.\u0275\u0275elementStart(4,"div",62)(5,"div",63),e.\u0275\u0275text(6),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(7,"div",64),e.\u0275\u0275text(8),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275template(9,Dy,3,2,"div",65),e.\u0275\u0275elementEnd()}if(2&i){const t=n.contextInfo;e.\u0275\u0275advance(1),e.\u0275\u0275classMapInterpolate1("tb-context-menu-header ",t.headerClass,""),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!t.iconUrl),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.iconUrl),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(t.title),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(t.subtitle),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",t.menuItems)}}const Ny=function(i){return{"tb-library-node-btn-icon-toggled":i}},Fy=function(i){return{"tb-hide":i}};function Ly(i,n){1&i&&e.\u0275\u0275element(0,"mat-progress-bar",14)}function Py(i,n){1&i&&e.\u0275\u0275element(0,"mat-progress-bar",14)}function ky(i,n){1&i&&e.\u0275\u0275element(0,"mat-progress-bar",19)}function Ry(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"rulechain.name-required")," "))}function Oy(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"rulechain.name-max-length")," "))}class Ge extends se.I{get isDirty(){return this.isDirtyValue||this.isImport}set isDirty(n){this.isDirtyValue=n}constructor(n,t,a,o,s,l,d,m,y,I,E,L,ae,Nn){super(n),this.store=n,this.route=t,this.router=a,this.ruleChainService=o,this.authService=s,this.translate=l,this.itembuffer=d,this.popoverService=m,this.renderer=y,this.viewContainerRef=I,this.changeDetector=E,this.dialog=L,this.dialogService=ae,this.fb=Nn,this.width="100%",this.height="100%",this.eventTypes=fr.tw,this.debugEventTypes=fr.UI,this.ruleChainMenuPosition={x:"0px",y:"0px"},this.ruleNodeTypeDescriptorsMap=B.Rb,this.ruleNodeTypesLibraryArray=B.D5,this.isInvalid=!1,this.errorTooltips={},this.isFullscreen=!1,this.selectedRuleNodeTabIndex=0,this.editingRuleNode=null,this.isEditingRuleNode=!1,this.editingRuleNodeIndex=-1,this.editingRuleNodeAllowCustomLabels=!1,this.editingRuleNodeLink=null,this.isEditingRuleNodeLink=!1,this.editingRuleNodeLinkIndex=-1,this.hotKeys=[],this.enableHotKeys=!0,this.ruleNodeSearch="",this.ruleNodeTypeSearch=this.fb.control("",{nonNullable:!0}),this.ruleChainModel={nodes:[],edges:[]},this.selectedObjects=[],this.editCallbacks={edgeDoubleClick:(it,w)=>{this.openLinkDetails(w)},edgeEdit:(it,w)=>{this.openLinkDetails(w)},nodeCallbacks:{doubleClick:(it,w)=>{this.openNodeDetails(w)},nodeEdit:(it,w)=>{this.openNodeDetails(w)},mouseEnter:this.displayNodeDescriptionTooltip.bind(this),mouseLeave:this.destroyTooltips.bind(this),mouseDown:this.destroyTooltips.bind(this)},isValidEdge:(it,w)=>it.type===K.Nt.rightConnectorType&&w.type===K.Nt.leftConnectorType,createEdge:(it,w)=>{const ie=this.ruleChainCanvas.modelService.nodes.getNodeByConnectorId(w.source);if(ie.component.type===B.ij.INPUT){const ge=this.ruleChainModel.edges.find(ce=>ce.source===this.inputConnectorId+"");return ge&&this.ruleChainCanvas.modelService.edges.delete(ge),(0,J.of)(w)}if(w.label)return w.labels||(w.labels=w.label.split(" / ")),(0,J.of)(w);{const ge=this.ruleChainService.getRuleNodeSupportedLinks(ie.component),ce=this.ruleChainService.ruleNodeAllowCustomLinks(ie.component),Me=this.ruleChainService.ruleNodeSourceRuleChainId(ie.component,ie.configuration);return this.enableHotKeys=!1,this.addRuleNodeLink(w,ge,ce,Me).pipe((0,Z.b)(()=>{this.enableHotKeys=!0}),(0,ne.z)(je=>je?(0,J.of)(je):Ob.C))}},dropNode:(it,w)=>{this.addRuleNode(w)}},this.ruleNodeTypesModel={},this.nodeLibCallbacks={nodeCallbacks:{mouseEnter:this.displayLibNodeDescriptionTooltip.bind(this),mouseLeave:this.destroyTooltips.bind(this),mouseDown:this.destroyTooltips.bind(this)}},this.flowchartConstants=K.Nt,this.updateBreadcrumbs=new e.EventEmitter,this.destroy$=new be.x,this.route.data.pipe((0,Y.R)(this.destroy$)).subscribe(()=>{this.reset(),this.init()})}ngOnInit(){this.ruleNodeTypeSearch.valueChanges.pipe((0,Bo.b)(150),(0,La.O)(""),(0,uo.x)((n,t)=>n.trim()===t.trim()),(0,Bb.T)(1),(0,Y.R)(this.destroy$)).subscribe(()=>this.updateRuleChainLibrary())}ngAfterViewChecked(){this.changeDetector.detectChanges()}ngAfterViewInit(){this.ruleChainCanvas.adjustCanvasSize(!0)}ngOnDestroy(){super.ngOnDestroy(),this.destroy$.next(),this.destroy$.complete()}currentRuleChainIdChanged(n){this.ruleChainType===de.CI.CORE?this.router.navigateByUrl(`ruleChains/${n}`):this.router.navigateByUrl(`edgeManagement/ruleChains/${n}`)}onSearchTextUpdated(n){this.ruleNodeSearch=n,this.updateRuleNodesHighlight()}init(){if(this.initHotKeys(),this.isImport=this.route.snapshot.data.import,this.ruleChainType=this.route.snapshot.data.ruleChainType,this.isImport){const n=this.itembuffer.getRuleChainImport();this.ruleChain=n.ruleChain,this.ruleChainMetaData=n.metadata}else this.ruleChain=this.route.snapshot.data.ruleChain,this.ruleChainMetaData=this.route.snapshot.data.ruleChainMetaData;this.ruleNodeComponents=this.route.snapshot.data.ruleNodeComponents;for(const n of B.D5)B.Rb.get(n).special||(this.ruleNodeTypesModel[n]={model:{nodes:[],edges:[]},selectedObjects:[]});this.updateRuleChainLibrary(),this.createRuleChainModel()}reset(){this.selectedObjects=[],this.ruleChainModel.nodes=[],this.ruleChainModel.edges=[],this.ruleNodeTypesModel={},this.ruleChainCanvas&&this.ruleChainCanvas.adjustCanvasSize(!0),this.isEditingRuleNode=!1,this.isEditingRuleNodeLink=!1,this.updateRuleNodesHighlight()}initHotKeys(){this.hotKeys.length||(this.hotKeys.push(new me.qm("ctrl+a",n=>!this.enableHotKeys||(n.preventDefault(),this.ruleChainCanvas.modelService.selectAll(),!1),["INPUT","SELECT","TEXTAREA"],this.translate.instant("rulenode.select-all-objects"))),this.hotKeys.push(new me.qm("ctrl+c",n=>!this.enableHotKeys||(n.preventDefault(),this.copyRuleNodes(),!1),["INPUT","SELECT","TEXTAREA"],this.translate.instant("rulenode.copy-selected"))),this.hotKeys.push(new me.qm("ctrl+v",n=>!this.enableHotKeys||(n.preventDefault(),this.itembuffer.hasRuleNodes()&&this.pasteRuleNodes(),!1),["INPUT","SELECT","TEXTAREA"],this.translate.instant("action.paste"))),this.hotKeys.push(new me.qm("esc",n=>!this.enableHotKeys||(n.preventDefault(),n.stopPropagation(),this.ruleChainCanvas.modelService.deselectAll(),!1),["INPUT","SELECT","TEXTAREA"],this.translate.instant("rulenode.deselect-all-objects"))),this.hotKeys.push(new me.qm("ctrl+s",n=>!this.enableHotKeys||(n.preventDefault(),this.saveRuleChain(),!1),["INPUT","SELECT","TEXTAREA"],this.translate.instant("action.apply"))),this.hotKeys.push(new me.qm("ctrl+z",n=>!this.enableHotKeys||(n.preventDefault(),this.revertRuleChain(),!1),["INPUT","SELECT","TEXTAREA"],this.translate.instant("action.decline-changes"))),this.hotKeys.push(new me.qm("del",n=>!this.enableHotKeys||(n.preventDefault(),this.ruleChainCanvas.modelService.deleteSelected(),!1),["INPUT","SELECT","TEXTAREA"],this.translate.instant("rulenode.delete-selected-objects"))),this.hotKeys.push(new me.qm("ctrl+r",n=>!this.enableHotKeys||!this.canCreateNestedRuleChain()||(n.preventDefault(),this.createNestedRuleChain(),!1),["INPUT","SELECT","TEXTAREA"],this.translate.instant("rulenode.create-nested-rulechain"))))}updateRuleChainLibrary(){const n=this.ruleNodeTypeSearch.value.trim().toUpperCase(),t=this.ruleNodeComponents.filter(a=>a.name.toUpperCase().includes(n));this.loadRuleChainLibrary(t)}loadRuleChainLibrary(n){for(const t of Object.keys(this.ruleNodeTypesModel))this.ruleNodeTypesModel[t].model.nodes.length=0;if(n.forEach(t=>{const a=t.type,o=this.ruleNodeTypesModel[a].model,s=B.Rb.get(B.ij[a]);let l=s.icon,d=null;t.configurationDescriptor.nodeDefinition.icon&&(l=t.configurationDescriptor.nodeDefinition.icon),t.configurationDescriptor.nodeDefinition.iconUrl&&(d=t.configurationDescriptor.nodeDefinition.iconUrl);const m={id:"node-lib-"+a+"-"+o.nodes.length,component:t,name:"",nodeClass:s.nodeClass,singletonMode:t.clusteringMode!==ur.m.ENABLED,icon:l,iconUrl:d,x:30,y:10+50*o.nodes.length,connectors:[]};t.configurationDescriptor.nodeDefinition.inEnabled&&m.connectors.push({type:K.Nt.leftConnectorType,id:2*o.nodes.length+""}),t.configurationDescriptor.nodeDefinition.outEnabled&&m.connectors.push({type:K.Nt.rightConnectorType,id:2*o.nodes.length+1+""}),o.nodes.push(m)}),this.expansionPanels)for(let t=0;t<B.D5.length;t++){const a=this.expansionPanels.find((o,s)=>s===t);if(a){const o=B.D5[t];this.ruleNodeTypesModel[o].model.nodes.length?a.open():a.close()}}}createRuleChainModel(){this.nextNodeID=1,this.nextConnectorID=1,this.selectedObjects=[],this.ruleChainModel.nodes=[],this.ruleChainModel.edges=[],this.inputConnectorId=this.nextConnectorID++,this.ruleChainModel.nodes.push({id:"rule-chain-node-"+this.nextNodeID++,component:de._l,name:"",nodeClass:B.Rb.get(B.ij.INPUT).nodeClass,icon:B.Rb.get(B.ij.INPUT).icon,readonly:!0,x:50,y:150,connectors:[{type:K.Nt.rightConnectorType,id:this.inputConnectorId+""}]});const n=[];if(this.ruleChainMetaData.nodes.forEach(t=>{const a=this.ruleChainService.getRuleNodeComponentByClazz(this.ruleChainType,t.type),o=B.Rb.get(a.type);let s=o.icon,l=null;a.configurationDescriptor.nodeDefinition.icon&&(s=a.configurationDescriptor.nodeDefinition.icon),a.configurationDescriptor.nodeDefinition.iconUrl&&(l=a.configurationDescriptor.nodeDefinition.iconUrl);const d={id:"rule-chain-node-"+this.nextNodeID++,ruleNodeId:t.id,additionalInfo:t.additionalInfo,configuration:t.configuration,configurationVersion:(0,T.nu)(t.configurationVersion)?t.configurationVersion:0,debugMode:t.debugMode,singletonMode:t.singletonMode,x:Math.round(t.additionalInfo.layoutX),y:Math.round(t.additionalInfo.layoutY),component:a,name:t.name,nodeClass:o.nodeClass,icon:s,iconUrl:l,connectors:[],ruleChainType:this.ruleChainType};a.configurationDescriptor.nodeDefinition.inEnabled&&d.connectors.push({type:K.Nt.leftConnectorType,id:this.nextConnectorID+++""}),a.configurationDescriptor.nodeDefinition.outEnabled&&d.connectors.push({type:K.Nt.rightConnectorType,id:this.nextConnectorID+++""}),n.push(d),this.ruleChainModel.nodes.push(d)}),this.ruleChainMetaData.firstNodeIndex>-1){const t=n[this.ruleChainMetaData.firstNodeIndex];if(t){const a=t.connectors.filter(o=>o.type===K.Nt.leftConnectorType);if(a&&a.length){const o={source:this.inputConnectorId+"",destination:a[0].id};this.ruleChainModel.edges.push(o)}}}if(this.ruleChainMetaData.connections){const t={};this.ruleChainMetaData.connections.forEach(a=>{const o=n[a.fromIndex],s=n[a.toIndex];if(o&&s){const l=o.connectors.filter(m=>m.type===K.Nt.rightConnectorType),d=s.connectors.filter(m=>m.type===K.Nt.leftConnectorType);if(l&&l.length&&d&&d.length){const m=l[0].id,y=d[0].id,I=m+"_"+y;let E=t[I];E?(E.label+=" / "+a.type,E.labels.push(a.type)):(E={source:m,destination:y,label:a.type,labels:[a.type]},t[I]=E,this.ruleChainModel.edges.push(E))}}})}this.ruleChainCanvas&&this.ruleChainCanvas.adjustCanvasSize(!0),this.isDirtyValue=!1,this.updateRuleNodesHighlight(),this.validate()}openRuleChainContextMenu(n){if(this.ruleChainCanvas.modelService&&!n.ctrlKey&&!n.metaKey){const t=n.clientX,a=n.clientY,o=this.ruleChainCanvas.modelService.getItemInfoAtPoint(t,a),s=this.prepareContextMenu(o);s.menuItems&&s.menuItems.length>0&&(n.preventDefault(),n.stopPropagation(),this.contextMenuEvent=n,this.ruleChainMenuPosition.x=t+"px",this.ruleChainMenuPosition.y=a+"px",this.ruleChainMenuTrigger.menuData={contextInfo:s},this.ruleChainMenuTrigger.openMenu())}}onRuleChainContextMenuMouseLeave(){this.ruleChainMenuTrigger.closeMenu()}prepareContextMenu(n){return this.objectsSelected()||!n.node&&!n.edge?this.prepareRuleChainContextMenu():n.node?this.prepareRuleNodeContextMenu(n.node):n.edge?this.prepareEdgeContextMenu(n.edge):void 0}prepareRuleChainContextMenu(){const n={headerClass:"tb-rulechain-header",icon:"settings_ethernet",title:this.ruleChain.name,subtitle:this.translate.instant("rulechain.rulechain"),menuItems:[]};return this.ruleChainCanvas.modelService.nodes.getSelectedNodes().length&&n.menuItems.push({action:()=>{this.copyRuleNodes()},enabled:!0,value:"rulenode.copy-selected",icon:"content_copy",shortcut:"M-C"}),n.menuItems.push({action:t=>{this.pasteRuleNodes(t)},enabled:this.itembuffer.hasRuleNodes(),value:"action.paste",icon:"content_paste",shortcut:"M-V"}),n.menuItems.push({divider:!0}),this.objectsSelected()?(n.menuItems.push({action:()=>{this.ruleChainCanvas.modelService.deselectAll()},enabled:!0,value:"rulenode.deselect-all",icon:"tab_unselected",shortcut:"Esc"}),this.canCreateNestedRuleChain()&&n.menuItems.push({action:()=>{this.createNestedRuleChain()},enabled:!0,value:"rulenode.create-nested-rulechain",icon:"settings_ethernet",shortcut:"M-R"}),n.menuItems.push({action:()=>{this.ruleChainCanvas.modelService.deleteSelected()},enabled:!0,value:"rulenode.delete-selected",icon:"clear",shortcut:"Del"})):n.menuItems.push({action:()=>{this.ruleChainCanvas.modelService.selectAll()},enabled:!0,value:"rulenode.select-all",icon:"select_all",shortcut:"M-A"}),n.menuItems.push({divider:!0}),n.menuItems.push({action:()=>{this.saveRuleChain()},enabled:!(this.isInvalid||!this.isDirty&&!this.isImport),value:"action.apply-changes",icon:"done",shortcut:"M-S"}),n.menuItems.push({action:()=>{this.revertRuleChain()},enabled:this.isDirty,value:"action.decline-changes",icon:"close",shortcut:"M-Z"}),n}prepareRuleNodeContextMenu(n){const t={headerClass:n.nodeClass,icon:n.icon,iconUrl:n.iconUrl,title:n.name,subtitle:n.component.name,menuItems:[]};return n.readonly||(t.menuItems.push({action:()=>{this.openNodeDetails(n)},enabled:!0,value:"rulenode.details",icon:"menu"}),t.menuItems.push({action:()=>{this.copyNode(n)},enabled:!0,value:"action.copy",icon:"content_copy"}),t.menuItems.push({action:()=>{this.ruleChainCanvas.modelService.nodes.delete(n)},enabled:!0,value:"action.delete",icon:"clear",shortcut:"M-X"})),t}prepareEdgeContextMenu(n){const t={headerClass:"tb-link-header",icon:"trending_flat",title:n.label,subtitle:this.translate.instant("rulenode.link"),menuItems:[]};return this.ruleChainCanvas.modelService.nodes.getNodeByConnectorId(n.source).component.type!==B.ij.INPUT&&t.menuItems.push({action:()=>{this.openLinkDetails(n)},enabled:!0,value:"rulenode.details",icon:"menu"}),t.menuItems.push({action:()=>{this.ruleChainCanvas.modelService.edges.delete(n)},enabled:!0,value:"action.delete",icon:"clear",shortcut:"M-X"}),t}canCreateNestedRuleChain(){const n=this.ruleChainCanvas.modelService.nodes.getSelectedNodes(),t=this.ruleChainCanvas.modelService.edges.getSelectedEdges();if(n.length>1){const a=new Set;return t.forEach(s=>{const l=this.ruleChainCanvas.modelService.nodes.getNodeByConnectorId(s.source),d=this.ruleChainCanvas.modelService.nodes.getNodeByConnectorId(s.destination),m=n.indexOf(l),y=n.indexOf(d);m>-1&&y>-1&&a.add(y)}),n.filter((s,l)=>!a.has(l)).filter(s=>s.component.configurationDescriptor.nodeDefinition.inEnabled).length<=1}return!1}createNestedRuleChain(){const n=this.ruleChainCanvas.modelService.nodes.getSelectedNodes(),t=this.ruleChainCanvas.modelService.edges.getSelectedEdges();this.dialog.open(ei,{disableClose:!0,panelClass:["tb-dialog","tb-fullscreen-dialog"],data:{ruleChainType:this.ruleChainType}}).afterClosed().subscribe(a=>{if(a){this.ruleChainCanvas.modelService.deselectAll();const o={ruleChainId:a.id,nodes:[],connections:[]};let s=[],l=null,d=0,m=null,y=0;n.forEach(w=>{const ie={type:w.component.clazz,name:w.name,configuration:(0,T.I8)(w.configuration),additionalInfo:w.additionalInfo?(0,T.I8)(w.additionalInfo):{},debugMode:w.debugMode,singletonMode:w.singletonMode};l=null===l?w.x:Math.min(l,w.x),m=null===m?w.y:Math.min(m,w.y),d=Math.max(d,w.x),y=Math.max(y,w.y),ie.additionalInfo.layoutX=Math.round(w.x),ie.additionalInfo.layoutY=Math.round(w.y),o.nodes.push(ie),this.ruleChainCanvas.modelService.nodes.getConnectorsByType(w,K.Nt.rightConnectorType).forEach(ce=>{const je=this.ruleChainCanvas.modelService.model.edges.filter(We=>We.source===ce.id).filter(We=>{const at=this.ruleChainCanvas.modelService.nodes.getNodeByConnectorId(We.destination);return-1===n.indexOf(at)});s=s.concat(je)})});const I=new Set;t.forEach(w=>{const ie=this.ruleChainCanvas.modelService.nodes.getNodeByConnectorId(w.source),ge=this.ruleChainCanvas.modelService.nodes.getNodeByConnectorId(w.destination);if(ie.component.type!==B.ij.INPUT){const ce=n.indexOf(ie),Me=n.indexOf(ge);if(ce>-1&&Me>-1){const je={fromIndex:ce,toIndex:Me};w.labels.forEach(We=>{const at=(0,T.I8)(je);at.type=We,o.connections.push(at)}),I.add(Me)}}});const L=n.filter((w,ie)=>!I.has(ie)).filter(w=>w.component.configurationDescriptor.nodeDefinition.inEnabled);let ae=[];if(L.length){const w=L[0],ie=this.ruleChainCanvas.modelService.nodes.getConnectorsByType(w,K.Nt.leftConnectorType);if(ie.length){const ge=ie[0],ce=this.ruleChainCanvas.modelService.model.edges.filter(Me=>Me.destination===ge.id);ae=ae.concat(ce)}o.firstNodeIndex=n.indexOf(w)}s.forEach(w=>{const ie=this.ruleChainCanvas.modelService.nodes.getNodeByConnectorId(w.source),ge=this.ruleChainCanvas.modelService.nodes.getNodeByConnectorId(w.destination),ce={type:B.QA,name:w.label,configuration:{},additionalInfo:{},debugMode:!1,singletonMode:!1};ce.additionalInfo.layoutX=Math.round(ge.x),ce.additionalInfo.layoutY=Math.round(ge.y),o.nodes.push(ce);const We={fromIndex:n.indexOf(ie),toIndex:o.nodes.length-1};w.labels.forEach(at=>{const eo=(0,T.I8)(We);eo.type=at,o.connections.push(eo)})});const Nn=Math.round(l-375),it=Math.round(m-150);o.nodes.forEach(w=>{w.additionalInfo.layoutX-=Nn,w.additionalInfo.layoutY-=it}),this.ruleChainService.saveRuleChainMetadata(o).subscribe(()=>{const w=this.ruleChainService.getRuleNodeComponentByClazz(this.ruleChainType,B.yy),ie=B.Rb.get(w.type);let ge=ie.icon,ce=null;w.configurationDescriptor.nodeDefinition.icon&&(ge=w.configurationDescriptor.nodeDefinition.icon),w.configurationDescriptor.nodeDefinition.iconUrl&&(ce=w.configurationDescriptor.nodeDefinition.iconUrl);const Me=(l+d)/2,je=(m+y)/2,We=this.nextConnectorID+++"",at=this.nextConnectorID+++"",eo={name:a.name,component:w,id:"rule-chain-node-"+this.nextNodeID++,configuration:{ruleChainId:a.id.id},debugMode:!1,singletonMode:!1,x:Math.round(Me),y:Math.round(je),nodeClass:ie.nodeClass,icon:ge,iconUrl:ce,ruleChainType:this.ruleChainType,connectors:[{type:K.Nt.leftConnectorType,id:We},{type:K.Nt.rightConnectorType,id:at}]};this.ruleChainModel.nodes.push(eo),ae.forEach(ci=>{ci.destination=We}),s.forEach(ci=>{ci.source=at,ci.labels=[ci.label]}),n.forEach(ci=>{this.ruleChainCanvas.modelService.nodes.delete(ci)}),this.onModelChanged(),this.updateRuleNodesHighlight()})}})}onModelChanged(){this.isDirtyValue=!0,this.validate()}helpLinkIdForRuleNodeType(){let n=null;return this.editingRuleNode&&(n=this.editingRuleNode.component),(0,B.OP)(n)}openNodeDetails(n){n.component.type!==B.ij.INPUT&&(this.enableHotKeys=!1,this.updateErrorTooltips(!0),this.isEditingRuleNodeLink=!1,this.editingRuleNodeLink=null,this.isEditingRuleNode=!0,this.editingRuleNodeIndex=this.ruleChainModel.nodes.indexOf(n),this.editingRuleNode=(0,T.I8)(n,["component"]),setTimeout(()=>{this.ruleNodeComponent.ruleNodeFormGroup.markAsPristine()},0))}openLinkDetails(n){const t=this.ruleChainCanvas.modelService.nodes.getNodeByConnectorId(n.source);t.component.type!==B.ij.INPUT&&(this.enableHotKeys=!1,this.updateErrorTooltips(!0),this.isEditingRuleNode=!1,this.editingRuleNode=null,this.editingRuleNodeLinkLabels=this.ruleChainService.getRuleNodeSupportedLinks(t.component),this.editingRuleNodeAllowCustomLabels=this.ruleChainService.ruleNodeAllowCustomLinks(t.component),this.editingRuleNodeSourceRuleChainId=this.ruleChainService.ruleNodeSourceRuleChainId(t.component,t.configuration),this.isEditingRuleNodeLink=!0,this.editingRuleNodeLinkIndex=this.ruleChainModel.edges.indexOf(n),this.editingRuleNodeLink=(0,T.I8)(n),setTimeout(()=>{this.ruleNodeLinkComponent.ruleNodeLinkFormGroup.markAsPristine()},0))}copyNode(n){this.itembuffer.copyRuleNodes([n],[])}copyRuleNodes(){const n=this.ruleChainCanvas.modelService.nodes.getSelectedNodes(),t=this.ruleChainCanvas.modelService.edges.getSelectedEdges(),a=[];t.forEach(o=>{const s=this.ruleChainCanvas.modelService.nodes.getNodeByConnectorId(o.source),l=this.ruleChainCanvas.modelService.nodes.getNodeByConnectorId(o.destination),d=s.component.type===B.ij.INPUT,m=n.indexOf(s),y=n.indexOf(l);if((d||m>-1)&&y>-1){const I={isInputSource:d,fromIndex:m,toIndex:y,label:o.label,labels:o.labels};a.push(I)}}),this.itembuffer.copyRuleNodes(n,a)}pasteRuleNodes(n){const t=ba(this.ruleChainCanvas.modelService.canvasHtmlElement);let a,o;if(n){const l=t.offset();a=Math.round(n.clientX-l.left),o=Math.round(n.clientY-l.top)}else{const l=t.parent(),d=l.scrollTop();a=l.scrollLeft()+l.width()/2,o=d+l.height()/2}const s=this.itembuffer.pasteRuleNodes(a,o);if(s){this.ruleChainCanvas.modelService.deselectAll();const l=[];s.nodes.forEach(d=>{d.id="rule-chain-node-"+this.nextNodeID++;const m=d.component;m.configurationDescriptor.nodeDefinition.inEnabled&&d.connectors.push({type:K.Nt.leftConnectorType,id:this.nextConnectorID+++""}),m.configurationDescriptor.nodeDefinition.outEnabled&&d.connectors.push({type:K.Nt.rightConnectorType,id:this.nextConnectorID+++""}),l.push(d),this.ruleChainModel.nodes.push(d),this.ruleChainCanvas.modelService.nodes.select(d)}),s.connections.forEach(d=>{const m=l[d.fromIndex],y=l[d.toIndex];if((d.isInputSource||m)&&y){let I,E;if(d.isInputSource){I=this.inputConnectorId+"";const ae=this.ruleChainModel.edges.find(Nn=>Nn.source===this.inputConnectorId+"");ae&&this.ruleChainCanvas.modelService.edges.delete(ae)}else{const ae=this.ruleChainCanvas.modelService.nodes.getConnectorsByType(m,K.Nt.rightConnectorType);ae&&ae.length&&(I=ae[0].id)}const L=this.ruleChainCanvas.modelService.nodes.getConnectorsByType(y,K.Nt.leftConnectorType);if(L&&L.length&&(E=L[0].id),I&&E){const ae={source:I,destination:E,label:d.label,labels:d.labels};this.ruleChainModel.edges.push(ae),this.ruleChainCanvas.modelService.edges.select(ae)}}}),this.updateRuleNodesHighlight(),this.validate(),this.onModelChanged()}}onDetailsDrawerClosed(){this.onEditRuleNodeClosed(),this.onEditRuleNodeLinkClosed(),this.enableHotKeys=!0,this.updateErrorTooltips(!1)}onEditRuleNodeClosed(){this.editingRuleNode=null,this.isEditingRuleNode=!1}onEditRuleNodeLinkClosed(){this.editingRuleNodeLink=null,this.isEditingRuleNodeLink=!1}onRevertRuleNodeEdit(){this.ruleNodeComponent.ruleNodeFormGroup.markAsPristine();const n=this.ruleChainModel.nodes[this.editingRuleNodeIndex];this.editingRuleNode=(0,T.I8)(n,["component"])}onRevertRuleNodeLinkEdit(){this.ruleNodeLinkComponent.ruleNodeLinkFormGroup.markAsPristine();const n=this.ruleChainModel.edges[this.editingRuleNodeLinkIndex];this.editingRuleNodeLink=(0,T.I8)(n)}onDebugEventSelected(n){const t=this.ruleNodeComponent.ruleNodeConfigComponent,a=t.definedConfigComponent;t.useDefinedDirective()&&a.hasScript&&a.testScript&&a.testScript(n)}onRuleNodeInit(){const n=this.ruleNodeComponent.ruleNodeConfigComponent.definedConfigComponent;this.ruleNodeComponent.ruleNodeConfigComponent.useDefinedDirective()&&n.hasScript?this.ruleNodeTestButtonLabel=n.testScriptLabel:this.ruleNodeTestButtonLabel=""}switchToFirstTab(){this.selectedRuleNodeTabIndex=0}saveRuleNode(){this.ruleNodeComponent.validate(),this.ruleNodeComponent.ruleNodeFormGroup.valid&&(this.ruleNodeComponent.ruleNodeFormGroup.markAsPristine(),this.editingRuleNode.error&&delete this.editingRuleNode.error,this.ruleChainModel.nodes[this.editingRuleNodeIndex]=this.editingRuleNode,this.editingRuleNode=(0,T.I8)(this.editingRuleNode,["component"]),this.onModelChanged(),this.updateRuleNodesHighlight())}saveRuleNodeLink(){this.ruleNodeLinkComponent.ruleNodeLinkFormGroup.markAsPristine(),this.ruleChainModel.edges[this.editingRuleNodeLinkIndex]=this.editingRuleNodeLink,this.editingRuleNodeLink=(0,T.I8)(this.editingRuleNodeLink),this.onModelChanged()}typeHeaderMouseEnter(n,t){const a=B.Rb.get(t);this.displayTooltip(n,'<div class="tb-rule-node-tooltip tb-lib-tooltip"><div id="tb-node-content"><div class="tb-node-title">'+this.translate.instant(a.name)+'</div><div class="tb-node-details">'+this.translate.instant(a.details)+"</div></div></div>")}displayLibNodeDescriptionTooltip(n,t){this.displayTooltip(n,'<div class="tb-rule-node-tooltip tb-lib-tooltip"><div id="tb-node-content"><div class="tb-node-title">'+t.component.name+'</div><div class="tb-node-description">'+t.component.configurationDescriptor.nodeDefinition.description+'</div><div class="tb-node-details">'+t.component.configurationDescriptor.nodeDefinition.details+"</div></div></div>")}displayNodeDescriptionTooltip(n,t){if(!this.errorTooltips[t.id]){let a,o,s;t.component.type===B.ij.INPUT?(a=this.translate.instant(B.Rb.get(B.ij.INPUT).name),o=this.translate.instant(B.Rb.get(B.ij.INPUT).details)):(a=t.name,o=this.translate.instant(B.Rb.get(t.component.type).name)+" - "+t.component.name,t.additionalInfo&&(s=t.additionalInfo.description));let l='<div class="tb-rule-node-tooltip"><div id="tb-node-content"><div class="tb-node-title">'+a+'</div><div class="tb-node-description">'+o+"</div>";s&&(l+='<div class="tb-node-details">'+s+"</div>"),l+="</div></div>",this.displayTooltip(n,l)}}destroyTooltips(){this.tooltipTimeout&&(clearTimeout(this.tooltipTimeout),this.tooltipTimeout=null),ba.tooltipster.instances().forEach(t=>{t.isErrorTooltip||t.destroy()})}updateRuleNodesHighlight(){for(const n of this.ruleChainModel.nodes)n.highlighted=!1;if(this.ruleNodeSearch){const n=this.ruleNodeSearch.toUpperCase(),t=this.ruleChainModel.nodes.filter(a=>a.name.toUpperCase().includes(n));if(t)for(const a of t)a.highlighted=!0}this.ruleChainCanvas&&this.ruleChainCanvas.modelService.detectChanges()}objectsSelected(){return this.ruleChainCanvas.modelService.nodes.getSelectedNodes().length>0||this.ruleChainCanvas.modelService.edges.getSelectedEdges().length>0}deleteSelected(){this.ruleChainCanvas.modelService.deleteSelected()}isDebugModeEnabled(){return typeof this.ruleChainModel.nodes.find(t=>t.debugMode)<"u"}resetDebugModeInAllNodes(){let n=!1;this.ruleChainModel.nodes.forEach(t=>{t.component.type!==B.ij.INPUT&&(n=n||t.debugMode,t.debugMode=!1)}),n&&this.onModelChanged()}validate(){setTimeout(()=>{this.isInvalid=!1,this.ruleChainModel.nodes.forEach(n=>{n.error&&(this.isInvalid=!0),this.updateNodeErrorTooltip(n)})},0)}saveRuleChain(){const n=new Vb.t;let t;return t=this.isImport?this.ruleChainService.saveRuleChain(this.ruleChain):(0,J.of)(this.ruleChain),t.subscribe(a=>{this.ruleChain=a;const o={ruleChainId:this.ruleChain.id,nodes:[],connections:[]},s=[];this.ruleChainModel.nodes.forEach(d=>{if(d.component.type!==B.ij.INPUT){const m={id:d.ruleNodeId,type:d.component.clazz,name:d.name,configurationVersion:(0,T.nu)(d.configurationVersion)?d.configurationVersion:d.component.configurationVersion,configuration:d.configuration,additionalInfo:d.additionalInfo?d.additionalInfo:{},debugMode:d.debugMode,singletonMode:d.singletonMode};m.additionalInfo.layoutX=Math.round(d.x),m.additionalInfo.layoutY=Math.round(d.y),o.nodes.push(m),s.push(d)}});const l=this.ruleChainModel.edges.find(d=>d.source===this.inputConnectorId+"");if(l){const d=this.ruleChainCanvas.modelService.nodes.getNodeByConnectorId(l.destination);o.firstNodeIndex=s.indexOf(d)}this.ruleChainModel.edges.forEach(d=>{const m=this.ruleChainCanvas.modelService.nodes.getNodeByConnectorId(d.source),y=this.ruleChainCanvas.modelService.nodes.getNodeByConnectorId(d.destination);if(m.component.type!==B.ij.INPUT){const L={fromIndex:s.indexOf(m),toIndex:s.indexOf(y)};d.labels.forEach(ae=>{const Nn=(0,T.I8)(L);Nn.type=ae,o.connections.push(Nn)})}}),this.ruleChainService.saveRuleChainMetadata(o).subscribe(d=>{this.ruleChainMetaData=d,this.isImport?(this.isDirtyValue=!1,this.isImport=!1,this.ruleChainType!==de.CI.EDGE?this.router.navigateByUrl(`ruleChains/${this.ruleChain.id.id}`):this.router.navigateByUrl(`edgeManagement/ruleChains/${this.ruleChain.id.id}`)):this.createRuleChainModel(),n.next()})}),n}reloadRuleChain(){this.ruleChainService.getRuleChain(this.ruleChain.id.id).subscribe(n=>{this.ruleChain=n,this.updateBreadcrumbs.emit(),this.ruleChainService.getRuleChainMetadata(this.ruleChain.id.id).subscribe(t=>{this.ruleChainMetaData=t,this.isDirtyValue=!1,this.createRuleChainModel()})})}revertRuleChain(){this.createRuleChainModel()}addRuleNode(n){n.configuration=(0,T.I8)(n.component.configurationDescriptor.nodeDefinition.defaultConfiguration);const t=this.ruleChain.id?this.ruleChain.id.id:null;this.enableHotKeys=!1;const a=this.ruleChainType;this.dialog.open(Zn,{disableClose:!0,panelClass:["tb-dialog","tb-fullscreen-dialog"],data:{ruleNode:n,ruleChainId:t,ruleChainType:a}}).afterClosed().subscribe(o=>{o&&(o.id="rule-chain-node-"+this.nextNodeID++,o.connectors=[],o.component.configurationDescriptor.nodeDefinition.inEnabled&&o.connectors.push({id:this.nextConnectorID+++"",type:K.Nt.leftConnectorType}),o.component.configurationDescriptor.nodeDefinition.outEnabled&&o.connectors.push({id:this.nextConnectorID+++"",type:K.Nt.rightConnectorType}),this.ruleChainModel.nodes.push(o),this.onModelChanged(),this.updateRuleNodesHighlight()),this.enableHotKeys=!0})}addRuleNodeLink(n,t,a,o){return this.dialog.open(Xn,{disableClose:!0,panelClass:["tb-dialog","tb-fullscreen-dialog"],data:{link:n,labels:t,allowCustomLabels:a,sourceRuleChainId:o}}).afterClosed()}toggleVersionControl(n,t){n&&n.stopPropagation();const a=t._elementRef.nativeElement;if(this.popoverService.hasPopover(a))this.popoverService.hidePopover(a);else{const o=this.popoverService.displayPopover(a,this.renderer,this.viewContainerRef,Ae.s,"leftTop",!0,null,{detailsMode:!0,active:!0,singleEntityMode:!0,externalEntityId:this.ruleChain.externalId||this.ruleChain.id,entityId:this.ruleChain.id,entityName:this.ruleChain.name,onBeforeCreateVersion:()=>this.isDirty?this.saveRuleChain():(0,J.of)(null)},{},{},{},!0);o.tbComponentRef.instance.popoverComponent=o,o.tbComponentRef.instance.versionRestored.subscribe(()=>{this.reloadRuleChain()})}}updateNodeErrorTooltip(n){if(n.error){const t=ba("#"+n.id);let a=this.errorTooltips[n.id];if(!a||!t.hasClass("tooltipstered")){t.tooltipster({theme:"tooltipster-shadow",delay:0,animationDuration:0,trigger:"custom",triggerOpen:{click:!1,tap:!1},triggerClose:{click:!1,tap:!1,scroll:!1},side:"top",trackOrigin:!0});const o='<div class="tb-rule-node-error-tooltip"><div id="tooltip-content"><div class="tb-node-details">'+n.error+"</div></div></div>",s=ba(o);a=t.tooltipster("instance"),a.isErrorTooltip=!0,a.content(s),this.errorTooltips[n.id]=a}setTimeout(()=>{a.open()},0)}else this.errorTooltips[n.id]&&(this.errorTooltips[n.id].destroy(),delete this.errorTooltips[n.id])}updateErrorTooltips(n){for(const t of Object.keys(this.errorTooltips)){const a=this.errorTooltips[t];n?a.close():a.open()}}displayTooltip(n,t){this.destroyTooltips(),this.tooltipTimeout=setTimeout(()=>{const a=ba(n.target);a.tooltipster({theme:"tooltipster-shadow",delay:100,trigger:"custom",triggerOpen:{click:!1,tap:!1},triggerClose:{click:!0,tap:!0,scroll:!0},side:"right",distance:12,trackOrigin:!0});const o=ba(t),s=a.tooltipster("instance");s.content(o),s.open()},500)}}Ge.\u0275fac=function(n){return new(n||Ge)(e.\u0275\u0275directiveInject(x.Store),e.\u0275\u0275directiveInject(b.ActivatedRoute),e.\u0275\u0275directiveInject(b.Router),e.\u0275\u0275directiveInject(zt.U),e.\u0275\u0275directiveInject(pi.e),e.\u0275\u0275directiveInject(g.TranslateService),e.\u0275\u0275directiveInject(mr.$),e.\u0275\u0275directiveInject(sy.t),e.\u0275\u0275directiveInject(e.Renderer2),e.\u0275\u0275directiveInject(e.ViewContainerRef),e.\u0275\u0275directiveInject(e.ChangeDetectorRef),e.\u0275\u0275directiveInject(C.MatDialog),e.\u0275\u0275directiveInject(pe.x),e.\u0275\u0275directiveInject(r.FormBuilder))},Ge.\u0275cmp=e.\u0275\u0275defineComponent({type:Ge,selectors:[["tb-rulechain-page"]],viewQuery:function(n,t){if(1&n&&(e.\u0275\u0275viewQuery(py,7),e.\u0275\u0275viewQuery(my,7),e.\u0275\u0275viewQuery(uy,5),e.\u0275\u0275viewQuery(hr,5),e.\u0275\u0275viewQuery(gy,5),e.\u0275\u0275viewQuery(fy,5,U.MatExpansionPanel)),2&n){let a;e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(t.ruleChainCanvas=a.first),e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(t.ruleChainMenuTrigger=a.first),e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(t.drawer=a.first),e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(t.ruleNodeComponent=a.first),e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(t.ruleNodeLinkComponent=a.first),e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(t.expansionPanels=a)}},hostVars:4,hostBindings:function(n,t){2&n&&e.\u0275\u0275styleProp("width",t.width)("height",t.height)},features:[e.\u0275\u0275InheritDefinitionFeature],decls:67,vars:71,consts:[["fxFlex","","tb-fullscreen","","tb-hotkeys","","fxLayout","column",1,"mat-content","tb-rulechain",3,"fullscreen","hotkeys","cheatSheet"],["cheatSheetComponent",""],["fxFlex","","fxLayout","column",1,"tb-rulechain-container"],["fxFlex","","fxLayout","row",1,"tb-rulechain-layout"],[2,"width","100%","height","100%"],["disableClose","true","mode","side","opened","","position","start","fxLayout","column",1,"tb-rulechain-library","mat-elevation-z4"],["drawer",""],["color","primary",1,"tb-dark"],["fxFlex","",3,"ruleChainType","disabled","ngModel","ngModelChange",4,"ngIf"],[1,"mat-toolbar-tools"],["fxFlex","",1,"tb-appearance-transparent"],["mat-icon-button","","matPrefix","","matTooltipPosition","above",1,"tb-small",3,"matTooltip"],["matInput","",3,"formControl","placeholder"],["mat-icon-button","","matSuffix","","matTooltipPosition","above",1,"tb-small",3,"fxShow","matTooltip","click"],[1,"tb-rulechain-library-panel-group"],["class","mat-elevation-z2",3,"expanded",4,"ngFor","ngForOf"],["mode","over","position","end",1,"tb-details-drawer",3,"opened","closed"],["fxFlex","",3,"headerTitle","headerSubtitle","isReadOnly","isAlwaysEdit","theForm","closeDetails","toggleDetailsEditMode","applyDetails",4,"ngIf"],[1,"tb-rulechain-graph-content"],["color","primary","mat-mini-fab","","matTooltipPosition","above",1,"tb-library-node-btn",3,"matTooltip","click"],[1,"tb-library-node-btn-icon",3,"ngClass"],["color","primary","type","button","mat-mini-fab","","class","version-control-button","matTooltipPosition","above",3,"matTooltip","click",4,"ngIf"],["type","button","mat-icon-button","","matTooltipPosition","above",1,"tb-fullscreen-button","tb-mat-40",3,"matTooltip","click"],[1,"tb-absolute-fill","tb-rulechain-graph",3,"contextmenu"],[2,"visibility","hidden","position","fixed",3,"matMenuTriggerFor"],["ruleChainMenuTrigger","matMenuTrigger"],[1,"tb-rule-chain-context-menu",3,"overlapTrigger"],["ruleChainMenu","matMenu"],["matMenuContent",""],["id","tb-rulchain-canvas","fitModelSizeByDefault","false",3,"model","selectedObjects","edgeStyle","automaticResize","nodeWidth","nodeHeight","dragAnimation","userCallbacks","modelChanged"],["ruleChainCanvas",""],["fxLayout","row","fxLayoutAlign","start end",1,"layout-wrap","tb-footer-buttons"],["mat-fab","","color","accent","matTooltipPosition","above",1,"tb-btn-footer",3,"disabled","ngClass","matTooltip","click"],["mat-fab","","color","accent","matTooltipPosition","above",1,"tb-btn-footer",3,"disabled","matTooltip","click"],["fxFlex","",3,"ruleChainType","disabled","ngModel","ngModelChange"],[1,"mat-elevation-z2",3,"expanded"],["ruleNodeTypeExpansionPanels",""],["expandedHeight","48px",3,"mouseenter","mouseleave"],["translate","",1,"tb-panel-title"],["fitModelSizeByDefault","",3,"id","model","selectedObjects","automaticResize","userCallbacks","nodeWidth","nodeHeight","dropTargetId"],["fxFlex","",3,"headerTitle","headerSubtitle","isReadOnly","isAlwaysEdit","theForm","closeDetails","toggleDetailsEditMode","applyDetails"],[1,"details-buttons"],[3,"tb-help"],["fxFlex","","mat-stretch-tabs","false",1,"tb-absolute-fill","tb-rulenode-details",3,"selectedIndex","selectedIndexChange"],[3,"label"],[3,"ruleNode","ruleChainId","ruleChainType","initRuleNode","changeScript"],["tbRuleNode",""],[3,"label",4,"ngIf"],[1,"tb-rule-node-help"],["id","tb-node-content","fxLayout","column",1,"mat-padding"],[1,"tb-node-title"],[1,"tb-node-description"],[1,"tb-node-details",3,"innerHtml"],["eventsTab","matTab"],[3,"debugEventTypes","defaultEventType","active","tenantId","entityId","functionTestButtonLabel","debugEventSelected"],["fxFlex","",3,"ngModel","allowedLabels","allowCustom","sourceRuleChainId","ngModelChange"],["tbRuleNodeLink",""],["color","primary","type","button","mat-mini-fab","","matTooltipPosition","above",1,"version-control-button",3,"matTooltip","click"],["versionControlButton",""],[1,"tb-rule-chain-context-menu-container",3,"mouseleave"],[4,"ngIf"],[3,"src",4,"ngIf"],["fxFlex",""],[1,"tb-context-menu-title"],[1,"tb-context-menu-subtitle"],[4,"ngFor","ngForOf"],[3,"src"],["mat-menu-item","",3,"disabled","click",4,"ngIf"],["mat-menu-item","",3,"disabled","click"],["class","tb-alt-text",4,"ngIf"],["translate",""],[1,"tb-alt-text"]],template:function(n,t){if(1&n){const a=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",0),e.\u0275\u0275element(1,"tb-hotkeys-cheatsheet",null,1),e.\u0275\u0275elementStart(3,"section",2)(4,"div",3)(5,"mat-drawer-container",4)(6,"mat-drawer",5,6)(8,"mat-toolbar",7),e.\u0275\u0275template(9,hy,1,3,"tb-rule-chain-select",8),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(10,"mat-toolbar")(11,"div",9)(12,"mat-form-field",10)(13,"button",11),e.\u0275\u0275pipe(14,"translate"),e.\u0275\u0275elementStart(15,"mat-icon"),e.\u0275\u0275text(16,"search"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275element(17,"input",12),e.\u0275\u0275pipe(18,"translate"),e.\u0275\u0275elementStart(19,"button",13),e.\u0275\u0275listener("click",function(){return t.ruleNodeTypeSearch.reset()}),e.\u0275\u0275pipe(20,"translate"),e.\u0275\u0275elementStart(21,"mat-icon"),e.\u0275\u0275text(22,"close"),e.\u0275\u0275elementEnd()()()()(),e.\u0275\u0275elementStart(23,"div",14),e.\u0275\u0275template(24,by,9,11,"mat-expansion-panel",15),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(25,"mat-drawer",16),e.\u0275\u0275listener("closed",function(){return t.onDetailsDrawerClosed()}),e.\u0275\u0275template(26,_y,23,22,"tb-details-panel",17),e.\u0275\u0275template(27,xy,6,12,"tb-details-panel",17),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(28,"mat-drawer-content",18)(29,"button",19),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(a);const s=e.\u0275\u0275reference(7);return e.\u0275\u0275resetView(s.toggle())}),e.\u0275\u0275pipe(30,"translate"),e.\u0275\u0275elementStart(31,"mat-icon",20),e.\u0275\u0275text(32,"chevron_right"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(33,Cy,5,3,"button",21),e.\u0275\u0275elementStart(34,"button",22),e.\u0275\u0275listener("click",function(){return t.isFullscreen=!t.isFullscreen}),e.\u0275\u0275pipe(35,"translate"),e.\u0275\u0275elementStart(36,"mat-icon"),e.\u0275\u0275text(37),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(38,"div",23),e.\u0275\u0275listener("contextmenu",function(s){return t.openRuleChainContextMenu(s)}),e.\u0275\u0275element(39,"div",24,25),e.\u0275\u0275elementStart(41,"mat-menu",26,27),e.\u0275\u0275template(43,Ay,10,8,"ng-template",28),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(44,"fc-canvas",29,30),e.\u0275\u0275listener("modelChanged",function(){return t.onModelChanged()}),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(46,"section",31)(47,"button",32),e.\u0275\u0275listener("click",function(){return t.deleteSelected()}),e.\u0275\u0275pipe(48,"async"),e.\u0275\u0275pipe(49,"translate"),e.\u0275\u0275elementStart(50,"mat-icon"),e.\u0275\u0275text(51,"delete"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(52,"button",33),e.\u0275\u0275listener("click",function(){return t.resetDebugModeInAllNodes()}),e.\u0275\u0275pipe(53,"async"),e.\u0275\u0275pipe(54,"translate"),e.\u0275\u0275elementStart(55,"mat-icon"),e.\u0275\u0275text(56,"bug_report"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(57,"button",33),e.\u0275\u0275listener("click",function(){return t.saveRuleChain()}),e.\u0275\u0275pipe(58,"async"),e.\u0275\u0275pipe(59,"translate"),e.\u0275\u0275elementStart(60,"mat-icon"),e.\u0275\u0275text(61,"done"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(62,"button",33),e.\u0275\u0275listener("click",function(){return t.revertRuleChain()}),e.\u0275\u0275pipe(63,"async"),e.\u0275\u0275pipe(64,"translate"),e.\u0275\u0275elementStart(65,"mat-icon"),e.\u0275\u0275text(66,"close"),e.\u0275\u0275elementEnd()()()()()()()()}if(2&n){const a=e.\u0275\u0275reference(2),o=e.\u0275\u0275reference(7),s=e.\u0275\u0275reference(42);e.\u0275\u0275property("fullscreen",t.isFullscreen)("hotkeys",t.hotKeys)("cheatSheet",a),e.\u0275\u0275advance(9),e.\u0275\u0275property("ngIf",!t.isImport),e.\u0275\u0275advance(4),e.\u0275\u0275propertyInterpolate("matTooltip",e.\u0275\u0275pipeBind1(14,41,"rulenode.search")),e.\u0275\u0275advance(4),e.\u0275\u0275propertyInterpolate("placeholder",e.\u0275\u0275pipeBind1(18,43,"rulenode.search")),e.\u0275\u0275property("formControl",t.ruleNodeTypeSearch),e.\u0275\u0275advance(2),e.\u0275\u0275propertyInterpolate("matTooltip",e.\u0275\u0275pipeBind1(20,45,"action.clear-search")),e.\u0275\u0275property("fxShow",""!==t.ruleNodeTypeSearch.value),e.\u0275\u0275advance(5),e.\u0275\u0275property("ngForOf",t.ruleNodeTypesLibraryArray),e.\u0275\u0275advance(1),e.\u0275\u0275property("opened",t.isEditingRuleNode||t.isEditingRuleNodeLink),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.editingRuleNode),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.editingRuleNodeLink),e.\u0275\u0275advance(2),e.\u0275\u0275propertyInterpolate("matTooltip",e.\u0275\u0275pipeBind1(30,47,o.opened?"rulenode.close-node-library":"rulenode.open-node-library")),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction1(67,Ny,o.opened)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!t.isImport),e.\u0275\u0275advance(1),e.\u0275\u0275propertyInterpolate("matTooltip",e.\u0275\u0275pipeBind1(35,49,t.isFullscreen?"fullscreen.exit":"fullscreen.expand")),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(t.isFullscreen?"fullscreen_exit":"fullscreen"),e.\u0275\u0275advance(2),e.\u0275\u0275styleProp("left",t.ruleChainMenuPosition.x)("top",t.ruleChainMenuPosition.y),e.\u0275\u0275property("matMenuTriggerFor",s),e.\u0275\u0275advance(2),e.\u0275\u0275property("overlapTrigger",!0),e.\u0275\u0275advance(3),e.\u0275\u0275property("model",t.ruleChainModel)("selectedObjects",t.selectedObjects)("edgeStyle",t.flowchartConstants.curvedStyle)("automaticResize",!0)("nodeWidth",170)("nodeHeight",50)("dragAnimation",t.flowchartConstants.dragAnimationRepaint)("userCallbacks",t.editCallbacks),e.\u0275\u0275advance(3),e.\u0275\u0275propertyInterpolate("matTooltip",e.\u0275\u0275pipeBind1(49,53,"rulenode.delete-selected-objects")),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(48,51,t.isLoading$))("ngClass",e.\u0275\u0275pureFunction1(69,Fy,!t.objectsSelected())),e.\u0275\u0275advance(5),e.\u0275\u0275propertyInterpolate("matTooltip",e.\u0275\u0275pipeBind1(54,57,"rulenode.reset-debug-mode")),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(53,55,t.isLoading$)||!t.isDebugModeEnabled()),e.\u0275\u0275advance(5),e.\u0275\u0275propertyInterpolate("matTooltip",e.\u0275\u0275pipeBind1(59,61,"action.apply-changes")),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(58,59,t.isLoading$)||t.isInvalid||!t.isDirtyValue&&!t.isImport),e.\u0275\u0275advance(5),e.\u0275\u0275propertyInterpolate("matTooltip",e.\u0275\u0275pipeBind1(64,65,"action.decline-changes")),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(63,63,t.isLoading$)||!t.isDirtyValue)}},dependencies:[p.NgClass,p.NgForOf,p.NgIf,Po.FullscreenDirective,ko.TbHotkeysDirective,De.HelpComponent,Oo.TbCheatSheetComponent,S.MatIconButton,S.MatMiniFabButton,S.MatFabButton,F.MatIcon,O.MatInput,_.MatFormField,_.MatPrefix,_.MatSuffix,xo.MatDrawer,xo.MatDrawerContainer,xo.MatDrawerContent,oe.MatToolbar,Oe.MatMenu,Oe.MatMenuItem,Oe.MatMenuContent,Oe.MatMenuTrigger,Ln.MatTooltip,kn.MatDivider,H.MatTab,H.MatTabGroup,U.MatExpansionPanel,U.MatExpansionPanelHeader,U.MatExpansionPanelTitle,h.DefaultLayoutDirective,h.DefaultLayoutAlignDirective,h.DefaultFlexDirective,G.DefaultShowHideDirective,G.DefaultClassDirective,r.DefaultValueAccessor,r.NgControlStatus,r.NgModel,r.FormControlDirective,me.cy,K.aL,g.TranslateDirective,ly.RuleChainSelectComponent,dy.DetailsPanelComponent,wt.EventTableComponent,Ze,Kt,p.AsyncPipe,cy.KeyboardShortcutPipe,g.TranslatePipe],styles:['@charset "UTF-8";.tb-rulechain{width:100%;height:100%}.tb-rulechain .mat-mdc-tab-group.tb-rulenode-details>.mat-mdc-tab-body-wrapper{position:absolute;inset:49px 0 0}.tb-rulechain .mat-mdc-tab-group.tb-rulenode-details>.mat-mdc-tab-header .mat-mdc-tab{min-width:40px}.tb-rulechain button.mdc-icon-button.tb-fullscreen-button{position:absolute;top:10px;right:10px;opacity:.85;margin:0 6px;z-index:2}.tb-rulechain button.mdc-fab.version-control-button{position:absolute;top:10px;right:60px;opacity:.85;margin:0 6px;z-index:2}.tb-rulechain .tb-library-node-btn{width:20px;height:90px;position:absolute;top:50%;z-index:1000;opacity:.5;border-radius:0 15px 15px 0!important;transform:translateY(-50%)}.tb-rulechain .tb-library-node-btn-icon{transition:transform .4s!important}.tb-rulechain .tb-library-node-btn-icon-toggled{transform:rotate(180deg)}.tb-rulechain .tb-library-node-btn:before{width:20px;height:30px;top:-28px;left:0;content:"";pointer-events:none;border-radius:0 0 0 15px;box-shadow:-10px 0 #305680;border:none}.tb-rulechain .tb-library-node-btn:after{position:absolute;width:20px;height:30px;bottom:-28px;left:0;content:"";pointer-events:none;border-top-left-radius:15px;box-shadow:-10px 0 #305680;border:none}.tb-rulechain .tb-rulechain-library{z-index:1;width:250px;min-width:250px}.tb-rulechain .tb-rulechain-library .mat-toolbar{height:min-content;padding:0}.tb-rulechain .tb-rulechain-library .mat-toolbar .mat-toolbar-tools{height:48px;padding:0 6px;font-size:14px}.tb-rulechain .tb-rulechain-library .mat-toolbar .mat-toolbar-tools .mat-mdc-icon-button{margin:0}.tb-rulechain .tb-rulechain-library .mat-toolbar .mat-toolbar-tools .mat-mdc-icon-button.tb-small{width:32px;height:32px;min-height:32px;padding:6px;line-height:20px}.tb-rulechain .tb-rulechain-library .mat-toolbar .mat-toolbar-tools .mat-mdc-icon-button.tb-small .mat-icon{width:20px;min-width:20px;height:20px;min-height:20px;font-size:20px;line-height:20px}.tb-rulechain .tb-rulechain-library .tb-rulechain-library-panel-group{overflow-x:hidden;overflow-y:auto}.tb-rulechain .tb-rulechain-library .tb-rulechain-library-panel-group .mat-expansion-panel{border-radius:0}.tb-rulechain .tb-rulechain-library .tb-rulechain-library-panel-group .mat-expansion-panel:last-child{margin-bottom:5px}.tb-rulechain .tb-rulechain-library .tb-rulechain-library-panel-group .mat-expansion-panel .mat-expansion-panel-header .mat-expansion-panel-header-title{line-height:48px;height:48px;overflow:hidden}.tb-rulechain .tb-rulechain-library .tb-rulechain-library-panel-group .mat-expansion-panel .mat-expansion-panel-header .mat-expansion-panel-header-title .mat-icon{min-width:24px;margin:auto 8px auto 0}.tb-rulechain .tb-rulechain-library .tb-rulechain-library-panel-group .mat-expansion-panel .mat-expansion-panel-header .mat-expansion-panel-header-title .tb-panel-title{min-width:130px;-webkit-user-select:none;user-select:none}.tb-rulechain .tb-rulechain-library .tb-rulechain-library-panel-group .mat-expansion-panel.mat-expanded .mat-expansion-panel-header{border-bottom:1px solid;border-color:#909090}.tb-rulechain .tb-rulechain-library .tb-rulechain-library-panel-group .mat-expansion-panel-body{padding:0}.tb-rulechain .mat-drawer-content.tb-rulechain-graph-content{overflow:hidden;z-index:0}.tb-rulechain .mat-drawer-content.tb-rulechain-graph-content .tb-rulechain-graph{z-index:0;overflow:auto}.tb-rulechain .fc-canvas .fc-node{border-radius:8px}.tb-rulechain .fc-canvas .fc-node.fc-selected{z-index:2}.tb-rulechain .fc-canvas .fc-node.fc-selected:not(.fc-edit){margin:-3px;border:solid 3px #f00}.tb-rulechain .fc-canvas .fc-edit .fc-nodeedit,.tb-rulechain .fc-canvas .fc-edit .fc-nodedelete{box-sizing:content-box;border:solid 2px #fff;background:#f83e05;outline:none}.tb-rulechain .fc-canvas .fc-nodeopen{display:block;position:absolute;top:11px;right:10px;border:1px solid #FFFFFF;border-radius:4px;line-height:18px;height:22px;width:22px;background:#886CB1;color:#fff;text-align:center;cursor:pointer;box-sizing:border-box}.tb-rulechain .fc-canvas .fc-nodeopen .mat-icon{width:16px;min-width:16px;height:16px;min-height:16px;font-size:16px}.tb-rulechain .fc-canvas .fc-nodeopen:hover{background-color:#4e2d7e}.tb-rulechain .fc-canvas .fc-arrow-marker polygon{fill:gray;stroke:gray}.tb-rulechain .fc-canvas .fc-arrow-marker-selected polygon{fill:red;stroke:red}.tb-rulechain .fc-canvas .fc-edge{outline:none;stroke:gray}.tb-rulechain .fc-canvas .fc-edge.fc-selected{stroke:red}.tb-rulechain .fc-canvas .fc-edge.fc-hover{stroke:gray}.tb-rulechain .fc-canvas .edge-endpoint{fill:gray}.tb-rulechain .fc-canvas .fc-edge-label{opacity:1!important}.tb-rulechain .fc-canvas .fc-edge-label:focus{outline:0}.tb-rulechain .fc-canvas .fc-edge-label.fc-selected .fc-edge-label-text span{color:#fff!important;background-color:red!important;border:solid #f00!important}.tb-rulechain .fc-canvas .fc-edge-label .fc-edge-label-text{font-size:14px!important;font-weight:600!important}.tb-rulechain .fc-canvas .fc-edge-label .fc-edge-label-text span{background-color:#fff!important;color:#003a79!important;border:solid 2px #003a79!important}.tb-rule-node-tooltip{color:#333}.tb-rule-node-tooltip{max-width:300px;font-size:14px}.tb-rule-node-tooltip.tb-lib-tooltip{width:300px}.tb-rule-node-help{font-size:16px}.tb-rule-node-error-tooltip{font-size:16px;color:#ea0d0d}.tb-rule-node-tooltip #tb-node-content .tb-node-title,.tb-rule-node-error-tooltip #tb-node-content .tb-node-title,.tb-rule-node-help #tb-node-content .tb-node-title{font-weight:600}.tb-rule-node-tooltip #tb-node-content .tb-node-description,.tb-rule-node-error-tooltip #tb-node-content .tb-node-description,.tb-rule-node-help #tb-node-content .tb-node-description{font-style:italic}.tb-rule-node-tooltip #tb-node-content .tb-node-details,.tb-rule-node-error-tooltip #tb-node-content .tb-node-details,.tb-rule-node-help #tb-node-content .tb-node-details{padding-top:10px;padding-bottom:10px}.tb-rule-node-tooltip #tb-node-content code,.tb-rule-node-error-tooltip #tb-node-content code,.tb-rule-node-help #tb-node-content code{padding:0 3px 2px;margin:1px;font-size:12px;color:#ad1625;white-space:nowrap;border:1px solid #e1e1e8;border-radius:2px}.tb-rule-chain-context-menu.mat-mdc-menu-panel.mdc-menu-surface{min-width:320px;max-height:404px;border-radius:8px;margin-left:-20px}.tb-rule-chain-context-menu.mat-mdc-menu-panel.mdc-menu-surface.mat-menu-below{margin-top:-60px}.tb-rule-chain-context-menu.mat-mdc-menu-panel.mdc-menu-surface .mat-mdc-menu-content{padding:0;display:flex;flex-direction:column}.tb-rule-chain-context-menu.mat-mdc-menu-panel.mdc-menu-surface .mat-mdc-menu-content .tb-rule-chain-context-menu-container{pointer-events:auto;padding:0 0 8px;display:flex;flex-direction:column;overflow-y:auto}.tb-rule-chain-context-menu.mat-mdc-menu-panel.mdc-menu-surface .tb-context-menu-header{display:flex;box-sizing:content-box;flex-direction:row;height:36px;min-height:36px;padding:8px 5px 5px;font-size:14px}.tb-rule-chain-context-menu.mat-mdc-menu-panel.mdc-menu-surface .tb-context-menu-header.tb-filter-type{background-color:#f1e861}.tb-rule-chain-context-menu.mat-mdc-menu-panel.mdc-menu-surface .tb-context-menu-header.tb-enrichment-type{background-color:#cdf14e}.tb-rule-chain-context-menu.mat-mdc-menu-panel.mdc-menu-surface .tb-context-menu-header.tb-transformation-type{background-color:#79cef1}.tb-rule-chain-context-menu.mat-mdc-menu-panel.mdc-menu-surface .tb-context-menu-header.tb-action-type{background-color:#f1928f}.tb-rule-chain-context-menu.mat-mdc-menu-panel.mdc-menu-surface .tb-context-menu-header.tb-external-type{background-color:#fbc766}.tb-rule-chain-context-menu.mat-mdc-menu-panel.mdc-menu-surface .tb-context-menu-header.tb-flow-type{background-color:#d6c4f1}.tb-rule-chain-context-menu.mat-mdc-menu-panel.mdc-menu-surface .tb-context-menu-header.tb-unknown-type{background-color:#f16c29}.tb-rule-chain-context-menu.mat-mdc-menu-panel.mdc-menu-surface .tb-context-menu-header.tb-rulechain-header,.tb-rule-chain-context-menu.mat-mdc-menu-panel.mdc-menu-surface .tb-context-menu-header.tb-link-header{background-color:#aac7e4}.tb-rule-chain-context-menu.mat-mdc-menu-panel.mdc-menu-surface .tb-context-menu-header .mat-icon{margin:auto 10px auto 2px}.tb-rule-chain-context-menu.mat-mdc-menu-panel.mdc-menu-surface .tb-context-menu-header .tb-context-menu-title{font-weight:500;line-height:normal}.tb-rule-chain-context-menu.mat-mdc-menu-panel.mdc-menu-surface .tb-context-menu-header .tb-context-menu-subtitle{font-size:12px;line-height:normal}\n'],encapsulation:2});class Xn extends le.a{constructor(n,t,a,o,s,l){super(n,t,s),this.store=n,this.router=t,this.data=a,this.errorStateMatcher=o,this.dialogRef=s,this.fb=l,this.submitted=!1,this.link=this.data.link,this.labels=this.data.labels,this.allowCustomLabels=this.data.allowCustomLabels,this.sourceRuleChainId=this.data.sourceRuleChainId,this.ruleNodeLinkFormGroup=this.fb.group({link:[(0,T.I8)(this.link),[r.Validators.required]]})}ngOnInit(){}isErrorState(n,t){const a=this.errorStateMatcher.isErrorState(n,t),o=!!(n&&n.invalid&&this.submitted);return a||o}cancel(){this.dialogRef.close(null)}add(){this.submitted=!0;const n=this.ruleNodeLinkFormGroup.get("link").value;this.link={...this.link,...n},this.dialogRef.close(this.link)}}Xn.\u0275fac=function(n){return new(n||Xn)(e.\u0275\u0275directiveInject(x.Store),e.\u0275\u0275directiveInject(b.Router),e.\u0275\u0275directiveInject(C.MAT_DIALOG_DATA),e.\u0275\u0275directiveInject(X.ErrorStateMatcher,4),e.\u0275\u0275directiveInject(C.MatDialogRef),e.\u0275\u0275directiveInject(r.UntypedFormBuilder))},Xn.\u0275cmp=e.\u0275\u0275defineComponent({type:Xn,selectors:[["tb-add-rule-node-link-dialog"]],features:[e.\u0275\u0275ProvidersFeature([{provide:X.ErrorStateMatcher,useExisting:Xn}]),e.\u0275\u0275InheritDefinitionFeature],decls:24,vars:23,consts:[[2,"width","480px",3,"formGroup","ngSubmit"],["color","primary"],["translate",""],["fxFlex",""],[3,"tb-help"],["mat-icon-button","","type","button",3,"click"],[1,"material-icons"],["color","warn","mode","indeterminate",4,"ngIf"],["mat-dialog-content",""],[3,"disabled"],["required","","formControlName","link",3,"allowedLabels","allowCustom","sourceRuleChainId"],["mat-dialog-actions","","fxLayoutAlign","end center"],["mat-button","","color","primary","type","button","cdkFocusInitial","",3,"disabled","click"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],["color","warn","mode","indeterminate"]],template:function(n,t){1&n&&(e.\u0275\u0275elementStart(0,"form",0),e.\u0275\u0275listener("ngSubmit",function(){return t.add()}),e.\u0275\u0275elementStart(1,"mat-toolbar",1)(2,"h2",2),e.\u0275\u0275text(3,"rulenode.add-link"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(4,"span",3)(5,"div",4),e.\u0275\u0275elementStart(6,"button",5),e.\u0275\u0275listener("click",function(){return t.cancel()}),e.\u0275\u0275elementStart(7,"mat-icon",6),e.\u0275\u0275text(8,"close"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275template(9,Ly,1,0,"mat-progress-bar",7),e.\u0275\u0275pipe(10,"async"),e.\u0275\u0275elementStart(11,"div",8)(12,"fieldset",9),e.\u0275\u0275pipe(13,"async"),e.\u0275\u0275element(14,"tb-rule-node-link",10),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(15,"div",11)(16,"button",12),e.\u0275\u0275listener("click",function(){return t.cancel()}),e.\u0275\u0275pipe(17,"async"),e.\u0275\u0275text(18),e.\u0275\u0275pipe(19,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(20,"button",13),e.\u0275\u0275pipe(21,"async"),e.\u0275\u0275text(22),e.\u0275\u0275pipe(23,"translate"),e.\u0275\u0275elementEnd()()()),2&n&&(e.\u0275\u0275property("formGroup",t.ruleNodeLinkFormGroup),e.\u0275\u0275advance(5),e.\u0275\u0275property("tb-help","ruleEngine"),e.\u0275\u0275advance(4),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(10,11,t.isLoading$)),e.\u0275\u0275advance(3),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(13,13,t.isLoading$)),e.\u0275\u0275advance(2),e.\u0275\u0275property("allowedLabels",t.labels)("allowCustom",t.allowCustomLabels)("sourceRuleChainId",t.sourceRuleChainId),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(17,15,t.isLoading$)),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(19,17,"action.cancel")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(21,19,t.isLoading$)||t.ruleNodeLinkFormGroup.invalid||!t.ruleNodeLinkFormGroup.dirty),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(23,21,"action.add")," "))},dependencies:[p.NgIf,De.HelpComponent,S.MatButton,S.MatIconButton,F.MatIcon,z.MatProgressBar,oe.MatToolbar,C.MatDialogContent,C.MatDialogActions,h.DefaultLayoutAlignDirective,h.DefaultFlexDirective,r.\u0275NgNoValidate,r.NgControlStatus,r.NgControlStatusGroup,r.RequiredValidator,r.FormGroupDirective,r.FormControlName,g.TranslateDirective,Kt,p.AsyncPipe,g.TranslatePipe],styles:['@charset "UTF-8";[_nghost-%COMP%]     tb-rule-node-link form{overflow:hidden!important}']});class Zn extends le.a{constructor(n,t,a,o,s){super(n,t,s),this.store=n,this.router=t,this.data=a,this.errorStateMatcher=o,this.dialogRef=s,this.submitted=!1,this.ruleNode=this.data.ruleNode,this.ruleChainId=this.data.ruleChainId,this.ruleChainType=this.data.ruleChainType}ngOnInit(){}isErrorState(n,t){const a=this.errorStateMatcher.isErrorState(n,t),o=!!(n&&n.invalid&&this.submitted);return a||o}helpLinkIdForRuleNodeType(){return(0,B.OP)(this.ruleNode.component)}cancel(){this.dialogRef.close(null)}add(){this.submitted=!0,this.ruleNodeDetailsComponent.validate(),this.ruleNodeDetailsComponent.ruleNodeFormGroup.valid&&this.dialogRef.close(this.ruleNode)}}Zn.\u0275fac=function(n){return new(n||Zn)(e.\u0275\u0275directiveInject(x.Store),e.\u0275\u0275directiveInject(b.Router),e.\u0275\u0275directiveInject(C.MAT_DIALOG_DATA),e.\u0275\u0275directiveInject(X.ErrorStateMatcher,4),e.\u0275\u0275directiveInject(C.MatDialogRef))},Zn.\u0275cmp=e.\u0275\u0275defineComponent({type:Zn,selectors:[["tb-add-rule-node-dialog"]],viewQuery:function(n,t){if(1&n&&e.\u0275\u0275viewQuery(hr,7),2&n){let a;e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(t.ruleNodeDetailsComponent=a.first)}},features:[e.\u0275\u0275ProvidersFeature([{provide:X.ErrorStateMatcher,useExisting:Zn}]),e.\u0275\u0275InheritDefinitionFeature],decls:24,vars:20,consts:[[1,"dialog-container",3,"ngSubmit"],["color","primary"],["translate",""],["fxFlex",""],[3,"tb-help"],["mat-icon-button","","type","button",3,"click"],[1,"material-icons"],["color","warn","mode","indeterminate",4,"ngIf"],["mat-dialog-content",""],["isAdd","",3,"ruleNode","ruleChainId","ruleChainType"],["tbRuleNode",""],["mat-dialog-actions","","fxLayoutAlign","end center"],["mat-button","","color","primary","type","button","cdkFocusInitial","",3,"disabled","click"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],["color","warn","mode","indeterminate"]],template:function(n,t){if(1&n&&(e.\u0275\u0275elementStart(0,"form",0),e.\u0275\u0275listener("ngSubmit",function(){return t.add()}),e.\u0275\u0275elementStart(1,"mat-toolbar",1)(2,"h2",2),e.\u0275\u0275text(3,"rulenode.add"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"span",3),e.\u0275\u0275text(5),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(6,"div",4),e.\u0275\u0275elementStart(7,"button",5),e.\u0275\u0275listener("click",function(){return t.cancel()}),e.\u0275\u0275elementStart(8,"mat-icon",6),e.\u0275\u0275text(9,"close"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275template(10,Py,1,0,"mat-progress-bar",7),e.\u0275\u0275pipe(11,"async"),e.\u0275\u0275elementStart(12,"div",8),e.\u0275\u0275element(13,"tb-rule-node",9,10),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(15,"div",11)(16,"button",12),e.\u0275\u0275listener("click",function(){return t.cancel()}),e.\u0275\u0275pipe(17,"async"),e.\u0275\u0275text(18),e.\u0275\u0275pipe(19,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(20,"button",13),e.\u0275\u0275pipe(21,"async"),e.\u0275\u0275text(22),e.\u0275\u0275pipe(23,"translate"),e.\u0275\u0275elementEnd()()()),2&n){const a=e.\u0275\u0275reference(14);e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate1(": ",t.ruleNode.component.name,""),e.\u0275\u0275advance(1),e.\u0275\u0275property("tb-help",t.helpLinkIdForRuleNodeType()),e.\u0275\u0275advance(4),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(11,10,t.isLoading$)),e.\u0275\u0275advance(3),e.\u0275\u0275property("ruleNode",t.ruleNode)("ruleChainId",t.ruleChainId)("ruleChainType",t.ruleChainType),e.\u0275\u0275advance(3),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(17,12,t.isLoading$)),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(19,14,"action.cancel")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(21,16,t.isLoading$)||a.ruleNodeFormGroup.invalid||!a.ruleNodeFormGroup.dirty),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(23,18,"action.add")," ")}},dependencies:[p.NgIf,De.HelpComponent,S.MatButton,S.MatIconButton,F.MatIcon,z.MatProgressBar,oe.MatToolbar,C.MatDialogContent,C.MatDialogActions,h.DefaultLayoutAlignDirective,h.DefaultFlexDirective,r.\u0275NgNoValidate,r.NgControlStatusGroup,r.NgForm,g.TranslateDirective,Ze,p.AsyncPipe,g.TranslatePipe],styles:['@charset "UTF-8";[_nghost-%COMP%]   .dialog-container[_ngcontent-%COMP%]{min-width:750px!important;max-width:750px!important}[_nghost-%COMP%]   .dialog-container[_ngcontent-%COMP%]   .mat-mdc-dialog-content[_ngcontent-%COMP%]{padding:8px}@media screen and (max-width: 959px){[_nghost-%COMP%]   .dialog-container[_ngcontent-%COMP%]{min-width:100%!important}}']});class ei extends le.a{constructor(n,t,a,o,s,l,d){super(n,t,d),this.store=n,this.router=t,this.data=a,this.errorStateMatcher=o,this.fb=s,this.ruleChainService=l,this.dialogRef=d,this.submitted=!1}ngOnInit(){this.createNestedRuleChainFormGroup=this.fb.group({name:["",[r.Validators.required,r.Validators.maxLength(255)]],additionalInfo:this.fb.group({description:[""]})})}isErrorState(n,t){const a=this.errorStateMatcher.isErrorState(n,t),o=!!(n&&n.invalid&&this.submitted);return a||o}cancel(){this.dialogRef.close(null)}add(){this.submitted=!0;const n={name:this.createNestedRuleChainFormGroup.get("name").value,debugMode:!1,type:this.data.ruleChainType,additionalInfo:{description:this.createNestedRuleChainFormGroup.get("additionalInfo").get("description").value}};this.ruleChainService.saveRuleChain(n).subscribe(t=>{this.dialogRef.close(t)})}}ei.\u0275fac=function(n){return new(n||ei)(e.\u0275\u0275directiveInject(x.Store),e.\u0275\u0275directiveInject(b.Router),e.\u0275\u0275directiveInject(C.MAT_DIALOG_DATA),e.\u0275\u0275directiveInject(X.ErrorStateMatcher,4),e.\u0275\u0275directiveInject(r.UntypedFormBuilder),e.\u0275\u0275directiveInject(zt.U),e.\u0275\u0275directiveInject(C.MatDialogRef))},ei.\u0275cmp=e.\u0275\u0275defineComponent({type:ei,selectors:[["tb-create-nested-rulechain-dialog"]],features:[e.\u0275\u0275ProvidersFeature([{provide:X.ErrorStateMatcher,useExisting:ei}]),e.\u0275\u0275InheritDefinitionFeature],decls:34,vars:21,consts:[[2,"min-width","650px",3,"ngSubmit"],["color","primary"],["translate",""],["fxFlex",""],["mat-icon-button","","type","button",3,"click"],[1,"material-icons"],["color","warn","mode","indeterminate",4,"ngIf"],["mat-dialog-content",""],[1,"mat-padding",3,"formGroup"],[3,"disabled"],["fxFlex","",1,"mat-block"],["matInput","","formControlName","name","required",""],[4,"ngIf"],["formGroupName","additionalInfo"],[1,"mat-block"],["matInput","","formControlName","description","rows","2"],["mat-dialog-actions","","fxLayoutAlign","end center"],["mat-button","","color","primary","type","button","cdkFocusInitial","",3,"disabled","click"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],["color","warn","mode","indeterminate"]],template:function(n,t){1&n&&(e.\u0275\u0275elementStart(0,"form",0),e.\u0275\u0275listener("ngSubmit",function(){return t.add()}),e.\u0275\u0275elementStart(1,"mat-toolbar",1)(2,"h2",2),e.\u0275\u0275text(3,"rulenode.create-nested-rulechain"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(4,"span",3),e.\u0275\u0275elementStart(5,"button",4),e.\u0275\u0275listener("click",function(){return t.cancel()}),e.\u0275\u0275elementStart(6,"mat-icon",5),e.\u0275\u0275text(7,"close"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275template(8,ky,1,0,"mat-progress-bar",6),e.\u0275\u0275pipe(9,"async"),e.\u0275\u0275elementStart(10,"div",7)(11,"form",8)(12,"fieldset",9),e.\u0275\u0275pipe(13,"async"),e.\u0275\u0275elementStart(14,"mat-form-field",10)(15,"mat-label",2),e.\u0275\u0275text(16,"rulechain.name"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(17,"input",11),e.\u0275\u0275template(18,Ry,3,3,"mat-error",12),e.\u0275\u0275template(19,Oy,3,3,"mat-error",12),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(20,"div",13)(21,"mat-form-field",14)(22,"mat-label",2),e.\u0275\u0275text(23,"rulechain.description"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(24,"textarea",15),e.\u0275\u0275elementEnd()()()()(),e.\u0275\u0275elementStart(25,"div",16)(26,"button",17),e.\u0275\u0275listener("click",function(){return t.cancel()}),e.\u0275\u0275pipe(27,"async"),e.\u0275\u0275text(28),e.\u0275\u0275pipe(29,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(30,"button",18),e.\u0275\u0275pipe(31,"async"),e.\u0275\u0275text(32),e.\u0275\u0275pipe(33,"translate"),e.\u0275\u0275elementEnd()()()),2&n&&(e.\u0275\u0275advance(8),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(9,9,t.isLoading$)),e.\u0275\u0275advance(3),e.\u0275\u0275property("formGroup",t.createNestedRuleChainFormGroup),e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(13,11,t.isLoading$)),e.\u0275\u0275advance(6),e.\u0275\u0275property("ngIf",t.createNestedRuleChainFormGroup.get("name").hasError("required")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.createNestedRuleChainFormGroup.get("name").hasError("maxlength")),e.\u0275\u0275advance(7),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(27,13,t.isLoading$)),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(29,15,"action.cancel")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(31,17,t.isLoading$)||t.createNestedRuleChainFormGroup.invalid||!t.createNestedRuleChainFormGroup.dirty),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(33,19,"action.create")," "))},dependencies:[p.NgIf,S.MatButton,S.MatIconButton,F.MatIcon,z.MatProgressBar,O.MatInput,_.MatFormField,_.MatLabel,_.MatError,oe.MatToolbar,C.MatDialogContent,C.MatDialogActions,h.DefaultLayoutAlignDirective,h.DefaultFlexDirective,r.\u0275NgNoValidate,r.DefaultValueAccessor,r.NgControlStatus,r.NgControlStatusGroup,r.RequiredValidator,r.NgForm,r.FormGroupDirective,r.FormControlName,r.FormGroupName,g.TranslateDirective,p.AsyncPipe,g.TranslatePipe],encapsulation:2});var By=c(26518),Vy=c(53543);class et{constructor(n){this.ruleChainService=n}resolve(n){const t=n.params.ruleChainId;return this.ruleChainService.getRuleChain(t)}}et.\u0275fac=function(n){return new(n||et)(e.\u0275\u0275inject(zt.U))},et.\u0275prov=e.\u0275\u0275defineInjectable({token:et,factory:et.\u0275fac});class tt{constructor(n){this.ruleChainService=n}resolve(n){const t=n.params.ruleChainId;return this.ruleChainService.getRuleChainMetadata(t)}}tt.\u0275fac=function(n){return new(n||tt)(e.\u0275\u0275inject(zt.U))},tt.\u0275prov=e.\u0275\u0275defineInjectable({token:tt,factory:tt.\u0275fac});class Fe{constructor(n,t){this.ruleChainService=n,this.modulesMap=t}resolve(n){return this.ruleChainService.getRuleNodeComponents(this.modulesMap,n.data.ruleChainType)}}Fe.\u0275fac=function(n){return new(n||Fe)(e.\u0275\u0275inject(zt.U),e.\u0275\u0275inject(Vy.MODULES_MAP,8))},Fe.\u0275prov=e.\u0275\u0275defineInjectable({token:Fe,factory:Fe.\u0275fac});class Le{constructor(){}resolve(n){return(0,Rb.D)(c.e(2631).then(c.t.bind(c,42631,23)))}}Le.\u0275fac=function(n){return new(n||Le)},Le.\u0275prov=e.\u0275\u0275defineInjectable({token:Le,factory:Le.\u0275fac});class Yt{constructor(n,t){this.itembuffer=n,this.router=t}canActivate(n,t){return!!this.itembuffer.hasRuleChainImport()||this.router.parseUrl("ruleChains")}}Yt.\u0275fac=function(n){return new(n||Yt)(e.\u0275\u0275inject(By.ItemBufferService),e.\u0275\u0275inject(b.Router))},Yt.\u0275prov=e.\u0275\u0275defineInjectable({token:Yt,factory:Yt.\u0275fac});const Co=(i,n,t)=>{let a=t.ruleChain.name;return t.ruleChain.root&&(a+=` (${n.instant("rulechain.root")})`),a},br=(i,n,t)=>`${n.instant("rulechain.import")}: ${t.ruleChain.name}`,Uy=[{path:"ruleChains",data:{breadcrumb:{label:"rulechain.rulechains",icon:"settings_ethernet"}},children:[{path:"",component:j.EntitiesTableComponent,data:{auth:[u.W.TENANT_ADMIN],title:"rulechain.rulechains",ruleChainsType:"tenant"},resolve:{entitiesTableConfig:Xe}},{path:":ruleChainId",component:Ge,canDeactivate:[N.P],data:{breadcrumb:{labelFunction:Co,icon:"settings_ethernet"},auth:[u.W.TENANT_ADMIN],title:"rulechain.rulechain",import:!1,ruleChainType:de.CI.CORE},resolve:{ruleChain:et,ruleChainMetaData:tt,ruleNodeComponents:Fe,tooltipster:Le}},{path:"ruleChain/import",component:Ge,canActivate:[Yt],canDeactivate:[N.P],data:{breadcrumb:{labelFunction:br,icon:"settings_ethernet"},auth:[u.W.TENANT_ADMIN],title:"rulechain.rulechain",import:!0,ruleChainType:de.CI.CORE},resolve:{ruleNodeComponents:Fe,tooltipster:Le}}]}];class Jt{}Jt.\u0275fac=function(n){return new(n||Jt)},Jt.\u0275mod=e.\u0275\u0275defineNgModule({type:Jt}),Jt.\u0275inj=e.\u0275\u0275defineInjector({providers:[Xe,et,tt,Fe,Le,Yt],imports:[b.RouterModule.forChild(Uy),b.RouterModule]}),(typeof ngJitMode>"u"||ngJitMode)&&e.\u0275\u0275setNgModuleScope(Jt,{imports:[b.RouterModule],exports:[b.RouterModule]});var yr=c(70970);function Gy(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-icon",10),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(t.node.icon)}}function jy(i,n){if(1&i&&e.\u0275\u0275element(0,"img",11),2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275property("src",t.iconUrl,e.\u0275\u0275sanitizeUrl)}}function Wy(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"span",12),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(t.node.name)}}function qy(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",13),e.\u0275\u0275element(1,"div",14),e.\u0275\u0275elementEnd()),2&i){const t=n.$implicit,a=e.\u0275\u0275nextContext();e.\u0275\u0275property("connector",t)("callbacks",a.callbacks),e.\u0275\u0275advance(1),e.\u0275\u0275property("connector",t)("nodeRectInfo",a.nodeRectInfo)("mouseOverConnector",a.mouseOverConnector)("callbacks",a.callbacks)("modelservice",a.modelservice)}}function $y(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",13),e.\u0275\u0275element(1,"div",14),e.\u0275\u0275elementEnd()),2&i){const t=n.$implicit,a=e.\u0275\u0275nextContext();e.\u0275\u0275property("connector",t)("callbacks",a.callbacks),e.\u0275\u0275advance(1),e.\u0275\u0275property("connector",t)("nodeRectInfo",a.nodeRectInfo)("mouseOverConnector",a.mouseOverConnector)("callbacks",a.callbacks)("modelservice",a.modelservice)}}function Hy(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"section")(1,"div",15),e.\u0275\u0275listener("click",function(o){e.\u0275\u0275restoreView(t);const s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.userNodeCallbacks.nodeEdit(o,s.node))}),e.\u0275\u0275element(2,"i",16),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"div",17),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.modelservice.nodes.delete(o.node))}),e.\u0275\u0275text(4," \xd7 "),e.\u0275\u0275elementEnd()()}}function zy(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"section")(1,"div",18),e.\u0275\u0275listener("click",function(o){e.\u0275\u0275restoreView(t);const s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.openRuleChain(o,s.node))})("mouseenter",function(o){e.\u0275\u0275restoreView(t);const s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.displayOpenRuleChainTooltip(o,s.node))}),e.\u0275\u0275element(2,"mat-icon",19),e.\u0275\u0275elementEnd()()}}const Ky=function(i,n){return{"tb-rule-node-highlighted":i,"tb-rule-node-invalid":n}};class ya extends K.eb{constructor(n,t,a){super(),this.sanitizer=n,this.translate=t,this.router=a,this.RuleNodeType=B.ij}ngOnInit(){super.ngOnInit(),this.node.iconUrl&&(this.iconUrl=this.sanitizer.bypassSecurityTrustResourceUrl(this.node.iconUrl))}openRuleChain(n,t){n&&n.stopPropagation(),t.configuration?.ruleChainId&&(t.ruleChainType===de.CI.EDGE?this.router.navigateByUrl(`/edgeManagement/ruleChains/${t.configuration?.ruleChainId}`):this.router.navigateByUrl(`/ruleChains/${t.configuration?.ruleChainId}`))}displayOpenRuleChainTooltip(n,t){n&&n.stopPropagation(),this.userNodeCallbacks.mouseLeave(n,t);const a='<div class="tb-rule-node-tooltip"><div id="tb-node-content"><div class="tb-node-description">'+this.translate.instant("rulechain.open-rulechain")+"</div></div></div>",o=yr(n.target);o.tooltipster({theme:"tooltipster-shadow",delay:100,trigger:"custom",triggerOpen:{click:!1,tap:!1},triggerClose:{click:!0,tap:!0,scroll:!0,mouseleave:!0},side:"top",distance:12,trackOrigin:!0});const s=o.tooltipster("instance"),l=yr(a);s.content(l),s.open()}}ya.\u0275fac=function(n){return new(n||ya)(e.\u0275\u0275directiveInject(jo.DomSanitizer),e.\u0275\u0275directiveInject(g.TranslateService),e.\u0275\u0275directiveInject(b.Router))},ya.\u0275cmp=e.\u0275\u0275defineComponent({type:ya,selectors:[["rule-node"]],features:[e.\u0275\u0275InheritDefinitionFeature],decls:15,vars:21,consts:[[3,"dblclick","mousedown","mouseenter","mouseleave"],[1,"fc-node-overlay"],[3,"ngClass"],["fxFlex","15",4,"ngIf"],["fxFlex","15",3,"src",4,"ngIf"],["fxLayout","column","fxFlex","85","fxLayoutAlign","center"],[1,"tb-node-type"],["class","tb-node-title",4,"ngIf"],["fc-magnet","",3,"connector","callbacks",4,"ngFor","ngForOf"],[4,"ngIf"],["fxFlex","15"],["fxFlex","15",3,"src"],[1,"tb-node-title"],["fc-magnet","",3,"connector","callbacks"],["fc-connector","",3,"connector","nodeRectInfo","mouseOverConnector","callbacks","modelservice"],[1,"fc-nodeedit",3,"click"],["aria-hidden","true",1,"fa","fa-pencil"],[1,"fc-nodedelete",3,"click"],[1,"fc-nodeopen",3,"click","mouseenter"],["svgIcon","mdi:login",1,"material-icons"]],template:function(n,t){1&n&&(e.\u0275\u0275elementStart(0,"div",0),e.\u0275\u0275listener("dblclick",function(o){return t.userNodeCallbacks.doubleClick(o,t.node)})("mousedown",function(o){return t.userNodeCallbacks.mouseDown(o,t.node)})("mouseenter",function(o){return t.userNodeCallbacks.mouseEnter(o,t.node)})("mouseleave",function(o){return t.userNodeCallbacks.mouseLeave(o,t.node)}),e.\u0275\u0275element(1,"div",1),e.\u0275\u0275elementStart(2,"div",2),e.\u0275\u0275template(3,Gy,2,1,"mat-icon",3),e.\u0275\u0275template(4,jy,1,1,"img",4),e.\u0275\u0275elementStart(5,"div",5)(6,"span",6),e.\u0275\u0275text(7),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(8,Wy,2,1,"span",7),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(9,"div"),e.\u0275\u0275template(10,qy,2,7,"div",8),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(11,"div"),e.\u0275\u0275template(12,$y,2,7,"div",8),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(13,Hy,5,0,"section",9),e.\u0275\u0275template(14,zy,3,0,"section",9),e.\u0275\u0275elementEnd()),2&n&&(e.\u0275\u0275advance(2),e.\u0275\u0275classMapInterpolate1("tb-rule-node ",t.node.nodeClass,""),e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction2(18,Ky,t.node.highlighted,t.node.error)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!t.iconUrl),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.iconUrl),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(t.node.component.name),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.node.name),e.\u0275\u0275advance(1),e.\u0275\u0275classMap(t.flowchartConstants.leftConnectorClass),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",t.modelservice.nodes.getConnectorsByType(t.node,t.flowchartConstants.leftConnectorType)),e.\u0275\u0275advance(1),e.\u0275\u0275classMap(t.flowchartConstants.rightConnectorClass),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",t.modelservice.nodes.getConnectorsByType(t.node,t.flowchartConstants.rightConnectorType)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.modelservice.isEditable()&&!t.node.readonly),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",(null==t.node.component||null==t.node.component.configurationDescriptor||null==t.node.component.configurationDescriptor.nodeDefinition?null:t.node.component.configurationDescriptor.nodeDefinition.ruleChainNode)&&t.modelservice.isEditable()))},dependencies:[p.NgClass,p.NgForOf,p.NgIf,F.MatIcon,h.DefaultLayoutDirective,h.DefaultLayoutAlignDirective,h.DefaultFlexDirective,G.DefaultClassDirective,K.vf,K.af],styles:['@charset "UTF-8";[_nghost-%COMP%]   .fc-node-overlay[_ngcontent-%COMP%]{position:absolute;pointer-events:none;inset:0;background-color:#000;border-radius:5px;opacity:0}[_nghost-%COMP%]   .fc-hover[_nghost-%COMP%]   .fc-node-overlay[_ngcontent-%COMP%], .fc-hover   [_nghost-%COMP%]   .fc-node-overlay[_ngcontent-%COMP%]{opacity:.25;transition:opacity .2s}[_nghost-%COMP%]   .fc-selected[_nghost-%COMP%]   .fc-node-overlay[_ngcontent-%COMP%], .fc-selected   [_nghost-%COMP%]   .fc-node-overlay[_ngcontent-%COMP%]{opacity:.25}[_nghost-%COMP%]   .fc-edit[_nghost-%COMP%]   .fc-nodeedit[_ngcontent-%COMP%], .fc-edit   [_nghost-%COMP%]   .fc-nodeedit[_ngcontent-%COMP%], [_nghost-%COMP%]   .fc-edit[_nghost-%COMP%]   .fc-nodedelete[_ngcontent-%COMP%], .fc-edit   [_nghost-%COMP%]   .fc-nodedelete[_ngcontent-%COMP%]{box-sizing:content-box;border:solid 2px #fff;background:#f83e05;outline:none}[_nghost-%COMP%]   .tb-rule-node[_ngcontent-%COMP%]{box-sizing:content-box;display:flex;flex-direction:row;min-width:150px;max-width:150px;height:32px;min-height:32px;max-height:32px;padding:5px 10px;font-size:12px;line-height:16px;color:#333;pointer-events:none;background-color:#f15b26;border:solid 1px #777;border-radius:5px}[_nghost-%COMP%]   .tb-rule-node.tb-filter-type[_ngcontent-%COMP%]{background-color:#f1e861}[_nghost-%COMP%]   .tb-rule-node.tb-enrichment-type[_ngcontent-%COMP%]{background-color:#cdf14e}[_nghost-%COMP%]   .tb-rule-node.tb-transformation-type[_ngcontent-%COMP%]{background-color:#79cef1}[_nghost-%COMP%]   .tb-rule-node.tb-action-type[_ngcontent-%COMP%]{background-color:#f1928f}[_nghost-%COMP%]   .tb-rule-node.tb-external-type[_ngcontent-%COMP%]{background-color:#fbc766}[_nghost-%COMP%]   .tb-rule-node.tb-flow-type[_ngcontent-%COMP%]{background-color:#d6c4f1}[_nghost-%COMP%]   .tb-rule-node.tb-unknown-type[_ngcontent-%COMP%]{background-color:#f16c29}[_nghost-%COMP%]   .tb-rule-node.tb-rule-node-highlighted[_ngcontent-%COMP%]:not(.tb-rule-node-invalid){box-shadow:0 0 10px 6px #51cbee}[_nghost-%COMP%]   .tb-rule-node.tb-rule-node-highlighted[_ngcontent-%COMP%]:not(.tb-rule-node-invalid)   .tb-node-title[_ngcontent-%COMP%]{font-weight:700;text-decoration:underline}[_nghost-%COMP%]   .tb-rule-node.tb-rule-node-invalid[_ngcontent-%COMP%]{box-shadow:0 0 10px 6px #ff5c50}[_nghost-%COMP%]   .tb-rule-node.tb-input-type[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none;background-color:#a3eaa9}[_nghost-%COMP%]   .tb-rule-node[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%], [_nghost-%COMP%]   .tb-rule-node[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{margin:auto;width:20px;min-width:20px;height:20px;min-height:20px;padding-right:4px;font-size:20px}[_nghost-%COMP%]   .tb-rule-node[_ngcontent-%COMP%]   .tb-node-title[_ngcontent-%COMP%]{font-weight:500}[_nghost-%COMP%]   .tb-rule-node[_ngcontent-%COMP%]   .tb-node-type[_ngcontent-%COMP%], [_nghost-%COMP%]   .tb-rule-node[_ngcontent-%COMP%]   .tb-node-title[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}[_nghost-%COMP%]   .tb-rule-node[_ngcontent-%COMP%]   .fc-leftConnectors[_ngcontent-%COMP%], [_nghost-%COMP%]   .tb-rule-node[_ngcontent-%COMP%]   .fc-rightConnectors[_ngcontent-%COMP%]{position:absolute;top:0;z-index:0;display:flex;flex-direction:column;height:100%}[_nghost-%COMP%]   .tb-rule-node[_ngcontent-%COMP%]   .fc-leftConnectors[_ngcontent-%COMP%]   .fc-magnet[_ngcontent-%COMP%], [_nghost-%COMP%]   .tb-rule-node[_ngcontent-%COMP%]   .fc-rightConnectors[_ngcontent-%COMP%]   .fc-magnet[_ngcontent-%COMP%]{align-items:center}[_nghost-%COMP%]   .tb-rule-node[_ngcontent-%COMP%]   .fc-leftConnectors[_ngcontent-%COMP%]{left:-20px}[_nghost-%COMP%]   .tb-rule-node[_ngcontent-%COMP%]   .fc-rightConnectors[_ngcontent-%COMP%]{right:-20px}[_nghost-%COMP%]   .tb-rule-node[_ngcontent-%COMP%]   .fc-magnet[_ngcontent-%COMP%]{display:flex;flex-grow:1;justify-content:center;height:60px}[_nghost-%COMP%]   .tb-rule-node[_ngcontent-%COMP%]   .fc-connector[_ngcontent-%COMP%]{width:14px;height:14px;margin:10px;pointer-events:all;background-color:#ccc;border:1px solid #333;border-radius:5px}[_nghost-%COMP%]   .tb-rule-node[_ngcontent-%COMP%]   .fc-connector.fc-hover[_ngcontent-%COMP%]{background-color:#000}']});class Qt{}Qt.\u0275fac=function(n){return new(n||Qt)},Qt.\u0275mod=e.\u0275\u0275defineNgModule({type:Qt}),Qt.\u0275inj=e.\u0275\u0275defineInjector({providers:[{provide:K.T4,useValue:{nodeComponentType:ya}}],imports:[p.CommonModule,M.m,k.W,Jt]}),(typeof ngJitMode>"u"||ngJitMode)&&e.\u0275\u0275setNgModuleScope(Qt,{declarations:[fa,ha,Ge,ya,Ze,Jn,Qn,Kt,Xn,Zn,ei],imports:[p.CommonModule,M.m,k.W,Jt]});class Xt{}Xt.\u0275fac=function(n){return new(n||Xt)},Xt.\u0275mod=e.\u0275\u0275defineNgModule({type:Xt}),Xt.\u0275inj=e.\u0275\u0275defineInjector({imports:[p.CommonModule,M.m,k.W,ht]}),(typeof ngJitMode>"u"||ngJitMode)&&e.\u0275\u0275setNgModuleScope(Xt,{declarations:[Fi,Ei,ft,Pi,Ni,Rn,Di,Li,Mi],imports:[p.CommonModule,M.m,k.W,ht]});var Yy=c(58137),Jy=c(28268),Qy=c(51695),Xy=c(30915);class Zt{}Zt.\u0275fac=function(n){return new(n||Zt)},Zt.\u0275mod=e.\u0275\u0275defineNgModule({type:Zt}),Zt.\u0275inj=e.\u0275\u0275defineInjector({imports:[p.CommonModule,M.m,k.W,Ee.J,sa.Ix]}),(typeof ngJitMode>"u"||ngJitMode)&&e.\u0275\u0275setNgModuleScope(Zt,{declarations:[Yy.h,Xy.M,Jy.j,Qy.a],imports:[p.CommonModule,M.m,k.W,Ee.J,sa.Ix]});var Zy=c(98624),ev=c(51689);function tv(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-tab",1,2),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275element(3,"tb-attribute-table",3),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275reference(1),a=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(2,5,"attribute.attributes")),e.\u0275\u0275advance(3),e.\u0275\u0275property("defaultAttributeScope",a.attributeScopes.SERVER_SCOPE)("active",t.isActive)("entityId",a.entity.id)("entityName",a.entity.name)}}function nv(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-tab",1,4),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275element(3,"tb-attribute-table",5),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275reference(1),a=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(2,5,"attribute.latest-telemetry")),e.\u0275\u0275advance(3),e.\u0275\u0275property("defaultAttributeScope",a.latestTelemetryTypes.LATEST_TELEMETRY)("active",t.isActive)("entityId",a.entity.id)("entityName",a.entity.name)}}function iv(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-tab",1,6),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275element(3,"tb-alarm-table",7),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275reference(1),a=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(2,3,"alarm.alarms")),e.\u0275\u0275advance(3),e.\u0275\u0275property("active",t.isActive)("entityId",a.entity.id)}}class va extends _e.l{constructor(n){super(n),this.store=n}ngOnInit(){super.ngOnInit()}}va.\u0275fac=function(n){return new(n||va)(e.\u0275\u0275directiveInject(x.Store))},va.\u0275cmp=e.\u0275\u0275defineComponent({type:va,selectors:[["tb-tenant-profile-tabs"]],features:[e.\u0275\u0275InheritDefinitionFeature],decls:3,vars:3,consts:[[3,"label",4,"ngIf"],[3,"label"],["attributesTab","matTab"],[3,"defaultAttributeScope","active","entityId","entityName"],["telemetryTab","matTab"],["disableAttributeScopeSelection","",3,"defaultAttributeScope","active","entityId","entityName"],["alarmsTab","matTab"],[3,"active","entityId"]],template:function(n,t){1&n&&(e.\u0275\u0275template(0,tv,4,7,"mat-tab",0),e.\u0275\u0275template(1,nv,4,7,"mat-tab",0),e.\u0275\u0275template(2,iv,4,5,"mat-tab",0)),2&n&&(e.\u0275\u0275property("ngIf",t.entity),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.entity),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.entity))},dependencies:[p.NgIf,H.MatTab,Ke.AlarmTableComponent,Ye.AttributeTableComponent,g.TranslatePipe],encapsulation:2});class en{constructor(n,t,a,o,s,l){this.tenantProfileService=n,this.importExport=t,this.translate=a,this.datePipe=o,this.router=s,this.dialogService=l,this.config=new v.ap,this.config.entityType=f.py.TENANT_PROFILE,this.config.entityComponent=ev.TenantProfileComponent,this.config.entityTabsComponent=va,this.config.entityTranslations=f.Jr.get(f.py.TENANT_PROFILE),this.config.entityResources=f.CZ.get(f.py.TENANT_PROFILE),this.config.columns.push(new v.eq("createdTime","common.created-time",this.datePipe,"150px"),new v.QI("name","tenant-profile.name","40%"),new v.QI("description","tenant-profile.description","60%"),new v.QI("isDefault","tenant-profile.default","60px",d=>(0,v.Gj)(d.default))),this.config.cellActionDescriptors.push({name:this.translate.instant("tenant-profile.export"),icon:"file_download",isEnabled:()=>!0,onAction:(d,m)=>this.exportTenantProfile(d,m)},{name:this.translate.instant("tenant-profile.set-default"),icon:"flag",isEnabled:d=>!d.default,onAction:(d,m)=>this.setDefaultTenantProfile(d,m)}),this.config.deleteEntityTitle=d=>this.translate.instant("tenant-profile.delete-tenant-profile-title",{tenantProfileName:d.name}),this.config.deleteEntityContent=()=>this.translate.instant("tenant-profile.delete-tenant-profile-text"),this.config.deleteEntitiesTitle=d=>this.translate.instant("tenant-profile.delete-tenant-profiles-title",{count:d}),this.config.deleteEntitiesContent=()=>this.translate.instant("tenant-profile.delete-tenant-profiles-text"),this.config.entitiesFetchFunction=d=>this.tenantProfileService.getTenantProfiles(d),this.config.loadEntity=d=>this.tenantProfileService.getTenantProfile(d.id),this.config.saveEntity=d=>this.tenantProfileService.saveTenantProfile(d),this.config.deleteEntity=d=>this.tenantProfileService.deleteTenantProfile(d.id),this.config.onEntityAction=d=>this.onTenantProfileAction(d),this.config.deleteEnabled=d=>d&&!d.default,this.config.entitySelectionEnabled=d=>d&&!d.default,this.config.addActionDescriptors=this.configureAddActions()}resolve(){return this.config.tableTitle=this.translate.instant("tenant-profile.tenant-profiles"),this.config}configureAddActions(){const n=[];return n.push({name:this.translate.instant("tenant-profile.create-tenant-profile"),icon:"insert_drive_file",isEnabled:()=>!0,onAction:t=>this.config.getTable().addEntity(t)},{name:this.translate.instant("tenant-profile.import"),icon:"file_upload",isEnabled:()=>!0,onAction:t=>this.importTenantProfile(t)}),n}openTenantProfile(n,t){n&&n.stopPropagation();const a=this.router.createUrlTree(["tenantProfiles",t.id.id]);this.router.navigateByUrl(a)}setDefaultTenantProfile(n,t){n&&n.stopPropagation(),this.dialogService.confirm(this.translate.instant("tenant-profile.set-default-tenant-profile-title",{tenantProfileName:t.name}),this.translate.instant("tenant-profile.set-default-tenant-profile-text"),this.translate.instant("action.no"),this.translate.instant("action.yes"),!0).subscribe(a=>{a&&this.tenantProfileService.setDefaultTenantProfile(t.id.id).subscribe(()=>{this.config.updateData()})})}importTenantProfile(n){this.importExport.importTenantProfile().subscribe(t=>{t&&this.config.updateData()})}exportTenantProfile(n,t){n&&n.stopPropagation(),this.importExport.exportTenantProfile(t.id.id)}onTenantProfileAction(n){switch(n.action){case"open":return this.openTenantProfile(n.event,n.entity),!0;case"setDefault":return this.setDefaultTenantProfile(n.event,n.entity),!0}return!1}}en.\u0275fac=function(n){return new(n||en)(e.\u0275\u0275inject(Zy.K),e.\u0275\u0275inject(ct.s),e.\u0275\u0275inject(g.TranslateService),e.\u0275\u0275inject(p.DatePipe),e.\u0275\u0275inject(b.Router),e.\u0275\u0275inject(pe.x))},en.\u0275prov=e.\u0275\u0275defineInjectable({token:en,factory:en.\u0275fac});const av=[{path:"tenantProfiles",data:{breadcrumb:{label:"tenant-profile.tenant-profiles",icon:"mdi:alpha-t-box"}},children:[{path:"",component:j.EntitiesTableComponent,data:{auth:[u.W.SYS_ADMIN],title:"tenant-profile.tenant-profiles"},resolve:{entitiesTableConfig:en}},{path:":entityId",component:ee.Y,canDeactivate:[N.P],data:{breadcrumb:{labelFunction:te,icon:"mdi:alpha-t-box"},auth:[u.W.SYS_ADMIN],title:"tenant-profile.tenant-profiles"},resolve:{entitiesTableConfig:en}}]}];class tn{}tn.\u0275fac=function(n){return new(n||tn)},tn.\u0275mod=e.\u0275\u0275defineNgModule({type:tn}),tn.\u0275inj=e.\u0275\u0275defineInjector({providers:[en],imports:[b.RouterModule.forChild(av),b.RouterModule]}),(typeof ngJitMode>"u"||ngJitMode)&&e.\u0275\u0275setNgModuleScope(tn,{imports:[b.RouterModule],exports:[b.RouterModule]});class nn{}nn.\u0275fac=function(n){return new(n||nn)},nn.\u0275mod=e.\u0275\u0275defineNgModule({type:nn}),nn.\u0275inj=e.\u0275\u0275defineInjector({imports:[p.CommonModule,M.m,k.W,tn]}),(typeof ngJitMode>"u"||ngJitMode)&&e.\u0275\u0275setNgModuleScope(nn,{declarations:[va],imports:[p.CommonModule,M.m,k.W,tn]});var ov=c(3197),rv=c(20366),sv=c(52941),lv=c(13678);function dv(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-option",12),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i){const t=n.$implicit,a=e.\u0275\u0275nextContext(3);e.\u0275\u0275property("value",t),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,2,a.deviceTransportTypeTranslations.get(t))," ")}}function cv(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-hint"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275nextContext(3);e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,t.deviceTransportTypeHints.get(t.detailsForm.get("transportType").value))," ")}}function pv(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"device-profile.transport-type-required")," "))}function mv(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",4)(1,"mat-form-field",5)(2,"mat-label",6),e.\u0275\u0275text(3,"device-profile.transport-type"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"mat-select",7),e.\u0275\u0275template(5,dv,3,4,"mat-option",8),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(6,cv,3,3,"mat-hint",9),e.\u0275\u0275template(7,pv,3,3,"mat-error",9),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(8,"div",10),e.\u0275\u0275element(9,"tb-device-profile-transport-configuration",11),e.\u0275\u0275elementEnd()()),2&i){const t=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("formGroup",t.detailsForm),e.\u0275\u0275advance(5),e.\u0275\u0275property("ngForOf",t.deviceTransportTypes),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.detailsForm.get("transportType").value),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.detailsForm.get("transportType").hasError("required")),e.\u0275\u0275advance(2),e.\u0275\u0275property("isAdd",t.isTransportTypeChanged)}}function uv(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-tab",1,2),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275template(3,mv,10,5,"div",3),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275reference(1);e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(2,2,"device-profile.transport-configuration")),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",t.isActive)}}function gv(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",4)(1,"div",10),e.\u0275\u0275element(2,"tb-device-profile-alarms",14),e.\u0275\u0275elementEnd()()),2&i){const t=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("formGroup",t.detailsForm),e.\u0275\u0275advance(2),e.\u0275\u0275property("deviceProfileId",t.entity.id)}}const fv=function(i){return{count:i}};function hv(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-tab",1,13),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275template(3,gv,3,2,"div",3),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275reference(1),a=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind2(2,2,"device-profile.alarm-rules-with-count",e.\u0275\u0275pureFunction1(5,fv,null!=a.detailsForm.get("profileData.alarms").value&&a.detailsForm.get("profileData.alarms").value.length?a.detailsForm.get("profileData.alarms").value.length:0))),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",t.isActive)}}function bv(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",4)(1,"div",10),e.\u0275\u0275element(2,"tb-device-profile-provision-configuration",16),e.\u0275\u0275elementEnd()()),2&i){const t=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("formGroup",t.detailsForm)}}function yv(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-tab",1,15),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275template(3,bv,3,1,"div",3),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275reference(1);e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(2,2,"device-profile.device-provisioning")),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",t.isActive)}}function vv(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-tab",1,17),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementStart(3,"div",4)(4,"div",10),e.\u0275\u0275element(5,"tb-device-profile-configuration",18),e.\u0275\u0275elementEnd()()()),2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(2,2,"device-profile.profile-configuration")),e.\u0275\u0275advance(3),e.\u0275\u0275property("formGroup",t.detailsForm)}}function _v(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-tab",1,19),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275element(3,"tb-audit-log-table",20),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275reference(1),a=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(2,4,"audit-log.audit-logs")),e.\u0275\u0275advance(3),e.\u0275\u0275property("active",t.isActive)("auditLogMode",a.auditLogModes.ENTITY)("entityId",a.entity.id)}}function xv(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"mat-tab",1,21),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementStart(3,"tb-version-control",22),e.\u0275\u0275listener("versionRestored",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.entitiesTableConfig.updateData())}),e.\u0275\u0275elementEnd()()}if(2&i){const t=e.\u0275\u0275reference(1),a=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(2,5,"version-control.version-control")),e.\u0275\u0275advance(3),e.\u0275\u0275property("active",t.isActive)("entityId",a.entity.id)("entityName",a.entity.name)("externalEntityId",a.entity.externalId||a.entity.id)}}class _a extends _e.l{constructor(n){super(n),this.store=n,this.deviceTransportTypes=Object.values(R.dH),this.deviceTransportTypeTranslations=R.GX,this.deviceTransportTypeHints=R.c2,this.isTransportTypeChanged=!1}ngOnInit(){super.ngOnInit(),this.detailsForm.get("transportType").valueChanges.subscribe(()=>{this.isTransportTypeChanged=!0})}}_a.\u0275fac=function(n){return new(n||_a)(e.\u0275\u0275directiveInject(x.Store))},_a.\u0275cmp=e.\u0275\u0275defineComponent({type:_a,selectors:[["tb-device-profile-tabs"]],features:[e.\u0275\u0275InheritDefinitionFeature],decls:6,vars:6,consts:[[3,"label",4,"ngIf"],[3,"label"],["transportType","matTab"],["class","mat-padding",3,"formGroup",4,"ngIf"],[1,"mat-padding",3,"formGroup"],[1,"mat-block"],["translate",""],["formControlName","transportType","required",""],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["formGroupName","profileData"],["formControlName","transportConfiguration","required","",3,"isAdd"],[3,"value"],["alarmRules","matTab"],["formControlName","alarms",3,"deviceProfileId"],["deviceProvisioning","matTab"],["formControlName","provisionConfiguration"],["deviceProfile","matTab"],["formControlName","configuration","required",""],["auditLogsTab","matTab"],["detailsMode","true",3,"active","auditLogMode","entityId"],["versionControlTab","matTab"],["detailsMode","true","singleEntityMode","true",3,"active","entityId","entityName","externalEntityId","versionRestored"]],template:function(n,t){1&n&&(e.\u0275\u0275template(0,uv,4,4,"mat-tab",0),e.\u0275\u0275template(1,hv,4,7,"mat-tab",0),e.\u0275\u0275template(2,yv,4,4,"mat-tab",0),e.\u0275\u0275template(3,vv,6,4,"mat-tab",0),e.\u0275\u0275template(4,_v,4,6,"mat-tab",0),e.\u0275\u0275template(5,xv,4,7,"mat-tab",0)),2&n&&(e.\u0275\u0275property("ngIf",t.entity),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.entity),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.entity),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!1),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.entity&&!t.isEdit),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.entity&&t.authUser.authority===t.authorities.TENANT_ADMIN&&!t.isEdit))},dependencies:[p.NgForOf,p.NgIf,_.MatFormField,_.MatLabel,_.MatHint,_.MatError,ye.MatSelect,X.MatOption,H.MatTab,r.NgControlStatus,r.NgControlStatusGroup,r.RequiredValidator,r.FormGroupDirective,r.FormControlName,r.FormGroupName,g.TranslateDirective,Be.AuditLogTableComponent,ov.DeviceProfileConfigurationComponent,rv.DeviceProfileTransportConfigurationComponent,sv.DeviceProfileAlarmsComponent,lv.DeviceProfileProvisionConfigurationComponent,Ae.s,g.TranslatePipe],encapsulation:2});var Cv=c(87539),Tv=c(90876);class an{constructor(n,t,a,o,s,l,d,m){this.deviceProfileService=n,this.importExport=t,this.homeDialogs=a,this.translate=o,this.datePipe=s,this.dialogService=l,this.router=d,this.dialog=m,this.config=new v.ap,this.config.entityType=f.py.DEVICE_PROFILE,this.config.entityComponent=Cv.DeviceProfileComponent,this.config.entityTabsComponent=_a,this.config.entityTranslations=f.Jr.get(f.py.DEVICE_PROFILE),this.config.entityResources=f.CZ.get(f.py.DEVICE_PROFILE),this.config.hideDetailsTabsOnEdit=!1,this.config.addDialogStyle={width:"1000px"},this.config.columns.push(new v.eq("createdTime","common.created-time",this.datePipe,"150px"),new v.QI("name","device-profile.name","20%"),new v.QI("type","device-profile.type","20%",y=>this.translate.instant(R.hB.get(y.type))),new v.QI("transportType","device-profile.transport-type","20%",y=>this.translate.instant(R.GX.get(y.transportType))),new v.QI("description","device-profile.description","40%"),new v.QI("isDefault","device-profile.default","60px",y=>(0,v.Gj)(y.default))),this.config.cellActionDescriptors.push({name:this.translate.instant("device-profile.export"),icon:"file_download",isEnabled:()=>!0,onAction:(y,I)=>this.exportDeviceProfile(y,I)},{name:this.translate.instant("device-profile.set-default"),icon:"flag",isEnabled:y=>!y.default,onAction:(y,I)=>this.setDefaultDeviceProfile(y,I)}),this.config.deleteEntityTitle=y=>this.translate.instant("device-profile.delete-device-profile-title",{deviceProfileName:y.name}),this.config.deleteEntityContent=()=>this.translate.instant("device-profile.delete-device-profile-text"),this.config.deleteEntitiesTitle=y=>this.translate.instant("device-profile.delete-device-profiles-title",{count:y}),this.config.deleteEntitiesContent=()=>this.translate.instant("device-profile.delete-device-profiles-text"),this.config.entitiesFetchFunction=y=>this.deviceProfileService.getDeviceProfiles(y),this.config.loadEntity=y=>this.deviceProfileService.getDeviceProfile(y.id),this.config.saveEntity=(y,I)=>this.deviceProfileService.saveDeviceProfileAndConfirmOtaChange(I,y),this.config.deleteEntity=y=>this.deviceProfileService.deleteDeviceProfile(y.id),this.config.onEntityAction=y=>this.onDeviceProfileAction(y),this.config.deleteEnabled=y=>y&&!y.default,this.config.entitySelectionEnabled=y=>y&&!y.default,this.config.addActionDescriptors=this.configureAddActions()}resolve(){return this.config.tableTitle=this.translate.instant("device-profile.device-profiles"),this.config}configureAddActions(){const n=[];return n.push({name:this.translate.instant("device-profile.create-device-profile"),icon:"insert_drive_file",isEnabled:()=>!0,onAction:()=>this.addDeviceProfile()},{name:this.translate.instant("device-profile.import"),icon:"file_upload",isEnabled:()=>!0,onAction:t=>this.importDeviceProfile(t)}),n}addDeviceProfile(){this.dialog.open(Tv.AddDeviceProfileDialogComponent,{disableClose:!0,panelClass:["tb-dialog","tb-fullscreen-dialog"],data:{deviceProfileName:null,transportType:null}}).afterClosed().subscribe(n=>{n&&this.config.updateData()})}setDefaultDeviceProfile(n,t){n&&n.stopPropagation(),this.dialogService.confirm(this.translate.instant("device-profile.set-default-device-profile-title",{deviceProfileName:t.name}),this.translate.instant("device-profile.set-default-device-profile-text"),this.translate.instant("action.no"),this.translate.instant("action.yes"),!0).subscribe(a=>{a&&this.deviceProfileService.setDefaultDeviceProfile(t.id.id).subscribe(()=>{this.config.updateData()})})}openDeviceProfile(n,t){n&&n.stopPropagation();const a=this.router.createUrlTree(["profiles","deviceProfiles",t.id.id]);this.router.navigateByUrl(a)}importDeviceProfile(n){this.importExport.importDeviceProfile().subscribe(t=>{t&&this.config.updateData()})}exportDeviceProfile(n,t){n&&n.stopPropagation(),this.importExport.exportDeviceProfile(t.id.id)}onDeviceProfileAction(n){switch(n.action){case"open":return this.openDeviceProfile(n.event,n.entity),!0;case"setDefault":return this.setDefaultDeviceProfile(n.event,n.entity),!0;case"export":return this.exportDeviceProfile(n.event,n.entity),!0}return!1}}an.\u0275fac=function(n){return new(n||an)(e.\u0275\u0275inject(tr.A),e.\u0275\u0275inject(ct.s),e.\u0275\u0275inject(lt.U),e.\u0275\u0275inject(g.TranslateService),e.\u0275\u0275inject(p.DatePipe),e.\u0275\u0275inject(pe.x),e.\u0275\u0275inject(b.Router),e.\u0275\u0275inject(C.MatDialog))},an.\u0275prov=e.\u0275\u0275defineInjectable({token:an,factory:an.\u0275fac});const Sv=[{path:"deviceProfiles",data:{breadcrumb:{label:"device-profile.device-profiles",icon:"mdi:alpha-d-box"}},children:[{path:"",component:j.EntitiesTableComponent,data:{auth:[u.W.TENANT_ADMIN],title:"device-profile.device-profiles"},resolve:{entitiesTableConfig:an}},{path:":entityId",component:ee.Y,canDeactivate:[N.P],data:{breadcrumb:{labelFunction:te,icon:"mdi:alpha-d-box"},auth:[u.W.TENANT_ADMIN],title:"device-profile.device-profiles"},resolve:{entitiesTableConfig:an}}]}];class ti{}ti.\u0275fac=function(n){return new(n||ti)},ti.\u0275mod=e.\u0275\u0275defineNgModule({type:ti}),ti.\u0275inj=e.\u0275\u0275defineInjector({providers:[an]});class on{}on.\u0275fac=function(n){return new(n||on)},on.\u0275mod=e.\u0275\u0275defineNgModule({type:on}),on.\u0275inj=e.\u0275\u0275defineInjector({imports:[p.CommonModule,M.m,k.W,ti]}),(typeof ngJitMode>"u"||ngJitMode)&&e.\u0275\u0275setNgModuleScope(on,{declarations:[_a],imports:[p.CommonModule,M.m,k.W,ti]});class xa extends se.I{constructor(n,t){super(n),this.store=n,this.route=t,this.apiUsageDashboard=this.route.snapshot.data.apiUsageDashboard}}xa.\u0275fac=function(n){return new(n||xa)(e.\u0275\u0275directiveInject(x.Store),e.\u0275\u0275directiveInject(b.ActivatedRoute))},xa.\u0275cmp=e.\u0275\u0275defineComponent({type:xa,selectors:[["tb-api-usage"]],features:[e.\u0275\u0275InheritDefinitionFeature],decls:1,vars:2,consts:[[3,"embedded","dashboard"]],template:function(n,t){1&n&&e.\u0275\u0275element(0,"tb-dashboard-page",0),2&n&&e.\u0275\u0275property("embedded",!0)("dashboard",t.apiUsageDashboard)},dependencies:[Ha.DashboardPageComponent],styles:['@charset "UTF-8";[_nghost-%COMP%]{width:100%;height:100%}']});const Ev=[{path:"usage",component:xa,data:{auth:[u.W.TENANT_ADMIN],title:"api-usage.api-usage",breadcrumb:{label:"api-usage.api-usage",icon:"insert_chart"}},resolve:{apiUsageDashboard:(i,n,t=(0,e.inject)(Ko.z))=>t.loadJsonResource("/assets/dashboard/api_usage.json")}}];class rn{}rn.\u0275fac=function(n){return new(n||rn)},rn.\u0275mod=e.\u0275\u0275defineNgModule({type:rn}),rn.\u0275inj=e.\u0275\u0275defineInjector({imports:[b.RouterModule.forChild(Ev),b.RouterModule]}),(typeof ngJitMode>"u"||ngJitMode)&&e.\u0275\u0275setNgModuleScope(rn,{imports:[b.RouterModule],exports:[b.RouterModule]});class sn{}sn.\u0275fac=function(n){return new(n||sn)},sn.\u0275mod=e.\u0275\u0275defineNgModule({type:sn}),sn.\u0275inj=e.\u0275\u0275defineInjector({imports:[p.CommonModule,M.m,k.W,rn]}),(typeof ngJitMode>"u"||ngJitMode)&&e.\u0275\u0275setNgModuleScope(sn,{declarations:[xa],imports:[p.CommonModule,M.m,k.W,rn]});const Mv=[{path:"edgeManagement",data:{breadcrumb:{label:"edge.management",icon:"settings_input_antenna"}},children:[{path:"",children:[],data:{auth:[u.W.TENANT_ADMIN,u.W.CUSTOMER_USER],redirectTo:"/edgeManagement/instances"}},{path:"instances",data:{breadcrumb:{label:"edge.instances",icon:"router"}},children:[{path:"",component:j.EntitiesTableComponent,data:{auth:[u.W.TENANT_ADMIN,u.W.CUSTOMER_USER],title:"edge.edge-instances",edgesType:"tenant"},resolve:{entitiesTableConfig:Ve}},{path:":entityId",component:ee.Y,canDeactivate:[N.P],data:{breadcrumb:{labelFunction:te,icon:"router"},auth:[u.W.TENANT_ADMIN,u.W.CUSTOMER_USER],title:"edge.edge-instances",edgesType:"tenant"},resolve:{entitiesTableConfig:Ve}},{path:":edgeId/assets",data:{breadcrumb:{label:"edge.assets",icon:"domain"}},children:[{path:"",component:j.EntitiesTableComponent,data:{auth:[u.W.TENANT_ADMIN,u.W.CUSTOMER_USER],title:"edge.assets",assetsType:"edge"},resolve:{entitiesTableConfig:we}},{path:":entityId",component:ee.Y,canDeactivate:[N.P],data:{breadcrumb:{labelFunction:te,icon:"domain"},auth:[u.W.TENANT_ADMIN,u.W.CUSTOMER_USER],title:"edge.assets",assetsType:"edge"},resolve:{entitiesTableConfig:we}}]},{path:":edgeId/devices",data:{breadcrumb:{label:"edge.devices",icon:"devices_other"}},children:[{path:"",component:j.EntitiesTableComponent,data:{auth:[u.W.TENANT_ADMIN,u.W.CUSTOMER_USER],title:"edge.devices",devicesType:"edge"},resolve:{entitiesTableConfig:Ie}},{path:":entityId",component:ee.Y,canDeactivate:[N.P],data:{breadcrumb:{labelFunction:te,icon:"devices_other"},auth:[u.W.TENANT_ADMIN,u.W.CUSTOMER_USER],title:"edge.devices",devicesType:"edge"},resolve:{entitiesTableConfig:Ie}}]},{path:":edgeId/entityViews",data:{breadcrumb:{label:"edge.entity-views",icon:"view_quilt"}},children:[{path:"",component:j.EntitiesTableComponent,data:{auth:[u.W.TENANT_ADMIN,u.W.CUSTOMER_USER],title:"edge.entity-views",entityViewsType:"edge"},resolve:{entitiesTableConfig:Ue}},{path:":entityId",component:ee.Y,canDeactivate:[N.P],data:{breadcrumb:{labelFunction:te,icon:"devices_other"},auth:[u.W.TENANT_ADMIN,u.W.CUSTOMER_USER],title:"edge.entity-views",entityViewsType:"edge"},resolve:{entitiesTableConfig:Ue}}]},{path:":edgeId/dashboards",data:{breadcrumb:{label:"edge.dashboards",icon:"dashboard"}},children:[{path:"",component:j.EntitiesTableComponent,data:{auth:[u.W.TENANT_ADMIN,u.W.CUSTOMER_USER],dashboardsType:"edge"},resolve:{entitiesTableConfig:rr.C}},{path:":dashboardId",component:Ha.DashboardPageComponent,canDeactivate:[N.P],data:{breadcrumb:{labelFunction:sa.it,icon:"dashboard"},auth:[u.W.TENANT_ADMIN,u.W.CUSTOMER_USER],title:"edge.dashboard",widgetEditMode:!1},resolve:{dashboard:sa.tA}}]},{path:":edgeId/ruleChains",data:{breadcrumb:{label:"edge.rulechains",icon:"settings_ethernet"}},children:[{path:"",component:j.EntitiesTableComponent,data:{auth:[u.W.TENANT_ADMIN],title:"edge.rulechains",ruleChainsType:"edge"},resolve:{entitiesTableConfig:Xe}},{path:":ruleChainId",component:Ge,canDeactivate:[N.P],data:{breadcrumb:{labelFunction:Co,icon:"settings_ethernet"},auth:[u.W.TENANT_ADMIN],title:"rulechain.edge-rulechain",import:!1,ruleChainType:de.CI.EDGE},resolve:{ruleChain:et,ruleChainMetaData:tt,ruleNodeComponents:Fe,tooltipster:Le}}]}]},{path:"ruleChains",data:{breadcrumb:{label:"edge.rulechain-templates",icon:"settings_ethernet"}},children:[{path:"",component:j.EntitiesTableComponent,data:{auth:[u.W.TENANT_ADMIN],title:"edge.rulechain-templates",ruleChainsType:"edges"},resolve:{entitiesTableConfig:Xe}},{path:":ruleChainId",component:Ge,canDeactivate:[N.P],data:{breadcrumb:{labelFunction:Co,icon:"settings_ethernet"},auth:[u.W.TENANT_ADMIN],title:"rulechain.edge-rulechain",import:!1,ruleChainType:de.CI.EDGE},resolve:{ruleChain:et,ruleChainMetaData:tt,ruleNodeComponents:Fe,tooltipster:Le}},{path:"ruleChain/import",component:Ge,canActivate:[Yt],canDeactivate:[N.P],data:{breadcrumb:{labelFunction:br,icon:"settings_ethernet"},auth:[u.W.TENANT_ADMIN],title:"rulechain.edge-rulechain",import:!0,ruleChainType:de.CI.EDGE},resolve:{ruleNodeComponents:Fe,tooltipster:Le}}]}]},{path:"edgeInstances",pathMatch:"full",redirectTo:"/edgeManagement/instances"},{path:"edgeInstances/:entityId",pathMatch:"full",redirectTo:"/edgeManagement/instances/:entityId"},{path:"edgeInstances/:edgeId/assets",pathMatch:"full",redirectTo:"/edgeManagement/instances/:edgeId/assets"},{path:"edgeInstances/:edgeId/assets/:entityId",redirectTo:"/edgeManagement/instances/:edgeId/assets/:entityId"},{path:"edgeInstances/:edgeId/devices",pathMatch:"full",redirectTo:"/edgeManagement/instances/:edgeId/devices"},{path:"edgeInstances/:edgeId/devices/:entityId",redirectTo:"/edgeManagement/instances/:edgeId/devices/:entityId"},{path:"edgeInstances/:edgeId/entityViews",pathMatch:"full",redirectTo:"/edgeManagement/instances/:edgeId/entityViews"},{path:"edgeInstances/:edgeId/entityViews/:entityId",redirectTo:"/edgeManagement/instances/:edgeId/entityViews/:entityId"},{path:"edgeInstances/:edgeId/dashboards",pathMatch:"full",redirectTo:"/edgeManagement/instances/:edgeId/dashboards"},{path:"edgeInstances/:edgeId/dashboards/:dashboardId",redirectTo:"/edgeManagement/instances/:edgeId/dashboards/:dashboardId"},{path:"edgeInstances/:edgeId/ruleChains",pathMatch:"full",redirectTo:"/edgeManagement/instances/:edgeId/ruleChains"},{path:"edgeInstances/:edgeId/ruleChains/:ruleChainId",redirectTo:"/edgeManagement/instances/:edgeId/ruleChains/:ruleChainId"}];class ln{}ln.\u0275fac=function(n){return new(n||ln)},ln.\u0275mod=e.\u0275\u0275defineNgModule({type:ln}),ln.\u0275inj=e.\u0275\u0275defineInjector({providers:[Ve],imports:[b.RouterModule.forChild(Mv),b.RouterModule]}),(typeof ngJitMode>"u"||ngJitMode)&&e.\u0275\u0275setNgModuleScope(ln,{imports:[b.RouterModule],exports:[b.RouterModule]});class dn{}dn.\u0275fac=function(n){return new(n||dn)},dn.\u0275mod=e.\u0275\u0275defineNgModule({type:dn}),dn.\u0275inj=e.\u0275\u0275defineInjector({imports:[p.CommonModule,M.m,Ee.J,k.W,ln]}),(typeof ngJitMode>"u"||ngJitMode)&&e.\u0275\u0275setNgModuleScope(dn,{declarations:[la,da,ca,pa],imports:[p.CommonModule,M.m,Ee.J,k.W,ln]});var Dv=c(63841),Av=c(53426),vr=c(18727);function Nv(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"ota-update.title-required")," "))}function Fv(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"ota-update.title-max-length")," "))}function Lv(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"ota-update.version-required")," "))}function Pv(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"ota-update.version-max-length")," "))}function kv(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-hint",5),e.\u0275\u0275text(1,"ota-update.version-tag-hint"),e.\u0275\u0275elementEnd())}function Rv(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-option",25),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i){const t=n.$implicit,a=e.\u0275\u0275nextContext();e.\u0275\u0275property("value",t),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,2,a.otaUpdateTypeTranslationMap.get(t))," ")}}function Ov(i,n){1&i&&(e.\u0275\u0275elementStart(0,"section")(1,"div",26),e.\u0275\u0275text(2,"ota-update.warning-after-save-no-edit"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"mat-radio-group",27)(4,"mat-radio-button",25),e.\u0275\u0275text(5),e.\u0275\u0275pipe(6,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(7,"mat-radio-button",25),e.\u0275\u0275text(8),e.\u0275\u0275pipe(9,"translate"),e.\u0275\u0275elementEnd()()()),2&i&&(e.\u0275\u0275advance(4),e.\u0275\u0275property("value",!1),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(6,4,"ota-update.upload-binary-file")),e.\u0275\u0275advance(2),e.\u0275\u0275property("value",!0),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(9,6,"ota-update.use-external-url")))}function Bv(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"section"),e.\u0275\u0275element(1,"tb-file-input",29),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275pipe(3,"translate"),e.\u0275\u0275elementStart(4,"mat-checkbox",30),e.\u0275\u0275text(5),e.\u0275\u0275pipe(6,"translate"),e.\u0275\u0275elementEnd()()),2&i){const t=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(2,4,"ota-update.package-file")),e.\u0275\u0275propertyInterpolate("dropLabel",e.\u0275\u0275pipeBind1(3,6,"ota-update.drop-package-file-or")),e.\u0275\u0275property("required",!t.entityForm.get("isURL").value),e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(6,8,"ota-update.auto-generate-checksum")," ")}}function Vv(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-option",25),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&i){const t=n.$implicit,a=e.\u0275\u0275nextContext(3);e.\u0275\u0275property("value",t),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",a.checksumAlgorithmTranslationMap.get(t)," ")}}function Uv(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-hint",5),e.\u0275\u0275text(1,"ota-update.checksum-hint"),e.\u0275\u0275elementEnd())}function Gv(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",31)(1,"mat-form-field",32)(2,"mat-label",5),e.\u0275\u0275text(3,"ota-update.checksum-algorithm"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"mat-select",33),e.\u0275\u0275template(5,Vv,2,2,"mat-option",21),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(6,"mat-form-field",13)(7,"mat-label",5),e.\u0275\u0275text(8,"ota-update.checksum"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(9,"input",34),e.\u0275\u0275template(10,Uv,2,0,"mat-hint",17),e.\u0275\u0275elementEnd()()),2&i){const t=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(5),e.\u0275\u0275property("ngForOf",t.checksumAlgorithms),e.\u0275\u0275advance(5),e.\u0275\u0275property("ngIf",t.isAdd)}}function jv(i,n){1&i&&(e.\u0275\u0275elementStart(0,"section")(1,"div",35)(2,"mat-form-field",32)(3,"mat-label",5),e.\u0275\u0275text(4,"ota-update.file-name"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(5,"input",36),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(6,"mat-form-field",13)(7,"mat-label",5),e.\u0275\u0275text(8,"ota-update.file-size-bytes"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(9,"input",37),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(10,"mat-form-field",13)(11,"mat-label",5),e.\u0275\u0275text(12,"ota-update.content-type"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(13,"input",38),e.\u0275\u0275elementEnd()()())}function Wv(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"section"),e.\u0275\u0275template(1,Bv,7,10,"section",12),e.\u0275\u0275template(2,Gv,11,2,"div",28),e.\u0275\u0275template(3,jv,14,0,"section",12),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.isAdd),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!(t.isAdd&&t.entityForm.get("generateChecksum").value)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!t.isAdd)}}function qv(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error",5),e.\u0275\u0275text(1," ota-update.direct-url-required "),e.\u0275\u0275elementEnd())}function $v(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"section",39)(1,"mat-form-field",19)(2,"mat-label",5),e.\u0275\u0275text(3,"ota-update.direct-url"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(4,"input",40),e.\u0275\u0275template(5,qv,2,0,"mat-error",17),e.\u0275\u0275elementEnd()()),2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(4),e.\u0275\u0275property("required",t.entityForm.get("isURL").value),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.entityForm.get("url").hasError("required")||t.entityForm.get("url").hasError("pattern"))}}const Hv=function(i){return{"padding-bottom":i}};class Ca extends Te.r{constructor(n,t,a,o,s,l){super(n,s,a,o,l),this.store=n,this.translate=t,this.entityValue=a,this.entitiesTableConfigValue=o,this.fb=s,this.cd=l,this.destroy$=new be.x,this.checksumAlgorithms=Object.values(Je.Es),this.checksumAlgorithmTranslationMap=Je.j4,this.packageTypes=Object.values(Je.Jj),this.otaUpdateTypeTranslationMap=Je.ot}ngOnInit(){super.ngOnInit(),this.isAdd&&(this.entityForm.get("isURL").valueChanges.pipe((0,Y.R)(this.destroy$)).subscribe(n=>{!1===n?(this.entityForm.get("url").clearValidators(),this.entityForm.get("file").setValidators(r.Validators.required),this.entityForm.get("url").updateValueAndValidity({emitEvent:!1}),this.entityForm.get("file").updateValueAndValidity({emitEvent:!1})):(this.entityForm.get("file").clearValidators(),this.entityForm.get("url").setValidators([r.Validators.required,r.Validators.pattern("(.|\\s)*\\S(.|\\s)*")]),this.entityForm.get("file").updateValueAndValidity({emitEvent:!1}),this.entityForm.get("url").updateValueAndValidity({emitEvent:!1}))}),(0,Av.a)([this.entityForm.get("title").valueChanges.pipe((0,La.O)("")),this.entityForm.get("version").valueChanges.pipe((0,La.O)(""))]).pipe((0,Mo.h)(()=>this.entityForm.get("tag").pristine),(0,Y.R)(this.destroy$)).subscribe(([n,t])=>{const a=`${n} ${t}`.trim();this.entityForm.get("tag").patchValue(a)}))}ngOnDestroy(){super.ngOnDestroy(),this.destroy$.next(),this.destroy$.complete()}hideDelete(){return!!this.entitiesTableConfig&&!this.entitiesTableConfig.deleteEnabled(this.entity)}buildForm(n){const t=this.fb.group({title:[n?n.title:"",[r.Validators.required,r.Validators.maxLength(255)]],version:[n?n.version:"",[r.Validators.required,r.Validators.maxLength(255)]],tag:[n?n.tag:"",[r.Validators.maxLength(255)]],type:[n?.type?n.type:Je.Jj.FIRMWARE,r.Validators.required],deviceProfileId:[n?n.deviceProfileId:null,r.Validators.required],checksumAlgorithm:[n&&n.checksumAlgorithm?n.checksumAlgorithm:Je.Es.SHA256],checksum:[n?n.checksum:"",r.Validators.maxLength(1020)],url:[n?n.url:""],isURL:[!1],additionalInfo:this.fb.group({description:[n&&n.additionalInfo?n.additionalInfo.description:""]})});return this.isAdd?(t.addControl("file",this.fb.control(null,r.Validators.required)),t.addControl("generateChecksum",this.fb.control(!0))):(t.addControl("fileName",this.fb.control(null)),t.addControl("dataSize",this.fb.control(null)),t.addControl("contentType",this.fb.control(null))),t}updateForm(n){this.entityForm.patchValue({title:n.title,version:n.version,tag:n.tag,type:n.type,deviceProfileId:n.deviceProfileId,checksumAlgorithm:n.checksumAlgorithm,checksum:n.checksum,fileName:n.fileName,dataSize:n.dataSize,contentType:n.contentType,url:n.url,isURL:(0,T.XE)(n.url),additionalInfo:{description:n.additionalInfo?n.additionalInfo.description:""}}),!this.isAdd&&this.entityForm.enabled&&(this.entityForm.disable({emitEvent:!1}),this.entityForm.get("additionalInfo").enable({emitEvent:!1}))}onPackageIdCopied(){this.store.dispatch(new V.zi({message:this.translate.instant("ota-update.idCopiedMessage"),type:"success",duration:750,verticalPosition:"bottom",horizontalPosition:"right"}))}onPackageChecksumCopied(){this.store.dispatch(new V.zi({message:this.translate.instant("ota-update.checksum-copied-message"),type:"success",duration:750,verticalPosition:"bottom",horizontalPosition:"right"}))}onPackageDirectUrlCopied(){this.store.dispatch(new V.zi({message:this.translate.instant("ota-update.checksum-copied-message"),type:"success",duration:750,verticalPosition:"bottom",horizontalPosition:"right"}))}prepareFormValue(n){return n.isURL?delete n.file:delete n.url,delete n.generateChecksum,super.prepareFormValue(n)}}Ca.\u0275fac=function(n){return new(n||Ca)(e.\u0275\u0275directiveInject(x.Store),e.\u0275\u0275directiveInject(g.TranslateService),e.\u0275\u0275directiveInject("entity"),e.\u0275\u0275directiveInject("entitiesTableConfig"),e.\u0275\u0275directiveInject(r.UntypedFormBuilder),e.\u0275\u0275directiveInject(e.ChangeDetectorRef))},Ca.\u0275cmp=e.\u0275\u0275defineComponent({type:Ca,selectors:[["tb-ota-update"]],features:[e.\u0275\u0275InheritDefinitionFeature],decls:62,vars:50,consts:[["fxLayout.xs","column",1,"tb-details-buttons"],["mat-raised-button","","color","primary","fxFlex.xs","",3,"disabled","fxShow","click"],["fxLayout","row","fxLayout.xs","column"],["mat-raised-button","","ngxClipboard","",3,"cbContent","fxShow","cbOnSuccess"],["svgIcon","mdi:clipboard-arrow-left"],["translate",""],["fxLayout","column","fxLayoutGap","8px",1,"mat-padding"],[3,"formGroup"],["fxLayout","column",3,"disabled"],["fxLayout","row","fxLayoutGap.gt-xs","8px","fxLayout.xs","column"],["fxFlex","45",1,"mat-block"],["matInput","","formControlName","title","type","text","required","",3,"readonly"],[4,"ngIf"],["fxFlex","",1,"mat-block"],["matInput","","formControlName","version","type","text","required","",3,"readonly"],["fxFlex","",1,"mat-block",2,"margin-bottom","8px"],["matInput","","formControlName","tag","type","text",3,"readonly"],["translate","",4,"ngIf"],["formControlName","deviceProfileId","required","",3,"ngStyle","hint","editProfileEnabled","addNewProfile","showDetailsPageLink"],[1,"mat-block"],["formControlName","type","required",""],[3,"value",4,"ngFor","ngForOf"],["style","margin-top: 8px",4,"ngIf"],["formGroupName","additionalInfo"],["matInput","","formControlName","description","rows","2"],[3,"value"],["translate","",1,"mat-caption",2,"margin","-8px 0 8px"],["formControlName","isURL","fxLayoutGap","16px"],["fxLayout","row","fxLayoutGap.gt-xs","8px","fxLayoutGap.sm","8px","fxLayout.xs","column","fxLayout.md","column",4,"ngIf"],["formControlName","file","workFromFileObj","true",3,"label","required","dropLabel"],["formControlName","generateChecksum",2,"margin-top","16px"],["fxLayout","row","fxLayoutGap.gt-xs","8px","fxLayoutGap.sm","8px","fxLayout.xs","column","fxLayout.md","column"],["fxFlex","33",1,"mat-block"],["formControlName","checksumAlgorithm"],["matInput","","formControlName","checksum","type","text"],["fxLayout","row","fxLayoutGap.gt-md","8px","fxLayoutGap.sm","8px","fxLayout.xs","column","fxLayout.md","column"],["matInput","","formControlName","fileName","type","text"],["matInput","","formControlName","dataSize","type","text"],["matInput","","formControlName","contentType","type","text"],[2,"margin-top","8px"],["matInput","","formControlName","url","type","text",3,"required"]],template:function(n,t){1&n&&(e.\u0275\u0275elementStart(0,"div",0)(1,"button",1),e.\u0275\u0275listener("click",function(o){return t.onEntityAction(o,"open")}),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275text(3),e.\u0275\u0275pipe(4,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"button",1),e.\u0275\u0275listener("click",function(o){return t.onEntityAction(o,"uploadPackage")}),e.\u0275\u0275pipe(6,"async"),e.\u0275\u0275text(7),e.\u0275\u0275pipe(8,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(9,"button",1),e.\u0275\u0275listener("click",function(o){return t.onEntityAction(o,"delete")}),e.\u0275\u0275pipe(10,"async"),e.\u0275\u0275text(11),e.\u0275\u0275pipe(12,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(13,"div",2)(14,"button",3),e.\u0275\u0275listener("cbOnSuccess",function(){return t.onPackageIdCopied()}),e.\u0275\u0275element(15,"mat-icon",4),e.\u0275\u0275elementStart(16,"span",5),e.\u0275\u0275text(17,"ota-update.copyId"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(18,"button",3),e.\u0275\u0275listener("cbOnSuccess",function(){return t.onPackageChecksumCopied()}),e.\u0275\u0275element(19,"mat-icon",4),e.\u0275\u0275elementStart(20,"span",5),e.\u0275\u0275text(21,"ota-update.copy-checksum"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(22,"button",3),e.\u0275\u0275listener("cbOnSuccess",function(){return t.onPackageDirectUrlCopied()}),e.\u0275\u0275element(23,"mat-icon",4),e.\u0275\u0275elementStart(24,"span",5),e.\u0275\u0275text(25,"ota-update.copy-direct-url"),e.\u0275\u0275elementEnd()()()(),e.\u0275\u0275elementStart(26,"div",6)(27,"form",7)(28,"fieldset",8),e.\u0275\u0275pipe(29,"async"),e.\u0275\u0275elementStart(30,"div",9)(31,"mat-form-field",10)(32,"mat-label",5),e.\u0275\u0275text(33,"ota-update.title"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(34,"input",11),e.\u0275\u0275template(35,Nv,3,3,"mat-error",12),e.\u0275\u0275template(36,Fv,3,3,"mat-error",12),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(37,"mat-form-field",13)(38,"mat-label",5),e.\u0275\u0275text(39,"ota-update.version"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(40,"input",14),e.\u0275\u0275template(41,Lv,3,3,"mat-error",12),e.\u0275\u0275template(42,Pv,3,3,"mat-error",12),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(43,"mat-form-field",15)(44,"mat-label",5),e.\u0275\u0275text(45,"ota-update.version-tag"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(46,"input",16),e.\u0275\u0275template(47,kv,2,0,"mat-hint",17),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(48,"tb-device-profile-autocomplete",18),e.\u0275\u0275elementStart(49,"mat-form-field",19)(50,"mat-label",5),e.\u0275\u0275text(51,"ota-update.package-type"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(52,"mat-select",20),e.\u0275\u0275template(53,Rv,3,4,"mat-option",21),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(54,Ov,10,8,"section",12),e.\u0275\u0275template(55,Wv,4,3,"section",12),e.\u0275\u0275template(56,$v,6,2,"section",22),e.\u0275\u0275elementStart(57,"div",23)(58,"mat-form-field",19)(59,"mat-label",5),e.\u0275\u0275text(60,"ota-update.description"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(61,"textarea",24),e.\u0275\u0275elementEnd()()()()()),2&n&&(e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(2,34,t.isLoading$))("fxShow",!t.isEdit&&!t.isDetailsPage),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(4,36,"common.open-details-page")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(6,38,t.isLoading$)||!(null!=t.entity&&t.entity.hasData&&(null==t.entity||!t.entity.url)))("fxShow",!t.isEdit),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(8,40,"ota-update.download")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(10,42,t.isLoading$))("fxShow",!t.hideDelete()&&!t.isEdit),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(12,44,"ota-update.delete")," "),e.\u0275\u0275advance(3),e.\u0275\u0275property("cbContent",null==t.entity||null==t.entity.id?null:t.entity.id.id)("fxShow",!t.isEdit),e.\u0275\u0275advance(4),e.\u0275\u0275property("cbContent",null==t.entity?null:t.entity.checksum)("fxShow",!t.isEdit&&(null==t.entity?null:t.entity.checksum)),e.\u0275\u0275advance(4),e.\u0275\u0275property("cbContent",null==t.entity?null:t.entity.url)("fxShow",!t.isEdit&&(null==t.entity?null:t.entity.url)),e.\u0275\u0275advance(5),e.\u0275\u0275property("formGroup",t.entityForm),e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(29,46,t.isLoading$)||!t.isEdit),e.\u0275\u0275advance(6),e.\u0275\u0275property("readonly",!t.isAdd),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.entityForm.get("title").hasError("required")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.entityForm.get("title").hasError("maxlength")),e.\u0275\u0275advance(4),e.\u0275\u0275property("readonly",!t.isAdd),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.entityForm.get("version").hasError("required")),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.entityForm.get("version").hasError("maxlength")),e.\u0275\u0275advance(4),e.\u0275\u0275property("readonly",!t.isAdd),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.isAdd),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngStyle",e.\u0275\u0275pureFunction1(48,Hv,t.isAdd?"16px":0))("hint","ota-update.chose-compatible-device-profile")("editProfileEnabled",!1)("addNewProfile",!1)("showDetailsPageLink",!0),e.\u0275\u0275advance(5),e.\u0275\u0275property("ngForOf",t.packageTypes),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.isAdd),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!t.entityForm.get("isURL").value),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.entityForm.get("isURL").value))},dependencies:[p.NgForOf,p.NgIf,p.NgStyle,S.MatButton,fe.MatCheckbox,F.MatIcon,O.MatInput,_.MatFormField,_.MatLabel,_.MatHint,_.MatError,ye.MatSelect,X.MatOption,vr.MatRadioGroup,vr.MatRadioButton,he.yb,h.DefaultLayoutDirective,h.DefaultLayoutGapDirective,h.DefaultFlexDirective,G.DefaultShowHideDirective,G.DefaultStyleDirective,r.\u0275NgNoValidate,r.DefaultValueAccessor,r.NgControlStatus,r.NgControlStatusGroup,r.RequiredValidator,r.FormGroupDirective,r.FormControlName,r.FormGroupName,Do.FileInputComponent,g.TranslateDirective,Zo.DeviceProfileAutocompleteComponent,p.AsyncPipe,g.TranslatePipe],encapsulation:2});var zv=c(18721);class cn{constructor(n,t,a,o,s,l){this.translate=n,this.datePipe=t,this.store=a,this.otaPackageService=o,this.router=s,this.fileSize=l,this.config=new v.ap,this.config.entityType=f.py.OTA_PACKAGE,this.config.entityComponent=Ca,this.config.entityTranslations=f.Jr.get(f.py.OTA_PACKAGE),this.config.entityResources=f.CZ.get(f.py.OTA_PACKAGE),this.config.entityTitle=d=>d?d.title:"",this.config.columns.push(new v.eq("createdTime","common.created-time",this.datePipe,"150px"),new v.QI("title","ota-update.title","15%"),new v.QI("version","ota-update.version","15%"),new v.QI("tag","ota-update.version-tag","15%"),new v.QI("type","ota-update.package-type","15%",d=>this.translate.instant(Je.ot.get(d.type))),new v.QI("url","ota-update.direct-url","20%",d=>d.url?d.url.length>20?`${d.url.slice(0,20)}\u2026`:d.url:"",()=>({}),!0,()=>({}),()=>{},!1,{name:this.translate.instant("ota-update.copy-direct-url"),icon:"content_paste",style:{padding:"4px","font-size":"16px",color:"rgba(0,0,0,.87)"},isEnabled:d=>!!d.url,onAction:(d,m)=>m.url,type:v.rI.COPY_BUTTON}),new v.QI("fileName","ota-update.file-name","20%"),new v.QI("dataSize","ota-update.file-size","70px",d=>d.dataSize?this.fileSize.transform(d.dataSize):""),new v.QI("checksum","ota-update.checksum","220px",d=>d.checksum?this.checksumText(d):"",()=>({}),!0,()=>({}),()=>{},!1,{name:this.translate.instant("ota-update.copy-checksum"),icon:"content_paste",style:{padding:"4px","font-size":"16px",color:"rgba(0,0,0,.87)"},isEnabled:d=>!!d.checksum,onAction:(d,m)=>m.checksum,type:v.rI.COPY_BUTTON})),this.config.cellActionDescriptors.push({name:this.translate.instant("ota-update.download"),icon:"file_download",isEnabled:d=>d.hasData&&!d.url,onAction:(d,m)=>this.exportPackage(d,m)}),this.config.deleteEntityTitle=d=>this.translate.instant("ota-update.delete-ota-update-title",{title:d.title}),this.config.deleteEntityContent=()=>this.translate.instant("ota-update.delete-ota-update-text"),this.config.deleteEntitiesTitle=d=>this.translate.instant("ota-update.delete-ota-updates-title",{count:d}),this.config.deleteEntitiesContent=()=>this.translate.instant("ota-update.delete-ota-updates-text"),this.config.entitiesFetchFunction=d=>this.otaPackageService.getOtaPackages(d),this.config.loadEntity=d=>this.otaPackageService.getOtaPackageInfo(d.id),this.config.saveEntity=d=>this.otaPackageService.saveOtaPackage(d),this.config.deleteEntity=d=>this.otaPackageService.deleteOtaPackage(d.id),this.config.onEntityAction=d=>this.onPackageAction(d)}resolve(){return this.config.tableTitle=this.translate.instant("ota-update.packages-repository"),this.config}openOtaPackage(n,t){n&&n.stopPropagation();const a=this.router.createUrlTree(["otaUpdates",t.id.id]);this.router.navigateByUrl(a)}exportPackage(n,t){n&&n.stopPropagation(),t.url?window.open(t.url,"_blank"):this.otaPackageService.downloadOtaPackage(t.id.id).subscribe()}checksumText(n){let t=`${Je.j4.get(n.checksumAlgorithm)}: ${n.checksum}`;return t.length>20&&(t=`${t.slice(0,20)}\u2026`),t}onPackageAction(n){switch(n.action){case"open":return this.openOtaPackage(n.event,n.entity),!0;case"uploadPackage":return this.exportPackage(n.event,n.entity),!0}return!1}}cn.\u0275fac=function(n){return new(n||cn)(e.\u0275\u0275inject(g.TranslateService),e.\u0275\u0275inject(p.DatePipe),e.\u0275\u0275inject(x.Store),e.\u0275\u0275inject(Dv.H),e.\u0275\u0275inject(b.Router),e.\u0275\u0275inject(zv.FileSizePipe))},cn.\u0275prov=e.\u0275\u0275defineInjectable({token:cn,factory:cn.\u0275fac});const Kv=[{path:"otaUpdates",data:{breadcrumb:{label:"ota-update.ota-updates",icon:"memory"}},children:[{path:"",component:j.EntitiesTableComponent,data:{auth:[u.W.TENANT_ADMIN],title:"ota-update.ota-updates"},resolve:{entitiesTableConfig:cn}},{path:":entityId",component:ee.Y,canDeactivate:[N.P],data:{breadcrumb:{labelFunction:te,icon:"memory"},auth:[u.W.TENANT_ADMIN],title:"ota-update.ota-updates"},resolve:{entitiesTableConfig:cn}}]}];class pn{}pn.\u0275fac=function(n){return new(n||pn)},pn.\u0275mod=e.\u0275\u0275defineNgModule({type:pn}),pn.\u0275inj=e.\u0275\u0275defineInjector({providers:[cn],imports:[b.RouterModule.forChild([{path:"otaUpdates",pathMatch:"full",redirectTo:"/features/otaUpdates"},{path:"otaUpdates/:entityId",redirectTo:"/features/otaUpdates/:entityId"}]),b.RouterModule]}),(typeof ngJitMode>"u"||ngJitMode)&&e.\u0275\u0275setNgModuleScope(pn,{imports:[b.RouterModule],exports:[b.RouterModule]});class mn{}mn.\u0275fac=function(n){return new(n||mn)},mn.\u0275mod=e.\u0275\u0275defineNgModule({type:mn}),mn.\u0275inj=e.\u0275\u0275defineInjector({imports:[p.CommonModule,M.m,k.W,pn]}),(typeof ngJitMode>"u"||ngJitMode)&&e.\u0275\u0275setNgModuleScope(mn,{declarations:[Ca],imports:[p.CommonModule,M.m,k.W,pn]});const Jv=[{path:"vc",component:Ae.s,canDeactivate:[N.P],data:{auth:[u.W.TENANT_ADMIN],title:"version-control.version-control",breadcrumb:{label:"version-control.version-control",icon:"history"}}}];class un{}un.\u0275fac=function(n){return new(n||un)},un.\u0275mod=e.\u0275\u0275defineNgModule({type:un}),un.\u0275inj=e.\u0275\u0275defineInjector({imports:[b.RouterModule.forChild([{path:"vc",redirectTo:"/features/vc"}]),b.RouterModule]}),(typeof ngJitMode>"u"||ngJitMode)&&e.\u0275\u0275setNgModuleScope(un,{imports:[b.RouterModule],exports:[b.RouterModule]});class gn{}function Xv(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-tab",1,2),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275element(3,"tb-audit-log-table",3),e.\u0275\u0275elementEnd()),2&i){const t=e.\u0275\u0275reference(1),a=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(2,4,"audit-log.audit-logs")),e.\u0275\u0275advance(3),e.\u0275\u0275property("active",t.isActive)("auditLogMode",a.auditLogModes.ENTITY)("entityId",a.entity.id)}}function Zv(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"mat-tab",1,4),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementStart(3,"tb-version-control",5),e.\u0275\u0275listener("versionRestored",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.entitiesTableConfig.updateData())}),e.\u0275\u0275elementEnd()()}if(2&i){const t=e.\u0275\u0275reference(1),a=e.\u0275\u0275nextContext();e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(2,5,"version-control.version-control")),e.\u0275\u0275advance(3),e.\u0275\u0275property("active",t.isActive)("entityId",a.entity.id)("entityName",a.entity.name)("externalEntityId",a.entity.externalId||a.entity.id)}}gn.\u0275fac=function(n){return new(n||gn)},gn.\u0275mod=e.\u0275\u0275defineNgModule({type:gn}),gn.\u0275inj=e.\u0275\u0275defineInjector({imports:[p.CommonModule,M.m,un]}),(typeof ngJitMode>"u"||ngJitMode)&&e.\u0275\u0275setNgModuleScope(gn,{imports:[p.CommonModule,M.m,un]});class Ta extends _e.l{constructor(n){super(n),this.store=n}ngOnInit(){super.ngOnInit()}}Ta.\u0275fac=function(n){return new(n||Ta)(e.\u0275\u0275directiveInject(x.Store))},Ta.\u0275cmp=e.\u0275\u0275defineComponent({type:Ta,selectors:[["tb-asset-profile-tabs"]],features:[e.\u0275\u0275InheritDefinitionFeature],decls:2,vars:2,consts:[[3,"label",4,"ngIf"],[3,"label"],["auditLogsTab","matTab"],["detailsMode","true",3,"active","auditLogMode","entityId"],["versionControlTab","matTab"],["detailsMode","true","singleEntityMode","true",3,"active","entityId","entityName","externalEntityId","versionRestored"]],template:function(n,t){1&n&&(e.\u0275\u0275template(0,Xv,4,6,"mat-tab",0),e.\u0275\u0275template(1,Zv,4,7,"mat-tab",0)),2&n&&(e.\u0275\u0275property("ngIf",t.entity&&!t.isEdit),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.entity&&t.authUser.authority===t.authorities.TENANT_ADMIN&&!t.isEdit))},dependencies:[p.NgIf,H.MatTab,Be.AuditLogTableComponent,Ae.s,g.TranslatePipe],encapsulation:2});var Xa=c(93083),e1=c(99473),t1=c(67510);class fn{constructor(n,t,a,o,s,l,d,m){this.assetProfileService=n,this.importExport=t,this.homeDialogs=a,this.translate=o,this.datePipe=s,this.dialogService=l,this.router=d,this.dialog=m,this.config=new v.ap,this.config.entityType=f.py.ASSET_PROFILE,this.config.entityComponent=t1.AssetProfileComponent,this.config.entityTabsComponent=Ta,this.config.entityTranslations=f.Jr.get(f.py.ASSET_PROFILE),this.config.entityResources=f.CZ.get(f.py.ASSET_PROFILE),this.config.hideDetailsTabsOnEdit=!1,this.config.columns.push(new v.eq("createdTime","common.created-time",this.datePipe,"150px"),new v.QI("name","asset-profile.name","50%"),new v.QI("description","asset-profile.description","50%"),new v.QI("isDefault","asset-profile.default","60px",y=>(0,v.Gj)(y.default))),this.config.cellActionDescriptors.push({name:this.translate.instant("asset-profile.export"),icon:"file_download",isEnabled:()=>!0,onAction:(y,I)=>this.exportAssetProfile(y,I)},{name:this.translate.instant("asset-profile.set-default"),icon:"flag",isEnabled:y=>!y.default&&Xa.o!==y.name,onAction:(y,I)=>this.setDefaultAssetProfile(y,I)}),this.config.deleteEntityTitle=y=>this.translate.instant("asset-profile.delete-asset-profile-title",{assetProfileName:y.name}),this.config.deleteEntityContent=()=>this.translate.instant("asset-profile.delete-asset-profile-text"),this.config.deleteEntitiesTitle=y=>this.translate.instant("asset-profile.delete-asset-profiles-title",{count:y}),this.config.deleteEntitiesContent=()=>this.translate.instant("asset-profile.delete-asset-profiles-text"),this.config.entitiesFetchFunction=y=>this.assetProfileService.getAssetProfiles(y),this.config.loadEntity=y=>this.assetProfileService.getAssetProfile(y.id),this.config.saveEntity=y=>this.assetProfileService.saveAssetProfile(y),this.config.deleteEntity=y=>this.assetProfileService.deleteAssetProfile(y.id),this.config.onEntityAction=y=>this.onAssetProfileAction(y),this.config.deleteEnabled=y=>y&&!y.default&&Xa.o!==y.name,this.config.entitySelectionEnabled=y=>y&&!y.default&&Xa.o!==y.name,this.config.detailsReadonly=y=>y&&Xa.o===y.name,this.config.addActionDescriptors=this.configureAddActions()}resolve(){return this.config.tableTitle=this.translate.instant("asset-profile.asset-profiles"),this.config}configureAddActions(){const n=[];return n.push({name:this.translate.instant("asset-profile.create-asset-profile"),icon:"insert_drive_file",isEnabled:()=>!0,onAction:t=>this.config.getTable().addEntity(t)},{name:this.translate.instant("asset-profile.import"),icon:"file_upload",isEnabled:()=>!0,onAction:t=>this.importAssetProfile(t)}),n}setDefaultAssetProfile(n,t){n&&n.stopPropagation(),this.dialogService.confirm(this.translate.instant("asset-profile.set-default-asset-profile-title",{assetProfileName:t.name}),this.translate.instant("asset-profile.set-default-asset-profile-text"),this.translate.instant("action.no"),this.translate.instant("action.yes"),!0).subscribe(a=>{a&&this.assetProfileService.setDefaultAssetProfile(t.id.id).subscribe(()=>{this.config.updateData()})})}openAssetProfile(n,t){n&&n.stopPropagation();const a=this.router.createUrlTree(["profiles","assetProfiles",t.id.id]);this.router.navigateByUrl(a)}importAssetProfile(n){this.importExport.importAssetProfile().subscribe(t=>{t&&this.config.updateData()})}exportAssetProfile(n,t){n&&n.stopPropagation(),this.importExport.exportAssetProfile(t.id.id)}onAssetProfileAction(n){switch(n.action){case"open":return this.openAssetProfile(n.event,n.entity),!0;case"setDefault":return this.setDefaultAssetProfile(n.event,n.entity),!0;case"export":return this.exportAssetProfile(n.event,n.entity),!0}return!1}}fn.\u0275fac=function(n){return new(n||fn)(e.\u0275\u0275inject(e1.w),e.\u0275\u0275inject(ct.s),e.\u0275\u0275inject(lt.U),e.\u0275\u0275inject(g.TranslateService),e.\u0275\u0275inject(p.DatePipe),e.\u0275\u0275inject(pe.x),e.\u0275\u0275inject(b.Router),e.\u0275\u0275inject(C.MatDialog))},fn.\u0275prov=e.\u0275\u0275defineInjectable({token:fn,factory:fn.\u0275fac});const n1=[{path:"assetProfiles",data:{breadcrumb:{label:"asset-profile.asset-profiles",icon:"mdi:alpha-a-box"}},children:[{path:"",component:j.EntitiesTableComponent,data:{auth:[u.W.TENANT_ADMIN],title:"asset-profile.asset-profiles"},resolve:{entitiesTableConfig:fn}},{path:":entityId",component:ee.Y,canDeactivate:[N.P],data:{breadcrumb:{labelFunction:te,icon:"mdi:alpha-a-box"},auth:[u.W.TENANT_ADMIN],title:"asset-profile.asset-profiles"},resolve:{entitiesTableConfig:fn}}]}];class ni{}ni.\u0275fac=function(n){return new(n||ni)},ni.\u0275mod=e.\u0275\u0275defineNgModule({type:ni}),ni.\u0275inj=e.\u0275\u0275defineInjector({providers:[fn]});class hn{}hn.\u0275fac=function(n){return new(n||hn)},hn.\u0275mod=e.\u0275\u0275defineNgModule({type:hn}),hn.\u0275inj=e.\u0275\u0275defineInjector({imports:[p.CommonModule,M.m,k.W,ni]}),(typeof ngJitMode>"u"||ngJitMode)&&e.\u0275\u0275setNgModuleScope(hn,{declarations:[Ta],imports:[p.CommonModule,M.m,k.W,ni]});const i1=[{path:"profiles",data:{auth:[u.W.TENANT_ADMIN],breadcrumb:{label:"profiles.profiles",icon:"badge"}},children:[{path:"",children:[],data:{auth:[u.W.TENANT_ADMIN],redirectTo:"/profiles/deviceProfiles"}},...Sv,...n1]}];class bn{}bn.\u0275fac=function(n){return new(n||bn)},bn.\u0275mod=e.\u0275\u0275defineNgModule({type:bn}),bn.\u0275inj=e.\u0275\u0275defineInjector({imports:[b.RouterModule.forChild(i1),b.RouterModule]}),(typeof ngJitMode>"u"||ngJitMode)&&e.\u0275\u0275setNgModuleScope(bn,{imports:[b.RouterModule],exports:[b.RouterModule]});class yn{}yn.\u0275fac=function(n){return new(n||yn)},yn.\u0275mod=e.\u0275\u0275defineNgModule({type:yn}),yn.\u0275inj=e.\u0275\u0275defineInjector({imports:[p.CommonModule,M.m,bn]}),(typeof ngJitMode>"u"||ngJitMode)&&e.\u0275\u0275setNgModuleScope(yn,{imports:[p.CommonModule,M.m,bn]});var vn=c(12893);class Ba{constructor(n){this.oauth2Service=n}resolve(){return this.oauth2Service.getLoginProcessingUrl()}}Ba.\u0275fac=function(n){return new(n||Ba)(e.\u0275\u0275inject(ao.G))},Ba.\u0275prov=e.\u0275\u0275defineInjectable({token:Ba,factory:Ba.\u0275fac});const a1=[{path:"alarms",component:Ke.AlarmTableComponent,data:{auth:[u.W.TENANT_ADMIN,u.W.CUSTOMER_USER],title:"alarm.alarms",breadcrumb:{label:"alarm.alarms",icon:"mdi:alert-outline"},isPage:!0,alarmsMode:vn.et.ALL}}];class _n{}_n.\u0275fac=function(n){return new(n||_n)},_n.\u0275mod=e.\u0275\u0275defineNgModule({type:_n}),_n.\u0275inj=e.\u0275\u0275defineInjector({imports:[b.RouterModule.forChild(a1),b.RouterModule]}),(typeof ngJitMode>"u"||ngJitMode)&&e.\u0275\u0275setNgModuleScope(_n,{imports:[b.RouterModule],exports:[b.RouterModule]});class xn{}xn.\u0275fac=function(n){return new(n||xn)},xn.\u0275mod=e.\u0275\u0275defineNgModule({type:xn}),xn.\u0275inj=e.\u0275\u0275defineInjector({imports:[p.CommonModule,M.m,k.W,Ee.J,_n]}),(typeof ngJitMode>"u"||ngJitMode)&&e.\u0275\u0275setNgModuleScope(xn,{imports:[p.CommonModule,M.m,k.W,Ee.J,_n]});const o1=[{path:"entities",data:{auth:[u.W.TENANT_ADMIN,u.W.CUSTOMER_USER],breadcrumb:{skip:!0}},children:[{path:"",children:[],data:{auth:[u.W.TENANT_ADMIN,u.W.CUSTOMER_USER],redirectTo:"/entities/devices"}},...sb,...db,...Sb]}];class Cn{}Cn.\u0275fac=function(n){return new(n||Cn)},Cn.\u0275mod=e.\u0275\u0275defineNgModule({type:Cn}),Cn.\u0275inj=e.\u0275\u0275defineInjector({imports:[b.RouterModule.forChild(o1),b.RouterModule]}),(typeof ngJitMode>"u"||ngJitMode)&&e.\u0275\u0275setNgModuleScope(Cn,{imports:[b.RouterModule],exports:[b.RouterModule]});class Tn{}Tn.\u0275fac=function(n){return new(n||Tn)},Tn.\u0275mod=e.\u0275\u0275defineNgModule({type:Tn}),Tn.\u0275inj=e.\u0275\u0275defineInjector({imports:[p.CommonModule,M.m,Cn]}),(typeof ngJitMode>"u"||ngJitMode)&&e.\u0275\u0275setNgModuleScope(Tn,{imports:[p.CommonModule,M.m,Cn]});const r1=[{path:"features",data:{auth:[u.W.TENANT_ADMIN],breadcrumb:{label:"feature.advanced-features",icon:"construction"}},children:[{path:"",children:[],data:{auth:[u.W.TENANT_ADMIN],redirectTo:"/features/otaUpdates"}},...Kv,...Jv]}];class Sn{}Sn.\u0275fac=function(n){return new(n||Sn)},Sn.\u0275mod=e.\u0275\u0275defineNgModule({type:Sn}),Sn.\u0275inj=e.\u0275\u0275defineInjector({imports:[b.RouterModule.forChild(r1),b.RouterModule]}),(typeof ngJitMode>"u"||ngJitMode)&&e.\u0275\u0275setNgModuleScope(Sn,{imports:[b.RouterModule],exports:[b.RouterModule]});class In{}In.\u0275fac=function(n){return new(n||In)},In.\u0275mod=e.\u0275\u0275defineNgModule({type:In}),In.\u0275inj=e.\u0275\u0275defineInjector({imports:[p.CommonModule,M.m,Sn]}),(typeof ngJitMode>"u"||ngJitMode)&&e.\u0275\u0275setNgModuleScope(In,{imports:[p.CommonModule,M.m,Sn]});var D=c(87373);class Sa extends He.n{constructor(n){super(n),this.store=n}changeUnreadOnly(n){this.entitiesTableConfig.componentsData.unreadOnly=n,this.entitiesTableConfig.getTable().resetSortAndFilter(!0)}}Sa.\u0275fac=function(n){return new(n||Sa)(e.\u0275\u0275directiveInject(x.Store))},Sa.\u0275cmp=e.\u0275\u0275defineComponent({type:Sa,selectors:[["tb-inbox-table-header"]],features:[e.\u0275\u0275InheritDefinitionFeature],decls:8,vars:9,consts:[["fxFlex","100","fxLayout","row","fxLayoutAlign","start center"],[1,"tb-notification-unread-toggle-group",2,"width","180px",3,"ngModel","ngModelChange"],["fxFlex","",3,"value"]],template:function(n,t){1&n&&(e.\u0275\u0275elementStart(0,"div",0)(1,"mat-button-toggle-group",1),e.\u0275\u0275listener("ngModelChange",function(o){return t.changeUnreadOnly(o)}),e.\u0275\u0275elementStart(2,"mat-button-toggle",2),e.\u0275\u0275text(3),e.\u0275\u0275pipe(4,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"mat-button-toggle",2),e.\u0275\u0275text(6),e.\u0275\u0275pipe(7,"translate"),e.\u0275\u0275elementEnd()()()),2&n&&(e.\u0275\u0275advance(1),e.\u0275\u0275property("ngModel",t.entitiesTableConfig.componentsData.unreadOnly),e.\u0275\u0275advance(1),e.\u0275\u0275property("value",!0),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(4,5,"notification.unread")),e.\u0275\u0275advance(2),e.\u0275\u0275property("value",!1),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(7,7,"notification.all")))},dependencies:[mi.MatButtonToggleGroup,mi.MatButtonToggle,h.DefaultLayoutDirective,h.DefaultLayoutAlignDirective,h.DefaultFlexDirective,r.NgControlStatus,r.NgModel,g.TranslatePipe],styles:['@charset "UTF-8";[_nghost-%COMP%]     .mat-button-toggle-group.tb-notification-unread-toggle-group.mat-button-toggle-group-appearance-standard{border:none;border-radius:14px}[_nghost-%COMP%]     .mat-button-toggle-group.tb-notification-unread-toggle-group.mat-button-toggle-group-appearance-standard .mat-button-toggle+.mat-button-toggle{border-left:none}[_nghost-%COMP%]     .mat-button-toggle-group.tb-notification-unread-toggle-group .mat-button-toggle{background:rgba(0,0,0,.06);height:28px;align-items:center;display:flex}[_nghost-%COMP%]     .mat-button-toggle-group.tb-notification-unread-toggle-group .mat-button-toggle .mat-button-toggle-ripple{inset:2px;border-radius:14px}[_nghost-%COMP%]     .mat-button-toggle-group.tb-notification-unread-toggle-group .mat-button-toggle-button{color:#959595}[_nghost-%COMP%]     .mat-button-toggle-group.tb-notification-unread-toggle-group .mat-button-toggle-focus-overlay{border-radius:14px;margin:2px}[_nghost-%COMP%]     .mat-button-toggle-group.tb-notification-unread-toggle-group .mat-button-toggle-checked .mat-button-toggle-button{background-color:#424242;color:#fff;border-radius:14px;margin-left:2px;margin-right:2px}[_nghost-%COMP%]     .mat-button-toggle-group.tb-notification-unread-toggle-group .mat-button-toggle-appearance-standard .mat-button-toggle-label-content{line-height:24px;font-size:14px;font-weight:500;letter-spacing:.25px}[_nghost-%COMP%]     .mat-button-toggle-group.tb-notification-unread-toggle-group .mat-button-toggle-checked.mat-button-toggle-appearance-standard:not(.mat-button-toggle-disabled):hover .mat-button-toggle-focus-overlay{opacity:.01}']});var s1=c(19158);class Ia extends le.a{constructor(n,t,a,o){super(n,t,a),this.store=n,this.router=t,this.dialogRef=a,this.data=o,this.notification=o.notification}markAsRead(n){this.dialogRef.close(n)}}Ia.\u0275fac=function(n){return new(n||Ia)(e.\u0275\u0275directiveInject(x.Store),e.\u0275\u0275directiveInject(b.Router),e.\u0275\u0275directiveInject(C.MatDialogRef),e.\u0275\u0275directiveInject(C.MAT_DIALOG_DATA))},Ia.\u0275cmp=e.\u0275\u0275defineComponent({type:Ia,selectors:[["tb-inbox-notification-dialog"]],features:[e.\u0275\u0275InheritDefinitionFeature],decls:1,vars:1,consts:[[3,"notification","markAsRead"]],template:function(n,t){1&n&&(e.\u0275\u0275elementStart(0,"tb-notification",0),e.\u0275\u0275listener("markAsRead",function(o){return t.markAsRead(o)}),e.\u0275\u0275elementEnd()),2&n&&e.\u0275\u0275property("notification",t.notification)},dependencies:[s1.NotificationComponent],styles:['@charset "UTF-8";[_nghost-%COMP%]{display:block;max-width:400px;min-width:350px;padding:2px}']});var l1=c(54822);class ii{constructor(n,t,a,o,s){this.notificationService=n,this.translate=t,this.dialog=a,this.datePipe=o,this.utilsService=s,this.config=new v.ap,this.config.entityType=f.py.NOTIFICATION,this.config.detailsPanelEnabled=!1,this.config.addEnabled=!1,this.config.rowPointer=!0,this.config.entityTranslations=f.Jr.get(f.py.NOTIFICATION),this.config.entityResources={},this.config.deleteEntityTitle=()=>this.translate.instant("notification.delete-notification-title"),this.config.deleteEntityContent=()=>this.translate.instant("notification.delete-notification-text"),this.config.deleteEntitiesTitle=l=>this.translate.instant("notification.delete-notifications-title",{count:l}),this.config.deleteEntitiesContent=()=>this.translate.instant("notification.delete-notifications-text"),this.config.deleteEntity=l=>this.notificationService.deleteNotification(l.id),this.config.entitiesFetchFunction=l=>this.notificationService.getNotifications(l,this.config.componentsData.unreadOnly),this.config.defaultSortOrder={property:"createdTime",direction:pt.N.DESC},this.config.handleRowClick=(l,d)=>(this.showNotification(l,d),!0),this.config.componentsData={unreadOnly:!0},this.config.cellActionDescriptors=this.configureCellActions(),this.config.headerComponent=Sa,this.config.headerActionDescriptors=[{name:this.translate.instant("notification.mark-all-as-read"),icon:"done_all",isEnabled:()=>!0,onAction:l=>this.markAllRead(l)}],this.config.columns.push(new v.eq("createdTime","common.created-time",this.datePipe,"170px"),new v.QI("type","notification.type","10%",l=>this.translate.instant(D.as.get(l.type).name)),new v.QI("subject","notification.subject","30%",l=>this.utilsService.customTranslation(l.subject,l.subject)),new v.QI("text","notification.message","60%",l=>this.utilsService.customTranslation(l.text,l.text)))}resolve(n){return this.config}configureCellActions(){return[{name:this.translate.instant("notification.mark-as-read"),icon:"check_circle_outline",isEnabled:n=>n.status!==D.Ez.READ,onAction:(n,t)=>this.markAsRead(n,t)}]}markAllRead(n){n&&n.stopPropagation(),this.notificationService.markAllNotificationsAsRead().subscribe(()=>{this.config.componentsData.unreadOnly?this.config.getTable().resetSortAndFilter(!0):this.config.updateData()})}markAsRead(n,t){n&&n.stopPropagation(),this.notificationService.markNotificationAsRead(t.id.id).subscribe(()=>{this.config.componentsData.unreadOnly?this.config.getTable().dataSource.pageData$.pipe((0,Re.q)(1)).subscribe(a=>{1===a.data.length&&this.config.getTable().pageLink.page&&this.config.getTable().pageLink.page--,this.config.updateData()}):(t.status=D.Ez.READ,this.config.getTable().detectChanges())})}showNotification(n,t){n&&n.stopPropagation(),this.dialog.open(Ia,{disableClose:!1,panelClass:["tb-dialog","tb-fullscreen-dialog"],data:{notification:t}}).afterClosed().subscribe(a=>{a&&this.markAsRead(null,t)})}}ii.\u0275fac=function(n){return new(n||ii)(e.\u0275\u0275inject(qe.g),e.\u0275\u0275inject(g.TranslateService),e.\u0275\u0275inject(C.MatDialog),e.\u0275\u0275inject(p.DatePipe),e.\u0275\u0275inject(l1.F))},ii.\u0275prov=e.\u0275\u0275defineInjectable({token:ii,factory:ii.\u0275fac});var _r=c(43990);function d1(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"tr")(1,"td")(2,"mat-chip"),e.\u0275\u0275text(3),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(4,"td",9),e.\u0275\u0275text(5),e.\u0275\u0275elementEnd()()),2&i){const t=n.$implicit;e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(t.key),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(t.value)}}function c1(i,n){1&i&&e.\u0275\u0275element(0,"mat-divider")}function p1(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div")(1,"h6"),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"table",7),e.\u0275\u0275template(5,d1,6,2,"tr",6),e.\u0275\u0275pipe(6,"keyvalue"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(7,c1,1,0,"mat-divider",8),e.\u0275\u0275elementEnd()),2&i){const t=n.$implicit,a=n.last,o=e.\u0275\u0275nextContext();e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(3,3,o.notificationDeliveryMethodTranslateMap.get(t.key))),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngForOf",e.\u0275\u0275pipeBind1(6,5,t.value)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!a)}}class wa extends le.a{constructor(n,t,a,o){super(n,t,a),this.store=n,this.router=t,this.dialogRef=a,this.data=o,this.notificationDeliveryMethodTranslateMap=D.WG,this.errorStats=o.notificationRequest.stats.errors}cancel(){this.dialogRef.close(null)}}wa.\u0275fac=function(n){return new(n||wa)(e.\u0275\u0275directiveInject(x.Store),e.\u0275\u0275directiveInject(b.Router),e.\u0275\u0275directiveInject(C.MatDialogRef),e.\u0275\u0275directiveInject(C.MAT_DIALOG_DATA))},wa.\u0275cmp=e.\u0275\u0275defineComponent({type:wa,selectors:[["tb-notification-send-error-dialog"]],features:[e.\u0275\u0275InheritDefinitionFeature],decls:10,vars:3,consts:[["color","primary"],["translate",""],["fxFlex",""],["mat-icon-button","","type","button",3,"click"],[1,"material-icons"],["mat-dialog-content",""],[4,"ngFor","ngForOf"],[1,"tb-table-list"],[4,"ngIf"],[1,"tb-row-error"]],template:function(n,t){1&n&&(e.\u0275\u0275elementStart(0,"mat-toolbar",0)(1,"h2",1),e.\u0275\u0275text(2,"notification.failed-send"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(3,"span",2),e.\u0275\u0275elementStart(4,"button",3),e.\u0275\u0275listener("click",function(){return t.cancel()}),e.\u0275\u0275elementStart(5,"mat-icon",4),e.\u0275\u0275text(6,"close"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(7,"div",5),e.\u0275\u0275template(8,p1,8,7,"div",6),e.\u0275\u0275pipe(9,"keyvalue"),e.\u0275\u0275elementEnd()),2&n&&(e.\u0275\u0275advance(8),e.\u0275\u0275property("ngForOf",e.\u0275\u0275pipeBind1(9,1,t.errorStats)))},dependencies:[p.NgForOf,p.NgIf,S.MatIconButton,F.MatIcon,oe.MatToolbar,C.MatDialogContent,kn.MatDivider,ve.MatChip,h.DefaultFlexDirective,g.TranslateDirective,p.KeyValuePipe,g.TranslatePipe],styles:['@charset "UTF-8";[_nghost-%COMP%]{display:block;width:600px;max-width:100%;color:#000000de}[_nghost-%COMP%]   h6[_ngcontent-%COMP%]{font-weight:500;font-size:16px;line-height:20px;margin-top:0}[_nghost-%COMP%]   .tb-table-list[_ngcontent-%COMP%]{table-layout:fixed;width:100%;border:hidden;border-collapse:collapse}[_nghost-%COMP%]   .tb-table-list[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border:8px solid transparent;border-collapse:collapse;font-size:14px}[_nghost-%COMP%]   .tb-table-list[_ngcontent-%COMP%]   .tb-row-error[_ngcontent-%COMP%]{word-wrap:break-word}[_nghost-%COMP%]   .mat-divider[_ngcontent-%COMP%]{margin:24px 0}']});class ai{constructor(n,t,a,o){this.notificationService=n,this.translate=t,this.dialog=a,this.datePipe=o,this.config=new v.ap,this.config.entityType=f.py.NOTIFICATION_REQUEST,this.config.detailsPanelEnabled=!1,this.config.addEnabled=!1,this.config.searchEnabled=!1,this.config.entityTranslations=f.Jr.get(f.py.NOTIFICATION_REQUEST),this.config.entityResources={},this.config.deleteEntityTitle=()=>this.translate.instant("notification.delete-request-title"),this.config.deleteEntityContent=()=>this.translate.instant("notification.delete-request-text"),this.config.deleteEntitiesTitle=s=>this.translate.instant("notification.delete-requests-title",{count:s}),this.config.deleteEntitiesContent=()=>this.translate.instant("notification.delete-requests-text"),this.config.deleteEntity=s=>this.notificationService.deleteNotificationRequest(s.id),this.config.entitiesFetchFunction=s=>this.notificationService.getNotificationRequests(s),this.config.cellActionDescriptors=this.configureCellActions(),this.config.onEntityAction=s=>this.onRequestAction(s),this.config.handleRowClick=(s,l)=>((s.target.getElementsByClassName("stats").length||"stats"===s.target.className)&&this.openStatsErrorDialog(s,l),!0),this.config.defaultSortOrder={property:"createdTime",direction:pt.N.DESC},this.config.columns.push(new v.eq("createdTime","common.created-time",this.datePipe,"170px"),new v.QI("status","notification.status","15%",s=>`<span style="display: flex;">${this.requestStatus(s.status)}${this.requestStats(s.stats)}</span>`,s=>this.requestStatusStyle(s.status)),new v.QI("deliveryMethods","notification.delivery-method.delivery-method","15%",s=>s.deliveryMethods.map(l=>this.translate.instant(D.WG.get(l))).join(", "),()=>({}),!1),new v.QI("templateName","notification.template","70%"))}resolve(n){return this.config}configureCellActions(){return[{name:this.translate.instant("notification.notify-again"),icon:"mdi:repeat-variant",isEnabled:n=>n.status!==D.Qf.SCHEDULED,onAction:(n,t)=>this.createRequest(n,t)}]}createRequest(n,t,a=!1,o=!0){n&&n.stopPropagation(),this.dialog.open(_r.m,{disableClose:!0,panelClass:["tb-dialog","tb-fullscreen-dialog"],data:{isAdd:a,request:t}}).afterClosed().subscribe(s=>{s&&o&&this.config.updateData()})}onRequestAction(n){switch(n.action){case"add":return this.createRequest(n.event,n.entity,!0),!0;case"add-without-update":return this.createRequest(n.event,n.entity,!0,!1),!0}return!1}requestStatus(n){const t=D.r6.get(n);let a="rgba(25, 128, 56, 0.08)";switch(n){case D.Qf.SCHEDULED:a="rgba(48, 86, 128, 0.08)";break;case D.Qf.PROCESSING:a="rgba(212, 125, 24, 0.08)"}return`<div style="border-radius: 12px; height: 24px; line-height: 24px; padding: 0 10px;\n                        width: fit-content; background-color: ${a}">\n                ${this.translate.instant(t)}\n            </div>`}requestStats(n){if(!n?.errors)return"";let t=0;return Object.keys(n.errors).forEach(a=>t+=Object.keys(n.errors[a]).length),0===t?"":`<div style="border-radius: 12px; height: 24px; line-height: 24px; padding: 0 10px; width: max-content; cursor: pointer;\n                        background-color: #D12730; color: #fff; font-weight: 500; margin-left: 8px" class="stats">\n                ${this.translate.instant("notification.fails",{count:t})} >\n            </div>`}requestStatusStyle(n){const t={fontSize:"14px",color:"#198038"};switch(n){case D.Qf.SCHEDULED:t.color="#305680";break;case D.Qf.PROCESSING:t.color="#D47D18"}return t}openStatsErrorDialog(n,t){n&&n.stopPropagation(),this.dialog.open(wa,{disableClose:!0,panelClass:["tb-dialog","tb-fullscreen-dialog"],data:{notificationRequest:t}}).afterClosed().subscribe(()=>{})}}ai.\u0275fac=function(n){return new(n||ai)(e.\u0275\u0275inject(qe.g),e.\u0275\u0275inject(g.TranslateService),e.\u0275\u0275inject(C.MatDialog),e.\u0275\u0275inject(p.DatePipe))},ai.\u0275prov=e.\u0275\u0275defineInjectable({token:ai,factory:ai.\u0275fac});var Za=c(13601);class Ea extends He.n{constructor(n){super(n),this.store=n}createTarget(n){this.entitiesTableConfig.onEntityAction({event:n,action:"add",entity:null})}}Ea.\u0275fac=function(n){return new(n||Ea)(e.\u0275\u0275directiveInject(x.Store))},Ea.\u0275cmp=e.\u0275\u0275defineComponent({type:Ea,selectors:[["tb-recipient-table-header"]],features:[e.\u0275\u0275InheritDefinitionFeature],decls:7,vars:3,consts:[["fxFlex","100","fxLayout","row","fxLayoutAlign","end center"],["mat-stroked-button","","color","primary",3,"click"],["fxLayout","row","fxLayoutAlign","start center"]],template:function(n,t){1&n&&(e.\u0275\u0275elementStart(0,"div",0)(1,"button",1),e.\u0275\u0275listener("click",function(o){return t.createTarget(o)}),e.\u0275\u0275elementStart(2,"div",2)(3,"mat-icon"),e.\u0275\u0275text(4,"add"),e.\u0275\u0275elementEnd(),e.\u0275\u0275text(5),e.\u0275\u0275pipe(6,"translate"),e.\u0275\u0275elementEnd()()()),2&n&&(e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate1("",e.\u0275\u0275pipeBind1(6,1,"notification.add-recipients")," "))},dependencies:[S.MatButton,F.MatIcon,h.DefaultLayoutDirective,h.DefaultLayoutAlignDirective,h.DefaultFlexDirective,g.TranslatePipe],styles:['@charset "UTF-8";[_nghost-%COMP%]{width:10000px}']});class oi{constructor(n,t,a,o){this.notificationService=n,this.translate=t,this.dialog=a,this.datePipe=o,this.config=new v.ap,this.config.entityType=f.py.NOTIFICATION_TARGET,this.config.detailsPanelEnabled=!1,this.config.addEnabled=!1,this.config.rowPointer=!0,this.config.entityTranslations=f.Jr.get(f.py.NOTIFICATION_TARGET),this.config.entityResources={},this.config.entitiesFetchFunction=s=>this.notificationService.getNotificationTargets(s),this.config.deleteEntityTitle=s=>this.translate.instant("notification.delete-recipient-title",{recipientName:s.name}),this.config.deleteEntityContent=()=>this.translate.instant("notification.delete-recipient-text"),this.config.deleteEntitiesTitle=s=>this.translate.instant("notification.delete-recipients-title",{count:s}),this.config.deleteEntitiesContent=()=>this.translate.instant("notification.delete-recipients-text"),this.config.deleteEntity=s=>this.notificationService.deleteNotificationTarget(s.id),this.config.cellActionDescriptors=this.configureCellActions(),this.config.headerComponent=Ea,this.config.onEntityAction=s=>this.onTargetAction(s),this.config.defaultSortOrder={property:"createdTime",direction:pt.N.DESC},this.config.handleRowClick=(s,l)=>(this.editTarget(s,l),!0),this.config.columns.push(new v.eq("createdTime","common.created-time",this.datePipe,"170px"),new v.QI("name","notification.recipient-group","20%"),new v.QI("configuration.type","notification.type","20%",s=>this.translate.instant(D.pR.get(s.configuration.type)),()=>({}),!1),new v.QI("configuration.description","notification.description","60%",s=>s.configuration.description||"",()=>({}),!1))}resolve(n){return this.config}configureCellActions(){return[]}editTarget(n,t,a=!1){n&&n.stopPropagation(),this.dialog.open(Za.U,{disableClose:!0,panelClass:["tb-dialog","tb-fullscreen-dialog"],data:{isAdd:a,target:t}}).afterClosed().subscribe(o=>{o&&this.config.updateData()})}onTargetAction(n){return"add"===n.action&&(this.editTarget(n.event,n.entity,!0),!0)}}oi.\u0275fac=function(n){return new(n||oi)(e.\u0275\u0275inject(qe.g),e.\u0275\u0275inject(g.TranslateService),e.\u0275\u0275inject(C.MatDialog),e.\u0275\u0275inject(p.DatePipe))},oi.\u0275prov=e.\u0275\u0275defineInjectable({token:oi,factory:oi.\u0275fac});var To=c(39616);class Ma extends He.n{constructor(n){super(n),this.store=n}createTemplate(n){this.entitiesTableConfig.onEntityAction({event:n,action:"add",entity:null})}}Ma.\u0275fac=function(n){return new(n||Ma)(e.\u0275\u0275directiveInject(x.Store))},Ma.\u0275cmp=e.\u0275\u0275defineComponent({type:Ma,selectors:[["tb-template-table-header"]],features:[e.\u0275\u0275InheritDefinitionFeature],decls:7,vars:3,consts:[["fxFlex","100","fxLayout","row","fxLayoutAlign","end center"],["mat-stroked-button","","color","primary",3,"click"],["fxLayout","row","fxLayoutAlign","start center"]],template:function(n,t){1&n&&(e.\u0275\u0275elementStart(0,"div",0)(1,"button",1),e.\u0275\u0275listener("click",function(o){return t.createTemplate(o)}),e.\u0275\u0275elementStart(2,"div",2)(3,"mat-icon"),e.\u0275\u0275text(4,"add"),e.\u0275\u0275elementEnd(),e.\u0275\u0275text(5),e.\u0275\u0275pipe(6,"translate"),e.\u0275\u0275elementEnd()()()),2&n&&(e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate1("",e.\u0275\u0275pipeBind1(6,1,"notification.add-template")," "))},dependencies:[S.MatButton,F.MatIcon,h.DefaultLayoutDirective,h.DefaultLayoutAlignDirective,h.DefaultFlexDirective,g.TranslatePipe],styles:['@charset "UTF-8";[_nghost-%COMP%]{width:10000px}']});class ri{constructor(n,t,a,o){this.notificationService=n,this.translate=t,this.dialog=a,this.datePipe=o,this.config=new v.ap,this.config.entityType=f.py.NOTIFICATION_TEMPLATE,this.config.detailsPanelEnabled=!1,this.config.addEnabled=!1,this.config.rowPointer=!0,this.config.entityTranslations=f.Jr.get(f.py.NOTIFICATION_TEMPLATE),this.config.entityResources={},this.config.entitiesFetchFunction=s=>this.notificationService.getNotificationTemplates(s),this.config.deleteEntityTitle=s=>this.translate.instant("notification.delete-template-title",{templateName:s.name}),this.config.deleteEntityContent=()=>this.translate.instant("notification.delete-template-text"),this.config.deleteEntitiesTitle=s=>this.translate.instant("notification.delete-templates-title",{count:s}),this.config.deleteEntitiesContent=()=>this.translate.instant("notification.delete-templates-text"),this.config.deleteEntity=s=>this.notificationService.deleteNotificationTemplate(s.id),this.config.cellActionDescriptors=this.configureCellActions(),this.config.headerComponent=Ma,this.config.onEntityAction=s=>this.onTemplateAction(s),this.config.defaultSortOrder={property:"createdTime",direction:pt.N.DESC},this.config.handleRowClick=(s,l)=>(this.editTemplate(s,l),!0),this.config.columns.push(new v.eq("createdTime","common.created-time",this.datePipe,"170px"),new v.QI("notificationType","notification.type","20%",s=>this.translate.instant(D.as.get(s.notificationType).name)),new v.QI("name","notification.template","80%"))}resolve(n){return this.config}configureCellActions(){return[{name:this.translate.instant("notification.copy-template"),icon:"content_copy",isEnabled:()=>!0,onAction:(n,t)=>this.editTemplate(n,t,!1,!0)}]}editTemplate(n,t,a=!1,o=!1){n&&n.stopPropagation(),this.dialog.open(To.A,{disableClose:!0,panelClass:["tb-dialog","tb-fullscreen-dialog"],data:{isAdd:a,isCopy:o,template:t}}).afterClosed().subscribe(s=>{s&&this.config.updateData()})}onTemplateAction(n){return"add"===n.action&&(this.editTemplate(n.event,n.entity,!0),!0)}}ri.\u0275fac=function(n){return new(n||ri)(e.\u0275\u0275inject(qe.g),e.\u0275\u0275inject(g.TranslateService),e.\u0275\u0275inject(C.MatDialog),e.\u0275\u0275inject(p.DatePipe))},ri.\u0275prov=e.\u0275\u0275defineInjectable({token:ri,factory:ri.\u0275fac});class Da extends He.n{constructor(n){super(n),this.store=n}createTarget(n){this.entitiesTableConfig.onEntityAction({event:n,action:"add",entity:null})}}Da.\u0275fac=function(n){return new(n||Da)(e.\u0275\u0275directiveInject(x.Store))},Da.\u0275cmp=e.\u0275\u0275defineComponent({type:Da,selectors:[["tb-rule-table-header"]],features:[e.\u0275\u0275InheritDefinitionFeature],decls:7,vars:3,consts:[["fxFlex","100","fxLayout","row","fxLayoutAlign","end center"],["mat-stroked-button","","color","primary",3,"click"],["fxLayout","row","fxLayoutAlign","start center"]],template:function(n,t){1&n&&(e.\u0275\u0275elementStart(0,"div",0)(1,"button",1),e.\u0275\u0275listener("click",function(o){return t.createTarget(o)}),e.\u0275\u0275elementStart(2,"div",2)(3,"mat-icon"),e.\u0275\u0275text(4,"add"),e.\u0275\u0275elementEnd(),e.\u0275\u0275text(5),e.\u0275\u0275pipe(6,"translate"),e.\u0275\u0275elementEnd()()()),2&n&&(e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate1("",e.\u0275\u0275pipeBind1(6,1,"notification.add-rule")," "))},dependencies:[S.MatButton,F.MatIcon,h.DefaultLayoutDirective,h.DefaultLayoutAlignDirective,h.DefaultFlexDirective,g.TranslatePipe],styles:['@charset "UTF-8";[_nghost-%COMP%]{width:10000px}']});var Va=c(466),xr=c(68826),Cr=c(59025),m1=c(55730),Tr=c(72149),u1=c(17187),g1=c(63101);function f1(i,n){1&i&&(e.\u0275\u0275elementStart(0,"div",8),e.\u0275\u0275text(1,"notification.first-recipient"),e.\u0275\u0275elementEnd())}function h1(i,n){1&i&&(e.\u0275\u0275elementStart(0,"div",9)(1,"span",10),e.\u0275\u0275text(2,"notification.after"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(3,"tb-timeinterval",11),e.\u0275\u0275elementStart(4,"span",12),e.\u0275\u0275text(5,"notification.notify"),e.\u0275\u0275elementEnd()())}class wn{constructor(n,t){this.fb=n,this.dialog=t,this.systemEscalation=!1,this.entityType=f.py,this.notificationType=D.k$,this.propagateChange=null,this.propagateChangePending=!1,this.destroy$=new be.x}registerOnChange(n){this.propagateChange=n,this.propagateChangePending&&(this.propagateChangePending=!1,setTimeout(()=>{this.propagateChange(this.modelValue)},0))}registerOnTouched(n){}ngOnInit(){this.escalationFormGroup=this.fb.group({delayInSec:[0],targets:[null,r.Validators.required]}),this.escalationFormGroup.valueChanges.pipe((0,Y.R)(this.destroy$)).subscribe(()=>this.updateModel())}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}setDisabledState(n){this.disabled=n,this.disabled?this.escalationFormGroup.disable({emitEvent:!1}):this.escalationFormGroup.enable({emitEvent:!1})}writeValue(n){this.propagateChangePending=!1,this.modelValue=n,this.modelValue.delayInSec=+n.delayInSec,(0,T.nu)(this.modelValue)&&this.escalationFormGroup.patchValue(this.modelValue,{emitEvent:!1}),!this.disabled&&!this.escalationFormGroup.valid&&this.updateModel()}createTarget(n,t){n&&n.stopPropagation(),t._elementRef.nativeElement.blur(),this.dialog.open(Za.U,{disableClose:!0,panelClass:["tb-dialog","tb-fullscreen-dialog"],data:{}}).afterClosed().subscribe(a=>{if(a){let o=this.escalationFormGroup.get("targets").value;o||(o=[]),o.push(a.id.id),this.escalationFormGroup.get("targets").patchValue(o)}})}validate(n){return this.escalationFormGroup.valid?null:{escalation:{valid:!1}}}updateModel(){const n=this.escalationFormGroup.value;this.modelValue={...this.modelValue,...n},this.propagateChange?this.propagateChange(this.modelValue):this.propagateChangePending=!0}}function b1(i,n){1&i&&e.\u0275\u0275element(0,"span",8)}function y1(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",9),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext().index,s=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(s.removeEscalation(o))}),e.\u0275\u0275pipe(1,"translate"),e.\u0275\u0275elementStart(2,"mat-icon"),e.\u0275\u0275text(3,"close"),e.\u0275\u0275elementEnd()()}2&i&&e.\u0275\u0275propertyInterpolate("matTooltip",e.\u0275\u0275pipeBind1(1,1,"action.remove"))}wn.\u0275fac=function(n){return new(n||wn)(e.\u0275\u0275directiveInject(r.FormBuilder),e.\u0275\u0275directiveInject(C.MatDialog))},wn.\u0275cmp=e.\u0275\u0275defineComponent({type:wn,selectors:[["tb-escalation-form"]],inputs:{disabled:"disabled",systemEscalation:"systemEscalation"},features:[e.\u0275\u0275ProvidersFeature([{provide:r.NG_VALUE_ACCESSOR,useExisting:(0,e.forwardRef)(()=>wn),multi:!0},{provide:r.NG_VALIDATORS,useExisting:(0,e.forwardRef)(()=>wn),multi:!0}])],decls:12,vars:12,consts:[["fxLayout","column",3,"formGroup"],["fxLayout","row","fxLayout.xs","column","fxLayoutAlign","center center","fxLayoutAlign.xs","start",1,"escalation"],["fxFlex","","translate","",4,"ngIf","ngIfElse"],["selectTime",""],["required","","fxFlex","60","formControlName","targets","subscriptSizing","dynamic",3,"entityType","subType","placeholderText"],["mat-button","","matSuffix","",3,"fxHide","click"],["createTargetButton",""],[2,"white-space","nowrap"],["fxFlex","","translate",""],["fxFlex","","fxLayout","row","fxLayout.xs","column","fxLayoutAlign","center center"],["translate",""],["subscriptSizing","dynamic","formControlName","delayInSec","min","60000","max","604800000","disabledAdvanced",""],["fxFlex","","translate","",1,"escalation-notify"]],template:function(n,t){if(1&n){const a=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"form",0)(1,"div",1),e.\u0275\u0275template(2,f1,2,0,"div",2),e.\u0275\u0275template(3,h1,6,0,"ng-template",null,3,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementStart(5,"tb-entity-list",4),e.\u0275\u0275pipe(6,"translate"),e.\u0275\u0275elementStart(7,"button",5,6),e.\u0275\u0275listener("click",function(s){e.\u0275\u0275restoreView(a);const l=e.\u0275\u0275reference(8);return e.\u0275\u0275resetView(t.createTarget(s,l))}),e.\u0275\u0275elementStart(9,"span",7),e.\u0275\u0275text(10),e.\u0275\u0275pipe(11,"translate"),e.\u0275\u0275elementEnd()()()()()}if(2&n){const a=e.\u0275\u0275reference(4);e.\u0275\u0275property("formGroup",t.escalationFormGroup),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",t.systemEscalation)("ngIfElse",a),e.\u0275\u0275advance(3),e.\u0275\u0275propertyInterpolate("entityType",t.entityType.NOTIFICATION_TARGET),e.\u0275\u0275propertyInterpolate("subType",t.notificationType.ALARM),e.\u0275\u0275property("placeholderText",t.escalationFormGroup.get("targets").value?"":e.\u0275\u0275pipeBind1(6,8,"notification.add-recipient")),e.\u0275\u0275advance(2),e.\u0275\u0275property("fxHide",t.disabled),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(11,10,"notification.create-new"))}},dependencies:[p.NgIf,g1.TimeintervalComponent,Cr.EntityListComponent,S.MatButton,_.MatSuffix,h.DefaultLayoutDirective,h.DefaultLayoutAlignDirective,h.DefaultFlexDirective,G.DefaultShowHideDirective,r.\u0275NgNoValidate,r.NgControlStatus,r.NgControlStatusGroup,r.RequiredValidator,r.FormGroupDirective,r.FormControlName,g.TranslateDirective,g.TranslatePipe],styles:['@charset "UTF-8";[_nghost-%COMP%]   .escalation[_ngcontent-%COMP%]{height:100%;min-height:74px;max-height:100%;border-radius:8px;background:rgba(0,0,0,.04);padding:0 10px}[_nghost-%COMP%]   .escalation[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{padding-right:10px}[_nghost-%COMP%]   .escalation-notify[_ngcontent-%COMP%]{text-align:center}[_nghost-%COMP%]   tb-timeinterval[_ngcontent-%COMP%]{min-width:100px;padding:0 10px}@media screen and (max-width: 599px){[_nghost-%COMP%]   .escalation[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{padding:10px 0 0}[_nghost-%COMP%]   tb-timeinterval[_ngcontent-%COMP%]{padding:0}}[_nghost-%COMP%]     .mat-mdc-form-field{min-width:100px}[_nghost-%COMP%]     .mat-mdc-form-field .mat-mdc-form-field-infix{width:100%}[_nghost-%COMP%]     .mat-mdc-form-field .mat-mdc-select{min-width:110px!important}']});const v1=function(){return{paddingBottom:"8px"}},_1=function(){return{}};function x1(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div",4),e.\u0275\u0275element(1,"tb-escalation-form",5),e.\u0275\u0275template(2,b1,1,0,"span",6),e.\u0275\u0275template(3,y1,4,3,"button",7),e.\u0275\u0275elementEnd()),2&i){const t=n.$implicit,a=n.index,o=n.last,s=e.\u0275\u0275nextContext();e.\u0275\u0275property("ngStyle",o?e.\u0275\u0275pureFunction0(6,_1):e.\u0275\u0275pureFunction0(5,v1)),e.\u0275\u0275advance(1),e.\u0275\u0275property("formControl",t)("systemEscalation",0===a),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",0===a),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",0!==a&&!s.disabled)}}function C1(i,n){1&i&&(e.\u0275\u0275elementStart(0,"div")(1,"span",10),e.\u0275\u0275text(2,"notification.no-rule"),e.\u0275\u0275elementEnd()())}function T1(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",11)(1,"button",12),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.addEscalation())}),e.\u0275\u0275elementStart(2,"span",13),e.\u0275\u0275text(3,"notification.add-stage"),e.\u0275\u0275elementEnd()()()}}class nt{constructor(n,t){this.store=n,this.fb=t,this.destroy$=new be.x,this.propagateChange=a=>{}}registerOnChange(n){this.propagateChange=n}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}registerOnTouched(n){}ngOnInit(){this.escalationsFormGroup=this.fb.group({escalations:this.fb.array([])}),this.escalationsFormGroup.valueChanges.pipe((0,Y.R)(this.destroy$)).subscribe(()=>this.updateModel())}get escalationsFormArray(){return this.escalationsFormGroup.get("escalations")}setDisabledState(n){this.disabled=n,this.disabled?this.escalationsFormGroup.disable({emitEvent:!1}):this.escalationsFormGroup.enable({emitEvent:!1})}writeValue(n){const t=[];for(const a in n)t.push({delayInSec:1e3*Number(a),targets:n[a]});if(0===t.length)this.addEscalation(0);else if(t?.length===this.escalationsFormArray.length)this.escalationsFormArray.patchValue(t,{emitEvent:!1});else{const a=[];t.forEach(o=>{a.push(this.fb.control(o,[r.Validators.required]))}),this.escalationsFormGroup.setControl("escalations",this.fb.array(a),{emitEvent:!1}),this.disabled?this.escalationsFormGroup.disable({emitEvent:!1}):this.escalationsFormGroup.enable({emitEvent:!1})}}removeEscalation(n){this.escalationsFormGroup.get("escalations").removeAt(n)}addEscalation(n=36e5){const t={delayInSec:n,targets:null};this.escalationsFormGroup.get("escalations").push(this.fb.control(t,[]),{emitEvent:!1})}validate(n){return this.escalationsFormGroup.valid?null:{escalation:{valid:!1}}}updateModel(){const n={};this.escalationsFormGroup.get("escalations").value.forEach(t=>n[t.delayInSec/1e3]=t.targets),this.propagateChange(n)}}nt.\u0275fac=function(n){return new(n||nt)(e.\u0275\u0275directiveInject(x.Store),e.\u0275\u0275directiveInject(r.FormBuilder))},nt.\u0275cmp=e.\u0275\u0275defineComponent({type:nt,selectors:[["tb-escalations-component"]],inputs:{required:"required",disabled:"disabled"},features:[e.\u0275\u0275ProvidersFeature([{provide:r.NG_VALUE_ACCESSOR,useExisting:(0,e.forwardRef)(()=>nt),multi:!0},{provide:r.NG_VALIDATORS,useExisting:(0,e.forwardRef)(()=>nt),multi:!0}])],decls:4,vars:3,consts:[["fxLayout","column"],["class","tb-tenant-profile-queues","fxLayout","row","style","align-items: center",3,"ngStyle",4,"ngFor","ngForOf"],[4,"ngIf"],["style","padding: 16px 0;",4,"ngIf"],["fxLayout","row",1,"tb-tenant-profile-queues",2,"align-items","center",3,"ngStyle"],["fxFlex","",3,"formControl","systemEscalation"],["style","width: 48px;",4,"ngIf"],["mat-icon-button","","style","min-width: 40px;","type","button","matTooltipPosition","above",3,"matTooltip","click",4,"ngIf"],[2,"width","48px"],["mat-icon-button","","type","button","matTooltipPosition","above",2,"min-width","40px",3,"matTooltip","click"],["translate","","fxLayoutAlign","center center",1,"tb-prompt"],[2,"padding","16px 0"],["mat-raised-button","","color","primary","type","button",3,"click"],["translate",""]],template:function(n,t){1&n&&(e.\u0275\u0275elementStart(0,"div",0),e.\u0275\u0275template(1,x1,4,7,"div",1),e.\u0275\u0275template(2,C1,3,0,"div",2),e.\u0275\u0275template(3,T1,4,0,"div",3),e.\u0275\u0275elementEnd()),2&n&&(e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",t.escalationsFormArray.controls),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!t.escalationsFormArray.controls.length),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!t.disabled))},dependencies:[p.NgForOf,p.NgIf,p.NgStyle,S.MatButton,S.MatIconButton,F.MatIcon,Ln.MatTooltip,h.DefaultLayoutDirective,h.DefaultLayoutAlignDirective,h.DefaultFlexDirective,G.DefaultStyleDirective,r.NgControlStatus,r.FormControlDirective,g.TranslateDirective,wn,g.TranslatePipe],encapsulation:2}),(0,gt.__decorate)([(0,qa.coerceBoolean)(),(0,gt.__metadata)("design:type",Boolean)],nt.prototype,"required",void 0);const S1=["addNotificationRule"];function I1(i,n){1&i&&e.\u0275\u0275element(0,"mat-progress-bar",29)}function w1(i,n){1&i&&e.\u0275\u0275element(0,"div",30)}function E1(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-icon"),e.\u0275\u0275text(1,"check"),e.\u0275\u0275elementEnd())}function M1(i,n){1&i&&(e.\u0275\u0275text(0),e.\u0275\u0275pipe(1,"translate")),2&i&&e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(1,1,"notification.basic-settings"))}function D1(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"notification.rule-name-required")," "))}function A1(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-option",31),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i){const t=n.$implicit,a=e.\u0275\u0275nextContext();e.\u0275\u0275property("value",t),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,2,a.triggerTypeTranslationMap.get(t))," ")}}function N1(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"notification.trigger.trigger-required")," "))}function F1(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"section",32)(1,"tb-entity-list",33),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementStart(3,"button",34,35),e.\u0275\u0275listener("click",function(o){e.\u0275\u0275restoreView(t);const s=e.\u0275\u0275reference(4),l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.createTarget(o,s))}),e.\u0275\u0275elementStart(5,"span",36),e.\u0275\u0275text(6),e.\u0275\u0275pipe(7,"translate"),e.\u0275\u0275elementEnd()()()()}if(2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275propertyInterpolate("subType",t.ruleNotificationForm.get("triggerType").value),e.\u0275\u0275propertyInterpolate("entityType",t.entityType.NOTIFICATION_TARGET),e.\u0275\u0275propertyInterpolate("placeholderText",e.\u0275\u0275pipeBind1(2,4,"notification.recipient")),e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(7,6,"notification.create-new"))}}function L1(i,n){1&i&&e.\u0275\u0275elementContainer(0)}function P1(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"fieldset",37)(1,"legend",15),e.\u0275\u0275text(2,"notification.escalation-chain"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"div",38),e.\u0275\u0275text(4,"notification.recipients"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(5,"tb-escalations-component",39),e.\u0275\u0275template(6,L1,1,0,"ng-container",40),e.\u0275\u0275elementEnd()),2&i){e.\u0275\u0275nextContext();const t=e.\u0275\u0275reference(40);e.\u0275\u0275advance(6),e.\u0275\u0275property("ngTemplateOutlet",t)}}function k1(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-option",31),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i){const t=n.$implicit,a=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("value",t),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,2,a.alarmSearchStatusTranslationMap.get(t))," ")}}function R1(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"form",13)(1,"section",41)(2,"section",42)(3,"div",38),e.\u0275\u0275text(4,"notification.stop-escalation-alarm-status-become"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"mat-form-field",43)(6,"mat-label",15),e.\u0275\u0275text(7,"alarm.alarm-status-list"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(8,"mat-select",44),e.\u0275\u0275pipe(9,"translate"),e.\u0275\u0275template(10,k1,3,4,"mat-option",20),e.\u0275\u0275elementEnd()()()()()),2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275property("formGroup",t.alarmTemplateForm),e.\u0275\u0275advance(8),e.\u0275\u0275propertyInterpolate("placeholder",null!=t.alarmTemplateForm.get("triggerConfig.clearRule.alarmStatuses").value&&t.alarmTemplateForm.get("triggerConfig.clearRule.alarmStatuses").value.length?"":e.\u0275\u0275pipeBind1(9,3,"alarm.any-status")),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",t.alarmSearchStatuses)}}function O1(i,n){1&i&&(e.\u0275\u0275text(0),e.\u0275\u0275pipe(1,"translate")),2&i&&e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(1,1,"notification.alarm-trigger-settings"))}function B1(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-option",31),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i){const t=n.$implicit,a=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("value",t),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,2,a.alarmSeverityTranslationMap.get(t))," ")}}function V1(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-option",31),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i){const t=n.$implicit,a=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("value",t),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,2,a.alarmActionTranslationMap.get(t))," ")}}function U1(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"notification.notify-on-required")," "))}function G1(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-step",11),e.\u0275\u0275template(1,O1,2,3,"ng-template",12),e.\u0275\u0275elementStart(2,"form",13)(3,"section",41)(4,"fieldset",45)(5,"legend",15),e.\u0275\u0275text(6,"notification.filter"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(7,"tb-string-items-list",46),e.\u0275\u0275pipe(8,"translate"),e.\u0275\u0275pipe(9,"translate"),e.\u0275\u0275elementStart(10,"mat-form-field",47)(11,"mat-label",15),e.\u0275\u0275text(12,"alarm.alarm-severity-list"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(13,"mat-select",48),e.\u0275\u0275pipe(14,"translate"),e.\u0275\u0275template(15,B1,3,4,"mat-option",20),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(16,"mat-form-field",49)(17,"mat-label",15),e.\u0275\u0275text(18,"notification.notify-on"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(19,"mat-select",50),e.\u0275\u0275template(20,V1,3,4,"mat-option",20),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(21,U1,3,3,"mat-error",17),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(22,"form",13)(23,"section",51)(24,"mat-form-field",14)(25,"mat-label",15),e.\u0275\u0275text(26,"notification.description"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(27,"input",52),e.\u0275\u0275elementEnd()()()()),2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275property("stepControl",t.alarmTemplateForm),e.\u0275\u0275advance(2),e.\u0275\u0275property("formGroup",t.alarmTemplateForm),e.\u0275\u0275advance(5),e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(8,9,"alarm.alarm-type-list")),e.\u0275\u0275propertyInterpolate("placeholder",null!=t.alarmTemplateForm.get("triggerConfig.alarmTypes").value&&t.alarmTemplateForm.get("triggerConfig.alarmTypes").value.length?"":e.\u0275\u0275pipeBind1(9,11,"alarm.any-type")),e.\u0275\u0275advance(6),e.\u0275\u0275propertyInterpolate("placeholder",null!=t.alarmTemplateForm.get("triggerConfig.alarmSeverities").value&&t.alarmTemplateForm.get("triggerConfig.alarmSeverities").value.length?"":e.\u0275\u0275pipeBind1(14,13,"alarm.any-severity")),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",t.alarmSeverities),e.\u0275\u0275advance(5),e.\u0275\u0275property("ngForOf",t.alarmActions),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.alarmTemplateForm.get("triggerConfig.notifyOn").hasError("required")),e.\u0275\u0275advance(1),e.\u0275\u0275property("formGroup",t.ruleNotificationForm)}}function j1(i,n){1&i&&(e.\u0275\u0275text(0),e.\u0275\u0275pipe(1,"translate")),2&i&&e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(1,1,"notification.device-activity-trigger-settings"))}function W1(i,n){if(1&i&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275element(1,"tb-entity-list",58),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275pipe(3,"translate"),e.\u0275\u0275pipe(4,"translate"),e.\u0275\u0275elementContainerEnd()),2&i){const t=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275propertyInterpolate("labelText",e.\u0275\u0275pipeBind1(2,4,"device.devices")),e.\u0275\u0275propertyInterpolate("placeholderText",e.\u0275\u0275pipeBind1(3,6,"device.devices")),e.\u0275\u0275propertyInterpolate("hint",e.\u0275\u0275pipeBind1(4,8,"notification.device-list-rule-hint")),e.\u0275\u0275property("entityType",t.entityType.DEVICE)}}function q1(i,n){if(1&i&&(e.\u0275\u0275element(0,"tb-entity-list",59),e.\u0275\u0275pipe(1,"translate"),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275pipe(3,"translate")),2&i){const t=e.\u0275\u0275nextContext(2);e.\u0275\u0275propertyInterpolate("labelText",e.\u0275\u0275pipeBind1(1,4,"device-profile.device-profiles")),e.\u0275\u0275propertyInterpolate("placeholderText",e.\u0275\u0275pipeBind1(2,6,"device-profile.device-profiles")),e.\u0275\u0275propertyInterpolate("hint",e.\u0275\u0275pipeBind1(3,8,"notification.device-profiles-list-rule-hint")),e.\u0275\u0275property("entityType",t.entityType.DEVICE_PROFILE)}}function $1(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-option",31),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i){const t=n.$implicit,a=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("value",t),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,2,a.deviceEventTranslationMap.get(t))," ")}}function H1(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"notification.notify-on-required")," "))}function z1(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-step",11),e.\u0275\u0275template(1,j1,2,3,"ng-template",12),e.\u0275\u0275elementStart(2,"form",13)(3,"section",41)(4,"div",53)(5,"mat-button-toggle-group",54)(6,"mat-button-toggle",55),e.\u0275\u0275text(7),e.\u0275\u0275pipe(8,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(9,"mat-button-toggle",55),e.\u0275\u0275text(10),e.\u0275\u0275pipe(11,"translate"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275template(12,W1,5,10,"ng-container",56),e.\u0275\u0275template(13,q1,4,10,"ng-template",null,57,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementStart(15,"mat-form-field",49)(16,"mat-label",15),e.\u0275\u0275text(17,"notification.notify-on"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(18,"mat-select",50),e.\u0275\u0275template(19,$1,3,4,"mat-option",20),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(20,H1,3,3,"mat-error",17),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(21,"form",13)(22,"section",51)(23,"mat-form-field",14)(24,"mat-label",15),e.\u0275\u0275text(25,"notification.description"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(26,"input",52),e.\u0275\u0275elementEnd()()()()),2&i){const t=e.\u0275\u0275reference(14),a=e.\u0275\u0275nextContext();e.\u0275\u0275property("stepControl",a.deviceInactivityTemplateForm),e.\u0275\u0275advance(2),e.\u0275\u0275property("formGroup",a.deviceInactivityTemplateForm),e.\u0275\u0275advance(4),e.\u0275\u0275property("value",!0),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(8,11,"device.device")),e.\u0275\u0275advance(2),e.\u0275\u0275property("value",!1),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(11,13,"device-profile.device-profile")),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",a.deviceInactivityTemplateForm.get("triggerConfig.filterByDevice").value)("ngIfElse",t),e.\u0275\u0275advance(7),e.\u0275\u0275property("ngForOf",a.deviceEvents),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",a.deviceInactivityTemplateForm.get("triggerConfig.notifyOn").hasError("required")),e.\u0275\u0275advance(1),e.\u0275\u0275property("formGroup",a.ruleNotificationForm)}}function K1(i,n){1&i&&(e.\u0275\u0275text(0),e.\u0275\u0275pipe(1,"translate")),2&i&&e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(1,1,"notification.entity-action-trigger-settings"))}function Y1(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-step",11),e.\u0275\u0275template(1,K1,2,3,"ng-template",12),e.\u0275\u0275elementStart(2,"form",13)(3,"fieldset",60)(4,"legend",15),e.\u0275\u0275text(5,"notification.filter"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(6,"tb-entity-type-list",61),e.\u0275\u0275elementStart(7,"section",62)(8,"span",63),e.\u0275\u0275text(9,"notification.status"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(10,"mat-slide-toggle",64),e.\u0275\u0275text(11),e.\u0275\u0275pipe(12,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(13,"mat-slide-toggle",65),e.\u0275\u0275text(14),e.\u0275\u0275pipe(15,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(16,"mat-slide-toggle",66),e.\u0275\u0275text(17),e.\u0275\u0275pipe(18,"translate"),e.\u0275\u0275elementEnd()()()(),e.\u0275\u0275elementStart(19,"form",13)(20,"section",51)(21,"mat-form-field",14)(22,"mat-label",15),e.\u0275\u0275text(23,"notification.description"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(24,"input",52),e.\u0275\u0275elementEnd()()()()),2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275property("stepControl",t.entityActionTemplateForm),e.\u0275\u0275advance(2),e.\u0275\u0275property("formGroup",t.entityActionTemplateForm),e.\u0275\u0275advance(4),e.\u0275\u0275property("allowedEntityTypes",t.allowEntityTypeForEntityAction),e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(12,7,"notification.created")),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(15,9,"notification.updated")),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(18,11,"notification.deleted")),e.\u0275\u0275advance(2),e.\u0275\u0275property("formGroup",t.ruleNotificationForm)}}function J1(i,n){1&i&&(e.\u0275\u0275text(0),e.\u0275\u0275pipe(1,"translate")),2&i&&e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(1,1,"notification.alarm-comment-trigger-settings"))}function Q1(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-option",31),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i){const t=n.$implicit,a=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("value",t),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,2,a.alarmSeverityTranslationMap.get(t))," ")}}function X1(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-option",31),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i){const t=n.$implicit,a=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("value",t),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,2,a.alarmSearchStatusTranslationMap.get(t))," ")}}function Z1(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-step",11),e.\u0275\u0275template(1,J1,2,3,"ng-template",12),e.\u0275\u0275elementStart(2,"form",13)(3,"section",41)(4,"fieldset",67)(5,"legend",15),e.\u0275\u0275text(6,"notification.filter"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(7,"tb-string-items-list",46),e.\u0275\u0275pipe(8,"translate"),e.\u0275\u0275pipe(9,"translate"),e.\u0275\u0275elementStart(10,"mat-form-field",47)(11,"mat-label",15),e.\u0275\u0275text(12,"alarm.alarm-severity-list"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(13,"mat-select",48),e.\u0275\u0275pipe(14,"translate"),e.\u0275\u0275template(15,Q1,3,4,"mat-option",20),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(16,"mat-form-field",47)(17,"mat-label",15),e.\u0275\u0275text(18,"alarm.alarm-status-list"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(19,"mat-select",44),e.\u0275\u0275pipe(20,"translate"),e.\u0275\u0275template(21,X1,3,4,"mat-option",20),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(22,"section",68)(23,"mat-slide-toggle",69),e.\u0275\u0275text(24),e.\u0275\u0275pipe(25,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(26,"mat-slide-toggle",70),e.\u0275\u0275text(27),e.\u0275\u0275pipe(28,"translate"),e.\u0275\u0275elementEnd()()()(),e.\u0275\u0275elementStart(29,"form",13)(30,"section",51)(31,"mat-form-field",14)(32,"mat-label",15),e.\u0275\u0275text(33,"notification.description"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(34,"input",52),e.\u0275\u0275elementEnd()()()()),2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275property("stepControl",t.alarmCommentTemplateForm),e.\u0275\u0275advance(2),e.\u0275\u0275property("formGroup",t.alarmCommentTemplateForm),e.\u0275\u0275advance(5),e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(8,11,"alarm.alarm-type-list")),e.\u0275\u0275propertyInterpolate("placeholder",null!=t.alarmCommentTemplateForm.get("triggerConfig.alarmTypes").value&&t.alarmCommentTemplateForm.get("triggerConfig.alarmTypes").value.length?"":e.\u0275\u0275pipeBind1(9,13,"alarm.any-type")),e.\u0275\u0275advance(6),e.\u0275\u0275propertyInterpolate("placeholder",null!=t.alarmCommentTemplateForm.get("triggerConfig.alarmSeverities").value&&t.alarmCommentTemplateForm.get("triggerConfig.alarmSeverities").value.length?"":e.\u0275\u0275pipeBind1(14,15,"alarm.any-severity")),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",t.alarmSeverities),e.\u0275\u0275advance(4),e.\u0275\u0275propertyInterpolate("placeholder",null!=t.alarmCommentTemplateForm.get("triggerConfig.alarmStatuses").value&&t.alarmCommentTemplateForm.get("triggerConfig.alarmStatuses").value.length?"":e.\u0275\u0275pipeBind1(20,17,"alarm.any-status")),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",t.alarmSearchStatuses),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(25,19,"notification.notify-only-user-comments")," "),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(28,21,"notification.notify-on-comment-update")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("formGroup",t.ruleNotificationForm)}}function e_(i,n){1&i&&(e.\u0275\u0275text(0),e.\u0275\u0275pipe(1,"translate")),2&i&&e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(1,1,"notification.alarm-assignment-trigger-settings"))}function t_(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-option",31),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i){const t=n.$implicit,a=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("value",t),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,2,a.alarmSeverityTranslationMap.get(t))," ")}}function n_(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-option",31),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i){const t=n.$implicit,a=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("value",t),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,2,a.alarmSearchStatusTranslationMap.get(t))," ")}}function i_(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-option",31),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i){const t=n.$implicit,a=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("value",t),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,2,a.alarmAssignmentActionTranslationMap.get(t))," ")}}function a_(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"notification.notify-on-required")," "))}function o_(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-step",11),e.\u0275\u0275template(1,e_,2,3,"ng-template",12),e.\u0275\u0275elementStart(2,"form",13)(3,"section",41)(4,"fieldset",67)(5,"legend",15),e.\u0275\u0275text(6,"notification.filter"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(7,"tb-string-items-list",46),e.\u0275\u0275pipe(8,"translate"),e.\u0275\u0275pipe(9,"translate"),e.\u0275\u0275elementStart(10,"mat-form-field",47)(11,"mat-label",15),e.\u0275\u0275text(12,"alarm.alarm-severity-list"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(13,"mat-select",48),e.\u0275\u0275pipe(14,"translate"),e.\u0275\u0275template(15,t_,3,4,"mat-option",20),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(16,"mat-form-field",47)(17,"mat-label",15),e.\u0275\u0275text(18,"alarm.alarm-status-list"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(19,"mat-select",44),e.\u0275\u0275pipe(20,"translate"),e.\u0275\u0275template(21,n_,3,4,"mat-option",20),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(22,"mat-form-field",49)(23,"mat-label",15),e.\u0275\u0275text(24,"notification.notify-on"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(25,"mat-select",50),e.\u0275\u0275template(26,i_,3,4,"mat-option",20),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(27,a_,3,3,"mat-error",17),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(28,"form",13)(29,"section",51)(30,"mat-form-field",14)(31,"mat-label",15),e.\u0275\u0275text(32,"notification.description"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(33,"input",52),e.\u0275\u0275elementEnd()()()()),2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275property("stepControl",t.alarmAssignmentTemplateForm),e.\u0275\u0275advance(2),e.\u0275\u0275property("formGroup",t.alarmAssignmentTemplateForm),e.\u0275\u0275advance(5),e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(8,11,"alarm.alarm-type-list")),e.\u0275\u0275propertyInterpolate("placeholder",null!=t.alarmAssignmentTemplateForm.get("triggerConfig.alarmTypes").value&&t.alarmAssignmentTemplateForm.get("triggerConfig.alarmTypes").value.length?"":e.\u0275\u0275pipeBind1(9,13,"alarm.any-type")),e.\u0275\u0275advance(6),e.\u0275\u0275propertyInterpolate("placeholder",null!=t.alarmAssignmentTemplateForm.get("triggerConfig.alarmSeverities").value&&t.alarmAssignmentTemplateForm.get("triggerConfig.alarmSeverities").value.length?"":e.\u0275\u0275pipeBind1(14,15,"alarm.any-severity")),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",t.alarmSeverities),e.\u0275\u0275advance(4),e.\u0275\u0275propertyInterpolate("placeholder",null!=t.alarmAssignmentTemplateForm.get("triggerConfig.alarmStatuses").value&&t.alarmAssignmentTemplateForm.get("triggerConfig.alarmStatuses").value.length?"":e.\u0275\u0275pipeBind1(20,17,"alarm.any-status")),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",t.alarmSearchStatuses),e.\u0275\u0275advance(5),e.\u0275\u0275property("ngForOf",t.alarmAssignmentActions),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.alarmAssignmentTemplateForm.get("triggerConfig.notifyOn").hasError("required")),e.\u0275\u0275advance(1),e.\u0275\u0275property("formGroup",t.ruleNotificationForm)}}function r_(i,n){1&i&&(e.\u0275\u0275text(0),e.\u0275\u0275pipe(1,"translate")),2&i&&e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(1,1,"notification.rule-engine-events-trigger-settings"))}function s_(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-option",31),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i){const t=n.$implicit,a=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("value",t),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,2,a.componentLifecycleEventTranslationMap.get(t))," ")}}function l_(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-option",31),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i){const t=n.$implicit,a=e.\u0275\u0275nextContext(3);e.\u0275\u0275property("value",t),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,2,a.componentLifecycleEventTranslationMap.get(t))," ")}}function d_(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"section")(1,"mat-form-field",47)(2,"mat-label",15),e.\u0275\u0275text(3,"rulenode.rule-node-events"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"mat-select",75),e.\u0275\u0275pipe(5,"translate"),e.\u0275\u0275template(6,l_,3,4,"mat-option",20),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(7,"mat-slide-toggle",76),e.\u0275\u0275text(8),e.\u0275\u0275pipe(9,"translate"),e.\u0275\u0275elementEnd()()),2&i){const t=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(4),e.\u0275\u0275propertyInterpolate("placeholder",null!=t.ruleEngineEventsTemplateForm.get("triggerConfig.ruleNodeEvents").value&&t.ruleEngineEventsTemplateForm.get("triggerConfig.ruleNodeEvents").value.length?"":e.\u0275\u0275pipeBind1(5,3,"event.all-events")),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",t.componentLifecycleEvents),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(9,5,"notification.only-rule-node-lifecycle-failures")," ")}}function c_(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-step",11),e.\u0275\u0275template(1,r_,2,3,"ng-template",12),e.\u0275\u0275elementStart(2,"form",13)(3,"section",41)(4,"fieldset",67)(5,"legend",15),e.\u0275\u0275text(6,"notification.rule-engine-filter"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(7,"tb-entity-list",71),e.\u0275\u0275pipe(8,"translate"),e.\u0275\u0275pipe(9,"translate"),e.\u0275\u0275pipe(10,"translate"),e.\u0275\u0275elementStart(11,"mat-form-field",47)(12,"mat-label",15),e.\u0275\u0275text(13,"rulechain.rulechain-events"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(14,"mat-select",72),e.\u0275\u0275pipe(15,"translate"),e.\u0275\u0275template(16,s_,3,4,"mat-option",20),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(17,"mat-slide-toggle",73),e.\u0275\u0275text(18),e.\u0275\u0275pipe(19,"translate"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(20,"fieldset",67)(21,"legend",15),e.\u0275\u0275text(22,"notification.rule-node-filter"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(23,"mat-slide-toggle",74),e.\u0275\u0275text(24),e.\u0275\u0275pipe(25,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(26,d_,10,7,"section",17),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(27,"form",13)(28,"section",51)(29,"mat-form-field",14)(30,"mat-label",15),e.\u0275\u0275text(31,"notification.description"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(32,"input",52),e.\u0275\u0275elementEnd()()()()),2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275property("stepControl",t.ruleEngineEventsTemplateForm),e.\u0275\u0275advance(2),e.\u0275\u0275property("formGroup",t.ruleEngineEventsTemplateForm),e.\u0275\u0275advance(5),e.\u0275\u0275propertyInterpolate("labelText",e.\u0275\u0275pipeBind1(8,12,"rulechain.rulechains")),e.\u0275\u0275propertyInterpolate("placeholderText",e.\u0275\u0275pipeBind1(9,14,"rulechain.rulechains")),e.\u0275\u0275propertyInterpolate("hint",e.\u0275\u0275pipeBind1(10,16,"notification.rule-chain-list-rule-hint")),e.\u0275\u0275property("entityType",t.entityType.RULE_CHAIN),e.\u0275\u0275advance(7),e.\u0275\u0275propertyInterpolate("placeholder",null!=t.ruleEngineEventsTemplateForm.get("triggerConfig.ruleChainEvents").value&&t.ruleEngineEventsTemplateForm.get("triggerConfig.ruleChainEvents").value.length?"":e.\u0275\u0275pipeBind1(15,18,"event.all-events")),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",t.componentLifecycleEvents),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(19,20,"notification.only-rule-chain-lifecycle-failures")," "),e.\u0275\u0275advance(6),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(25,22,"notification.track-rule-node-events")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",t.ruleEngineEventsTemplateForm.get("triggerConfig.trackRuleNodeEvents").value),e.\u0275\u0275advance(1),e.\u0275\u0275property("formGroup",t.ruleNotificationForm)}}function p_(i,n){1&i&&(e.\u0275\u0275text(0),e.\u0275\u0275pipe(1,"translate")),2&i&&e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(1,1,"notification.entities-limit-trigger-settings"))}function m_(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-step",11),e.\u0275\u0275template(1,p_,2,3,"ng-template",12),e.\u0275\u0275elementStart(2,"form",13)(3,"fieldset",60)(4,"legend",15),e.\u0275\u0275text(5,"notification.filter"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(6,"tb-entity-type-list",77),e.\u0275\u0275elementStart(7,"div",78)(8,"label",15),e.\u0275\u0275text(9,"notification.threshold"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(10,"div",79)(11,"mat-slider",80),e.\u0275\u0275element(12,"input",81),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(13,"mat-form-field",82),e.\u0275\u0275element(14,"input",83),e.\u0275\u0275elementEnd()()()()(),e.\u0275\u0275elementStart(15,"form",13)(16,"section",51)(17,"mat-form-field",14)(18,"mat-label",15),e.\u0275\u0275text(19,"notification.description"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(20,"input",52),e.\u0275\u0275elementEnd()()()()),2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275property("stepControl",t.entitiesLimitTemplateForm),e.\u0275\u0275advance(2),e.\u0275\u0275property("formGroup",t.entitiesLimitTemplateForm),e.\u0275\u0275advance(4),e.\u0275\u0275property("allowedEntityTypes",t.allowEntityTypeForEntitiesLimit),e.\u0275\u0275advance(5),e.\u0275\u0275property("displayWith",t.formatLabel),e.\u0275\u0275advance(3),e.\u0275\u0275property("value",t.entitiesLimitTemplateForm.get("triggerConfig.threshold").value),e.\u0275\u0275advance(1),e.\u0275\u0275property("formGroup",t.ruleNotificationForm)}}function u_(i,n){1&i&&(e.\u0275\u0275text(0),e.\u0275\u0275pipe(1,"translate")),2&i&&e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(1,1,"notification.api-usage-trigger-settings"))}function g_(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-option",31),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i){const t=n.$implicit,a=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("value",t),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,2,a.apiFeatureTranslationMap.get(t))," ")}}function f_(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-option",31),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i){const t=n.$implicit,a=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("value",t),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,2,a.apiUsageStateValueTranslationMap.get(t))," ")}}function h_(i,n){1&i&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()),2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(2,1,"notification.notify-on-required")," "))}function b_(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-step",11),e.\u0275\u0275template(1,u_,2,3,"ng-template",12),e.\u0275\u0275elementStart(2,"form",13)(3,"section",41)(4,"mat-form-field",84)(5,"mat-label",15),e.\u0275\u0275text(6,"api-usage.api-features"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(7,"mat-select",85),e.\u0275\u0275template(8,g_,3,4,"mat-option",20),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(9,"mat-hint"),e.\u0275\u0275text(10),e.\u0275\u0275pipe(11,"translate"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(12,"mat-form-field",49)(13,"mat-label",15),e.\u0275\u0275text(14,"notification.notify-on"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(15,"mat-select",50),e.\u0275\u0275template(16,f_,3,4,"mat-option",20),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(17,h_,3,3,"mat-error",17),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(18,"form",13)(19,"section",51)(20,"mat-form-field",14)(21,"mat-label",15),e.\u0275\u0275text(22,"notification.description"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(23,"input",52),e.\u0275\u0275elementEnd()()()()),2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275property("stepControl",t.apiUsageLimitTemplateForm),e.\u0275\u0275advance(2),e.\u0275\u0275property("formGroup",t.apiUsageLimitTemplateForm),e.\u0275\u0275advance(6),e.\u0275\u0275property("ngForOf",t.apiFeatures),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(11,7,"notification.api-feature-hint")),e.\u0275\u0275advance(6),e.\u0275\u0275property("ngForOf",t.apiUsageStateValues),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.apiUsageLimitTemplateForm.get("triggerConfig.notifyOn").hasError("required")),e.\u0275\u0275advance(1),e.\u0275\u0275property("formGroup",t.ruleNotificationForm)}}function y_(i,n){1&i&&(e.\u0275\u0275text(0),e.\u0275\u0275pipe(1,"translate")),2&i&&e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(1,1,"notification.new-platform-version-trigger-settings"))}function v_(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-step",11),e.\u0275\u0275template(1,y_,2,3,"ng-template",12),e.\u0275\u0275elementStart(2,"form",13)(3,"section",51)(4,"mat-form-field",14)(5,"mat-label",15),e.\u0275\u0275text(6,"notification.description"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(7,"input",52),e.\u0275\u0275elementEnd()()()()),2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275property("stepControl",t.newPlatformVersionTemplateForm),e.\u0275\u0275advance(2),e.\u0275\u0275property("formGroup",t.ruleNotificationForm)}}function __(i,n){1&i&&(e.\u0275\u0275text(0),e.\u0275\u0275pipe(1,"translate")),2&i&&e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(1,1,"notification.rate-limits-trigger-settings"))}function x_(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"mat-step",11),e.\u0275\u0275template(1,__,2,3,"ng-template",12),e.\u0275\u0275elementStart(2,"form",13)(3,"section",41),e.\u0275\u0275element(4,"tb-string-items-list",86),e.\u0275\u0275pipe(5,"translate"),e.\u0275\u0275pipe(6,"translate"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(7,"form",13)(8,"section",51)(9,"mat-form-field",14)(10,"mat-label",15),e.\u0275\u0275text(11,"notification.description"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(12,"input",52),e.\u0275\u0275elementEnd()()()()),2&i){const t=e.\u0275\u0275nextContext();e.\u0275\u0275property("stepControl",t.rateLimitsTemplateForm),e.\u0275\u0275advance(2),e.\u0275\u0275property("formGroup",t.rateLimitsTemplateForm),e.\u0275\u0275advance(2),e.\u0275\u0275propertyInterpolate("label",e.\u0275\u0275pipeBind1(5,6,"notification.rate-limits")),e.\u0275\u0275propertyInterpolate("hint",e.\u0275\u0275pipeBind1(6,8,"notification.api-feature-hint")),e.\u0275\u0275property("predefinedValues",t.limitedApis),e.\u0275\u0275advance(3),e.\u0275\u0275property("formGroup",t.ruleNotificationForm)}}function C_(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",87),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const o=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(o.backStep())}),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"translate"),e.\u0275\u0275elementEnd()}2&i&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(2,1,"action.back")))}class Aa extends le.a{constructor(n,t,a,o,s,l,d,m,y){super(n,t,a),this.store=n,this.router=t,this.dialogRef=a,this.data=o,this.breakpointObserver=s,this.fb=l,this.translate=d,this.notificationService=m,this.dialog=y,this.triggerType=D.zn,this.triggerTypeTranslationMap=D.PA,this.alarmSearchStatuses=[vn.rk.ACTIVE,vn.rk.CLEARED,vn.rk.ACK,vn.rk.UNACK],this.alarmSearchStatusTranslationMap=vn.Vt,this.alarmSeverityTranslationMap=vn.vZ,this.alarmSeverities=Object.keys(vn.Xm),this.alarmActions=Object.values(D.iu),this.alarmActionTranslationMap=D.OA,this.alarmAssignmentActions=Object.values(D.Qp),this.alarmAssignmentActionTranslationMap=D.ll,this.componentLifecycleEvents=Object.values(D.Uu),this.componentLifecycleEventTranslationMap=D.kz,this.deviceEvents=Object.values(D.Xf),this.deviceEventTranslationMap=D.KX,this.apiUsageStateValues=Object.values(Va.Oi),this.apiUsageStateValueTranslationMap=Va.lF,this.apiFeatures=Object.values(Va.TV),this.apiFeatureTranslationMap=Va.CT,this.entityType=f.py,this.isAdd=!0,this.allowEntityTypeForEntitiesLimit=[f.py.DEVICE,f.py.ASSET,f.py.CUSTOMER,f.py.USER,f.py.DASHBOARD,f.py.RULE_CHAIN],this.selectedIndex=0,this.dialogTitle="notification.edit-rule",this.destroy$=new be.x,this.authState=(0,q.dE)(this.store),this.authUser=this.authState.authUser,this.triggerTypes=this.allowTriggerTypes(),(0,T.$K)(o.isAdd)&&(this.isAdd=o.isAdd),this.limitedApis=Object.values(xr.u).map(I=>({name:this.translate.instant(xr.P.get(I)),value:I})),this.stepperOrientation=this.breakpointObserver.observe(Ri.tr["gt-xs"]).pipe((0,re.U)(({matches:I})=>I?"horizontal":"vertical")),this.ruleNotificationForm=this.fb.group({name:[null,r.Validators.required],enabled:[!0,r.Validators.required],templateId:[null,r.Validators.required],triggerType:[this.isSysAdmin()?D.zn.ENTITIES_LIMIT:D.zn.ALARM,r.Validators.required],recipientsConfig:this.fb.group({targets:[{value:null,disabled:!this.isSysAdmin()},r.Validators.required],escalationTable:[{value:null,disabled:this.isSysAdmin()},r.Validators.required]}),triggerConfig:[null],additionalConfig:this.fb.group({description:[""]})}),this.ruleNotificationForm.get("triggerType").valueChanges.pipe((0,Y.R)(this.destroy$)).subscribe(I=>{I===D.zn.ALARM?(this.ruleNotificationForm.get("recipientsConfig.escalationTable").enable({emitEvent:!1}),this.ruleNotificationForm.get("recipientsConfig.targets").disable({emitEvent:!1})):(this.ruleNotificationForm.get("recipientsConfig.escalationTable").disable({emitEvent:!1}),this.ruleNotificationForm.get("recipientsConfig.targets").enable({emitEvent:!1}))}),this.ruleNotificationForm.get("recipientsConfig.escalationTable").valueChanges.pipe((0,Y.R)(this.destroy$)).subscribe(()=>{this.countRecipientsChainConfig()>1?this.alarmTemplateForm.get("triggerConfig.clearRule").enable({emitEvent:!1}):this.alarmTemplateForm.get("triggerConfig.clearRule").disable({emitEvent:!1})}),this.alarmTemplateForm=this.fb.group({triggerConfig:this.fb.group({alarmTypes:[null],alarmSeverities:[[]],clearRule:this.fb.group({alarmStatuses:[[]]}),notifyOn:[[D.iu.CREATED],r.Validators.required]})}),this.deviceInactivityTemplateForm=this.fb.group({triggerConfig:this.fb.group({filterByDevice:[!0],devices:[null],deviceProfiles:[{value:null,disabled:!0}],notifyOn:[[D.Xf.INACTIVE],r.Validators.required]})}),this.deviceInactivityTemplateForm.get("triggerConfig.filterByDevice").valueChanges.pipe((0,Y.R)(this.destroy$)).subscribe(I=>{I?(this.deviceInactivityTemplateForm.get("triggerConfig.devices").enable({emitEvent:!1}),this.deviceInactivityTemplateForm.get("triggerConfig.deviceProfiles").disable({emitEvent:!1})):(this.deviceInactivityTemplateForm.get("triggerConfig.deviceProfiles").enable({emitEvent:!1}),this.deviceInactivityTemplateForm.get("triggerConfig.devices").disable({emitEvent:!1}))}),this.entityActionTemplateForm=this.fb.group({triggerConfig:this.fb.group({entityTypes:[[f.py.DEVICE],r.Validators.required],created:[!1],updated:[!1],deleted:[!1]})}),this.alarmCommentTemplateForm=this.fb.group({triggerConfig:this.fb.group({alarmTypes:[null],alarmSeverities:[[]],alarmStatuses:[[]],onlyUserComments:[!1],notifyOnCommentUpdate:[!1]})}),this.alarmAssignmentTemplateForm=this.fb.group({triggerConfig:this.fb.group({alarmTypes:[null],alarmSeverities:[[]],alarmStatuses:[[]],notifyOn:[[D.Qp.ASSIGNED],r.Validators.required]})}),this.ruleEngineEventsTemplateForm=this.fb.group({triggerConfig:this.fb.group({ruleChains:[null],ruleChainEvents:[null],onlyRuleChainLifecycleFailures:[!1],trackRuleNodeEvents:[!1],ruleNodeEvents:[null],onlyRuleNodeLifecycleFailures:[!1]})}),this.entitiesLimitTemplateForm=this.fb.group({triggerConfig:this.fb.group({entityTypes:[],threshold:[.8,[r.Validators.min(0),r.Validators.max(1)]]})}),this.apiUsageLimitTemplateForm=this.fb.group({triggerConfig:this.fb.group({apiFeatures:[[]],notifyOn:[[Va.Oi.WARNING],r.Validators.required]})}),this.newPlatformVersionTemplateForm=this.fb.group({triggerConfig:this.fb.group({})}),this.rateLimitsTemplateForm=this.fb.group({triggerConfig:this.fb.group({apis:[]})}),this.triggerTypeFormsMap=new Map([[D.zn.ALARM,this.alarmTemplateForm],[D.zn.ALARM_COMMENT,this.alarmCommentTemplateForm],[D.zn.DEVICE_ACTIVITY,this.deviceInactivityTemplateForm],[D.zn.ENTITY_ACTION,this.entityActionTemplateForm],[D.zn.ALARM_ASSIGNMENT,this.alarmAssignmentTemplateForm],[D.zn.RULE_ENGINE_COMPONENT_LIFECYCLE_EVENT,this.ruleEngineEventsTemplateForm],[D.zn.ENTITIES_LIMIT,this.entitiesLimitTemplateForm],[D.zn.API_USAGE_LIMIT,this.apiUsageLimitTemplateForm],[D.zn.NEW_PLATFORM_VERSION,this.newPlatformVersionTemplateForm],[D.zn.RATE_LIMITS,this.rateLimitsTemplateForm]]),(o.isAdd||o.isCopy)&&(this.dialogTitle="notification.add-rule"),this.ruleNotification=(0,T.I8)(this.data.rule),this.ruleNotification&&(this.data.isCopy?this.ruleNotification.name+=` (${this.translate.instant("action.copy")})`:this.ruleNotificationForm.get("triggerType").disable({emitEvent:!1}),this.ruleNotificationForm.reset({},{emitEvent:!1}),this.ruleNotificationForm.patchValue(this.ruleNotification,{emitEvent:!1}),this.ruleNotificationForm.get("triggerType").updateValueAndValidity({onlySelf:!0}),this.triggerTypeFormsMap.get(this.ruleNotification.triggerType).patchValue(this.ruleNotification,{emitEvent:!1}),this.ruleNotification.triggerType===D.zn.DEVICE_ACTIVITY&&this.deviceInactivityTemplateForm.get("triggerConfig.filterByDevice").patchValue(!!this.ruleNotification.triggerConfig.devices,{onlySelf:!0}))}ngOnDestroy(){super.ngOnDestroy(),this.destroy$.next(),this.destroy$.complete()}changeStep(n){this.selectedIndex=n.selectedIndex}backStep(){this.addNotificationRule.previous()}nextStep(){this.selectedIndex>=this.maxStepperIndex?this.add():this.addNotificationRule.next()}nextStepLabel(){return 0!==this.selectedIndex?this.data.isAdd||this.data.isCopy?"action.add":"action.save":"action.next"}get maxStepperIndex(){return this.addNotificationRule?._steps?.length-1}add(){if(this.allValid()){let n=this.ruleNotificationForm.value;const t=this.ruleNotificationForm.get("triggerType").value,a=this.triggerTypeFormsMap.get(t);Object.assign(n,a.value),t===D.zn.DEVICE_ACTIVITY&&delete n.triggerConfig.filterByDevice,n.recipientsConfig.triggerType=t,n.triggerConfig.triggerType=t,this.ruleNotification&&!this.data.isCopy&&(n={...this.ruleNotification,...n}),this.notificationService.saveNotificationRule((0,T.se)(n)).subscribe(o=>this.dialogRef.close(o))}}allValid(){return!this.addNotificationRule.steps.find((n,t)=>!!n.stepControl.invalid&&(n.interacted=!0,this.addNotificationRule.selectedIndex=t,!0))}cancel(){this.dialogRef.close(null)}createTarget(n,t){n&&n.stopPropagation(),t._elementRef.nativeElement.blur(),this.dialog.open(Za.U,{disableClose:!0,panelClass:["tb-dialog","tb-fullscreen-dialog"],data:{}}).afterClosed().subscribe(a=>{if(a){let o=this.ruleNotificationForm.get("recipientsConfig.targets").value;o||(o=[]),o.push(a.id.id),this.ruleNotificationForm.get("recipientsConfig.targets").patchValue(o)}})}countRecipientsChainConfig(){return Object.keys(this.ruleNotificationForm.get("recipientsConfig.escalationTable").value??{}).length}formatLabel(n){return`${(100*n).toFixed()}%`}isSysAdmin(){return this.authUser.authority===u.W.SYS_ADMIN}allowTriggerTypes(){const n=new Set([D.zn.ENTITIES_LIMIT,D.zn.API_USAGE_LIMIT,D.zn.NEW_PLATFORM_VERSION,D.zn.RATE_LIMITS]);return this.isSysAdmin()?Array.from(n):Object.values(D.zn).filter(t=>!n.has(t))}get allowEntityTypeForEntityAction(){if(!this._allowEntityTypeForEntityAction){const n=new Set([f.py.API_USAGE_STATE,f.py.TENANT_PROFILE,f.py.RPC,f.py.QUEUE,f.py.NOTIFICATION,f.py.NOTIFICATION_REQUEST,f.py.WIDGET_TYPE]);this._allowEntityTypeForEntityAction=Object.values(f.py).filter(t=>!n.has(t))}return this._allowEntityTypeForEntityAction}}Aa.\u0275fac=function(n){return new(n||Aa)(e.\u0275\u0275directiveInject(x.Store),e.\u0275\u0275directiveInject(b.Router),e.\u0275\u0275directiveInject(C.MatDialogRef),e.\u0275\u0275directiveInject(C.MAT_DIALOG_DATA),e.\u0275\u0275directiveInject(Ho.BreakpointObserver),e.\u0275\u0275directiveInject(r.FormBuilder),e.\u0275\u0275directiveInject(g.TranslateService),e.\u0275\u0275directiveInject(qe.g),e.\u0275\u0275directiveInject(C.MatDialog))},Aa.\u0275cmp=e.\u0275\u0275defineComponent({type:Aa,selectors:[["tb-rule-notification-dialog"]],viewQuery:function(n,t){if(1&n&&e.\u0275\u0275viewQuery(S1,7),2&n){let a;e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(t.addNotificationRule=a.first)}},features:[e.\u0275\u0275InheritDefinitionFeature],decls:58,vars:38,consts:[["color","primary"],["fxFlex",""],["tb-help","ruleNotifications"],["mat-icon-button","","type","button",3,"click"],[1,"material-icons"],["color","warn","mode","indeterminate",4,"ngIf"],["style","height: 4px;",4,"ngIf"],["mat-dialog-content","","ngStyle.xs","padding: 0;"],["labelPosition","end",3,"linear","orientation","selectionChange"],["addNotificationRule",""],["matStepperIcon","edit"],[3,"stepControl"],["matStepLabel",""],[3,"formGroup"],[1,"mat-block"],["translate",""],["matInput","","formControlName","name","required",""],[4,"ngIf"],["formControlName","enabled",2,"margin-bottom","22px"],["formControlName","triggerType","required",""],[3,"value",4,"ngFor","ngForOf"],["required","","allowCreate","","allowEdit","","formControlName","templateId",3,"notificationTypes"],["formGroupName","recipientsConfig",4,"ngIf","ngIfElse"],["alarmTargesConfig",""],["clearRules",""],[3,"stepControl",4,"ngIf"],["mat-dialog-actions","","fxLayout","row"],["mat-stroked-button","",3,"click",4,"ngIf"],["mat-raised-button","","color","primary",3,"click"],["color","warn","mode","indeterminate"],[2,"height","4px"],[3,"value"],["formGroupName","recipientsConfig"],["required","","formControlName","targets",3,"subType","entityType","placeholderText"],["mat-button","","color","primary","matSuffix","",3,"click"],["createTargetButton",""],[2,"white-space","nowrap"],["formGroupName","recipientsConfig",1,"fields-group","tb-hierarchy"],["translate","",1,"mat-body-2"],["formControlName","escalationTable"],[4,"ngTemplateOutlet"],["formGroupName","triggerConfig"],["formGroupName","clearRule"],["fxFlex","","floatLabel","always",1,"mat-block",2,"margin-right","48px"],["formControlName","alarmStatuses","multiple","",3,"placeholder"],[1,"fields-group","tb-margin-before-field"],["editable","","floatLabel","always","formControlName","alarmTypes",3,"label","placeholder"],["fxFlex","","floatLabel","always",1,"mat-block"],["formControlName","alarmSeverities","multiple","",3,"placeholder"],["fxFlex","",1,"mat-block"],["formControlName","notifyOn","multiple",""],["formGroupName","additionalConfig"],["matInput","","formControlName","description"],["fxFlex","","fxLayoutAlign","center center"],["formControlName","filterByDevice",1,"tb-notification-unread-toggle-group",2,"width","250px"],["fxFlex","",3,"value"],[4,"ngIf","ngIfElse"],["deviceProfile",""],["formControlName","devices","subscriptSizing","dynamic",3,"labelText","placeholderText","hint","entityType"],["formControlName","deviceProfiles","subscriptSizing","dynamic",3,"labelText","placeholderText","hint","entityType"],["formGroupName","triggerConfig",1,"fields-group","tb-margin"],["required","","ignoreAuthorityFilter","","formControlName","entityTypes",3,"allowedEntityTypes"],["fxLayout","column","fxLayoutGap","8px"],["fxFlex","","translate",""],["formControlName","created"],["formControlName","updated"],["formControlName","deleted"],[1,"fields-group","tb-margin"],["fxLayout","column"],["formControlName","onlyUserComments",2,"margin-bottom","12px"],["formControlName","notifyOnCommentUpdate",2,"margin-bottom","12px"],["formControlName","ruleChains","subscriptSizing","dynamic",3,"labelText","placeholderText","hint","entityType"],["formControlName","ruleChainEvents","multiple","",3,"placeholder"],["formControlName","onlyRuleChainLifecycleFailures"],["formControlName","trackRuleNodeEvents"],["formControlName","ruleNodeEvents","multiple","",3,"placeholder"],["formControlName","onlyRuleNodeLifecycleFailures"],["formControlName","entityTypes","ignoreAuthorityFilter","",3,"allowedEntityTypes"],["fxLayout","row","fxLayoutAlign","start center","fxLayout.xs","column","fxLayoutAlign.xs","stretch",1,"limit-slider-container"],["fxLayout","row","fxLayoutAlign","start center","fxFlex",""],["fxFlex","","min","0","max","1","step","0.01","discrete","",3,"displayWith"],["matSliderThumb","","formControlName","threshold"],[1,"limit-slider-value"],["matInput","","formControlName","threshold","type","number","step","0.01","min","0","max","1",3,"value"],["fxFlex","","subscriptSizing","dynamic",1,"mat-block"],["formControlName","apiFeatures","multiple",""],["formControlName","apis",3,"label","hint","predefinedValues"],["mat-stroked-button","",3,"click"]],template:function(n,t){if(1&n&&(e.\u0275\u0275elementStart(0,"mat-toolbar",0)(1,"h2"),e.\u0275\u0275text(2),e.\u0275\u0275pipe(3,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(4,"span",1)(5,"div",2),e.\u0275\u0275elementStart(6,"button",3),e.\u0275\u0275listener("click",function(){return t.cancel()}),e.\u0275\u0275elementStart(7,"mat-icon",4),e.\u0275\u0275text(8,"close"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275template(9,I1,1,0,"mat-progress-bar",5),e.\u0275\u0275pipe(10,"async"),e.\u0275\u0275template(11,w1,1,0,"div",6),e.\u0275\u0275pipe(12,"async"),e.\u0275\u0275elementStart(13,"div",7)(14,"mat-horizontal-stepper",8,9),e.\u0275\u0275listener("selectionChange",function(o){return t.changeStep(o)}),e.\u0275\u0275pipe(16,"async"),e.\u0275\u0275template(17,E1,2,0,"ng-template",10),e.\u0275\u0275elementStart(18,"mat-step",11),e.\u0275\u0275template(19,M1,2,3,"ng-template",12),e.\u0275\u0275elementStart(20,"form",13)(21,"mat-form-field",14)(22,"mat-label",15),e.\u0275\u0275text(23,"notification.rule-name"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(24,"input",16),e.\u0275\u0275template(25,D1,3,3,"mat-error",17),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(26,"mat-slide-toggle",18),e.\u0275\u0275text(27),e.\u0275\u0275pipe(28,"translate"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(29,"mat-form-field",14)(30,"mat-label",15),e.\u0275\u0275text(31,"notification.trigger.trigger"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(32,"mat-select",19),e.\u0275\u0275template(33,A1,3,4,"mat-option",20),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(34,N1,3,3,"mat-error",17),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(35,"tb-template-autocomplete",21),e.\u0275\u0275template(36,F1,8,8,"section",22),e.\u0275\u0275template(37,P1,7,1,"ng-template",null,23,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(39,R1,11,5,"ng-template",null,24,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(41,G1,28,15,"mat-step",25),e.\u0275\u0275template(42,z1,27,15,"mat-step",25),e.\u0275\u0275template(43,Y1,25,13,"mat-step",25),e.\u0275\u0275template(44,Z1,35,23,"mat-step",25),e.\u0275\u0275template(45,o_,34,19,"mat-step",25),e.\u0275\u0275template(46,c_,33,24,"mat-step",25),e.\u0275\u0275template(47,m_,21,6,"mat-step",25),e.\u0275\u0275template(48,b_,24,9,"mat-step",25),e.\u0275\u0275template(49,v_,8,2,"mat-step",25),e.\u0275\u0275template(50,x_,13,10,"mat-step",25),e.\u0275\u0275elementEnd()(),e.\u0275\u0275element(51,"mat-divider"),e.\u0275\u0275elementStart(52,"div",26),e.\u0275\u0275template(53,C_,3,3,"button",27),e.\u0275\u0275element(54,"span",1),e.\u0275\u0275elementStart(55,"button",28),e.\u0275\u0275listener("click",function(){return t.nextStep()}),e.\u0275\u0275text(56),e.\u0275\u0275pipe(57,"translate"),e.\u0275\u0275elementEnd()()),2&n){const a=e.\u0275\u0275reference(38);e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(3,26,t.dialogTitle)),e.\u0275\u0275advance(7),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(10,28,t.isLoading$)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!e.\u0275\u0275pipeBind1(12,30,t.isLoading$)),e.\u0275\u0275advance(3),e.\u0275\u0275property("linear",!0)("orientation",e.\u0275\u0275pipeBind1(16,32,t.stepperOrientation)),e.\u0275\u0275advance(4),e.\u0275\u0275property("stepControl",t.ruleNotificationForm),e.\u0275\u0275advance(2),e.\u0275\u0275property("formGroup",t.ruleNotificationForm),e.\u0275\u0275advance(5),e.\u0275\u0275property("ngIf",t.ruleNotificationForm.get("name").hasError("required")),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(28,34,"notification.rule-enable")," "),e.\u0275\u0275advance(6),e.\u0275\u0275property("ngForOf",t.triggerTypes),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.ruleNotificationForm.get("triggerType").hasError("required")),e.\u0275\u0275advance(1),e.\u0275\u0275property("notificationTypes",t.ruleNotificationForm.get("triggerType").value),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.ruleNotificationForm.get("triggerType").value!==t.triggerType.ALARM)("ngIfElse",a),e.\u0275\u0275advance(5),e.\u0275\u0275property("ngIf",t.ruleNotificationForm.get("triggerType").value===t.triggerType.ALARM),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.ruleNotificationForm.get("triggerType").value===t.triggerType.DEVICE_ACTIVITY),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.ruleNotificationForm.get("triggerType").value===t.triggerType.ENTITY_ACTION),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.ruleNotificationForm.get("triggerType").value===t.triggerType.ALARM_COMMENT),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.ruleNotificationForm.get("triggerType").value===t.triggerType.ALARM_ASSIGNMENT),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.ruleNotificationForm.get("triggerType").value===t.triggerType.RULE_ENGINE_COMPONENT_LIFECYCLE_EVENT),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.ruleNotificationForm.get("triggerType").value===t.triggerType.ENTITIES_LIMIT),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.ruleNotificationForm.get("triggerType").value===t.triggerType.API_USAGE_LIMIT),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.ruleNotificationForm.get("triggerType").value===t.triggerType.NEW_PLATFORM_VERSION),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",t.ruleNotificationForm.get("triggerType").value===t.triggerType.RATE_LIMITS),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",t.selectedIndex>0),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(57,36,t.nextStepLabel()))}},dependencies:[p.NgForOf,p.NgIf,p.NgTemplateOutlet,De.HelpComponent,Cr.EntityListComponent,m1.EntityTypeListComponent,po.StringItemsListComponent,S.MatButton,S.MatIconButton,mi.MatButtonToggleGroup,mi.MatButtonToggle,F.MatIcon,z.MatProgressBar,O.MatInput,_.MatFormField,_.MatLabel,_.MatHint,_.MatError,_.MatSuffix,oe.MatToolbar,C.MatDialogContent,C.MatDialogActions,ye.MatSelect,X.MatOption,kn.MatDivider,Ce.MatSlideToggle,Tr.MatSlider,Tr.MatSliderThumb,Q.MatStep,Q.MatStepLabel,Q.MatStepper,Q.MatStepperIcon,h.DefaultLayoutDirective,h.DefaultLayoutGapDirective,h.DefaultLayoutAlignDirective,h.DefaultFlexDirective,G.DefaultStyleDirective,r.\u0275NgNoValidate,r.DefaultValueAccessor,r.NumberValueAccessor,r.NgControlStatus,r.NgControlStatusGroup,r.RequiredValidator,r.MinValidator,r.MaxValidator,r.FormGroupDirective,r.FormControlName,r.FormGroupName,g.TranslateDirective,u1.TemplateAutocompleteComponent,nt,p.AsyncPipe,g.TranslatePipe],styles:['@charset "UTF-8";[_nghost-%COMP%]{width:900px;height:100%;max-width:100%;max-height:100vh;display:flex;flex-direction:column}[_nghost-%COMP%]   .tb-hint[_ngcontent-%COMP%]{margin-top:-1.25em;padding:0}[_nghost-%COMP%]   .fields-group[_ngcontent-%COMP%]{padding:0 16px;border:1px groove rgba(171,171,171,.25);border-radius:4px}[_nghost-%COMP%]   .fields-group.tb-margin[_ngcontent-%COMP%]{margin-bottom:12px}[_nghost-%COMP%]   .fields-group.tb-margin-before-field[_ngcontent-%COMP%]{margin-bottom:12px}[_nghost-%COMP%]   .fields-group.tb-hierarchy[_ngcontent-%COMP%]{padding:0 0 8px 16px}[_nghost-%COMP%]   .fields-group[_ngcontent-%COMP%]   legend[_ngcontent-%COMP%]{margin-bottom:8px;width:-moz-fit-content;width:fit-content}[_nghost-%COMP%]   .fields-group[_ngcontent-%COMP%]   .mat-body-2[_ngcontent-%COMP%]{margin-bottom:8px}[_nghost-%COMP%]   .fields-group[_ngcontent-%COMP%]   .clear-button-space[_ngcontent-%COMP%]{margin-right:48px}[_nghost-%COMP%]   .fields-group[_ngcontent-%COMP%]   .mat-mdc-slide-toggle[_ngcontent-%COMP%]{margin-bottom:16px}[_nghost-%COMP%]   .limit-slider-container[_ngcontent-%COMP%]   .limit-slider-value[_ngcontent-%COMP%]{margin-left:16px;min-width:25px;max-width:100px}[_nghost-%COMP%]   .limit-slider-container[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%]{text-align:center}@media screen and (min-width: 960px){[_nghost-%COMP%]   .history-time-input[_ngcontent-%COMP%]{min-width:364px}[_nghost-%COMP%]   .limit-slider-container[_ngcontent-%COMP%] > label[_ngcontent-%COMP%]{margin-right:16px;width:min-content;max-width:40%}}[_nghost-%COMP%]     .mat-mdc-dialog-content{display:flex;flex-direction:column;height:100%;padding:0!important}[_nghost-%COMP%]     .mat-mdc-dialog-content .mat-stepper-horizontal{display:flex;height:100%;overflow:hidden}[_nghost-%COMP%]     .mat-mdc-dialog-content .mat-stepper-horizontal .mat-horizontal-stepper-wrapper{flex:1 1 100%}[_nghost-%COMP%]     .mat-mdc-dialog-content .mat-stepper-horizontal .mat-horizontal-content-container{height:700px;max-height:100%;width:100%;overflow-y:auto;scrollbar-gutter:stable}@media screen and (min-width: 960px){[_nghost-%COMP%]     .mat-mdc-dialog-content .mat-stepper-horizontal .mat-horizontal-content-container{min-width:500px}}[_nghost-%COMP%]     .mat-button-toggle-group.tb-notification-unread-toggle-group.mat-button-toggle-group-appearance-standard{border:none;border-radius:18px;margin-bottom:8px}[_nghost-%COMP%]     .mat-button-toggle-group.tb-notification-unread-toggle-group.mat-button-toggle-group-appearance-standard .mat-button-toggle+.mat-button-toggle{border-left:none}[_nghost-%COMP%]     .mat-button-toggle-group.tb-notification-unread-toggle-group .mat-button-toggle{height:36px;align-items:center;display:flex}[_nghost-%COMP%]     .mat-button-toggle-group.tb-notification-unread-toggle-group .mat-button-toggle .mat-button-toggle-ripple{inset:2px;border-radius:18px}[_nghost-%COMP%]     .mat-button-toggle-group.tb-notification-unread-toggle-group .mat-button-toggle-focus-overlay{border-radius:18px;margin:2px}[_nghost-%COMP%]     .mat-button-toggle-group.tb-notification-unread-toggle-group .mat-button-toggle-checked .mat-button-toggle-button{background-color:#424242;border-radius:18px;margin-left:2px;margin-right:2px}[_nghost-%COMP%]     .mat-button-toggle-group.tb-notification-unread-toggle-group .mat-button-toggle-appearance-standard .mat-button-toggle-label-content{line-height:34px;font-size:16px;font-weight:500}[_nghost-%COMP%]     .mat-button-toggle-group.tb-notification-unread-toggle-group .mat-button-toggle-checked.mat-button-toggle-appearance-standard:not(.mat-button-toggle-disabled):hover .mat-button-toggle-focus-overlay{opacity:.01}']});class si{constructor(n,t,a,o){this.notificationService=n,this.translate=t,this.dialog=a,this.datePipe=o,this.config=new v.ap,this.config.entityType=f.py.NOTIFICATION_RULE,this.config.detailsPanelEnabled=!1,this.config.addEnabled=!1,this.config.rowPointer=!0,this.config.entityTranslations=f.Jr.get(f.py.NOTIFICATION_RULE),this.config.entityResources={},this.config.entitiesFetchFunction=s=>this.notificationService.getNotificationRules(s),this.config.deleteEntityTitle=s=>this.translate.instant("notification.delete-rule-title",{ruleName:s.name}),this.config.deleteEntityContent=()=>this.translate.instant("notification.delete-rule-text"),this.config.deleteEntitiesTitle=s=>this.translate.instant("notification.delete-rules-title",{count:s}),this.config.deleteEntitiesContent=()=>this.translate.instant("notification.delete-rules-text"),this.config.deleteEntity=s=>this.notificationService.deleteNotificationRule(s.id),this.config.cellActionDescriptors=this.configureCellActions(),this.config.headerComponent=Da,this.config.onEntityAction=s=>this.onTargetAction(s),this.config.defaultSortOrder={property:"createdTime",direction:pt.N.DESC},this.config.handleRowClick=(s,l)=>(this.editRule(s,l),!0),this.config.columns.push(new v.eq("createdTime","common.created-time",this.datePipe,"170px"),new v.QI("name","notification.rule-name","30%"),new v.QI("templateName","notification.template","20%"),new v.QI("triggerType","notification.trigger.trigger","20%",s=>this.translate.instant(D.PA.get(s.triggerType))||"",()=>({}),!0),new v.QI("additionalConfig.description","notification.description","30%",s=>s.additionalConfig?.description||"",()=>({}),!1))}resolve(n){return this.config}configureCellActions(){return[{name:"",nameFunction:n=>this.translate.instant(n.enabled?"notification.rule-disable":"notification.rule-enable"),icon:"mdi:toggle-switch",isEnabled:()=>!0,iconFunction:n=>n.enabled?"mdi:toggle-switch":"mdi:toggle-switch-off-outline",onAction:(n,t)=>this.toggleEnableMode(n,t)},{name:this.translate.instant("notification.copy-rule"),icon:"content_copy",isEnabled:()=>!0,onAction:(n,t)=>this.editRule(n,t,!1,!0)}]}editRule(n,t,a=!1,o=!1){n&&n.stopPropagation(),this.dialog.open(Aa,{disableClose:!0,panelClass:["tb-dialog","tb-fullscreen-dialog"],data:{isAdd:a,isCopy:o,rule:t}}).afterClosed().subscribe(s=>{s&&this.config.updateData()})}onTargetAction(n){return"add"===n.action&&(this.editRule(n.event,n.entity,!0),!0)}toggleEnableMode(n,t){n&&n.stopPropagation();const a={...t,enabled:!t.enabled};this.notificationService.saveNotificationRule(a,{ignoreLoading:!0}).subscribe(o=>{t.enabled=o.enabled,this.config.getTable().detectChanges()})}}si.\u0275fac=function(n){return new(n||si)(e.\u0275\u0275inject(qe.g),e.\u0275\u0275inject(g.TranslateService),e.\u0275\u0275inject(C.MatDialog),e.\u0275\u0275inject(p.DatePipe))},si.\u0275prov=e.\u0275\u0275defineInjectable({token:si,factory:si.\u0275fac});var T_=c(41193);const S_=[{path:"notification",component:ja.x,data:{auth:[u.W.TENANT_ADMIN,u.W.CUSTOMER_USER,u.W.SYS_ADMIN],breadcrumb:{label:"notification.notification-center",icon:"mdi:message-badge"},routerTabsHeaderComponent:T_.E},children:[{path:"",children:[],data:{auth:[u.W.TENANT_ADMIN,u.W.CUSTOMER_USER,u.W.SYS_ADMIN],redirectTo:"/notification/inbox"}},{path:"inbox",component:j.EntitiesTableComponent,data:{auth:[u.W.TENANT_ADMIN,u.W.CUSTOMER_USER,u.W.SYS_ADMIN],title:"notification.inbox",breadcrumb:{label:"notification.inbox",icon:"inbox"}},resolve:{entitiesTableConfig:ii}},{path:"sent",component:j.EntitiesTableComponent,data:{auth:[u.W.TENANT_ADMIN,u.W.SYS_ADMIN],title:"notification.sent",breadcrumb:{label:"notification.sent",icon:"outbox"}},resolve:{entitiesTableConfig:ai}},{path:"templates",component:j.EntitiesTableComponent,data:{auth:[u.W.TENANT_ADMIN,u.W.SYS_ADMIN],title:"notification.templates",breadcrumb:{label:"notification.templates",icon:"mdi:message-draw"}},resolve:{entitiesTableConfig:ri}},{path:"recipients",component:j.EntitiesTableComponent,data:{auth:[u.W.TENANT_ADMIN,u.W.SYS_ADMIN],title:"notification.recipients",breadcrumb:{label:"notification.recipients",icon:"contacts"}},resolve:{entitiesTableConfig:oi}},{path:"rules",component:j.EntitiesTableComponent,data:{auth:[u.W.TENANT_ADMIN,u.W.SYS_ADMIN],title:"notification.rules",breadcrumb:{label:"notification.rules",icon:"mdi:message-cog"}},resolve:{entitiesTableConfig:si}}]}];class En{}function I_(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",6)(1,"div",7)(2,"mat-checkbox",8),e.\u0275\u0275listener("click",function(){const s=e.\u0275\u0275restoreView(t).$implicit,l=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(l.toggleDeliviryMethod(s))}),e.\u0275\u0275elementEnd()()()}if(2&i){const t=n.$implicit,a=e.\u0275\u0275nextContext();e.\u0275\u0275advance(2),e.\u0275\u0275property("checked",a.getChecked(t))}}En.\u0275fac=function(n){return new(n||En)},En.\u0275mod=e.\u0275\u0275defineNgModule({type:En}),En.\u0275inj=e.\u0275\u0275defineInjector({providers:[ii,ai,oi,ri,si],imports:[b.RouterModule.forChild(S_),b.RouterModule]}),(typeof ngJitMode>"u"||ngJitMode)&&e.\u0275\u0275setNgModuleScope(En,{imports:[b.RouterModule],exports:[b.RouterModule]});const w_=function(i){return{"notification-type-disabled":i}};class li{constructor(n){this.fb=n,this.deliveryMethods=[],this.notificationTemplateTypeTranslateMap=D.as,this.propagateChange=null,this.valueChange$=null}registerOnChange(n){this.propagateChange=n}registerOnTouched(n){}ngOnInit(){const n={};this.deliveryMethods.forEach(t=>{n[t]=!0}),this.notificationSettingsFormGroup=this.fb.group({name:[""],enabled:[!0],enabledDeliveryMethods:this.fb.group({...n})}),this.valueChange$=this.notificationSettingsFormGroup.valueChanges.subscribe(()=>{this.updateModel()})}ngOnDestroy(){this.valueChange$&&(this.valueChange$.unsubscribe(),this.valueChange$=null)}setDisabledState(n){this.disabled=n,this.disabled?this.notificationSettingsFormGroup.disable({emitEvent:!1}):this.notificationSettingsFormGroup.enable({emitEvent:!1})}getChecked(n){if(n)return this.notificationSettingsFormGroup.get("enabledDeliveryMethods").get(n).value;{const t=Object.values(this.notificationSettingsFormGroup.get("enabledDeliveryMethods").value),a=t.some(o=>!0===o);return a!==this.notificationSettingsFormGroup.get("enabled").value&&setTimeout(()=>this.notificationSettingsFormGroup.get("enabled").patchValue(a),0),t.every(o=>o)}}toggleDeliviryMethod(n){this.notificationSettingsFormGroup.get("enabledDeliveryMethods").get(n).patchValue(!this.notificationSettingsFormGroup.get("enabledDeliveryMethods").get(n).value)}changeInstanceTypeCheckBox(n){const t=(0,T.I8)(this.notificationSettingsFormGroup.get("enabledDeliveryMethods").value);Object.keys(t).forEach(a=>{t[a]=n}),this.notificationSettingsFormGroup.get("enabled").patchValue(n,{emitEvent:!1}),this.notificationSettingsFormGroup.get("enabledDeliveryMethods").patchValue(t),this.notificationSettingsFormGroup.markAsDirty()}getIndeterminate(){if(!this.notificationSettingsFormGroup.get("enabled").value)return!1;const n=Object.values(this.notificationSettingsFormGroup.get("enabledDeliveryMethods").value),t=n.filter(a=>a);return 0!==t.length&&t.length!==n.length}writeValue(n){(0,T.nu)(n)&&this.notificationSettingsFormGroup.patchValue(n,{emitEvent:!1})}updateModel(){this.propagateChange(this.notificationSettingsFormGroup.value)}}function E_(i,n){1&i&&e.\u0275\u0275element(0,"mat-progress-bar",20)}function M_(i,n){1&i&&e.\u0275\u0275element(0,"div",21)}function D_(i,n){if(1&i){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",22)(1,"div",23)(2,"mat-checkbox",24),e.\u0275\u0275listener("change",function(o){const l=e.\u0275\u0275restoreView(t).$implicit,d=e.\u0275\u0275nextContext();return e.\u0275\u0275resetView(d.changeInstanceTypeCheckBox(o.checked,l))})("click",function(o){return o.stopPropagation()}),e.\u0275\u0275elementStart(3,"mat-label"),e.\u0275\u0275text(4),e.\u0275\u0275pipe(5,"translate"),e.\u0275\u0275elementEnd()()()()}if(2&i){const t=n.$implicit,a=e.\u0275\u0275nextContext();e.\u0275\u0275advance(2),e.\u0275\u0275property("checked",a.getChecked(t))("indeterminate",a.getIndeterminate(t)),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(5,3,a.notificationDeliveryMethodTranslateMap.get(t)))}}function A_(i,n){1&i&&e.\u0275\u0275element(0,"mat-divider")}function N_(i,n){if(1&i&&(e.\u0275\u0275elementStart(0,"div"),e.\u0275\u0275element(1,"tb-notification-setting-form",25),e.\u0275\u0275template(2,A_,1,0,"mat-divider",26),e.\u0275\u0275elementEnd()),2&i){const t=n.$implicit,a=n.last,o=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("formControl",t)("deliveryMethods",o.notificationDeliveryMethods),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!a)}}li.\u0275fac=function(n){return new(n||li)(e.\u0275\u0275directiveInject(r.UntypedFormBuilder))},li.\u0275cmp=e.\u0275\u0275defineComponent({type:li,selectors:[["tb-notification-setting-form"]],inputs:{disabled:"disabled",deliveryMethods:"deliveryMethods"},features:[e.\u0275\u0275ProvidersFeature([{provide:r.NG_VALUE_ACCESSOR,useExisting:(0,e.forwardRef)(()=>li),multi:!0}])],decls:8,vars:10,consts:[["fxLayout","column",3,"formGroup"],["fxLayout","row",2,"height","48px"],["fxFlex","50","fxLayoutAlign","start center"],["color","primary",3,"checked","indeterminate","click","change"],[1,"notification-type",3,"ngClass"],["fxFlex","","fxLayout","row",4,"ngFor","ngForOf"],["fxFlex","","fxLayout","row"],["fxFlex","","fxLayoutAlign","start center"],["color","primary",3,"checked","click"]],template:function(n,t){if(1&n&&(e.\u0275\u0275elementStart(0,"form",0)(1,"div",1)(2,"div",2)(3,"mat-checkbox",3),e.\u0275\u0275listener("click",function(o){return o.stopPropagation()})("change",function(o){return t.changeInstanceTypeCheckBox(o.checked)}),e.\u0275\u0275elementStart(4,"span",4),e.\u0275\u0275text(5),e.\u0275\u0275pipe(6,"translate"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275template(7,I_,3,1,"div",5),e.\u0275\u0275elementEnd()()),2&n){let a;e.\u0275\u0275property("formGroup",t.notificationSettingsFormGroup),e.\u0275\u0275advance(3),e.\u0275\u0275property("checked",t.getChecked())("indeterminate",t.getIndeterminate()),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction1(8,w_,!t.notificationSettingsFormGroup.get("enabled").value)),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(6,6,null==(a=t.notificationTemplateTypeTranslateMap.get(t.notificationSettingsFormGroup.get("name").value))?null:a.name)," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",t.deliveryMethods)}},dependencies:[p.NgClass,p.NgForOf,fe.MatCheckbox,h.DefaultLayoutDirective,h.DefaultLayoutAlignDirective,h.DefaultFlexDirective,G.DefaultClassDirective,r.\u0275NgNoValidate,r.NgControlStatusGroup,r.FormGroupDirective,g.TranslatePipe],styles:['@charset "UTF-8";[_nghost-%COMP%]   .notification-type[_ngcontent-%COMP%]{font-size:14px}[_nghost-%COMP%]   .notification-type-disabled[_ngcontent-%COMP%]{color:#00000061}']});class Na extends se.I{constructor(n,t,a,o,s,l){super(n),this.store=n,this.route=t,this.translate=a,this.dialogService=o,this.notificationService=s,this.fb=l,this.notificationDeliveryMethodTranslateMap=D.WG,this.deliveryMethods=new Set([D.Js.SLACK,D.Js.MICROSOFT_TEAMS]),this.getChecked=(d=null)=>{const m=this.notificationSettings.get("prefs").value;return(0,T.nu)(d)?(0,T.nu)(m)&&m.every(y=>y.enabledDeliveryMethods[d]):(0,T.nu)(m)&&m.every(y=>y.enabled)},this.getSomeChecked=()=>{const d=this.notificationSettings.get("prefs").value;return(0,T.nu)(d)&&d.some(m=>m.enabled)},this.getIndeterminate=(d=null)=>{const m=this.notificationSettings.get("prefs").value;if((0,T.nu)(m)){const y=(0,T.nu)(d)?m.filter(I=>I.enabledDeliveryMethods[d]):m.filter(I=>I.enabled);return 0!==y.length&&y.length!==m.length}return!1},this.changeInstanceTypeCheckBox=(d,m=null)=>{const y=(0,T.I8)(this.notificationSettings.get("prefs").value);(0,T.nu)(m)?y.forEach(I=>I.enabledDeliveryMethods[m]=d):y.forEach(I=>{I.enabled=d,I.enabledDeliveryMethods=Object.keys(I.enabledDeliveryMethods).reduce((E,L)=>({...E,[L]:d}),{})}),this.notificationSettings.get("prefs").patchValue(y,{emitEvent:!1}),this.notificationSettings.markAsDirty()},this.notificationService.getAvailableDeliveryMethods({ignoreLoading:!0}).subscribe(d=>{this.notificationDeliveryMethods=d.filter(m=>!this.deliveryMethods.has(m)),this.patchNotificationSettings(this.route.snapshot.data.userSettings)})}ngOnInit(){this.buildNotificationSettingsForm()}buildNotificationSettingsForm(){this.notificationSettings=this.fb.group({prefs:this.fb.array([])})}patchNotificationSettings(n){const t=[];n.prefs&&this.prepareNotificationSettings(n.prefs).forEach(a=>t.push(this.fb.control(a,[r.Validators.required]))),this.notificationSettings.setControl("prefs",this.fb.array(t),{emitEvent:!1})}prepareNotificationSettings(n){return Object.entries(n).map(t=>{if(t[1].name=t[0],!t[1].enabled&&Object.values(t[1].enabledDeliveryMethods).some(a=>!0===a)){const a=(0,T.I8)(t[1].enabledDeliveryMethods);Object.keys(a).forEach(o=>{a[o]=!1}),t[1].enabledDeliveryMethods=a}return t[1].enabledDeliveryMethods=Object.assign(this.notificationDeliveryMethods.reduce((a,o)=>({...a,[o]:!0}),{}),t[1].enabledDeliveryMethods),t[1]})}resetSettings(){this.dialogService.confirm(this.translate.instant("notification.settings.reset-all-title"),this.translate.instant("notification.settings.reset-all-text"),this.translate.instant("action.no"),this.translate.instant("action.yes"),!0).subscribe(n=>{if(n){const t=this.prepareNotificationSettings(this.route.snapshot.data.userSettings.prefs),a=[];this.notificationSettings.reset({}),t&&t.forEach(o=>{o.enabled=!0,o.enabledDeliveryMethods=this.notificationDeliveryMethods.reduce((s,l)=>({...s,[l]:!0}),{}),a.push(this.fb.control(o,[r.Validators.required]))}),this.notificationSettings.setControl("prefs",this.fb.array(a),{emitEvent:!1}),this.save()}})}get notificationSettingsFormArray(){return this.notificationSettings.get("prefs")}save(){const n={prefs:{}};this.notificationSettings.getRawValue().prefs.forEach(t=>{const a=t.name;delete t.name,n.prefs[a]=t}),this.notificationService.saveNotificationUserSettings(n).subscribe(t=>{this.notificationSettings.get("prefs").reset({}),this.patchNotificationSettings(t)})}confirmForm(){return this.notificationSettings}}Na.\u0275fac=function(n){return new(n||Na)(e.\u0275\u0275directiveInject(x.Store),e.\u0275\u0275directiveInject(b.ActivatedRoute),e.\u0275\u0275directiveInject(g.TranslateService),e.\u0275\u0275directiveInject(pe.x),e.\u0275\u0275directiveInject(qe.g),e.\u0275\u0275directiveInject(r.UntypedFormBuilder))},Na.\u0275cmp=e.\u0275\u0275defineComponent({type:Na,selectors:[["tb-notification-settings"]],features:[e.\u0275\u0275InheritDefinitionFeature],decls:33,vars:23,consts:[["appearance","outlined",1,"settings-card","tb-absolute-fill"],["fxFlex","","fxLayout","row","fxLayout.xs","column","fxLayoutGap.xs","8px","fxLayoutAlign","space-between start","fxLayoutAlign.xs","start start"],["fxFlex","","fxLayout","column"],["translate","",1,"mat-headline-5"],["fxLayout","column"],["mat-button","","color","primary",3,"disabled","click"],["color","warn","mode","indeterminate",4,"ngIf"],["style","height: 4px;",4,"ngIf"],[2,"padding-top","16px","overflow","hidden"],[1,"notification-form",3,"formGroup"],[1,"notification-section"],[1,"notification-section-block"],["fxLayout","row","fxLayoutAlign","start center",2,"height","44px"],["fxFlex","50"],["color","warn",3,"indeterminate","checked","click","change"],["translate",""],["fxFlex","",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],["fxLayout","row","fxLayoutAlign","end start",2,"padding","16px"],["mat-button","","mat-raised-button","","color","primary","type","button",3,"disabled","click"],["color","warn","mode","indeterminate"],[2,"height","4px"],["fxFlex",""],["fxFlex","","fxLayoutAlign","start center"],["color","warn",3,"checked","indeterminate","change","click"],[3,"formControl","deliveryMethods"],[4,"ngIf"]],template:function(n,t){1&n&&(e.\u0275\u0275elementStart(0,"div")(1,"mat-card",0)(2,"mat-card-header")(3,"div",1)(4,"div",2)(5,"span",3),e.\u0275\u0275text(6,"notification.settings.notification-settings"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(7,"div",4)(8,"button",5),e.\u0275\u0275listener("click",function(){return t.resetSettings()}),e.\u0275\u0275pipe(9,"async"),e.\u0275\u0275text(10),e.\u0275\u0275pipe(11,"translate"),e.\u0275\u0275elementEnd()()()(),e.\u0275\u0275template(12,E_,1,0,"mat-progress-bar",6),e.\u0275\u0275pipe(13,"async"),e.\u0275\u0275template(14,M_,1,0,"div",7),e.\u0275\u0275pipe(15,"async"),e.\u0275\u0275elementStart(16,"mat-card-content",8)(17,"form",9)(18,"section",10)(19,"div",11)(20,"div",12)(21,"div",13)(22,"mat-checkbox",14),e.\u0275\u0275listener("click",function(o){return o.stopPropagation()})("change",function(o){return t.changeInstanceTypeCheckBox(o.checked)}),e.\u0275\u0275elementStart(23,"mat-label",15),e.\u0275\u0275text(24,"notification.settings.type"),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275template(25,D_,6,5,"div",16),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(26,"mat-divider"),e.\u0275\u0275template(27,N_,3,3,"div",17),e.\u0275\u0275elementEnd()()()(),e.\u0275\u0275elementStart(28,"div",18)(29,"button",19),e.\u0275\u0275listener("click",function(){return t.save()}),e.\u0275\u0275pipe(30,"async"),e.\u0275\u0275text(31),e.\u0275\u0275pipe(32,"translate"),e.\u0275\u0275elementEnd()()()()),2&n&&(e.\u0275\u0275advance(8),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(9,11,t.isLoading$)),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(11,13,"notification.settings.reset-all")),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(13,15,t.isLoading$)),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",!e.\u0275\u0275pipeBind1(15,17,t.isLoading$)),e.\u0275\u0275advance(3),e.\u0275\u0275property("formGroup",t.notificationSettings),e.\u0275\u0275advance(5),e.\u0275\u0275property("indeterminate",t.getIndeterminate())("checked",t.getChecked()),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngForOf",t.notificationDeliveryMethods),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",t.notificationSettingsFormArray.controls),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",e.\u0275\u0275pipeBind1(30,19,t.isLoading$)||t.notificationSettings.invalid||!t.notificationSettings.dirty),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(32,21,"action.save")," "))},dependencies:[p.NgForOf,p.NgIf,S.MatButton,fe.MatCheckbox,A.MatCard,A.MatCardContent,A.MatCardHeader,z.MatProgressBar,_.MatLabel,kn.MatDivider,h.DefaultLayoutDirective,h.DefaultLayoutGapDirective,h.DefaultLayoutAlignDirective,h.DefaultFlexDirective,r.\u0275NgNoValidate,r.NgControlStatus,r.NgControlStatusGroup,r.FormControlDirective,r.FormGroupDirective,g.TranslateDirective,li,p.AsyncPipe,g.TranslatePipe],styles:['@charset "UTF-8";[_nghost-%COMP%]   .mat-mdc-card.settings-card[_ngcontent-%COMP%]{margin:8px}@media screen and (min-width: 960px){[_nghost-%COMP%]   .mat-mdc-card.settings-card[_ngcontent-%COMP%]{width:60%}}[_nghost-%COMP%]   .mat-mdc-card.settings-card[_ngcontent-%COMP%]   .mat-headline-5[_ngcontent-%COMP%]{margin:0}[_nghost-%COMP%]   .mat-mdc-card.settings-card[_ngcontent-%COMP%]   .notification-form[_ngcontent-%COMP%]{height:100%;min-height:min-content;max-height:min-content}[_nghost-%COMP%]   .mat-mdc-card.settings-card[_ngcontent-%COMP%]   .notification-section[_ngcontent-%COMP%]{height:100%;border:1px solid rgba(0,0,0,.12);overflow:scroll}[_nghost-%COMP%]   .mat-mdc-card.settings-card[_ngcontent-%COMP%]   .notification-section-block[_ngcontent-%COMP%]{min-width:470px}']});var F_=c(4215),L_=c(90291),P_=c(17435),k_=c(42834);class Mn{}Mn.\u0275fac=function(n){return new(n||Mn)},Mn.\u0275mod=e.\u0275\u0275defineNgModule({type:Mn}),Mn.\u0275inj=e.\u0275\u0275defineInjector({imports:[p.CommonModule,M.m,En,k.W]}),(typeof ngJitMode>"u"||ngJitMode)&&e.\u0275\u0275setNgModuleScope(Mn,{declarations:[Sa,Ia,wa,_r.m,Za.U,Ea,To.A,Ma,wn,nt,Aa,Da,Na,li],imports:[p.CommonModule,M.m,En,k.W]}),e.\u0275\u0275setComponentScope(To.A,[p.NgClass,p.NgForOf,p.NgIf,De.HelpComponent,Ro.HelpPopupComponent,vi.DashboardAutocompleteComponent,F_.H,S.MatButton,S.MatIconButton,F.MatIcon,z.MatProgressBar,O.MatInput,_.MatFormField,_.MatLabel,_.MatError,L_.IC,oe.MatToolbar,C.MatDialogContent,C.MatDialogActions,ye.MatSelect,X.MatOption,kn.MatDivider,Ce.MatSlideToggle,U.MatExpansionPanel,U.MatExpansionPanelHeader,U.MatExpansionPanelTitle,U.MatExpansionPanelContent,Q.MatStep,Q.MatStepLabel,Q.MatStepper,Q.MatStepperIcon,Q.MatStepContent,h.DefaultLayoutDirective,h.DefaultLayoutGapDirective,h.DefaultLayoutAlignDirective,h.DefaultFlexDirective,G.DefaultClassDirective,r.\u0275NgNoValidate,r.DefaultValueAccessor,r.NgControlStatus,r.NgControlStatusGroup,r.RequiredValidator,r.FormGroupDirective,r.FormControlName,r.FormGroupName,P_.PG,Eo.ColorInputComponent,k_.MaterialIconSelectComponent,g.TranslateDirective],[p.AsyncPipe,g.TranslatePipe]);const R_=[{path:"notificationSettings",component:Na,canDeactivate:[N.P],data:{auth:[u.W.SYS_ADMIN,u.W.TENANT_ADMIN,u.W.CUSTOMER_USER],title:"account.notification-settings",breadcrumb:{label:"account.notification-settings",icon:"settings"}},resolve:{userSettings:()=>(0,e.inject)(qe.g).getNotificationUserSettings()}}],O_=[{path:"account",component:ja.x,data:{auth:[u.W.SYS_ADMIN,u.W.TENANT_ADMIN,u.W.CUSTOMER_USER],breadcrumb:{label:"account.account",icon:"account_circle"},useChildrenRoutesForTabs:!0},resolve:{replaceUrl:()=>(0,q.dE)((0,e.inject)(x.Store)).forceFullscreen},children:[{path:"",children:[],data:{auth:[u.W.SYS_ADMIN,u.W.TENANT_ADMIN,u.W.CUSTOMER_USER],redirectTo:"/account/profile"}},...xm,...Mu,...R_]}];class Dn{}Dn.\u0275fac=function(n){return new(n||Dn)},Dn.\u0275mod=e.\u0275\u0275defineNgModule({type:Dn}),Dn.\u0275inj=e.\u0275\u0275defineInjector({imports:[b.RouterModule.forChild(O_),b.RouterModule]}),(typeof ngJitMode>"u"||ngJitMode)&&e.\u0275\u0275setNgModuleScope(Dn,{imports:[b.RouterModule],exports:[b.RouterModule]});class An{}An.\u0275fac=function(n){return new(n||An)},An.\u0275mod=e.\u0275\u0275defineNgModule({type:An}),An.\u0275inj=e.\u0275\u0275defineInjector({imports:[p.CommonModule,Dn]}),(typeof ngJitMode>"u"||ngJitMode)&&e.\u0275\u0275setNgModuleScope(An,{imports:[p.CommonModule,Dn]});class di{}di.\u0275fac=function(n){return new(n||di)},di.\u0275mod=e.\u0275\u0275defineNgModule({type:di}),di.\u0275inj=e.\u0275\u0275defineInjector({imports:[vt,xt,Tt,It,nn,Nt,on,hn,yn,Tn,In,Mn,jt,qt,xn,dn,Ht,Ot,Qt,Xt,Zt,Bt,sn,mn,Ut,gn,An]}),(typeof ngJitMode>"u"||ngJitMode)&&e.\u0275\u0275setNgModuleScope(di,{exports:[vt,xt,Tt,It,nn,Nt,on,hn,yn,Tn,In,Mn,jt,qt,xn,dn,Ht,Ot,Qt,Xt,Zt,Bt,sn,mn,Ut,gn,An]})}}]);